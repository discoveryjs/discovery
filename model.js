var s1=Object.create;var ua=Object.defineProperty;var a1=Object.getOwnPropertyDescriptor;var l1=Object.getOwnPropertyNames;var u1=Object.getPrototypeOf,c1=Object.prototype.hasOwnProperty;var f1=(n,t,i)=>t in n?ua(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var It=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),Ke=(n,t)=>{for(var i in t)ua(n,i,{get:t[i],enumerable:!0})},d1=(n,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of l1(t))!c1.call(n,u)&&u!==i&&ua(n,u,{get:()=>t[u],enumerable:!(o=a1(t,u))||o.enumerable});return n};var Bn=(n,t,i)=>(i=n!=null?s1(u1(n)):{},d1(t||!n||!n.__esModule?ua(i,"default",{value:n,enumerable:!0}):i,n));var Cp=(n,t,i)=>(f1(n,typeof t!="symbol"?t+"":t,i),i);var Cr=It((fu,du)=>{(function(n,t){typeof fu=="object"&&typeof du<"u"?du.exports=t():typeof define=="function"&&define.amd?define(t):(n=n||self,n.CodeMirror=t())})(fu,function(){"use strict";var n=navigator.userAgent,t=navigator.platform,i=/gecko\/\d/i.test(n),o=/MSIE \d/.test(n),u=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(n),c=/Edge\/(\d+)/.exec(n),f=o||u||c,p=f&&(o?document.documentMode||6:+(c||u)[1]),m=!c&&/WebKit\//.test(n),y=m&&/Qt\/\d+\.\d+/.test(n),x=!c&&/Chrome\//.test(n),S=/Opera\//.test(n),k=/Apple Computer/.test(navigator.vendor),T=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(n),O=/PhantomJS/.test(n),E=k&&(/Mobile\/\w+/.test(n)||navigator.maxTouchPoints>2),M=/Android/.test(n),_=E||M||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(n),C=E||/Mac/.test(t),I=/\bCrOS\b/.test(n),N=/win/i.test(t),R=S&&n.match(/Version\/(\d*\.\d*)/);R&&(R=Number(R[1])),R&&R>=15&&(S=!1,m=!0);var j=C&&(y||S&&(R==null||R<12.11)),F=i||f&&p>=9;function q(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var H=function(e,r){var a=e.className,s=q(r).exec(a);if(s){var l=a.slice(s.index+s[0].length);e.className=a.slice(0,s.index)+(l?s[1]+l:"")}};function te(e){for(var r=e.childNodes.length;r>0;--r)e.removeChild(e.firstChild);return e}function W(e,r){return te(e).appendChild(r)}function U(e,r,a,s){var l=document.createElement(e);if(a&&(l.className=a),s&&(l.style.cssText=s),typeof r=="string")l.appendChild(document.createTextNode(r));else if(r)for(var d=0;d<r.length;++d)l.appendChild(r[d]);return l}function L(e,r,a,s){var l=U(e,r,a,s);return l.setAttribute("role","presentation"),l}var Z;document.createRange?Z=function(e,r,a,s){var l=document.createRange();return l.setEnd(s||e,a),l.setStart(e,r),l}:Z=function(e,r,a){var s=document.body.createTextRange();try{s.moveToElementText(e.parentNode)}catch{return s}return s.collapse(!0),s.moveEnd("character",a),s.moveStart("character",r),s};function X(e,r){if(r.nodeType==3&&(r=r.parentNode),e.contains)return e.contains(r);do if(r.nodeType==11&&(r=r.host),r==e)return!0;while(r=r.parentNode)}function he(){var e;try{e=document.activeElement}catch{e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function yt(e,r){var a=e.className;q(r).test(a)||(e.className+=(a?" ":"")+r)}function _t(e,r){for(var a=e.split(" "),s=0;s<a.length;s++)a[s]&&!q(a[s]).test(r)&&(r+=" "+a[s]);return r}var An=function(e){e.select()};E?An=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:f&&(An=function(e){try{e.select()}catch{}});function Kr(e){var r=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,r)}}function Xt(e,r,a){r||(r={});for(var s in e)e.hasOwnProperty(s)&&(a!==!1||!r.hasOwnProperty(s))&&(r[s]=e[s]);return r}function qt(e,r,a,s,l){r==null&&(r=e.search(/[^\s\u00a0]/),r==-1&&(r=e.length));for(var d=s||0,h=l||0;;){var g=e.indexOf("	",d);if(g<0||g>=r)return h+(r-d);h+=g-d,h+=a-h%a,d=g+1}}var Et=function(){this.id=null,this.f=null,this.time=0,this.handler=Kr(this.onTimeout,this)};Et.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},Et.prototype.set=function(e,r){this.f=r;var a=+new Date+e;(!this.id||a<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=a)};function ge(e,r){for(var a=0;a<e.length;++a)if(e[a]==r)return a;return-1}var qe=50,et={toString:function(){return"CodeMirror.Pass"}},ft={scroll:!1},it={origin:"*mouse"},Ge={origin:"+move"};function Vt(e,r,a){for(var s=0,l=0;;){var d=e.indexOf("	",s);d==-1&&(d=e.length);var h=d-s;if(d==e.length||l+h>=r)return s+Math.min(h,r-l);if(l+=d-s,l+=a-l%a,s=d+1,l>=r)return s}}var Yn=[""];function Ar(e){for(;Yn.length<=e;)Yn.push(tt(Yn)+" ");return Yn[e]}function tt(e){return e[e.length-1]}function gt(e,r){for(var a=[],s=0;s<e.length;s++)a[s]=r(e[s],s);return a}function Gt(e,r,a){for(var s=0,l=a(r);s<e.length&&a(e[s])<=l;)s++;e.splice(s,0,r)}function On(){}function Fn(e,r){var a;return Object.create?a=Object.create(e):(On.prototype=e,a=new On),r&&Xt(r,a),a}var Jr=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Ct(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Jr.test(e))}function $(e,r){return r?r.source.indexOf("\\w")>-1&&Ct(e)?!0:r.test(e):Ct(e)}function ie(e){for(var r in e)if(e.hasOwnProperty(r)&&e[r])return!1;return!0}var Y=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ot(e){return e.charCodeAt(0)>=768&&Y.test(e)}function ln(e,r,a){for(;(a<0?r>0:r<e.length)&&ot(e.charAt(r));)r+=a;return r}function nr(e,r,a){for(var s=r>a?-1:1;;){if(r==a)return r;var l=(r+a)/2,d=s<0?Math.ceil(l):Math.floor(l);if(d==r)return e(d)?r:a;e(d)?a=d:r=d+s}}function pl(e,r,a,s){if(!e)return s(r,a,"ltr",0);for(var l=!1,d=0;d<e.length;++d){var h=e[d];(h.from<a&&h.to>r||r==a&&h.to==r)&&(s(Math.max(h.from,r),Math.min(h.to,a),h.level==1?"rtl":"ltr",d),l=!0)}l||s(r,a,"ltr")}var Nn=null;function Rt(e,r,a){var s;Nn=null;for(var l=0;l<e.length;++l){var d=e[l];if(d.from<r&&d.to>r)return l;d.to==r&&(d.from!=d.to&&a=="before"?s=l:Nn=l),d.from==r&&(d.from!=d.to&&a!="before"?s=l:Nn=l)}return s??Nn}var Qr=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function a(b){return b<=247?e.charAt(b):1424<=b&&b<=1524?"R":1536<=b&&b<=1785?r.charAt(b-1536):1774<=b&&b<=2220?"r":8192<=b&&b<=8203?"w":b==8204?"b":"L"}var s=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,l=/[stwN]/,d=/[LRr]/,h=/[Lb1n]/,g=/[1n]/;function v(b,A,P){this.level=b,this.from=A,this.to=P}return function(b,A){var P=A=="ltr"?"L":"R";if(b.length==0||A=="ltr"&&!s.test(b))return!1;for(var B=b.length,z=[],G=0;G<B;++G)z.push(a(b.charCodeAt(G)));for(var Q=0,re=P;Q<B;++Q){var oe=z[Q];oe=="m"?z[Q]=re:re=oe}for(var ae=0,se=P;ae<B;++ae){var ue=z[ae];ue=="1"&&se=="r"?z[ae]="n":d.test(ue)&&(se=ue,ue=="r"&&(z[ae]="R"))}for(var Fe=1,me=z[0];Fe<B-1;++Fe){var Xe=z[Fe];Xe=="+"&&me=="1"&&z[Fe+1]=="1"?z[Fe]="1":Xe==","&&me==z[Fe+1]&&(me=="1"||me=="n")&&(z[Fe]=me),me=Xe}for(var Tt=0;Tt<B;++Tt){var Qt=z[Tt];if(Qt==",")z[Tt]="N";else if(Qt=="%"){var Dt=void 0;for(Dt=Tt+1;Dt<B&&z[Dt]=="%";++Dt);for(var Ln=Tt&&z[Tt-1]=="!"||Dt<B&&z[Dt]=="1"?"1":"N",vn=Tt;vn<Dt;++vn)z[vn]=Ln;Tt=Dt-1}}for(var Wt=0,yn=P;Wt<B;++Wt){var tn=z[Wt];yn=="L"&&tn=="1"?z[Wt]="L":d.test(tn)&&(yn=tn)}for(var Ut=0;Ut<B;++Ut)if(l.test(z[Ut])){var $t=void 0;for($t=Ut+1;$t<B&&l.test(z[$t]);++$t);for(var zt=(Ut?z[Ut-1]:P)=="L",bn=($t<B?z[$t]:P)=="L",$i=zt==bn?zt?"L":"R":P,Hr=Ut;Hr<$t;++Hr)z[Hr]=$i;Ut=$t-1}for(var sn=[],cr,Zt=0;Zt<B;)if(h.test(z[Zt])){var iu=Zt;for(++Zt;Zt<B&&h.test(z[Zt]);++Zt);sn.push(new v(0,iu,Zt))}else{var Sr=Zt,li=sn.length,ui=A=="rtl"?1:0;for(++Zt;Zt<B&&z[Zt]!="L";++Zt);for(var cn=Sr;cn<Zt;)if(g.test(z[cn])){Sr<cn&&(sn.splice(li,0,new v(1,Sr,cn)),li+=ui);var qi=cn;for(++cn;cn<Zt&&g.test(z[cn]);++cn);sn.splice(li,0,new v(2,qi,cn)),li+=ui,Sr=cn}else++cn;Sr<Zt&&sn.splice(li,0,new v(1,Sr,Zt))}return A=="ltr"&&(sn[0].level==1&&(cr=b.match(/^\s+/))&&(sn[0].from=cr[0].length,sn.unshift(new v(0,0,cr[0].length))),tt(sn).level==1&&(cr=b.match(/\s+$/))&&(tt(sn).to-=cr[0].length,sn.push(new v(0,B-cr[0].length,B)))),A=="rtl"?sn.reverse():sn}}();function Sn(e,r){var a=e.order;return a==null&&(a=e.order=Qr(e.text,r)),a}var mr=[],Be=function(e,r,a){if(e.addEventListener)e.addEventListener(r,a,!1);else if(e.attachEvent)e.attachEvent("on"+r,a);else{var s=e._handlers||(e._handlers={});s[r]=(s[r]||mr).concat(a)}};function wi(e,r){return e._handlers&&e._handlers[r]||mr}function pn(e,r,a){if(e.removeEventListener)e.removeEventListener(r,a,!1);else if(e.detachEvent)e.detachEvent("on"+r,a);else{var s=e._handlers,l=s&&s[r];if(l){var d=ge(l,a);d>-1&&(s[r]=l.slice(0,d).concat(l.slice(d+1)))}}}function Ue(e,r){var a=wi(e,r);if(a.length)for(var s=Array.prototype.slice.call(arguments,2),l=0;l<a.length;++l)a[l].apply(null,s)}function Bt(e,r,a){return typeof r=="string"&&(r={type:r,preventDefault:function(){this.defaultPrevented=!0}}),Ue(e,a||r.type,e,r),Pn(r)||r.codemirrorIgnore}function xi(e){var r=e._handlers&&e._handlers.cursorActivity;if(r)for(var a=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),s=0;s<r.length;++s)ge(a,r[s])==-1&&a.push(r[s])}function en(e,r){return wi(e,r).length>0}function rr(e){e.prototype.on=function(r,a){Be(this,r,a)},e.prototype.off=function(r,a){pn(this,r,a)}}function nn(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function ki(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Pn(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function Zr(e){nn(e),ki(e)}function Or(e){return e.target||e.srcElement}function As(e){var r=e.which;return r==null&&(e.button&1?r=1:e.button&2?r=3:e.button&4&&(r=2)),C&&e.ctrlKey&&r==1&&(r=3),r}var mo=function(){if(f&&p<9)return!1;var e=U("div");return"draggable"in e||"dragDrop"in e}(),hn;function Os(e){if(hn==null){var r=U("span","\u200B");W(e,U("span",[r,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(hn=r.offsetWidth<=1&&r.offsetHeight>2&&!(f&&p<8))}var a=hn?U("span","\u200B"):U("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px");return a.setAttribute("cm-text",""),a}var vo;function ir(e){if(vo!=null)return vo;var r=W(e,document.createTextNode("A\u062EA")),a=Z(r,0,1).getBoundingClientRect(),s=Z(r,1,2).getBoundingClientRect();return te(e),!a||a.left==a.right?!1:vo=s.right-a.right<3}var yo=`

b`.split(/\n/).length!=3?function(e){for(var r=0,a=[],s=e.length;r<=s;){var l=e.indexOf(`
`,r);l==-1&&(l=e.length);var d=e.slice(r,e.charAt(l-1)=="\r"?l-1:l),h=d.indexOf("\r");h!=-1?(a.push(d.slice(0,h)),r+=h+1):(a.push(d),r=l+1)}return a}:function(e){return e.split(/\r\n?|\n/)},Ns=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var r;try{r=e.ownerDocument.selection.createRange()}catch{}return!r||r.parentElement()!=e?!1:r.compareEndPoints("StartToEnd",r)!=0},Ps=function(){var e=U("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),bo=null;function Nr(e){if(bo!=null)return bo;var r=W(e,U("span","x")),a=r.getBoundingClientRect(),s=Z(r,0,1).getBoundingClientRect();return bo=Math.abs(a.left-s.left)>1}var Hn={},Dn={};function Ds(e,r){arguments.length>2&&(r.dependencies=Array.prototype.slice.call(arguments,2)),Hn[e]=r}function vr(e,r){Dn[e]=r}function Si(e){if(typeof e=="string"&&Dn.hasOwnProperty(e))e=Dn[e];else if(e&&typeof e.name=="string"&&Dn.hasOwnProperty(e.name)){var r=Dn[e.name];typeof r=="string"&&(r={name:r}),e=Fn(r,e),e.name=r.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Si("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Si("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function Ci(e,r){r=Si(r);var a=Hn[r.name];if(!a)return Ci(e,"text/plain");var s=a(e,r);if(Kn.hasOwnProperty(r.name)){var l=Kn[r.name];for(var d in l)l.hasOwnProperty(d)&&(s.hasOwnProperty(d)&&(s["_"+d]=s[d]),s[d]=l[d])}if(s.name=r.name,r.helperType&&(s.helperType=r.helperType),r.modeProps)for(var h in r.modeProps)s[h]=r.modeProps[h];return s}var Kn={};function Jn(e,r){var a=Kn.hasOwnProperty(e)?Kn[e]:Kn[e]={};Xt(r,a)}function In(e,r){if(r===!0)return r;if(e.copyState)return e.copyState(r);var a={};for(var s in r){var l=r[s];l instanceof Array&&(l=l.concat([])),a[s]=l}return a}function wo(e,r){for(var a;e.innerMode&&(a=e.innerMode(r),!(!a||a.mode==e));)r=a.state,e=a.mode;return a||{mode:e,state:r}}function xo(e,r,a){return e.startState?e.startState(r,a):!0}var jt=function(e,r,a){this.pos=this.start=0,this.string=e,this.tabSize=r||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=a};jt.prototype.eol=function(){return this.pos>=this.string.length},jt.prototype.sol=function(){return this.pos==this.lineStart},jt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},jt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},jt.prototype.eat=function(e){var r=this.string.charAt(this.pos),a;if(typeof e=="string"?a=r==e:a=r&&(e.test?e.test(r):e(r)),a)return++this.pos,r},jt.prototype.eatWhile=function(e){for(var r=this.pos;this.eat(e););return this.pos>r},jt.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},jt.prototype.skipToEnd=function(){this.pos=this.string.length},jt.prototype.skipTo=function(e){var r=this.string.indexOf(e,this.pos);if(r>-1)return this.pos=r,!0},jt.prototype.backUp=function(e){this.pos-=e},jt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=qt(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?qt(this.string,this.lineStart,this.tabSize):0)},jt.prototype.indentation=function(){return qt(this.string,null,this.tabSize)-(this.lineStart?qt(this.string,this.lineStart,this.tabSize):0)},jt.prototype.match=function(e,r,a){if(typeof e=="string"){var s=function(h){return a?h.toLowerCase():h},l=this.string.substr(this.pos,e.length);if(s(l)==s(e))return r!==!1&&(this.pos+=e.length),!0}else{var d=this.string.slice(this.pos).match(e);return d&&d.index>0?null:(d&&r!==!1&&(this.pos+=d[0].length),d)}},jt.prototype.current=function(){return this.string.slice(this.start,this.pos)},jt.prototype.hideFirstChars=function(e,r){this.lineStart+=e;try{return r()}finally{this.lineStart-=e}},jt.prototype.lookAhead=function(e){var r=this.lineOracle;return r&&r.lookAhead(e)},jt.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function de(e,r){if(r-=e.first,r<0||r>=e.size)throw new Error("There is no line "+(r+e.first)+" in the document.");for(var a=e;!a.lines;)for(var s=0;;++s){var l=a.children[s],d=l.chunkSize();if(r<d){a=l;break}r-=d}return a.lines[r]}function or(e,r,a){var s=[],l=r.line;return e.iter(r.line,a.line+1,function(d){var h=d.text;l==a.line&&(h=h.slice(0,a.ch)),l==r.line&&(h=h.slice(r.ch)),s.push(h),++l}),s}function ko(e,r,a){var s=[];return e.iter(r,a,function(l){s.push(l.text)}),s}function Cn(e,r){var a=r-e.height;if(a)for(var s=e;s;s=s.parent)s.height+=a}function mt(e){if(e.parent==null)return null;for(var r=e.parent,a=ge(r.lines,e),s=r.parent;s;r=s,s=s.parent)for(var l=0;s.children[l]!=r;++l)a+=s.children[l].chunkSize();return a+r.first}function sr(e,r){var a=e.first;e:do{for(var s=0;s<e.children.length;++s){var l=e.children[s],d=l.height;if(r<d){e=l;continue e}r-=d,a+=l.chunkSize()}return a}while(!e.lines);for(var h=0;h<e.lines.length;++h){var g=e.lines[h],v=g.height;if(r<v)break;r-=v}return a+h}function Xr(e,r){return r>=e.first&&r<e.first+e.size}function So(e,r){return String(e.lineNumberFormatter(r+e.firstLineNumber))}function ee(e,r,a){if(a===void 0&&(a=null),!(this instanceof ee))return new ee(e,r,a);this.line=e,this.ch=r,this.sticky=a}function w(e,r){return e.line-r.line||e.ch-r.ch}function D(e,r){return e.sticky==r.sticky&&w(e,r)==0}function J(e){return ee(e.line,e.ch)}function ne(e,r){return w(e,r)<0?r:e}function Ve(e,r){return w(e,r)<0?e:r}function ct(e,r){return Math.max(e.first,Math.min(r,e.first+e.size-1))}function le(e,r){if(r.line<e.first)return ee(e.first,0);var a=e.first+e.size-1;return r.line>a?ee(a,de(e,a).text.length):rn(r,de(e,r.line).text.length)}function rn(e,r){var a=e.ch;return a==null||a>r?ee(e.line,r):a<0?ee(e.line,0):e}function _n(e,r){for(var a=[],s=0;s<r.length;s++)a[s]=le(e,r[s]);return a}var Ti=function(e,r){this.state=e,this.lookAhead=r},ar=function(e,r,a,s){this.state=r,this.doc=e,this.line=a,this.maxLookAhead=s||0,this.baseTokens=null,this.baseTokenPos=1};ar.prototype.lookAhead=function(e){var r=this.doc.getLine(this.line+e);return r!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),r},ar.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var r=this.baseTokens[this.baseTokenPos+1];return{type:r&&r.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ar.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},ar.fromSaved=function(e,r,a){return r instanceof Ti?new ar(e,In(e.mode,r.state),a,r.lookAhead):new ar(e,In(e.mode,r),a)},ar.prototype.save=function(e){var r=e!==!1?In(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Ti(r,this.maxLookAhead):r};function Lf(e,r,a,s){var l=[e.state.modeGen],d={};Pf(e,r.text,e.doc.mode,a,function(b,A){return l.push(b,A)},d,s);for(var h=a.state,g=function(b){a.baseTokens=l;var A=e.state.overlays[b],P=1,B=0;a.state=!0,Pf(e,r.text,A.mode,a,function(z,G){for(var Q=P;B<z;){var re=l[P];re>z&&l.splice(P,1,z,l[P+1],re),P+=2,B=Math.min(z,re)}if(G)if(A.opaque)l.splice(Q,P-Q,z,"overlay "+G),P=Q+2;else for(;Q<P;Q+=2){var oe=l[Q+1];l[Q+1]=(oe?oe+" ":"")+"overlay "+G}},d),a.state=h,a.baseTokens=null,a.baseTokenPos=1},v=0;v<e.state.overlays.length;++v)g(v);return{styles:l,classes:d.bgClass||d.textClass?d:null}}function Ef(e,r,a){if(!r.styles||r.styles[0]!=e.state.modeGen){var s=Co(e,mt(r)),l=r.text.length>e.options.maxHighlightLength&&In(e.doc.mode,s.state),d=Lf(e,r,s);l&&(s.state=l),r.stateAfter=s.save(!l),r.styles=d.styles,d.classes?r.styleClasses=d.classes:r.styleClasses&&(r.styleClasses=null),a===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return r.styles}function Co(e,r,a){var s=e.doc,l=e.display;if(!s.mode.startState)return new ar(s,!0,r);var d=lb(e,r,a),h=d>s.first&&de(s,d-1).stateAfter,g=h?ar.fromSaved(s,h,d):new ar(s,xo(s.mode),d);return s.iter(d,r,function(v){hl(e,v.text,g);var b=g.line;v.stateAfter=b==r-1||b%5==0||b>=l.viewFrom&&b<l.viewTo?g.save():null,g.nextLine()}),a&&(s.modeFrontier=g.line),g}function hl(e,r,a,s){var l=e.doc.mode,d=new jt(r,e.options.tabSize,a);for(d.start=d.pos=s||0,r==""&&Mf(l,a.state);!d.eol();)gl(l,d,a.state),d.start=d.pos}function Mf(e,r){if(e.blankLine)return e.blankLine(r);if(e.innerMode){var a=wo(e,r);if(a.mode.blankLine)return a.mode.blankLine(a.state)}}function gl(e,r,a,s){for(var l=0;l<10;l++){s&&(s[0]=wo(e,a).mode);var d=e.token(r,a);if(r.pos>r.start)return d}throw new Error("Mode "+e.name+" failed to advance stream.")}var Af=function(e,r,a){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=r||null,this.state=a};function Of(e,r,a,s){var l=e.doc,d=l.mode,h;r=le(l,r);var g=de(l,r.line),v=Co(e,r.line,a),b=new jt(g.text,e.options.tabSize,v),A;for(s&&(A=[]);(s||b.pos<r.ch)&&!b.eol();)b.start=b.pos,h=gl(d,b,v.state),s&&A.push(new Af(b,h,In(l.mode,v.state)));return s?A:new Af(b,h,v.state)}function Nf(e,r){if(e)for(;;){var a=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!a)break;e=e.slice(0,a.index)+e.slice(a.index+a[0].length);var s=a[1]?"bgClass":"textClass";r[s]==null?r[s]=a[2]:new RegExp("(?:^|\\s)"+a[2]+"(?:$|\\s)").test(r[s])||(r[s]+=" "+a[2])}return e}function Pf(e,r,a,s,l,d,h){var g=a.flattenSpans;g==null&&(g=e.options.flattenSpans);var v=0,b=null,A=new jt(r,e.options.tabSize,s),P,B=e.options.addModeClass&&[null];for(r==""&&Nf(Mf(a,s.state),d);!A.eol();){if(A.pos>e.options.maxHighlightLength?(g=!1,h&&hl(e,r,s,A.pos),A.pos=r.length,P=null):P=Nf(gl(a,A,s.state,B),d),B){var z=B[0].name;z&&(P="m-"+(P?z+" "+P:z))}if(!g||b!=P){for(;v<A.start;)v=Math.min(A.start,v+5e3),l(v,b);b=P}A.start=A.pos}for(;v<A.pos;){var G=Math.min(A.pos,v+5e3);l(G,b),v=G}}function lb(e,r,a){for(var s,l,d=e.doc,h=a?-1:r-(e.doc.mode.innerMode?1e3:100),g=r;g>h;--g){if(g<=d.first)return d.first;var v=de(d,g-1),b=v.stateAfter;if(b&&(!a||g+(b instanceof Ti?b.lookAhead:0)<=d.modeFrontier))return g;var A=qt(v.text,null,e.options.tabSize);(l==null||s>A)&&(l=g-1,s=A)}return l}function ub(e,r){if(e.modeFrontier=Math.min(e.modeFrontier,r),!(e.highlightFrontier<r-10)){for(var a=e.first,s=r-1;s>a;s--){var l=de(e,s).stateAfter;if(l&&(!(l instanceof Ti)||s+l.lookAhead<r)){a=s+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,a)}}var Df=!1,yr=!1;function cb(){Df=!0}function fb(){yr=!0}function Is(e,r,a){this.marker=e,this.from=r,this.to=a}function To(e,r){if(e)for(var a=0;a<e.length;++a){var s=e[a];if(s.marker==r)return s}}function db(e,r){for(var a,s=0;s<e.length;++s)e[s]!=r&&(a||(a=[])).push(e[s]);return a}function pb(e,r,a){var s=a&&window.WeakSet&&(a.markedSpans||(a.markedSpans=new WeakSet));s&&s.has(e.markedSpans)?e.markedSpans.push(r):(e.markedSpans=e.markedSpans?e.markedSpans.concat([r]):[r],s&&s.add(e.markedSpans)),r.marker.attachLine(e)}function hb(e,r,a){var s;if(e)for(var l=0;l<e.length;++l){var d=e[l],h=d.marker,g=d.from==null||(h.inclusiveLeft?d.from<=r:d.from<r);if(g||d.from==r&&h.type=="bookmark"&&(!a||!d.marker.insertLeft)){var v=d.to==null||(h.inclusiveRight?d.to>=r:d.to>r);(s||(s=[])).push(new Is(h,d.from,v?null:d.to))}}return s}function gb(e,r,a){var s;if(e)for(var l=0;l<e.length;++l){var d=e[l],h=d.marker,g=d.to==null||(h.inclusiveRight?d.to>=r:d.to>r);if(g||d.from==r&&h.type=="bookmark"&&(!a||d.marker.insertLeft)){var v=d.from==null||(h.inclusiveLeft?d.from<=r:d.from<r);(s||(s=[])).push(new Is(h,v?null:d.from-r,d.to==null?null:d.to-r))}}return s}function ml(e,r){if(r.full)return null;var a=Xr(e,r.from.line)&&de(e,r.from.line).markedSpans,s=Xr(e,r.to.line)&&de(e,r.to.line).markedSpans;if(!a&&!s)return null;var l=r.from.ch,d=r.to.ch,h=w(r.from,r.to)==0,g=hb(a,l,h),v=gb(s,d,h),b=r.text.length==1,A=tt(r.text).length+(b?l:0);if(g)for(var P=0;P<g.length;++P){var B=g[P];if(B.to==null){var z=To(v,B.marker);z?b&&(B.to=z.to==null?null:z.to+A):B.to=l}}if(v)for(var G=0;G<v.length;++G){var Q=v[G];if(Q.to!=null&&(Q.to+=A),Q.from==null){var re=To(g,Q.marker);re||(Q.from=A,b&&(g||(g=[])).push(Q))}else Q.from+=A,b&&(g||(g=[])).push(Q)}g&&(g=If(g)),v&&v!=g&&(v=If(v));var oe=[g];if(!b){var ae=r.text.length-2,se;if(ae>0&&g)for(var ue=0;ue<g.length;++ue)g[ue].to==null&&(se||(se=[])).push(new Is(g[ue].marker,null,null));for(var Fe=0;Fe<ae;++Fe)oe.push(se);oe.push(v)}return oe}function If(e){for(var r=0;r<e.length;++r){var a=e[r];a.from!=null&&a.from==a.to&&a.marker.clearWhenEmpty!==!1&&e.splice(r--,1)}return e.length?e:null}function mb(e,r,a){var s=null;if(e.iter(r.line,a.line+1,function(z){if(z.markedSpans)for(var G=0;G<z.markedSpans.length;++G){var Q=z.markedSpans[G].marker;Q.readOnly&&(!s||ge(s,Q)==-1)&&(s||(s=[])).push(Q)}}),!s)return null;for(var l=[{from:r,to:a}],d=0;d<s.length;++d)for(var h=s[d],g=h.find(0),v=0;v<l.length;++v){var b=l[v];if(!(w(b.to,g.from)<0||w(b.from,g.to)>0)){var A=[v,1],P=w(b.from,g.from),B=w(b.to,g.to);(P<0||!h.inclusiveLeft&&!P)&&A.push({from:b.from,to:g.from}),(B>0||!h.inclusiveRight&&!B)&&A.push({from:g.to,to:b.to}),l.splice.apply(l,A),v+=A.length-3}}return l}function _f(e){var r=e.markedSpans;if(r){for(var a=0;a<r.length;++a)r[a].marker.detachLine(e);e.markedSpans=null}}function Rf(e,r){if(r){for(var a=0;a<r.length;++a)r[a].marker.attachLine(e);e.markedSpans=r}}function _s(e){return e.inclusiveLeft?-1:0}function Rs(e){return e.inclusiveRight?1:0}function vl(e,r){var a=e.lines.length-r.lines.length;if(a!=0)return a;var s=e.find(),l=r.find(),d=w(s.from,l.from)||_s(e)-_s(r);if(d)return-d;var h=w(s.to,l.to)||Rs(e)-Rs(r);return h||r.id-e.id}function jf(e,r){var a=yr&&e.markedSpans,s;if(a)for(var l=void 0,d=0;d<a.length;++d)l=a[d],l.marker.collapsed&&(r?l.from:l.to)==null&&(!s||vl(s,l.marker)<0)&&(s=l.marker);return s}function zf(e){return jf(e,!0)}function js(e){return jf(e,!1)}function vb(e,r){var a=yr&&e.markedSpans,s;if(a)for(var l=0;l<a.length;++l){var d=a[l];d.marker.collapsed&&(d.from==null||d.from<r)&&(d.to==null||d.to>r)&&(!s||vl(s,d.marker)<0)&&(s=d.marker)}return s}function Ff(e,r,a,s,l){var d=de(e,r),h=yr&&d.markedSpans;if(h)for(var g=0;g<h.length;++g){var v=h[g];if(v.marker.collapsed){var b=v.marker.find(0),A=w(b.from,a)||_s(v.marker)-_s(l),P=w(b.to,s)||Rs(v.marker)-Rs(l);if(!(A>=0&&P<=0||A<=0&&P>=0)&&(A<=0&&(v.marker.inclusiveRight&&l.inclusiveLeft?w(b.to,a)>=0:w(b.to,a)>0)||A>=0&&(v.marker.inclusiveRight&&l.inclusiveLeft?w(b.from,s)<=0:w(b.from,s)<0)))return!0}}}function Qn(e){for(var r;r=zf(e);)e=r.find(-1,!0).line;return e}function yb(e){for(var r;r=js(e);)e=r.find(1,!0).line;return e}function bb(e){for(var r,a;r=js(e);)e=r.find(1,!0).line,(a||(a=[])).push(e);return a}function yl(e,r){var a=de(e,r),s=Qn(a);return a==s?r:mt(s)}function Hf(e,r){if(r>e.lastLine())return r;var a=de(e,r),s;if(!Pr(e,a))return r;for(;s=js(a);)a=s.find(1,!0).line;return mt(a)+1}function Pr(e,r){var a=yr&&r.markedSpans;if(a){for(var s=void 0,l=0;l<a.length;++l)if(s=a[l],!!s.marker.collapsed){if(s.from==null)return!0;if(!s.marker.widgetNode&&s.from==0&&s.marker.inclusiveLeft&&bl(e,r,s))return!0}}}function bl(e,r,a){if(a.to==null){var s=a.marker.find(1,!0);return bl(e,s.line,To(s.line.markedSpans,a.marker))}if(a.marker.inclusiveRight&&a.to==r.text.length)return!0;for(var l=void 0,d=0;d<r.markedSpans.length;++d)if(l=r.markedSpans[d],l.marker.collapsed&&!l.marker.widgetNode&&l.from==a.to&&(l.to==null||l.to!=a.from)&&(l.marker.inclusiveLeft||a.marker.inclusiveRight)&&bl(e,r,l))return!0}function br(e){e=Qn(e);for(var r=0,a=e.parent,s=0;s<a.lines.length;++s){var l=a.lines[s];if(l==e)break;r+=l.height}for(var d=a.parent;d;a=d,d=a.parent)for(var h=0;h<d.children.length;++h){var g=d.children[h];if(g==a)break;r+=g.height}return r}function zs(e){if(e.height==0)return 0;for(var r=e.text.length,a,s=e;a=zf(s);){var l=a.find(0,!0);s=l.from.line,r+=l.from.ch-l.to.ch}for(s=e;a=js(s);){var d=a.find(0,!0);r-=s.text.length-d.from.ch,s=d.to.line,r+=s.text.length-d.to.ch}return r}function wl(e){var r=e.display,a=e.doc;r.maxLine=de(a,a.first),r.maxLineLength=zs(r.maxLine),r.maxLineChanged=!0,a.iter(function(s){var l=zs(s);l>r.maxLineLength&&(r.maxLineLength=l,r.maxLine=s)})}var Li=function(e,r,a){this.text=e,Rf(this,r),this.height=a?a(this):1};Li.prototype.lineNo=function(){return mt(this)},rr(Li);function wb(e,r,a,s){e.text=r,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),_f(e),Rf(e,a);var l=s?s(e):1;l!=e.height&&Cn(e,l)}function xb(e){e.parent=null,_f(e)}var kb={},Sb={};function Bf(e,r){if(!e||/^\s*$/.test(e))return null;var a=r.addModeClass?Sb:kb;return a[e]||(a[e]=e.replace(/\S+/g,"cm-$&"))}function Wf(e,r){var a=L("span",null,null,m?"padding-right: .1px":null),s={pre:L("pre",[a],"CodeMirror-line"),content:a,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};r.measure={};for(var l=0;l<=(r.rest?r.rest.length:0);l++){var d=l?r.rest[l-1]:r.line,h=void 0;s.pos=0,s.addToken=Tb,ir(e.display.measure)&&(h=Sn(d,e.doc.direction))&&(s.addToken=Eb(s.addToken,h)),s.map=[];var g=r!=e.display.externalMeasured&&mt(d);Mb(d,s,Ef(e,d,g)),d.styleClasses&&(d.styleClasses.bgClass&&(s.bgClass=_t(d.styleClasses.bgClass,s.bgClass||"")),d.styleClasses.textClass&&(s.textClass=_t(d.styleClasses.textClass,s.textClass||""))),s.map.length==0&&s.map.push(0,0,s.content.appendChild(Os(e.display.measure))),l==0?(r.measure.map=s.map,r.measure.cache={}):((r.measure.maps||(r.measure.maps=[])).push(s.map),(r.measure.caches||(r.measure.caches=[])).push({}))}if(m){var v=s.content.lastChild;(/\bcm-tab\b/.test(v.className)||v.querySelector&&v.querySelector(".cm-tab"))&&(s.content.className="cm-tab-wrap-hack")}return Ue(e,"renderLine",e,r.line,s.pre),s.pre.className&&(s.textClass=_t(s.pre.className,s.textClass||"")),s}function Cb(e){var r=U("span","\u2022","cm-invalidchar");return r.title="\\u"+e.charCodeAt(0).toString(16),r.setAttribute("aria-label",r.title),r}function Tb(e,r,a,s,l,d,h){if(r){var g=e.splitSpaces?Lb(r,e.trailingSpace):r,v=e.cm.state.specialChars,b=!1,A;if(!v.test(r))e.col+=r.length,A=document.createTextNode(g),e.map.push(e.pos,e.pos+r.length,A),f&&p<9&&(b=!0),e.pos+=r.length;else{A=document.createDocumentFragment();for(var P=0;;){v.lastIndex=P;var B=v.exec(r),z=B?B.index-P:r.length-P;if(z){var G=document.createTextNode(g.slice(P,P+z));f&&p<9?A.appendChild(U("span",[G])):A.appendChild(G),e.map.push(e.pos,e.pos+z,G),e.col+=z,e.pos+=z}if(!B)break;P+=z+1;var Q=void 0;if(B[0]=="	"){var re=e.cm.options.tabSize,oe=re-e.col%re;Q=A.appendChild(U("span",Ar(oe),"cm-tab")),Q.setAttribute("role","presentation"),Q.setAttribute("cm-text","	"),e.col+=oe}else B[0]=="\r"||B[0]==`
`?(Q=A.appendChild(U("span",B[0]=="\r"?"\u240D":"\u2424","cm-invalidchar")),Q.setAttribute("cm-text",B[0]),e.col+=1):(Q=e.cm.options.specialCharPlaceholder(B[0]),Q.setAttribute("cm-text",B[0]),f&&p<9?A.appendChild(U("span",[Q])):A.appendChild(Q),e.col+=1);e.map.push(e.pos,e.pos+1,Q),e.pos++}}if(e.trailingSpace=g.charCodeAt(r.length-1)==32,a||s||l||b||d||h){var ae=a||"";s&&(ae+=s),l&&(ae+=l);var se=U("span",[A],ae,d);if(h)for(var ue in h)h.hasOwnProperty(ue)&&ue!="style"&&ue!="class"&&se.setAttribute(ue,h[ue]);return e.content.appendChild(se)}e.content.appendChild(A)}}function Lb(e,r){if(e.length>1&&!/  /.test(e))return e;for(var a=r,s="",l=0;l<e.length;l++){var d=e.charAt(l);d==" "&&a&&(l==e.length-1||e.charCodeAt(l+1)==32)&&(d="\xA0"),s+=d,a=d==" "}return s}function Eb(e,r){return function(a,s,l,d,h,g,v){l=l?l+" cm-force-border":"cm-force-border";for(var b=a.pos,A=b+s.length;;){for(var P=void 0,B=0;B<r.length&&(P=r[B],!(P.to>b&&P.from<=b));B++);if(P.to>=A)return e(a,s,l,d,h,g,v);e(a,s.slice(0,P.to-b),l,d,null,g,v),d=null,s=s.slice(P.to-b),b=P.to}}}function $f(e,r,a,s){var l=!s&&a.widgetNode;l&&e.map.push(e.pos,e.pos+r,l),!s&&e.cm.display.input.needsContentAttribute&&(l||(l=e.content.appendChild(document.createElement("span"))),l.setAttribute("cm-marker",a.id)),l&&(e.cm.display.input.setUneditable(l),e.content.appendChild(l)),e.pos+=r,e.trailingSpace=!1}function Mb(e,r,a){var s=e.markedSpans,l=e.text,d=0;if(!s){for(var h=1;h<a.length;h+=2)r.addToken(r,l.slice(d,d=a[h]),Bf(a[h+1],r.cm.options));return}for(var g=l.length,v=0,b=1,A="",P,B,z=0,G,Q,re,oe,ae;;){if(z==v){G=Q=re=B="",ae=null,oe=null,z=1/0;for(var se=[],ue=void 0,Fe=0;Fe<s.length;++Fe){var me=s[Fe],Xe=me.marker;if(Xe.type=="bookmark"&&me.from==v&&Xe.widgetNode)se.push(Xe);else if(me.from<=v&&(me.to==null||me.to>v||Xe.collapsed&&me.to==v&&me.from==v)){if(me.to!=null&&me.to!=v&&z>me.to&&(z=me.to,Q=""),Xe.className&&(G+=" "+Xe.className),Xe.css&&(B=(B?B+";":"")+Xe.css),Xe.startStyle&&me.from==v&&(re+=" "+Xe.startStyle),Xe.endStyle&&me.to==z&&(ue||(ue=[])).push(Xe.endStyle,me.to),Xe.title&&((ae||(ae={})).title=Xe.title),Xe.attributes)for(var Tt in Xe.attributes)(ae||(ae={}))[Tt]=Xe.attributes[Tt];Xe.collapsed&&(!oe||vl(oe.marker,Xe)<0)&&(oe=me)}else me.from>v&&z>me.from&&(z=me.from)}if(ue)for(var Qt=0;Qt<ue.length;Qt+=2)ue[Qt+1]==z&&(Q+=" "+ue[Qt]);if(!oe||oe.from==v)for(var Dt=0;Dt<se.length;++Dt)$f(r,0,se[Dt]);if(oe&&(oe.from||0)==v){if($f(r,(oe.to==null?g+1:oe.to)-v,oe.marker,oe.from==null),oe.to==null)return;oe.to==v&&(oe=!1)}}if(v>=g)break;for(var Ln=Math.min(g,z);;){if(A){var vn=v+A.length;if(!oe){var Wt=vn>Ln?A.slice(0,Ln-v):A;r.addToken(r,Wt,P?P+G:G,re,v+Wt.length==z?Q:"",B,ae)}if(vn>=Ln){A=A.slice(Ln-v),v=Ln;break}v=vn,re=""}A=l.slice(d,d=a[b++]),P=Bf(a[b++],r.cm.options)}}}function qf(e,r,a){this.line=r,this.rest=bb(r),this.size=this.rest?mt(tt(this.rest))-a+1:1,this.node=this.text=null,this.hidden=Pr(e,r)}function Fs(e,r,a){for(var s=[],l,d=r;d<a;d=l){var h=new qf(e.doc,de(e.doc,d),d);l=d+h.size,s.push(h)}return s}var Ei=null;function Ab(e){Ei?Ei.ops.push(e):e.ownsGroup=Ei={ops:[e],delayedCallbacks:[]}}function Ob(e){var r=e.delayedCallbacks,a=0;do{for(;a<r.length;a++)r[a].call(null);for(var s=0;s<e.ops.length;s++){var l=e.ops[s];if(l.cursorActivityHandlers)for(;l.cursorActivityCalled<l.cursorActivityHandlers.length;)l.cursorActivityHandlers[l.cursorActivityCalled++].call(null,l.cm)}}while(a<r.length)}function Nb(e,r){var a=e.ownsGroup;if(a)try{Ob(a)}finally{Ei=null,r(a)}}var Lo=null;function Yt(e,r){var a=wi(e,r);if(a.length){var s=Array.prototype.slice.call(arguments,2),l;Ei?l=Ei.delayedCallbacks:Lo?l=Lo:(l=Lo=[],setTimeout(Pb,0));for(var d=function(g){l.push(function(){return a[g].apply(null,s)})},h=0;h<a.length;++h)d(h)}}function Pb(){var e=Lo;Lo=null;for(var r=0;r<e.length;++r)e[r]()}function Uf(e,r,a,s){for(var l=0;l<r.changes.length;l++){var d=r.changes[l];d=="text"?Ib(e,r):d=="gutter"?Gf(e,r,a,s):d=="class"?xl(e,r):d=="widget"&&_b(e,r,s)}r.changes=null}function Eo(e){return e.node==e.text&&(e.node=U("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),f&&p<8&&(e.node.style.zIndex=2)),e.node}function Db(e,r){var a=r.bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass;if(a&&(a+=" CodeMirror-linebackground"),r.background)a?r.background.className=a:(r.background.parentNode.removeChild(r.background),r.background=null);else if(a){var s=Eo(r);r.background=s.insertBefore(U("div",null,a),s.firstChild),e.display.input.setUneditable(r.background)}}function Vf(e,r){var a=e.display.externalMeasured;return a&&a.line==r.line?(e.display.externalMeasured=null,r.measure=a.measure,a.built):Wf(e,r)}function Ib(e,r){var a=r.text.className,s=Vf(e,r);r.text==r.node&&(r.node=s.pre),r.text.parentNode.replaceChild(s.pre,r.text),r.text=s.pre,s.bgClass!=r.bgClass||s.textClass!=r.textClass?(r.bgClass=s.bgClass,r.textClass=s.textClass,xl(e,r)):a&&(r.text.className=a)}function xl(e,r){Db(e,r),r.line.wrapClass?Eo(r).className=r.line.wrapClass:r.node!=r.text&&(r.node.className="");var a=r.textClass?r.textClass+" "+(r.line.textClass||""):r.line.textClass;r.text.className=a||""}function Gf(e,r,a,s){if(r.gutter&&(r.node.removeChild(r.gutter),r.gutter=null),r.gutterBackground&&(r.node.removeChild(r.gutterBackground),r.gutterBackground=null),r.line.gutterClass){var l=Eo(r);r.gutterBackground=U("div",null,"CodeMirror-gutter-background "+r.line.gutterClass,"left: "+(e.options.fixedGutter?s.fixedPos:-s.gutterTotalWidth)+"px; width: "+s.gutterTotalWidth+"px"),e.display.input.setUneditable(r.gutterBackground),l.insertBefore(r.gutterBackground,r.text)}var d=r.line.gutterMarkers;if(e.options.lineNumbers||d){var h=Eo(r),g=r.gutter=U("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?s.fixedPos:-s.gutterTotalWidth)+"px");if(g.setAttribute("aria-hidden","true"),e.display.input.setUneditable(g),h.insertBefore(g,r.text),r.line.gutterClass&&(g.className+=" "+r.line.gutterClass),e.options.lineNumbers&&(!d||!d["CodeMirror-linenumbers"])&&(r.lineNumber=g.appendChild(U("div",So(e.options,a),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+s.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),d)for(var v=0;v<e.display.gutterSpecs.length;++v){var b=e.display.gutterSpecs[v].className,A=d.hasOwnProperty(b)&&d[b];A&&g.appendChild(U("div",[A],"CodeMirror-gutter-elt","left: "+s.gutterLeft[b]+"px; width: "+s.gutterWidth[b]+"px"))}}}function _b(e,r,a){r.alignable&&(r.alignable=null);for(var s=q("CodeMirror-linewidget"),l=r.node.firstChild,d=void 0;l;l=d)d=l.nextSibling,s.test(l.className)&&r.node.removeChild(l);Yf(e,r,a)}function Rb(e,r,a,s){var l=Vf(e,r);return r.text=r.node=l.pre,l.bgClass&&(r.bgClass=l.bgClass),l.textClass&&(r.textClass=l.textClass),xl(e,r),Gf(e,r,a,s),Yf(e,r,s),r.node}function Yf(e,r,a){if(Kf(e,r.line,r,a,!0),r.rest)for(var s=0;s<r.rest.length;s++)Kf(e,r.rest[s],r,a,!1)}function Kf(e,r,a,s,l){if(r.widgets)for(var d=Eo(a),h=0,g=r.widgets;h<g.length;++h){var v=g[h],b=U("div",[v.node],"CodeMirror-linewidget"+(v.className?" "+v.className:""));v.handleMouseEvents||b.setAttribute("cm-ignore-events","true"),jb(v,b,a,s),e.display.input.setUneditable(b),l&&v.above?d.insertBefore(b,a.gutter||a.text):d.appendChild(b),Yt(v,"redraw")}}function jb(e,r,a,s){if(e.noHScroll){(a.alignable||(a.alignable=[])).push(r);var l=s.wrapperWidth;r.style.left=s.fixedPos+"px",e.coverGutter||(l-=s.gutterTotalWidth,r.style.paddingLeft=s.gutterTotalWidth+"px"),r.style.width=l+"px"}e.coverGutter&&(r.style.zIndex=5,r.style.position="relative",e.noHScroll||(r.style.marginLeft=-s.gutterTotalWidth+"px"))}function Mo(e){if(e.height!=null)return e.height;var r=e.doc.cm;if(!r)return 0;if(!X(document.body,e.node)){var a="position: relative;";e.coverGutter&&(a+="margin-left: -"+r.display.gutters.offsetWidth+"px;"),e.noHScroll&&(a+="width: "+r.display.wrapper.clientWidth+"px;"),W(r.display.measure,U("div",[e.node],null,a))}return e.height=e.node.parentNode.offsetHeight}function wr(e,r){for(var a=Or(r);a!=e.wrapper;a=a.parentNode)if(!a||a.nodeType==1&&a.getAttribute("cm-ignore-events")=="true"||a.parentNode==e.sizer&&a!=e.mover)return!0}function Hs(e){return e.lineSpace.offsetTop}function kl(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Jf(e){if(e.cachedPaddingH)return e.cachedPaddingH;var r=W(e.measure,U("pre","x","CodeMirror-line-like")),a=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,s={left:parseInt(a.paddingLeft),right:parseInt(a.paddingRight)};return!isNaN(s.left)&&!isNaN(s.right)&&(e.cachedPaddingH=s),s}function lr(e){return qe-e.display.nativeBarWidth}function ei(e){return e.display.scroller.clientWidth-lr(e)-e.display.barWidth}function Sl(e){return e.display.scroller.clientHeight-lr(e)-e.display.barHeight}function zb(e,r,a){var s=e.options.lineWrapping,l=s&&ei(e);if(!r.measure.heights||s&&r.measure.width!=l){var d=r.measure.heights=[];if(s){r.measure.width=l;for(var h=r.text.firstChild.getClientRects(),g=0;g<h.length-1;g++){var v=h[g],b=h[g+1];Math.abs(v.bottom-b.bottom)>2&&d.push((v.bottom+b.top)/2-a.top)}}d.push(a.bottom-a.top)}}function Qf(e,r,a){if(e.line==r)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var s=0;s<e.rest.length;s++)if(e.rest[s]==r)return{map:e.measure.maps[s],cache:e.measure.caches[s]};for(var l=0;l<e.rest.length;l++)if(mt(e.rest[l])>a)return{map:e.measure.maps[l],cache:e.measure.caches[l],before:!0}}}function Fb(e,r){r=Qn(r);var a=mt(r),s=e.display.externalMeasured=new qf(e.doc,r,a);s.lineN=a;var l=s.built=Wf(e,s);return s.text=l.pre,W(e.display.lineMeasure,l.pre),s}function Zf(e,r,a,s){return ur(e,Mi(e,r),a,s)}function Cl(e,r){if(r>=e.display.viewFrom&&r<e.display.viewTo)return e.display.view[ri(e,r)];var a=e.display.externalMeasured;if(a&&r>=a.lineN&&r<a.lineN+a.size)return a}function Mi(e,r){var a=mt(r),s=Cl(e,a);s&&!s.text?s=null:s&&s.changes&&(Uf(e,s,a,Al(e)),e.curOp.forceUpdate=!0),s||(s=Fb(e,r));var l=Qf(s,r,a);return{line:r,view:s,rect:null,map:l.map,cache:l.cache,before:l.before,hasHeights:!1}}function ur(e,r,a,s,l){r.before&&(a=-1);var d=a+(s||""),h;return r.cache.hasOwnProperty(d)?h=r.cache[d]:(r.rect||(r.rect=r.view.text.getBoundingClientRect()),r.hasHeights||(zb(e,r.view,r.rect),r.hasHeights=!0),h=Bb(e,r,a,s),h.bogus||(r.cache[d]=h)),{left:h.left,right:h.right,top:l?h.rtop:h.top,bottom:l?h.rbottom:h.bottom}}var Xf={left:0,right:0,top:0,bottom:0};function ed(e,r,a){for(var s,l,d,h,g,v,b=0;b<e.length;b+=3)if(g=e[b],v=e[b+1],r<g?(l=0,d=1,h="left"):r<v?(l=r-g,d=l+1):(b==e.length-3||r==v&&e[b+3]>r)&&(d=v-g,l=d-1,r>=v&&(h="right")),l!=null){if(s=e[b+2],g==v&&a==(s.insertLeft?"left":"right")&&(h=a),a=="left"&&l==0)for(;b&&e[b-2]==e[b-3]&&e[b-1].insertLeft;)s=e[(b-=3)+2],h="left";if(a=="right"&&l==v-g)for(;b<e.length-3&&e[b+3]==e[b+4]&&!e[b+5].insertLeft;)s=e[(b+=3)+2],h="right";break}return{node:s,start:l,end:d,collapse:h,coverStart:g,coverEnd:v}}function Hb(e,r){var a=Xf;if(r=="left")for(var s=0;s<e.length&&(a=e[s]).left==a.right;s++);else for(var l=e.length-1;l>=0&&(a=e[l]).left==a.right;l--);return a}function Bb(e,r,a,s){var l=ed(r.map,a,s),d=l.node,h=l.start,g=l.end,v=l.collapse,b;if(d.nodeType==3){for(var A=0;A<4;A++){for(;h&&ot(r.line.text.charAt(l.coverStart+h));)--h;for(;l.coverStart+g<l.coverEnd&&ot(r.line.text.charAt(l.coverStart+g));)++g;if(f&&p<9&&h==0&&g==l.coverEnd-l.coverStart?b=d.parentNode.getBoundingClientRect():b=Hb(Z(d,h,g).getClientRects(),s),b.left||b.right||h==0)break;g=h,h=h-1,v="right"}f&&p<11&&(b=Wb(e.display.measure,b))}else{h>0&&(v=s="right");var P;e.options.lineWrapping&&(P=d.getClientRects()).length>1?b=P[s=="right"?P.length-1:0]:b=d.getBoundingClientRect()}if(f&&p<9&&!h&&(!b||!b.left&&!b.right)){var B=d.parentNode.getClientRects()[0];B?b={left:B.left,right:B.left+Oi(e.display),top:B.top,bottom:B.bottom}:b=Xf}for(var z=b.top-r.rect.top,G=b.bottom-r.rect.top,Q=(z+G)/2,re=r.view.measure.heights,oe=0;oe<re.length-1&&!(Q<re[oe]);oe++);var ae=oe?re[oe-1]:0,se=re[oe],ue={left:(v=="right"?b.right:b.left)-r.rect.left,right:(v=="left"?b.left:b.right)-r.rect.left,top:ae,bottom:se};return!b.left&&!b.right&&(ue.bogus=!0),e.options.singleCursorHeightPerLine||(ue.rtop=z,ue.rbottom=G),ue}function Wb(e,r){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Nr(e))return r;var a=screen.logicalXDPI/screen.deviceXDPI,s=screen.logicalYDPI/screen.deviceYDPI;return{left:r.left*a,right:r.right*a,top:r.top*s,bottom:r.bottom*s}}function td(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var r=0;r<e.rest.length;r++)e.measure.caches[r]={}}function nd(e){e.display.externalMeasure=null,te(e.display.lineMeasure);for(var r=0;r<e.display.view.length;r++)td(e.display.view[r])}function Ao(e){nd(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function rd(){return x&&M?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function id(){return x&&M?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Tl(e){var r=Qn(e),a=r.widgets,s=0;if(a)for(var l=0;l<a.length;++l)a[l].above&&(s+=Mo(a[l]));return s}function Bs(e,r,a,s,l){if(!l){var d=Tl(r);a.top+=d,a.bottom+=d}if(s=="line")return a;s||(s="local");var h=br(r);if(s=="local"?h+=Hs(e.display):h-=e.display.viewOffset,s=="page"||s=="window"){var g=e.display.lineSpace.getBoundingClientRect();h+=g.top+(s=="window"?0:id());var v=g.left+(s=="window"?0:rd());a.left+=v,a.right+=v}return a.top+=h,a.bottom+=h,a}function od(e,r,a){if(a=="div")return r;var s=r.left,l=r.top;if(a=="page")s-=rd(),l-=id();else if(a=="local"||!a){var d=e.display.sizer.getBoundingClientRect();s+=d.left,l+=d.top}var h=e.display.lineSpace.getBoundingClientRect();return{left:s-h.left,top:l-h.top}}function Ws(e,r,a,s,l){return s||(s=de(e.doc,r.line)),Bs(e,s,Zf(e,s,r.ch,l),a)}function Zn(e,r,a,s,l,d){s=s||de(e.doc,r.line),l||(l=Mi(e,s));function h(G,Q){var re=ur(e,l,G,Q?"right":"left",d);return Q?re.left=re.right:re.right=re.left,Bs(e,s,re,a)}var g=Sn(s,e.doc.direction),v=r.ch,b=r.sticky;if(v>=s.text.length?(v=s.text.length,b="before"):v<=0&&(v=0,b="after"),!g)return h(b=="before"?v-1:v,b=="before");function A(G,Q,re){var oe=g[Q],ae=oe.level==1;return h(re?G-1:G,ae!=re)}var P=Rt(g,v,b),B=Nn,z=A(v,P,b=="before");return B!=null&&(z.other=A(v,B,b!="before")),z}function sd(e,r){var a=0;r=le(e.doc,r),e.options.lineWrapping||(a=Oi(e.display)*r.ch);var s=de(e.doc,r.line),l=br(s)+Hs(e.display);return{left:a,right:a,top:l,bottom:l+s.height}}function Ll(e,r,a,s,l){var d=ee(e,r,a);return d.xRel=l,s&&(d.outside=s),d}function El(e,r,a){var s=e.doc;if(a+=e.display.viewOffset,a<0)return Ll(s.first,0,null,-1,-1);var l=sr(s,a),d=s.first+s.size-1;if(l>d)return Ll(s.first+s.size-1,de(s,d).text.length,null,1,1);r<0&&(r=0);for(var h=de(s,l);;){var g=$b(e,h,l,r,a),v=vb(h,g.ch+(g.xRel>0||g.outside>0?1:0));if(!v)return g;var b=v.find(1);if(b.line==l)return b;h=de(s,l=b.line)}}function ad(e,r,a,s){s-=Tl(r);var l=r.text.length,d=nr(function(h){return ur(e,a,h-1).bottom<=s},l,0);return l=nr(function(h){return ur(e,a,h).top>s},d,l),{begin:d,end:l}}function ld(e,r,a,s){a||(a=Mi(e,r));var l=Bs(e,r,ur(e,a,s),"line").top;return ad(e,r,a,l)}function Ml(e,r,a,s){return e.bottom<=a?!1:e.top>a?!0:(s?e.left:e.right)>r}function $b(e,r,a,s,l){l-=br(r);var d=Mi(e,r),h=Tl(r),g=0,v=r.text.length,b=!0,A=Sn(r,e.doc.direction);if(A){var P=(e.options.lineWrapping?Ub:qb)(e,r,a,d,A,s,l);b=P.level!=1,g=b?P.from:P.to-1,v=b?P.to:P.from-1}var B=null,z=null,G=nr(function(Fe){var me=ur(e,d,Fe);return me.top+=h,me.bottom+=h,Ml(me,s,l,!1)?(me.top<=l&&me.left<=s&&(B=Fe,z=me),!0):!1},g,v),Q,re,oe=!1;if(z){var ae=s-z.left<z.right-s,se=ae==b;G=B+(se?0:1),re=se?"after":"before",Q=ae?z.left:z.right}else{!b&&(G==v||G==g)&&G++,re=G==0?"after":G==r.text.length?"before":ur(e,d,G-(b?1:0)).bottom+h<=l==b?"after":"before";var ue=Zn(e,ee(a,G,re),"line",r,d);Q=ue.left,oe=l<ue.top?-1:l>=ue.bottom?1:0}return G=ln(r.text,G,1),Ll(a,G,re,oe,s-Q)}function qb(e,r,a,s,l,d,h){var g=nr(function(P){var B=l[P],z=B.level!=1;return Ml(Zn(e,ee(a,z?B.to:B.from,z?"before":"after"),"line",r,s),d,h,!0)},0,l.length-1),v=l[g];if(g>0){var b=v.level!=1,A=Zn(e,ee(a,b?v.from:v.to,b?"after":"before"),"line",r,s);Ml(A,d,h,!0)&&A.top>h&&(v=l[g-1])}return v}function Ub(e,r,a,s,l,d,h){var g=ad(e,r,s,h),v=g.begin,b=g.end;/\s/.test(r.text.charAt(b-1))&&b--;for(var A=null,P=null,B=0;B<l.length;B++){var z=l[B];if(!(z.from>=b||z.to<=v)){var G=z.level!=1,Q=ur(e,s,G?Math.min(b,z.to)-1:Math.max(v,z.from)).right,re=Q<d?d-Q+1e9:Q-d;(!A||P>re)&&(A=z,P=re)}}return A||(A=l[l.length-1]),A.from<v&&(A={from:v,to:A.to,level:A.level}),A.to>b&&(A={from:A.from,to:b,level:A.level}),A}var ti;function Ai(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(ti==null){ti=U("pre",null,"CodeMirror-line-like");for(var r=0;r<49;++r)ti.appendChild(document.createTextNode("x")),ti.appendChild(U("br"));ti.appendChild(document.createTextNode("x"))}W(e.measure,ti);var a=ti.offsetHeight/50;return a>3&&(e.cachedTextHeight=a),te(e.measure),a||1}function Oi(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var r=U("span","xxxxxxxxxx"),a=U("pre",[r],"CodeMirror-line-like");W(e.measure,a);var s=r.getBoundingClientRect(),l=(s.right-s.left)/10;return l>2&&(e.cachedCharWidth=l),l||10}function Al(e){for(var r=e.display,a={},s={},l=r.gutters.clientLeft,d=r.gutters.firstChild,h=0;d;d=d.nextSibling,++h){var g=e.display.gutterSpecs[h].className;a[g]=d.offsetLeft+d.clientLeft+l,s[g]=d.clientWidth}return{fixedPos:Ol(r),gutterTotalWidth:r.gutters.offsetWidth,gutterLeft:a,gutterWidth:s,wrapperWidth:r.wrapper.clientWidth}}function Ol(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function ud(e){var r=Ai(e.display),a=e.options.lineWrapping,s=a&&Math.max(5,e.display.scroller.clientWidth/Oi(e.display)-3);return function(l){if(Pr(e.doc,l))return 0;var d=0;if(l.widgets)for(var h=0;h<l.widgets.length;h++)l.widgets[h].height&&(d+=l.widgets[h].height);return a?d+(Math.ceil(l.text.length/s)||1)*r:d+r}}function Nl(e){var r=e.doc,a=ud(e);r.iter(function(s){var l=a(s);l!=s.height&&Cn(s,l)})}function ni(e,r,a,s){var l=e.display;if(!a&&Or(r).getAttribute("cm-not-content")=="true")return null;var d,h,g=l.lineSpace.getBoundingClientRect();try{d=r.clientX-g.left,h=r.clientY-g.top}catch{return null}var v=El(e,d,h),b;if(s&&v.xRel>0&&(b=de(e.doc,v.line).text).length==v.ch){var A=qt(b,b.length,e.options.tabSize)-b.length;v=ee(v.line,Math.max(0,Math.round((d-Jf(e.display).left)/Oi(e.display))-A))}return v}function ri(e,r){if(r>=e.display.viewTo||(r-=e.display.viewFrom,r<0))return null;for(var a=e.display.view,s=0;s<a.length;s++)if(r-=a[s].size,r<0)return s}function gn(e,r,a,s){r==null&&(r=e.doc.first),a==null&&(a=e.doc.first+e.doc.size),s||(s=0);var l=e.display;if(s&&a<l.viewTo&&(l.updateLineNumbers==null||l.updateLineNumbers>r)&&(l.updateLineNumbers=r),e.curOp.viewChanged=!0,r>=l.viewTo)yr&&yl(e.doc,r)<l.viewTo&&Ir(e);else if(a<=l.viewFrom)yr&&Hf(e.doc,a+s)>l.viewFrom?Ir(e):(l.viewFrom+=s,l.viewTo+=s);else if(r<=l.viewFrom&&a>=l.viewTo)Ir(e);else if(r<=l.viewFrom){var d=$s(e,a,a+s,1);d?(l.view=l.view.slice(d.index),l.viewFrom=d.lineN,l.viewTo+=s):Ir(e)}else if(a>=l.viewTo){var h=$s(e,r,r,-1);h?(l.view=l.view.slice(0,h.index),l.viewTo=h.lineN):Ir(e)}else{var g=$s(e,r,r,-1),v=$s(e,a,a+s,1);g&&v?(l.view=l.view.slice(0,g.index).concat(Fs(e,g.lineN,v.lineN)).concat(l.view.slice(v.index)),l.viewTo+=s):Ir(e)}var b=l.externalMeasured;b&&(a<b.lineN?b.lineN+=s:r<b.lineN+b.size&&(l.externalMeasured=null))}function Dr(e,r,a){e.curOp.viewChanged=!0;var s=e.display,l=e.display.externalMeasured;if(l&&r>=l.lineN&&r<l.lineN+l.size&&(s.externalMeasured=null),!(r<s.viewFrom||r>=s.viewTo)){var d=s.view[ri(e,r)];if(d.node!=null){var h=d.changes||(d.changes=[]);ge(h,a)==-1&&h.push(a)}}}function Ir(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function $s(e,r,a,s){var l=ri(e,r),d,h=e.display.view;if(!yr||a==e.doc.first+e.doc.size)return{index:l,lineN:a};for(var g=e.display.viewFrom,v=0;v<l;v++)g+=h[v].size;if(g!=r){if(s>0){if(l==h.length-1)return null;d=g+h[l].size-r,l++}else d=g-r;r+=d,a+=d}for(;yl(e.doc,a)!=a;){if(l==(s<0?0:h.length-1))return null;a+=s*h[l-(s<0?1:0)].size,l+=s}return{index:l,lineN:a}}function Vb(e,r,a){var s=e.display,l=s.view;l.length==0||r>=s.viewTo||a<=s.viewFrom?(s.view=Fs(e,r,a),s.viewFrom=r):(s.viewFrom>r?s.view=Fs(e,r,s.viewFrom).concat(s.view):s.viewFrom<r&&(s.view=s.view.slice(ri(e,r))),s.viewFrom=r,s.viewTo<a?s.view=s.view.concat(Fs(e,s.viewTo,a)):s.viewTo>a&&(s.view=s.view.slice(0,ri(e,a)))),s.viewTo=a}function cd(e){for(var r=e.display.view,a=0,s=0;s<r.length;s++){var l=r[s];!l.hidden&&(!l.node||l.changes)&&++a}return a}function Oo(e){e.display.input.showSelection(e.display.input.prepareSelection())}function fd(e,r){r===void 0&&(r=!0);var a=e.doc,s={},l=s.cursors=document.createDocumentFragment(),d=s.selection=document.createDocumentFragment(),h=e.options.$customCursor;h&&(r=!0);for(var g=0;g<a.sel.ranges.length;g++)if(!(!r&&g==a.sel.primIndex)){var v=a.sel.ranges[g];if(!(v.from().line>=e.display.viewTo||v.to().line<e.display.viewFrom)){var b=v.empty();if(h){var A=h(e,v);A&&Pl(e,A,l)}else(b||e.options.showCursorWhenSelecting)&&Pl(e,v.head,l);b||Gb(e,v,d)}}return s}function Pl(e,r,a){var s=Zn(e,r,"div",null,null,!e.options.singleCursorHeightPerLine),l=a.appendChild(U("div","\xA0","CodeMirror-cursor"));if(l.style.left=s.left+"px",l.style.top=s.top+"px",l.style.height=Math.max(0,s.bottom-s.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var d=Ws(e,r,"div",null,null),h=d.right-d.left;l.style.width=(h>0?h:e.defaultCharWidth())+"px"}if(s.other){var g=a.appendChild(U("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"));g.style.display="",g.style.left=s.other.left+"px",g.style.top=s.other.top+"px",g.style.height=(s.other.bottom-s.other.top)*.85+"px"}}function qs(e,r){return e.top-r.top||e.left-r.left}function Gb(e,r,a){var s=e.display,l=e.doc,d=document.createDocumentFragment(),h=Jf(e.display),g=h.left,v=Math.max(s.sizerWidth,ei(e)-s.sizer.offsetLeft)-h.right,b=l.direction=="ltr";function A(se,ue,Fe,me){ue<0&&(ue=0),ue=Math.round(ue),me=Math.round(me),d.appendChild(U("div",null,"CodeMirror-selected","position: absolute; left: "+se+`px;
                             top: `+ue+"px; width: "+(Fe??v-se)+`px;
                             height: `+(me-ue)+"px"))}function P(se,ue,Fe){var me=de(l,se),Xe=me.text.length,Tt,Qt;function Dt(Wt,yn){return Ws(e,ee(se,Wt),"div",me,yn)}function Ln(Wt,yn,tn){var Ut=ld(e,me,null,Wt),$t=yn=="ltr"==(tn=="after")?"left":"right",zt=tn=="after"?Ut.begin:Ut.end-(/\s/.test(me.text.charAt(Ut.end-1))?2:1);return Dt(zt,$t)[$t]}var vn=Sn(me,l.direction);return pl(vn,ue||0,Fe??Xe,function(Wt,yn,tn,Ut){var $t=tn=="ltr",zt=Dt(Wt,$t?"left":"right"),bn=Dt(yn-1,$t?"right":"left"),$i=ue==null&&Wt==0,Hr=Fe==null&&yn==Xe,sn=Ut==0,cr=!vn||Ut==vn.length-1;if(bn.top-zt.top<=3){var Zt=(b?$i:Hr)&&sn,iu=(b?Hr:$i)&&cr,Sr=Zt?g:($t?zt:bn).left,li=iu?v:($t?bn:zt).right;A(Sr,zt.top,li-Sr,zt.bottom)}else{var ui,cn,qi,ou;$t?(ui=b&&$i&&sn?g:zt.left,cn=b?v:Ln(Wt,tn,"before"),qi=b?g:Ln(yn,tn,"after"),ou=b&&Hr&&cr?v:bn.right):(ui=b?Ln(Wt,tn,"before"):g,cn=!b&&$i&&sn?v:zt.right,qi=!b&&Hr&&cr?g:bn.left,ou=b?Ln(yn,tn,"after"):v),A(ui,zt.top,cn-ui,zt.bottom),zt.bottom<bn.top&&A(g,zt.bottom,null,bn.top),A(qi,bn.top,ou-qi,bn.bottom)}(!Tt||qs(zt,Tt)<0)&&(Tt=zt),qs(bn,Tt)<0&&(Tt=bn),(!Qt||qs(zt,Qt)<0)&&(Qt=zt),qs(bn,Qt)<0&&(Qt=bn)}),{start:Tt,end:Qt}}var B=r.from(),z=r.to();if(B.line==z.line)P(B.line,B.ch,z.ch);else{var G=de(l,B.line),Q=de(l,z.line),re=Qn(G)==Qn(Q),oe=P(B.line,B.ch,re?G.text.length+1:null).end,ae=P(z.line,re?0:null,z.ch).start;re&&(oe.top<ae.top-2?(A(oe.right,oe.top,null,oe.bottom),A(g,ae.top,ae.left,ae.bottom)):A(oe.right,oe.top,ae.left-oe.right,oe.bottom)),oe.bottom<ae.top&&A(g,oe.bottom,null,ae.top)}a.appendChild(d)}function Dl(e){if(e.state.focused){var r=e.display;clearInterval(r.blinker);var a=!0;r.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?r.blinker=setInterval(function(){e.hasFocus()||Ni(e),r.cursorDiv.style.visibility=(a=!a)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(r.cursorDiv.style.visibility="hidden")}}function dd(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||_l(e))}function Il(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&Ni(e))},100)}function _l(e,r){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Ue(e,"focus",e,r),e.state.focused=!0,yt(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),m&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Dl(e))}function Ni(e,r){e.state.delayingBlurEvent||(e.state.focused&&(Ue(e,"blur",e,r),e.state.focused=!1,H(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Us(e){for(var r=e.display,a=r.lineDiv.offsetTop,s=Math.max(0,r.scroller.getBoundingClientRect().top),l=r.lineDiv.getBoundingClientRect().top,d=0,h=0;h<r.view.length;h++){var g=r.view[h],v=e.options.lineWrapping,b=void 0,A=0;if(!g.hidden){if(l+=g.line.height,f&&p<8){var P=g.node.offsetTop+g.node.offsetHeight;b=P-a,a=P}else{var B=g.node.getBoundingClientRect();b=B.bottom-B.top,!v&&g.text.firstChild&&(A=g.text.firstChild.getBoundingClientRect().right-B.left-1)}var z=g.line.height-b;if((z>.005||z<-.005)&&(l<s&&(d-=z),Cn(g.line,b),pd(g.line),g.rest))for(var G=0;G<g.rest.length;G++)pd(g.rest[G]);if(A>e.display.sizerWidth){var Q=Math.ceil(A/Oi(e.display));Q>e.display.maxLineLength&&(e.display.maxLineLength=Q,e.display.maxLine=g.line,e.display.maxLineChanged=!0)}}}Math.abs(d)>2&&(r.scroller.scrollTop+=d)}function pd(e){if(e.widgets)for(var r=0;r<e.widgets.length;++r){var a=e.widgets[r],s=a.node.parentNode;s&&(a.height=s.offsetHeight)}}function Vs(e,r,a){var s=a&&a.top!=null?Math.max(0,a.top):e.scroller.scrollTop;s=Math.floor(s-Hs(e));var l=a&&a.bottom!=null?a.bottom:s+e.wrapper.clientHeight,d=sr(r,s),h=sr(r,l);if(a&&a.ensure){var g=a.ensure.from.line,v=a.ensure.to.line;g<d?(d=g,h=sr(r,br(de(r,g))+e.wrapper.clientHeight)):Math.min(v,r.lastLine())>=h&&(d=sr(r,br(de(r,v))-e.wrapper.clientHeight),h=v)}return{from:d,to:Math.max(h,d+1)}}function Yb(e,r){if(!Bt(e,"scrollCursorIntoView")){var a=e.display,s=a.sizer.getBoundingClientRect(),l=null;if(r.top+s.top<0?l=!0:r.bottom+s.top>(window.innerHeight||document.documentElement.clientHeight)&&(l=!1),l!=null&&!O){var d=U("div","\u200B",null,`position: absolute;
                         top: `+(r.top-a.viewOffset-Hs(e.display))+`px;
                         height: `+(r.bottom-r.top+lr(e)+a.barHeight)+`px;
                         left: `+r.left+"px; width: "+Math.max(2,r.right-r.left)+"px;");e.display.lineSpace.appendChild(d),d.scrollIntoView(l),e.display.lineSpace.removeChild(d)}}}function Kb(e,r,a,s){s==null&&(s=0);var l;!e.options.lineWrapping&&r==a&&(a=r.sticky=="before"?ee(r.line,r.ch+1,"before"):r,r=r.ch?ee(r.line,r.sticky=="before"?r.ch-1:r.ch,"after"):r);for(var d=0;d<5;d++){var h=!1,g=Zn(e,r),v=!a||a==r?g:Zn(e,a);l={left:Math.min(g.left,v.left),top:Math.min(g.top,v.top)-s,right:Math.max(g.left,v.left),bottom:Math.max(g.bottom,v.bottom)+s};var b=Rl(e,l),A=e.doc.scrollTop,P=e.doc.scrollLeft;if(b.scrollTop!=null&&(Po(e,b.scrollTop),Math.abs(e.doc.scrollTop-A)>1&&(h=!0)),b.scrollLeft!=null&&(ii(e,b.scrollLeft),Math.abs(e.doc.scrollLeft-P)>1&&(h=!0)),!h)break}return l}function Jb(e,r){var a=Rl(e,r);a.scrollTop!=null&&Po(e,a.scrollTop),a.scrollLeft!=null&&ii(e,a.scrollLeft)}function Rl(e,r){var a=e.display,s=Ai(e.display);r.top<0&&(r.top=0);var l=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:a.scroller.scrollTop,d=Sl(e),h={};r.bottom-r.top>d&&(r.bottom=r.top+d);var g=e.doc.height+kl(a),v=r.top<s,b=r.bottom>g-s;if(r.top<l)h.scrollTop=v?0:r.top;else if(r.bottom>l+d){var A=Math.min(r.top,(b?g:r.bottom)-d);A!=l&&(h.scrollTop=A)}var P=e.options.fixedGutter?0:a.gutters.offsetWidth,B=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:a.scroller.scrollLeft-P,z=ei(e)-a.gutters.offsetWidth,G=r.right-r.left>z;return G&&(r.right=r.left+z),r.left<10?h.scrollLeft=0:r.left<B?h.scrollLeft=Math.max(0,r.left+P-(G?0:10)):r.right>z+B-3&&(h.scrollLeft=r.right+(G?0:10)-z),h}function jl(e,r){r!=null&&(Gs(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+r)}function Pi(e){Gs(e);var r=e.getCursor();e.curOp.scrollToPos={from:r,to:r,margin:e.options.cursorScrollMargin}}function No(e,r,a){(r!=null||a!=null)&&Gs(e),r!=null&&(e.curOp.scrollLeft=r),a!=null&&(e.curOp.scrollTop=a)}function Qb(e,r){Gs(e),e.curOp.scrollToPos=r}function Gs(e){var r=e.curOp.scrollToPos;if(r){e.curOp.scrollToPos=null;var a=sd(e,r.from),s=sd(e,r.to);hd(e,a,s,r.margin)}}function hd(e,r,a,s){var l=Rl(e,{left:Math.min(r.left,a.left),top:Math.min(r.top,a.top)-s,right:Math.max(r.right,a.right),bottom:Math.max(r.bottom,a.bottom)+s});No(e,l.scrollLeft,l.scrollTop)}function Po(e,r){Math.abs(e.doc.scrollTop-r)<2||(i||Fl(e,{top:r}),gd(e,r,!0),i&&Fl(e),_o(e,100))}function gd(e,r,a){r=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,r)),!(e.display.scroller.scrollTop==r&&!a)&&(e.doc.scrollTop=r,e.display.scrollbars.setScrollTop(r),e.display.scroller.scrollTop!=r&&(e.display.scroller.scrollTop=r))}function ii(e,r,a,s){r=Math.max(0,Math.min(r,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((a?r==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-r)<2)&&!s)&&(e.doc.scrollLeft=r,wd(e),e.display.scroller.scrollLeft!=r&&(e.display.scroller.scrollLeft=r),e.display.scrollbars.setScrollLeft(r))}function Do(e){var r=e.display,a=r.gutters.offsetWidth,s=Math.round(e.doc.height+kl(e.display));return{clientHeight:r.scroller.clientHeight,viewHeight:r.wrapper.clientHeight,scrollWidth:r.scroller.scrollWidth,clientWidth:r.scroller.clientWidth,viewWidth:r.wrapper.clientWidth,barLeft:e.options.fixedGutter?a:0,docHeight:s,scrollHeight:s+lr(e)+r.barHeight,nativeBarWidth:r.nativeBarWidth,gutterWidth:a}}var oi=function(e,r,a){this.cm=a;var s=this.vert=U("div",[U("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),l=this.horiz=U("div",[U("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");s.tabIndex=l.tabIndex=-1,e(s),e(l),Be(s,"scroll",function(){s.clientHeight&&r(s.scrollTop,"vertical")}),Be(l,"scroll",function(){l.clientWidth&&r(l.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,f&&p<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};oi.prototype.update=function(e){var r=e.scrollWidth>e.clientWidth+1,a=e.scrollHeight>e.clientHeight+1,s=e.nativeBarWidth;if(a){this.vert.style.display="block",this.vert.style.bottom=r?s+"px":"0";var l=e.viewHeight-(r?s:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+l)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(r){this.horiz.style.display="block",this.horiz.style.right=a?s+"px":"0",this.horiz.style.left=e.barLeft+"px";var d=e.viewWidth-e.barLeft-(a?s:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+d)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(s==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:a?s:0,bottom:r?s:0}},oi.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},oi.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},oi.prototype.zeroWidthHack=function(){var e=C&&!T?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Et,this.disableVert=new Et},oi.prototype.enableZeroWidthBar=function(e,r,a){e.style.pointerEvents="auto";function s(){var l=e.getBoundingClientRect(),d=a=="vert"?document.elementFromPoint(l.right-1,(l.top+l.bottom)/2):document.elementFromPoint((l.right+l.left)/2,l.bottom-1);d!=e?e.style.pointerEvents="none":r.set(1e3,s)}r.set(1e3,s)},oi.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var Io=function(){};Io.prototype.update=function(){return{bottom:0,right:0}},Io.prototype.setScrollLeft=function(){},Io.prototype.setScrollTop=function(){},Io.prototype.clear=function(){};function Di(e,r){r||(r=Do(e));var a=e.display.barWidth,s=e.display.barHeight;md(e,r);for(var l=0;l<4&&a!=e.display.barWidth||s!=e.display.barHeight;l++)a!=e.display.barWidth&&e.options.lineWrapping&&Us(e),md(e,Do(e)),a=e.display.barWidth,s=e.display.barHeight}function md(e,r){var a=e.display,s=a.scrollbars.update(r);a.sizer.style.paddingRight=(a.barWidth=s.right)+"px",a.sizer.style.paddingBottom=(a.barHeight=s.bottom)+"px",a.heightForcer.style.borderBottom=s.bottom+"px solid transparent",s.right&&s.bottom?(a.scrollbarFiller.style.display="block",a.scrollbarFiller.style.height=s.bottom+"px",a.scrollbarFiller.style.width=s.right+"px"):a.scrollbarFiller.style.display="",s.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(a.gutterFiller.style.display="block",a.gutterFiller.style.height=s.bottom+"px",a.gutterFiller.style.width=r.gutterWidth+"px"):a.gutterFiller.style.display=""}var vd={native:oi,null:Io};function yd(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&H(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new vd[e.options.scrollbarStyle](function(r){e.display.wrapper.insertBefore(r,e.display.scrollbarFiller),Be(r,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),r.setAttribute("cm-not-content","true")},function(r,a){a=="horizontal"?ii(e,r):Po(e,r)},e),e.display.scrollbars.addClass&&yt(e.display.wrapper,e.display.scrollbars.addClass)}var Zb=0;function si(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Zb,markArrays:null},Ab(e.curOp)}function ai(e){var r=e.curOp;r&&Nb(r,function(a){for(var s=0;s<a.ops.length;s++)a.ops[s].cm.curOp=null;Xb(a)})}function Xb(e){for(var r=e.ops,a=0;a<r.length;a++)ew(r[a]);for(var s=0;s<r.length;s++)tw(r[s]);for(var l=0;l<r.length;l++)nw(r[l]);for(var d=0;d<r.length;d++)rw(r[d]);for(var h=0;h<r.length;h++)iw(r[h])}function ew(e){var r=e.cm,a=r.display;sw(r),e.updateMaxLine&&wl(r),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<a.viewFrom||e.scrollToPos.to.line>=a.viewTo)||a.maxLineChanged&&r.options.lineWrapping,e.update=e.mustUpdate&&new Ys(r,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function tw(e){e.updatedDisplay=e.mustUpdate&&zl(e.cm,e.update)}function nw(e){var r=e.cm,a=r.display;e.updatedDisplay&&Us(r),e.barMeasure=Do(r),a.maxLineChanged&&!r.options.lineWrapping&&(e.adjustWidthTo=Zf(r,a.maxLine,a.maxLine.text.length).left+3,r.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(a.scroller.clientWidth,a.sizer.offsetLeft+e.adjustWidthTo+lr(r)+r.display.barWidth),e.maxScrollLeft=Math.max(0,a.sizer.offsetLeft+e.adjustWidthTo-ei(r))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=a.input.prepareSelection())}function rw(e){var r=e.cm;e.adjustWidthTo!=null&&(r.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<r.doc.scrollLeft&&ii(r,Math.min(r.display.scroller.scrollLeft,e.maxScrollLeft),!0),r.display.maxLineChanged=!1);var a=e.focus&&e.focus==he();e.preparedSelection&&r.display.input.showSelection(e.preparedSelection,a),(e.updatedDisplay||e.startHeight!=r.doc.height)&&Di(r,e.barMeasure),e.updatedDisplay&&Bl(r,e.barMeasure),e.selectionChanged&&Dl(r),r.state.focused&&e.updateInput&&r.display.input.reset(e.typing),a&&dd(e.cm)}function iw(e){var r=e.cm,a=r.display,s=r.doc;if(e.updatedDisplay&&bd(r,e.update),a.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(a.wheelStartX=a.wheelStartY=null),e.scrollTop!=null&&gd(r,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&ii(r,e.scrollLeft,!0,!0),e.scrollToPos){var l=Kb(r,le(s,e.scrollToPos.from),le(s,e.scrollToPos.to),e.scrollToPos.margin);Yb(r,l)}var d=e.maybeHiddenMarkers,h=e.maybeUnhiddenMarkers;if(d)for(var g=0;g<d.length;++g)d[g].lines.length||Ue(d[g],"hide");if(h)for(var v=0;v<h.length;++v)h[v].lines.length&&Ue(h[v],"unhide");a.wrapper.offsetHeight&&(s.scrollTop=r.display.scroller.scrollTop),e.changeObjs&&Ue(r,"changes",r,e.changeObjs),e.update&&e.update.finish()}function Tn(e,r){if(e.curOp)return r();si(e);try{return r()}finally{ai(e)}}function Kt(e,r){return function(){if(e.curOp)return r.apply(e,arguments);si(e);try{return r.apply(e,arguments)}finally{ai(e)}}}function un(e){return function(){if(this.curOp)return e.apply(this,arguments);si(this);try{return e.apply(this,arguments)}finally{ai(this)}}}function Jt(e){return function(){var r=this.cm;if(!r||r.curOp)return e.apply(this,arguments);si(r);try{return e.apply(this,arguments)}finally{ai(r)}}}function _o(e,r){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(r,Kr(ow,e))}function ow(e){var r=e.doc;if(!(r.highlightFrontier>=e.display.viewTo)){var a=+new Date+e.options.workTime,s=Co(e,r.highlightFrontier),l=[];r.iter(s.line,Math.min(r.first+r.size,e.display.viewTo+500),function(d){if(s.line>=e.display.viewFrom){var h=d.styles,g=d.text.length>e.options.maxHighlightLength?In(r.mode,s.state):null,v=Lf(e,d,s,!0);g&&(s.state=g),d.styles=v.styles;var b=d.styleClasses,A=v.classes;A?d.styleClasses=A:b&&(d.styleClasses=null);for(var P=!h||h.length!=d.styles.length||b!=A&&(!b||!A||b.bgClass!=A.bgClass||b.textClass!=A.textClass),B=0;!P&&B<h.length;++B)P=h[B]!=d.styles[B];P&&l.push(s.line),d.stateAfter=s.save(),s.nextLine()}else d.text.length<=e.options.maxHighlightLength&&hl(e,d.text,s),d.stateAfter=s.line%5==0?s.save():null,s.nextLine();if(+new Date>a)return _o(e,e.options.workDelay),!0}),r.highlightFrontier=s.line,r.modeFrontier=Math.max(r.modeFrontier,s.line),l.length&&Tn(e,function(){for(var d=0;d<l.length;d++)Dr(e,l[d],"text")})}}var Ys=function(e,r,a){var s=e.display;this.viewport=r,this.visible=Vs(s,e.doc,r),this.editorIsHidden=!s.wrapper.offsetWidth,this.wrapperHeight=s.wrapper.clientHeight,this.wrapperWidth=s.wrapper.clientWidth,this.oldDisplayWidth=ei(e),this.force=a,this.dims=Al(e),this.events=[]};Ys.prototype.signal=function(e,r){en(e,r)&&this.events.push(arguments)},Ys.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ue.apply(null,this.events[e])};function sw(e){var r=e.display;!r.scrollbarsClipped&&r.scroller.offsetWidth&&(r.nativeBarWidth=r.scroller.offsetWidth-r.scroller.clientWidth,r.heightForcer.style.height=lr(e)+"px",r.sizer.style.marginBottom=-r.nativeBarWidth+"px",r.sizer.style.borderRightWidth=lr(e)+"px",r.scrollbarsClipped=!0)}function aw(e){if(e.hasFocus())return null;var r=he();if(!r||!X(e.display.lineDiv,r))return null;var a={activeElt:r};if(window.getSelection){var s=window.getSelection();s.anchorNode&&s.extend&&X(e.display.lineDiv,s.anchorNode)&&(a.anchorNode=s.anchorNode,a.anchorOffset=s.anchorOffset,a.focusNode=s.focusNode,a.focusOffset=s.focusOffset)}return a}function lw(e){if(!(!e||!e.activeElt||e.activeElt==he())&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&X(document.body,e.anchorNode)&&X(document.body,e.focusNode))){var r=window.getSelection(),a=document.createRange();a.setEnd(e.anchorNode,e.anchorOffset),a.collapse(!1),r.removeAllRanges(),r.addRange(a),r.extend(e.focusNode,e.focusOffset)}}function zl(e,r){var a=e.display,s=e.doc;if(r.editorIsHidden)return Ir(e),!1;if(!r.force&&r.visible.from>=a.viewFrom&&r.visible.to<=a.viewTo&&(a.updateLineNumbers==null||a.updateLineNumbers>=a.viewTo)&&a.renderedView==a.view&&cd(e)==0)return!1;xd(e)&&(Ir(e),r.dims=Al(e));var l=s.first+s.size,d=Math.max(r.visible.from-e.options.viewportMargin,s.first),h=Math.min(l,r.visible.to+e.options.viewportMargin);a.viewFrom<d&&d-a.viewFrom<20&&(d=Math.max(s.first,a.viewFrom)),a.viewTo>h&&a.viewTo-h<20&&(h=Math.min(l,a.viewTo)),yr&&(d=yl(e.doc,d),h=Hf(e.doc,h));var g=d!=a.viewFrom||h!=a.viewTo||a.lastWrapHeight!=r.wrapperHeight||a.lastWrapWidth!=r.wrapperWidth;Vb(e,d,h),a.viewOffset=br(de(e.doc,a.viewFrom)),e.display.mover.style.top=a.viewOffset+"px";var v=cd(e);if(!g&&v==0&&!r.force&&a.renderedView==a.view&&(a.updateLineNumbers==null||a.updateLineNumbers>=a.viewTo))return!1;var b=aw(e);return v>4&&(a.lineDiv.style.display="none"),uw(e,a.updateLineNumbers,r.dims),v>4&&(a.lineDiv.style.display=""),a.renderedView=a.view,lw(b),te(a.cursorDiv),te(a.selectionDiv),a.gutters.style.height=a.sizer.style.minHeight=0,g&&(a.lastWrapHeight=r.wrapperHeight,a.lastWrapWidth=r.wrapperWidth,_o(e,400)),a.updateLineNumbers=null,!0}function bd(e,r){for(var a=r.viewport,s=!0;;s=!1){if(!s||!e.options.lineWrapping||r.oldDisplayWidth==ei(e)){if(a&&a.top!=null&&(a={top:Math.min(e.doc.height+kl(e.display)-Sl(e),a.top)}),r.visible=Vs(e.display,e.doc,a),r.visible.from>=e.display.viewFrom&&r.visible.to<=e.display.viewTo)break}else s&&(r.visible=Vs(e.display,e.doc,a));if(!zl(e,r))break;Us(e);var l=Do(e);Oo(e),Di(e,l),Bl(e,l),r.force=!1}r.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(r.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Fl(e,r){var a=new Ys(e,r);if(zl(e,a)){Us(e),bd(e,a);var s=Do(e);Oo(e),Di(e,s),Bl(e,s),a.finish()}}function uw(e,r,a){var s=e.display,l=e.options.lineNumbers,d=s.lineDiv,h=d.firstChild;function g(G){var Q=G.nextSibling;return m&&C&&e.display.currentWheelTarget==G?G.style.display="none":G.parentNode.removeChild(G),Q}for(var v=s.view,b=s.viewFrom,A=0;A<v.length;A++){var P=v[A];if(!P.hidden)if(!P.node||P.node.parentNode!=d){var B=Rb(e,P,b,a);d.insertBefore(B,h)}else{for(;h!=P.node;)h=g(h);var z=l&&r!=null&&r<=b&&P.lineNumber;P.changes&&(ge(P.changes,"gutter")>-1&&(z=!1),Uf(e,P,b,a)),z&&(te(P.lineNumber),P.lineNumber.appendChild(document.createTextNode(So(e.options,b)))),h=P.node.nextSibling}b+=P.size}for(;h;)h=g(h)}function Hl(e){var r=e.gutters.offsetWidth;e.sizer.style.marginLeft=r+"px",Yt(e,"gutterChanged",e)}function Bl(e,r){e.display.sizer.style.minHeight=r.docHeight+"px",e.display.heightForcer.style.top=r.docHeight+"px",e.display.gutters.style.height=r.docHeight+e.display.barHeight+lr(e)+"px"}function wd(e){var r=e.display,a=r.view;if(!(!r.alignWidgets&&(!r.gutters.firstChild||!e.options.fixedGutter))){for(var s=Ol(r)-r.scroller.scrollLeft+e.doc.scrollLeft,l=r.gutters.offsetWidth,d=s+"px",h=0;h<a.length;h++)if(!a[h].hidden){e.options.fixedGutter&&(a[h].gutter&&(a[h].gutter.style.left=d),a[h].gutterBackground&&(a[h].gutterBackground.style.left=d));var g=a[h].alignable;if(g)for(var v=0;v<g.length;v++)g[v].style.left=d}e.options.fixedGutter&&(r.gutters.style.left=s+l+"px")}}function xd(e){if(!e.options.lineNumbers)return!1;var r=e.doc,a=So(e.options,r.first+r.size-1),s=e.display;if(a.length!=s.lineNumChars){var l=s.measure.appendChild(U("div",[U("div",a)],"CodeMirror-linenumber CodeMirror-gutter-elt")),d=l.firstChild.offsetWidth,h=l.offsetWidth-d;return s.lineGutter.style.width="",s.lineNumInnerWidth=Math.max(d,s.lineGutter.offsetWidth-h)+1,s.lineNumWidth=s.lineNumInnerWidth+h,s.lineNumChars=s.lineNumInnerWidth?a.length:-1,s.lineGutter.style.width=s.lineNumWidth+"px",Hl(e.display),!0}return!1}function Wl(e,r){for(var a=[],s=!1,l=0;l<e.length;l++){var d=e[l],h=null;if(typeof d!="string"&&(h=d.style,d=d.className),d=="CodeMirror-linenumbers")if(r)s=!0;else continue;a.push({className:d,style:h})}return r&&!s&&a.push({className:"CodeMirror-linenumbers",style:null}),a}function kd(e){var r=e.gutters,a=e.gutterSpecs;te(r),e.lineGutter=null;for(var s=0;s<a.length;++s){var l=a[s],d=l.className,h=l.style,g=r.appendChild(U("div",null,"CodeMirror-gutter "+d));h&&(g.style.cssText=h),d=="CodeMirror-linenumbers"&&(e.lineGutter=g,g.style.width=(e.lineNumWidth||1)+"px")}r.style.display=a.length?"":"none",Hl(e)}function Ro(e){kd(e.display),gn(e),wd(e)}function cw(e,r,a,s){var l=this;this.input=a,l.scrollbarFiller=U("div",null,"CodeMirror-scrollbar-filler"),l.scrollbarFiller.setAttribute("cm-not-content","true"),l.gutterFiller=U("div",null,"CodeMirror-gutter-filler"),l.gutterFiller.setAttribute("cm-not-content","true"),l.lineDiv=L("div",null,"CodeMirror-code"),l.selectionDiv=U("div",null,null,"position: relative; z-index: 1"),l.cursorDiv=U("div",null,"CodeMirror-cursors"),l.measure=U("div",null,"CodeMirror-measure"),l.lineMeasure=U("div",null,"CodeMirror-measure"),l.lineSpace=L("div",[l.measure,l.lineMeasure,l.selectionDiv,l.cursorDiv,l.lineDiv],null,"position: relative; outline: none");var d=L("div",[l.lineSpace],"CodeMirror-lines");l.mover=U("div",[d],null,"position: relative"),l.sizer=U("div",[l.mover],"CodeMirror-sizer"),l.sizerWidth=null,l.heightForcer=U("div",null,null,"position: absolute; height: "+qe+"px; width: 1px;"),l.gutters=U("div",null,"CodeMirror-gutters"),l.lineGutter=null,l.scroller=U("div",[l.sizer,l.heightForcer,l.gutters],"CodeMirror-scroll"),l.scroller.setAttribute("tabIndex","-1"),l.wrapper=U("div",[l.scrollbarFiller,l.gutterFiller,l.scroller],"CodeMirror"),l.wrapper.setAttribute("translate","no"),f&&p<8&&(l.gutters.style.zIndex=-1,l.scroller.style.paddingRight=0),!m&&!(i&&_)&&(l.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(l.wrapper):e(l.wrapper)),l.viewFrom=l.viewTo=r.first,l.reportedViewFrom=l.reportedViewTo=r.first,l.view=[],l.renderedView=null,l.externalMeasured=null,l.viewOffset=0,l.lastWrapHeight=l.lastWrapWidth=0,l.updateLineNumbers=null,l.nativeBarWidth=l.barHeight=l.barWidth=0,l.scrollbarsClipped=!1,l.lineNumWidth=l.lineNumInnerWidth=l.lineNumChars=null,l.alignWidgets=!1,l.cachedCharWidth=l.cachedTextHeight=l.cachedPaddingH=null,l.maxLine=null,l.maxLineLength=0,l.maxLineChanged=!1,l.wheelDX=l.wheelDY=l.wheelStartX=l.wheelStartY=null,l.shift=!1,l.selForContextMenu=null,l.activeTouch=null,l.gutterSpecs=Wl(s.gutters,s.lineNumbers),kd(l),a.init(l)}var Ks=0,xr=null;f?xr=-.53:i?xr=15:x?xr=-.7:k&&(xr=-1/3);function Sd(e){var r=e.wheelDeltaX,a=e.wheelDeltaY;return r==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(r=e.detail),a==null&&e.detail&&e.axis==e.VERTICAL_AXIS?a=e.detail:a==null&&(a=e.wheelDelta),{x:r,y:a}}function fw(e){var r=Sd(e);return r.x*=xr,r.y*=xr,r}function Cd(e,r){var a=Sd(r),s=a.x,l=a.y,d=xr;r.deltaMode===0&&(s=r.deltaX,l=r.deltaY,d=1);var h=e.display,g=h.scroller,v=g.scrollWidth>g.clientWidth,b=g.scrollHeight>g.clientHeight;if(s&&v||l&&b){if(l&&C&&m){e:for(var A=r.target,P=h.view;A!=g;A=A.parentNode)for(var B=0;B<P.length;B++)if(P[B].node==A){e.display.currentWheelTarget=A;break e}}if(s&&!i&&!S&&d!=null){l&&b&&Po(e,Math.max(0,g.scrollTop+l*d)),ii(e,Math.max(0,g.scrollLeft+s*d)),(!l||l&&b)&&nn(r),h.wheelStartX=null;return}if(l&&d!=null){var z=l*d,G=e.doc.scrollTop,Q=G+h.wrapper.clientHeight;z<0?G=Math.max(0,G+z-50):Q=Math.min(e.doc.height,Q+z+50),Fl(e,{top:G,bottom:Q})}Ks<20&&r.deltaMode!==0&&(h.wheelStartX==null?(h.wheelStartX=g.scrollLeft,h.wheelStartY=g.scrollTop,h.wheelDX=s,h.wheelDY=l,setTimeout(function(){if(h.wheelStartX!=null){var re=g.scrollLeft-h.wheelStartX,oe=g.scrollTop-h.wheelStartY,ae=oe&&h.wheelDY&&oe/h.wheelDY||re&&h.wheelDX&&re/h.wheelDX;h.wheelStartX=h.wheelStartY=null,ae&&(xr=(xr*Ks+ae)/(Ks+1),++Ks)}},200)):(h.wheelDX+=s,h.wheelDY+=l))}}var Rn=function(e,r){this.ranges=e,this.primIndex=r};Rn.prototype.primary=function(){return this.ranges[this.primIndex]},Rn.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var r=0;r<this.ranges.length;r++){var a=this.ranges[r],s=e.ranges[r];if(!D(a.anchor,s.anchor)||!D(a.head,s.head))return!1}return!0},Rn.prototype.deepCopy=function(){for(var e=[],r=0;r<this.ranges.length;r++)e[r]=new vt(J(this.ranges[r].anchor),J(this.ranges[r].head));return new Rn(e,this.primIndex)},Rn.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Rn.prototype.contains=function(e,r){r||(r=e);for(var a=0;a<this.ranges.length;a++){var s=this.ranges[a];if(w(r,s.from())>=0&&w(e,s.to())<=0)return a}return-1};var vt=function(e,r){this.anchor=e,this.head=r};vt.prototype.from=function(){return Ve(this.anchor,this.head)},vt.prototype.to=function(){return ne(this.anchor,this.head)},vt.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function Xn(e,r,a){var s=e&&e.options.selectionsMayTouch,l=r[a];r.sort(function(B,z){return w(B.from(),z.from())}),a=ge(r,l);for(var d=1;d<r.length;d++){var h=r[d],g=r[d-1],v=w(g.to(),h.from());if(s&&!h.empty()?v>0:v>=0){var b=Ve(g.from(),h.from()),A=ne(g.to(),h.to()),P=g.empty()?h.from()==h.head:g.from()==g.head;d<=a&&--a,r.splice(--d,2,new vt(P?A:b,P?b:A))}}return new Rn(r,a)}function _r(e,r){return new Rn([new vt(e,r||e)],0)}function Rr(e){return e.text?ee(e.from.line+e.text.length-1,tt(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function Td(e,r){if(w(e,r.from)<0)return e;if(w(e,r.to)<=0)return Rr(r);var a=e.line+r.text.length-(r.to.line-r.from.line)-1,s=e.ch;return e.line==r.to.line&&(s+=Rr(r).ch-r.to.ch),ee(a,s)}function $l(e,r){for(var a=[],s=0;s<e.sel.ranges.length;s++){var l=e.sel.ranges[s];a.push(new vt(Td(l.anchor,r),Td(l.head,r)))}return Xn(e.cm,a,e.sel.primIndex)}function Ld(e,r,a){return e.line==r.line?ee(a.line,e.ch-r.ch+a.ch):ee(a.line+(e.line-r.line),e.ch)}function dw(e,r,a){for(var s=[],l=ee(e.first,0),d=l,h=0;h<r.length;h++){var g=r[h],v=Ld(g.from,l,d),b=Ld(Rr(g),l,d);if(l=g.to,d=b,a=="around"){var A=e.sel.ranges[h],P=w(A.head,A.anchor)<0;s[h]=new vt(P?b:v,P?v:b)}else s[h]=new vt(v,v)}return new Rn(s,e.sel.primIndex)}function ql(e){e.doc.mode=Ci(e.options,e.doc.modeOption),jo(e)}function jo(e){e.doc.iter(function(r){r.stateAfter&&(r.stateAfter=null),r.styles&&(r.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,_o(e,100),e.state.modeGen++,e.curOp&&gn(e)}function Ed(e,r){return r.from.ch==0&&r.to.ch==0&&tt(r.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ul(e,r,a,s){function l(ae){return a?a[ae]:null}function d(ae,se,ue){wb(ae,se,ue,s),Yt(ae,"change",ae,r)}function h(ae,se){for(var ue=[],Fe=ae;Fe<se;++Fe)ue.push(new Li(b[Fe],l(Fe),s));return ue}var g=r.from,v=r.to,b=r.text,A=de(e,g.line),P=de(e,v.line),B=tt(b),z=l(b.length-1),G=v.line-g.line;if(r.full)e.insert(0,h(0,b.length)),e.remove(b.length,e.size-b.length);else if(Ed(e,r)){var Q=h(0,b.length-1);d(P,P.text,z),G&&e.remove(g.line,G),Q.length&&e.insert(g.line,Q)}else if(A==P)if(b.length==1)d(A,A.text.slice(0,g.ch)+B+A.text.slice(v.ch),z);else{var re=h(1,b.length-1);re.push(new Li(B+A.text.slice(v.ch),z,s)),d(A,A.text.slice(0,g.ch)+b[0],l(0)),e.insert(g.line+1,re)}else if(b.length==1)d(A,A.text.slice(0,g.ch)+b[0]+P.text.slice(v.ch),l(0)),e.remove(g.line+1,G);else{d(A,A.text.slice(0,g.ch)+b[0],l(0)),d(P,B+P.text.slice(v.ch),z);var oe=h(1,b.length-1);G>1&&e.remove(g.line+1,G-1),e.insert(g.line+1,oe)}Yt(e,"change",e,r)}function jr(e,r,a){function s(l,d,h){if(l.linked)for(var g=0;g<l.linked.length;++g){var v=l.linked[g];if(v.doc!=d){var b=h&&v.sharedHist;a&&!b||(r(v.doc,b),s(v.doc,l,b))}}}s(e,null,!0)}function Md(e,r){if(r.cm)throw new Error("This document is already in use.");e.doc=r,r.cm=e,Nl(e),ql(e),Ad(e),e.options.direction=r.direction,e.options.lineWrapping||wl(e),e.options.mode=r.modeOption,gn(e)}function Ad(e){(e.doc.direction=="rtl"?yt:H)(e.display.lineDiv,"CodeMirror-rtl")}function pw(e){Tn(e,function(){Ad(e),gn(e)})}function Js(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Vl(e,r){var a={from:J(r.from),to:Rr(r),text:or(e,r.from,r.to)};return Pd(e,a,r.from.line,r.to.line+1),jr(e,function(s){return Pd(s,a,r.from.line,r.to.line+1)},!0),a}function Od(e){for(;e.length;){var r=tt(e);if(r.ranges)e.pop();else break}}function hw(e,r){if(r)return Od(e.done),tt(e.done);if(e.done.length&&!tt(e.done).ranges)return tt(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),tt(e.done)}function Nd(e,r,a,s){var l=e.history;l.undone.length=0;var d=+new Date,h,g;if((l.lastOp==s||l.lastOrigin==r.origin&&r.origin&&(r.origin.charAt(0)=="+"&&l.lastModTime>d-(e.cm?e.cm.options.historyEventDelay:500)||r.origin.charAt(0)=="*"))&&(h=hw(l,l.lastOp==s)))g=tt(h.changes),w(r.from,r.to)==0&&w(r.from,g.to)==0?g.to=Rr(r):h.changes.push(Vl(e,r));else{var v=tt(l.done);for((!v||!v.ranges)&&Qs(e.sel,l.done),h={changes:[Vl(e,r)],generation:l.generation},l.done.push(h);l.done.length>l.undoDepth;)l.done.shift(),l.done[0].ranges||l.done.shift()}l.done.push(a),l.generation=++l.maxGeneration,l.lastModTime=l.lastSelTime=d,l.lastOp=l.lastSelOp=s,l.lastOrigin=l.lastSelOrigin=r.origin,g||Ue(e,"historyAdded")}function gw(e,r,a,s){var l=r.charAt(0);return l=="*"||l=="+"&&a.ranges.length==s.ranges.length&&a.somethingSelected()==s.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function mw(e,r,a,s){var l=e.history,d=s&&s.origin;a==l.lastSelOp||d&&l.lastSelOrigin==d&&(l.lastModTime==l.lastSelTime&&l.lastOrigin==d||gw(e,d,tt(l.done),r))?l.done[l.done.length-1]=r:Qs(r,l.done),l.lastSelTime=+new Date,l.lastSelOrigin=d,l.lastSelOp=a,s&&s.clearRedo!==!1&&Od(l.undone)}function Qs(e,r){var a=tt(r);a&&a.ranges&&a.equals(e)||r.push(e)}function Pd(e,r,a,s){var l=r["spans_"+e.id],d=0;e.iter(Math.max(e.first,a),Math.min(e.first+e.size,s),function(h){h.markedSpans&&((l||(l=r["spans_"+e.id]={}))[d]=h.markedSpans),++d})}function vw(e){if(!e)return null;for(var r,a=0;a<e.length;++a)e[a].marker.explicitlyCleared?r||(r=e.slice(0,a)):r&&r.push(e[a]);return r?r.length?r:null:e}function yw(e,r){var a=r["spans_"+e.id];if(!a)return null;for(var s=[],l=0;l<r.text.length;++l)s.push(vw(a[l]));return s}function Dd(e,r){var a=yw(e,r),s=ml(e,r);if(!a)return s;if(!s)return a;for(var l=0;l<a.length;++l){var d=a[l],h=s[l];if(d&&h)e:for(var g=0;g<h.length;++g){for(var v=h[g],b=0;b<d.length;++b)if(d[b].marker==v.marker)continue e;d.push(v)}else h&&(a[l]=h)}return a}function Ii(e,r,a){for(var s=[],l=0;l<e.length;++l){var d=e[l];if(d.ranges){s.push(a?Rn.prototype.deepCopy.call(d):d);continue}var h=d.changes,g=[];s.push({changes:g});for(var v=0;v<h.length;++v){var b=h[v],A=void 0;if(g.push({from:b.from,to:b.to,text:b.text}),r)for(var P in b)(A=P.match(/^spans_(\d+)$/))&&ge(r,Number(A[1]))>-1&&(tt(g)[P]=b[P],delete b[P])}}return s}function Gl(e,r,a,s){if(s){var l=e.anchor;if(a){var d=w(r,l)<0;d!=w(a,l)<0?(l=r,r=a):d!=w(r,a)<0&&(r=a)}return new vt(l,r)}else return new vt(a||r,r)}function Zs(e,r,a,s,l){l==null&&(l=e.cm&&(e.cm.display.shift||e.extend)),on(e,new Rn([Gl(e.sel.primary(),r,a,l)],0),s)}function Id(e,r,a){for(var s=[],l=e.cm&&(e.cm.display.shift||e.extend),d=0;d<e.sel.ranges.length;d++)s[d]=Gl(e.sel.ranges[d],r[d],null,l);var h=Xn(e.cm,s,e.sel.primIndex);on(e,h,a)}function Yl(e,r,a,s){var l=e.sel.ranges.slice(0);l[r]=a,on(e,Xn(e.cm,l,e.sel.primIndex),s)}function _d(e,r,a,s){on(e,_r(r,a),s)}function bw(e,r,a){var s={ranges:r.ranges,update:function(l){this.ranges=[];for(var d=0;d<l.length;d++)this.ranges[d]=new vt(le(e,l[d].anchor),le(e,l[d].head))},origin:a&&a.origin};return Ue(e,"beforeSelectionChange",e,s),e.cm&&Ue(e.cm,"beforeSelectionChange",e.cm,s),s.ranges!=r.ranges?Xn(e.cm,s.ranges,s.ranges.length-1):r}function Rd(e,r,a){var s=e.history.done,l=tt(s);l&&l.ranges?(s[s.length-1]=r,Xs(e,r,a)):on(e,r,a)}function on(e,r,a){Xs(e,r,a),mw(e,e.sel,e.cm?e.cm.curOp.id:NaN,a)}function Xs(e,r,a){(en(e,"beforeSelectionChange")||e.cm&&en(e.cm,"beforeSelectionChange"))&&(r=bw(e,r,a));var s=a&&a.bias||(w(r.primary().head,e.sel.primary().head)<0?-1:1);jd(e,Fd(e,r,s,!0)),!(a&&a.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&Pi(e.cm)}function jd(e,r){r.equals(e.sel)||(e.sel=r,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,xi(e.cm)),Yt(e,"cursorActivity",e))}function zd(e){jd(e,Fd(e,e.sel,null,!1))}function Fd(e,r,a,s){for(var l,d=0;d<r.ranges.length;d++){var h=r.ranges[d],g=r.ranges.length==e.sel.ranges.length&&e.sel.ranges[d],v=ea(e,h.anchor,g&&g.anchor,a,s),b=ea(e,h.head,g&&g.head,a,s);(l||v!=h.anchor||b!=h.head)&&(l||(l=r.ranges.slice(0,d)),l[d]=new vt(v,b))}return l?Xn(e.cm,l,r.primIndex):r}function _i(e,r,a,s,l){var d=de(e,r.line);if(d.markedSpans)for(var h=0;h<d.markedSpans.length;++h){var g=d.markedSpans[h],v=g.marker,b="selectLeft"in v?!v.selectLeft:v.inclusiveLeft,A="selectRight"in v?!v.selectRight:v.inclusiveRight;if((g.from==null||(b?g.from<=r.ch:g.from<r.ch))&&(g.to==null||(A?g.to>=r.ch:g.to>r.ch))){if(l&&(Ue(v,"beforeCursorEnter"),v.explicitlyCleared))if(d.markedSpans){--h;continue}else break;if(!v.atomic)continue;if(a){var P=v.find(s<0?1:-1),B=void 0;if((s<0?A:b)&&(P=Hd(e,P,-s,P&&P.line==r.line?d:null)),P&&P.line==r.line&&(B=w(P,a))&&(s<0?B<0:B>0))return _i(e,P,r,s,l)}var z=v.find(s<0?-1:1);return(s<0?b:A)&&(z=Hd(e,z,s,z.line==r.line?d:null)),z?_i(e,z,r,s,l):null}}return r}function ea(e,r,a,s,l){var d=s||1,h=_i(e,r,a,d,l)||!l&&_i(e,r,a,d,!0)||_i(e,r,a,-d,l)||!l&&_i(e,r,a,-d,!0);return h||(e.cantEdit=!0,ee(e.first,0))}function Hd(e,r,a,s){return a<0&&r.ch==0?r.line>e.first?le(e,ee(r.line-1)):null:a>0&&r.ch==(s||de(e,r.line)).text.length?r.line<e.first+e.size-1?ee(r.line+1,0):null:new ee(r.line,r.ch+a)}function Bd(e){e.setSelection(ee(e.firstLine(),0),ee(e.lastLine()),ft)}function Wd(e,r,a){var s={canceled:!1,from:r.from,to:r.to,text:r.text,origin:r.origin,cancel:function(){return s.canceled=!0}};return a&&(s.update=function(l,d,h,g){l&&(s.from=le(e,l)),d&&(s.to=le(e,d)),h&&(s.text=h),g!==void 0&&(s.origin=g)}),Ue(e,"beforeChange",e,s),e.cm&&Ue(e.cm,"beforeChange",e.cm,s),s.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:s.from,to:s.to,text:s.text,origin:s.origin}}function Ri(e,r,a){if(e.cm){if(!e.cm.curOp)return Kt(e.cm,Ri)(e,r,a);if(e.cm.state.suppressEdits)return}if(!((en(e,"beforeChange")||e.cm&&en(e.cm,"beforeChange"))&&(r=Wd(e,r,!0),!r))){var s=Df&&!a&&mb(e,r.from,r.to);if(s)for(var l=s.length-1;l>=0;--l)$d(e,{from:s[l].from,to:s[l].to,text:l?[""]:r.text,origin:r.origin});else $d(e,r)}}function $d(e,r){if(!(r.text.length==1&&r.text[0]==""&&w(r.from,r.to)==0)){var a=$l(e,r);Nd(e,r,a,e.cm?e.cm.curOp.id:NaN),zo(e,r,a,ml(e,r));var s=[];jr(e,function(l,d){!d&&ge(s,l.history)==-1&&(Gd(l.history,r),s.push(l.history)),zo(l,r,null,ml(l,r))})}}function ta(e,r,a){var s=e.cm&&e.cm.state.suppressEdits;if(!(s&&!a)){for(var l=e.history,d,h=e.sel,g=r=="undo"?l.done:l.undone,v=r=="undo"?l.undone:l.done,b=0;b<g.length&&(d=g[b],!(a?d.ranges&&!d.equals(e.sel):!d.ranges));b++);if(b!=g.length){for(l.lastOrigin=l.lastSelOrigin=null;;)if(d=g.pop(),d.ranges){if(Qs(d,v),a&&!d.equals(e.sel)){on(e,d,{clearRedo:!1});return}h=d}else if(s){g.push(d);return}else break;var A=[];Qs(h,v),v.push({changes:A,generation:l.generation}),l.generation=d.generation||++l.maxGeneration;for(var P=en(e,"beforeChange")||e.cm&&en(e.cm,"beforeChange"),B=function(Q){var re=d.changes[Q];if(re.origin=r,P&&!Wd(e,re,!1))return g.length=0,{};A.push(Vl(e,re));var oe=Q?$l(e,re):tt(g);zo(e,re,oe,Dd(e,re)),!Q&&e.cm&&e.cm.scrollIntoView({from:re.from,to:Rr(re)});var ae=[];jr(e,function(se,ue){!ue&&ge(ae,se.history)==-1&&(Gd(se.history,re),ae.push(se.history)),zo(se,re,null,Dd(se,re))})},z=d.changes.length-1;z>=0;--z){var G=B(z);if(G)return G.v}}}}function qd(e,r){if(r!=0&&(e.first+=r,e.sel=new Rn(gt(e.sel.ranges,function(l){return new vt(ee(l.anchor.line+r,l.anchor.ch),ee(l.head.line+r,l.head.ch))}),e.sel.primIndex),e.cm)){gn(e.cm,e.first,e.first-r,r);for(var a=e.cm.display,s=a.viewFrom;s<a.viewTo;s++)Dr(e.cm,s,"gutter")}}function zo(e,r,a,s){if(e.cm&&!e.cm.curOp)return Kt(e.cm,zo)(e,r,a,s);if(r.to.line<e.first){qd(e,r.text.length-1-(r.to.line-r.from.line));return}if(!(r.from.line>e.lastLine())){if(r.from.line<e.first){var l=r.text.length-1-(e.first-r.from.line);qd(e,l),r={from:ee(e.first,0),to:ee(r.to.line+l,r.to.ch),text:[tt(r.text)],origin:r.origin}}var d=e.lastLine();r.to.line>d&&(r={from:r.from,to:ee(d,de(e,d).text.length),text:[r.text[0]],origin:r.origin}),r.removed=or(e,r.from,r.to),a||(a=$l(e,r)),e.cm?ww(e.cm,r,s):Ul(e,r,s),Xs(e,a,ft),e.cantEdit&&ea(e,ee(e.firstLine(),0))&&(e.cantEdit=!1)}}function ww(e,r,a){var s=e.doc,l=e.display,d=r.from,h=r.to,g=!1,v=d.line;e.options.lineWrapping||(v=mt(Qn(de(s,d.line))),s.iter(v,h.line+1,function(z){if(z==l.maxLine)return g=!0,!0})),s.sel.contains(r.from,r.to)>-1&&xi(e),Ul(s,r,a,ud(e)),e.options.lineWrapping||(s.iter(v,d.line+r.text.length,function(z){var G=zs(z);G>l.maxLineLength&&(l.maxLine=z,l.maxLineLength=G,l.maxLineChanged=!0,g=!1)}),g&&(e.curOp.updateMaxLine=!0)),ub(s,d.line),_o(e,400);var b=r.text.length-(h.line-d.line)-1;r.full?gn(e):d.line==h.line&&r.text.length==1&&!Ed(e.doc,r)?Dr(e,d.line,"text"):gn(e,d.line,h.line+1,b);var A=en(e,"changes"),P=en(e,"change");if(P||A){var B={from:d,to:h,text:r.text,removed:r.removed,origin:r.origin};P&&Yt(e,"change",e,B),A&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(B)}e.display.selForContextMenu=null}function ji(e,r,a,s,l){var d;s||(s=a),w(s,a)<0&&(d=[s,a],a=d[0],s=d[1]),typeof r=="string"&&(r=e.splitLines(r)),Ri(e,{from:a,to:s,text:r,origin:l})}function Ud(e,r,a,s){a<e.line?e.line+=s:r<e.line&&(e.line=r,e.ch=0)}function Vd(e,r,a,s){for(var l=0;l<e.length;++l){var d=e[l],h=!0;if(d.ranges){d.copied||(d=e[l]=d.deepCopy(),d.copied=!0);for(var g=0;g<d.ranges.length;g++)Ud(d.ranges[g].anchor,r,a,s),Ud(d.ranges[g].head,r,a,s);continue}for(var v=0;v<d.changes.length;++v){var b=d.changes[v];if(a<b.from.line)b.from=ee(b.from.line+s,b.from.ch),b.to=ee(b.to.line+s,b.to.ch);else if(r<=b.to.line){h=!1;break}}h||(e.splice(0,l+1),l=0)}}function Gd(e,r){var a=r.from.line,s=r.to.line,l=r.text.length-(s-a)-1;Vd(e.done,a,s,l),Vd(e.undone,a,s,l)}function Fo(e,r,a,s){var l=r,d=r;return typeof r=="number"?d=de(e,ct(e,r)):l=mt(r),l==null?null:(s(d,l)&&e.cm&&Dr(e.cm,l,a),d)}function Ho(e){this.lines=e,this.parent=null;for(var r=0,a=0;a<e.length;++a)e[a].parent=this,r+=e[a].height;this.height=r}Ho.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,r){for(var a=e,s=e+r;a<s;++a){var l=this.lines[a];this.height-=l.height,xb(l),Yt(l,"delete")}this.lines.splice(e,r)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,r,a){this.height+=a,this.lines=this.lines.slice(0,e).concat(r).concat(this.lines.slice(e));for(var s=0;s<r.length;++s)r[s].parent=this},iterN:function(e,r,a){for(var s=e+r;e<s;++e)if(a(this.lines[e]))return!0}};function Bo(e){this.children=e;for(var r=0,a=0,s=0;s<e.length;++s){var l=e[s];r+=l.chunkSize(),a+=l.height,l.parent=this}this.size=r,this.height=a,this.parent=null}Bo.prototype={chunkSize:function(){return this.size},removeInner:function(e,r){this.size-=r;for(var a=0;a<this.children.length;++a){var s=this.children[a],l=s.chunkSize();if(e<l){var d=Math.min(r,l-e),h=s.height;if(s.removeInner(e,d),this.height-=h-s.height,l==d&&(this.children.splice(a--,1),s.parent=null),(r-=d)==0)break;e=0}else e-=l}if(this.size-r<25&&(this.children.length>1||!(this.children[0]instanceof Ho))){var g=[];this.collapse(g),this.children=[new Ho(g)],this.children[0].parent=this}},collapse:function(e){for(var r=0;r<this.children.length;++r)this.children[r].collapse(e)},insertInner:function(e,r,a){this.size+=r.length,this.height+=a;for(var s=0;s<this.children.length;++s){var l=this.children[s],d=l.chunkSize();if(e<=d){if(l.insertInner(e,r,a),l.lines&&l.lines.length>50){for(var h=l.lines.length%25+25,g=h;g<l.lines.length;){var v=new Ho(l.lines.slice(g,g+=25));l.height-=v.height,this.children.splice(++s,0,v),v.parent=this}l.lines=l.lines.slice(0,h),this.maybeSpill()}break}e-=d}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var r=e.children.splice(e.children.length-5,5),a=new Bo(r);if(e.parent){e.size-=a.size,e.height-=a.height;var l=ge(e.parent.children,e);e.parent.children.splice(l+1,0,a)}else{var s=new Bo(e.children);s.parent=e,e.children=[s,a],e=s}a.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,r,a){for(var s=0;s<this.children.length;++s){var l=this.children[s],d=l.chunkSize();if(e<d){var h=Math.min(r,d-e);if(l.iterN(e,h,a))return!0;if((r-=h)==0)break;e=0}else e-=d}}};var Wo=function(e,r,a){if(a)for(var s in a)a.hasOwnProperty(s)&&(this[s]=a[s]);this.doc=e,this.node=r};Wo.prototype.clear=function(){var e=this.doc.cm,r=this.line.widgets,a=this.line,s=mt(a);if(!(s==null||!r)){for(var l=0;l<r.length;++l)r[l]==this&&r.splice(l--,1);r.length||(a.widgets=null);var d=Mo(this);Cn(a,Math.max(0,a.height-d)),e&&(Tn(e,function(){Yd(e,a,-d),Dr(e,s,"widget")}),Yt(e,"lineWidgetCleared",e,this,s))}},Wo.prototype.changed=function(){var e=this,r=this.height,a=this.doc.cm,s=this.line;this.height=null;var l=Mo(this)-r;l&&(Pr(this.doc,s)||Cn(s,s.height+l),a&&Tn(a,function(){a.curOp.forceUpdate=!0,Yd(a,s,l),Yt(a,"lineWidgetChanged",a,e,mt(s))}))},rr(Wo);function Yd(e,r,a){br(r)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&jl(e,a)}function xw(e,r,a,s){var l=new Wo(e,a,s),d=e.cm;return d&&l.noHScroll&&(d.display.alignWidgets=!0),Fo(e,r,"widget",function(h){var g=h.widgets||(h.widgets=[]);if(l.insertAt==null?g.push(l):g.splice(Math.min(g.length,Math.max(0,l.insertAt)),0,l),l.line=h,d&&!Pr(e,h)){var v=br(h)<e.scrollTop;Cn(h,h.height+Mo(l)),v&&jl(d,l.height),d.curOp.forceUpdate=!0}return!0}),d&&Yt(d,"lineWidgetAdded",d,l,typeof r=="number"?r:mt(r)),l}var Kd=0,zr=function(e,r){this.lines=[],this.type=r,this.doc=e,this.id=++Kd};zr.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,r=e&&!e.curOp;if(r&&si(e),en(this,"clear")){var a=this.find();a&&Yt(this,"clear",a.from,a.to)}for(var s=null,l=null,d=0;d<this.lines.length;++d){var h=this.lines[d],g=To(h.markedSpans,this);e&&!this.collapsed?Dr(e,mt(h),"text"):e&&(g.to!=null&&(l=mt(h)),g.from!=null&&(s=mt(h))),h.markedSpans=db(h.markedSpans,g),g.from==null&&this.collapsed&&!Pr(this.doc,h)&&e&&Cn(h,Ai(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var v=0;v<this.lines.length;++v){var b=Qn(this.lines[v]),A=zs(b);A>e.display.maxLineLength&&(e.display.maxLine=b,e.display.maxLineLength=A,e.display.maxLineChanged=!0)}s!=null&&e&&this.collapsed&&gn(e,s,l+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&zd(e.doc)),e&&Yt(e,"markerCleared",e,this,s,l),r&&ai(e),this.parent&&this.parent.clear()}},zr.prototype.find=function(e,r){e==null&&this.type=="bookmark"&&(e=1);for(var a,s,l=0;l<this.lines.length;++l){var d=this.lines[l],h=To(d.markedSpans,this);if(h.from!=null&&(a=ee(r?d:mt(d),h.from),e==-1))return a;if(h.to!=null&&(s=ee(r?d:mt(d),h.to),e==1))return s}return a&&{from:a,to:s}},zr.prototype.changed=function(){var e=this,r=this.find(-1,!0),a=this,s=this.doc.cm;!r||!s||Tn(s,function(){var l=r.line,d=mt(r.line),h=Cl(s,d);if(h&&(td(h),s.curOp.selectionChanged=s.curOp.forceUpdate=!0),s.curOp.updateMaxLine=!0,!Pr(a.doc,l)&&a.height!=null){var g=a.height;a.height=null;var v=Mo(a)-g;v&&Cn(l,l.height+v)}Yt(s,"markerChanged",s,e)})},zr.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(!r.maybeHiddenMarkers||ge(r.maybeHiddenMarkers,this)==-1)&&(r.maybeUnhiddenMarkers||(r.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},zr.prototype.detachLine=function(e){if(this.lines.splice(ge(this.lines,e),1),!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(r.maybeHiddenMarkers||(r.maybeHiddenMarkers=[])).push(this)}},rr(zr);function zi(e,r,a,s,l){if(s&&s.shared)return kw(e,r,a,s,l);if(e.cm&&!e.cm.curOp)return Kt(e.cm,zi)(e,r,a,s,l);var d=new zr(e,l),h=w(r,a);if(s&&Xt(s,d,!1),h>0||h==0&&d.clearWhenEmpty!==!1)return d;if(d.replacedWith&&(d.collapsed=!0,d.widgetNode=L("span",[d.replacedWith],"CodeMirror-widget"),s.handleMouseEvents||d.widgetNode.setAttribute("cm-ignore-events","true"),s.insertLeft&&(d.widgetNode.insertLeft=!0)),d.collapsed){if(Ff(e,r.line,r,a,d)||r.line!=a.line&&Ff(e,a.line,r,a,d))throw new Error("Inserting collapsed marker partially overlapping an existing one");fb()}d.addToHistory&&Nd(e,{from:r,to:a,origin:"markText"},e.sel,NaN);var g=r.line,v=e.cm,b;if(e.iter(g,a.line+1,function(P){v&&d.collapsed&&!v.options.lineWrapping&&Qn(P)==v.display.maxLine&&(b=!0),d.collapsed&&g!=r.line&&Cn(P,0),pb(P,new Is(d,g==r.line?r.ch:null,g==a.line?a.ch:null),e.cm&&e.cm.curOp),++g}),d.collapsed&&e.iter(r.line,a.line+1,function(P){Pr(e,P)&&Cn(P,0)}),d.clearOnEnter&&Be(d,"beforeCursorEnter",function(){return d.clear()}),d.readOnly&&(cb(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),d.collapsed&&(d.id=++Kd,d.atomic=!0),v){if(b&&(v.curOp.updateMaxLine=!0),d.collapsed)gn(v,r.line,a.line+1);else if(d.className||d.startStyle||d.endStyle||d.css||d.attributes||d.title)for(var A=r.line;A<=a.line;A++)Dr(v,A,"text");d.atomic&&zd(v.doc),Yt(v,"markerAdded",v,d)}return d}var $o=function(e,r){this.markers=e,this.primary=r;for(var a=0;a<e.length;++a)e[a].parent=this};$o.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Yt(this,"clear")}},$o.prototype.find=function(e,r){return this.primary.find(e,r)},rr($o);function kw(e,r,a,s,l){s=Xt(s),s.shared=!1;var d=[zi(e,r,a,s,l)],h=d[0],g=s.widgetNode;return jr(e,function(v){g&&(s.widgetNode=g.cloneNode(!0)),d.push(zi(v,le(v,r),le(v,a),s,l));for(var b=0;b<v.linked.length;++b)if(v.linked[b].isParent)return;h=tt(d)}),new $o(d,h)}function Jd(e){return e.findMarks(ee(e.first,0),e.clipPos(ee(e.lastLine())),function(r){return r.parent})}function Sw(e,r){for(var a=0;a<r.length;a++){var s=r[a],l=s.find(),d=e.clipPos(l.from),h=e.clipPos(l.to);if(w(d,h)){var g=zi(e,d,h,s.primary,s.primary.type);s.markers.push(g),g.parent=s}}}function Cw(e){for(var r=function(s){var l=e[s],d=[l.primary.doc];jr(l.primary.doc,function(v){return d.push(v)});for(var h=0;h<l.markers.length;h++){var g=l.markers[h];ge(d,g.doc)==-1&&(g.parent=null,l.markers.splice(h--,1))}},a=0;a<e.length;a++)r(a)}var Tw=0,mn=function(e,r,a,s,l){if(!(this instanceof mn))return new mn(e,r,a,s,l);a==null&&(a=0),Bo.call(this,[new Ho([new Li("",null)])]),this.first=a,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=a;var d=ee(a,0);this.sel=_r(d),this.history=new Js(null),this.id=++Tw,this.modeOption=r,this.lineSep=s,this.direction=l=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),Ul(this,{from:d,to:d,text:e}),on(this,_r(d),ft)};mn.prototype=Fn(Bo.prototype,{constructor:mn,iter:function(e,r,a){a?this.iterN(e-this.first,r-e,a):this.iterN(this.first,this.first+this.size,e)},insert:function(e,r){for(var a=0,s=0;s<r.length;++s)a+=r[s].height;this.insertInner(e-this.first,r,a)},remove:function(e,r){this.removeInner(e-this.first,r)},getValue:function(e){var r=ko(this,this.first,this.first+this.size);return e===!1?r:r.join(e||this.lineSeparator())},setValue:Jt(function(e){var r=ee(this.first,0),a=this.first+this.size-1;Ri(this,{from:r,to:ee(a,de(this,a).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&No(this.cm,0,0),on(this,_r(r),ft)}),replaceRange:function(e,r,a,s){r=le(this,r),a=a?le(this,a):r,ji(this,e,r,a,s)},getRange:function(e,r,a){var s=or(this,le(this,e),le(this,r));return a===!1?s:a===""?s.join(""):s.join(a||this.lineSeparator())},getLine:function(e){var r=this.getLineHandle(e);return r&&r.text},getLineHandle:function(e){if(Xr(this,e))return de(this,e)},getLineNumber:function(e){return mt(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=de(this,e)),Qn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return le(this,e)},getCursor:function(e){var r=this.sel.primary(),a;return e==null||e=="head"?a=r.head:e=="anchor"?a=r.anchor:e=="end"||e=="to"||e===!1?a=r.to():a=r.from(),a},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Jt(function(e,r,a){_d(this,le(this,typeof e=="number"?ee(e,r||0):e),null,a)}),setSelection:Jt(function(e,r,a){_d(this,le(this,e),le(this,r||e),a)}),extendSelection:Jt(function(e,r,a){Zs(this,le(this,e),r&&le(this,r),a)}),extendSelections:Jt(function(e,r){Id(this,_n(this,e),r)}),extendSelectionsBy:Jt(function(e,r){var a=gt(this.sel.ranges,e);Id(this,_n(this,a),r)}),setSelections:Jt(function(e,r,a){if(e.length){for(var s=[],l=0;l<e.length;l++)s[l]=new vt(le(this,e[l].anchor),le(this,e[l].head||e[l].anchor));r==null&&(r=Math.min(e.length-1,this.sel.primIndex)),on(this,Xn(this.cm,s,r),a)}}),addSelection:Jt(function(e,r,a){var s=this.sel.ranges.slice(0);s.push(new vt(le(this,e),le(this,r||e))),on(this,Xn(this.cm,s,s.length-1),a)}),getSelection:function(e){for(var r=this.sel.ranges,a,s=0;s<r.length;s++){var l=or(this,r[s].from(),r[s].to());a=a?a.concat(l):l}return e===!1?a:a.join(e||this.lineSeparator())},getSelections:function(e){for(var r=[],a=this.sel.ranges,s=0;s<a.length;s++){var l=or(this,a[s].from(),a[s].to());e!==!1&&(l=l.join(e||this.lineSeparator())),r[s]=l}return r},replaceSelection:function(e,r,a){for(var s=[],l=0;l<this.sel.ranges.length;l++)s[l]=e;this.replaceSelections(s,r,a||"+input")},replaceSelections:Jt(function(e,r,a){for(var s=[],l=this.sel,d=0;d<l.ranges.length;d++){var h=l.ranges[d];s[d]={from:h.from(),to:h.to(),text:this.splitLines(e[d]),origin:a}}for(var g=r&&r!="end"&&dw(this,s,r),v=s.length-1;v>=0;v--)Ri(this,s[v]);g?Rd(this,g):this.cm&&Pi(this.cm)}),undo:Jt(function(){ta(this,"undo")}),redo:Jt(function(){ta(this,"redo")}),undoSelection:Jt(function(){ta(this,"undo",!0)}),redoSelection:Jt(function(){ta(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,r=0,a=0,s=0;s<e.done.length;s++)e.done[s].ranges||++r;for(var l=0;l<e.undone.length;l++)e.undone[l].ranges||++a;return{undo:r,redo:a}},clearHistory:function(){var e=this;this.history=new Js(this.history),jr(this,function(r){return r.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Ii(this.history.done),undone:Ii(this.history.undone)}},setHistory:function(e){var r=this.history=new Js(this.history);r.done=Ii(e.done.slice(0),null,!0),r.undone=Ii(e.undone.slice(0),null,!0)},setGutterMarker:Jt(function(e,r,a){return Fo(this,e,"gutter",function(s){var l=s.gutterMarkers||(s.gutterMarkers={});return l[r]=a,!a&&ie(l)&&(s.gutterMarkers=null),!0})}),clearGutter:Jt(function(e){var r=this;this.iter(function(a){a.gutterMarkers&&a.gutterMarkers[e]&&Fo(r,a,"gutter",function(){return a.gutterMarkers[e]=null,ie(a.gutterMarkers)&&(a.gutterMarkers=null),!0})})}),lineInfo:function(e){var r;if(typeof e=="number"){if(!Xr(this,e)||(r=e,e=de(this,e),!e))return null}else if(r=mt(e),r==null)return null;return{line:r,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Jt(function(e,r,a){return Fo(this,e,r=="gutter"?"gutter":"class",function(s){var l=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass";if(!s[l])s[l]=a;else{if(q(a).test(s[l]))return!1;s[l]+=" "+a}return!0})}),removeLineClass:Jt(function(e,r,a){return Fo(this,e,r=="gutter"?"gutter":"class",function(s){var l=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass",d=s[l];if(d)if(a==null)s[l]=null;else{var h=d.match(q(a));if(!h)return!1;var g=h.index+h[0].length;s[l]=d.slice(0,h.index)+(!h.index||g==d.length?"":" ")+d.slice(g)||null}else return!1;return!0})}),addLineWidget:Jt(function(e,r,a){return xw(this,e,r,a)}),removeLineWidget:function(e){e.clear()},markText:function(e,r,a){return zi(this,le(this,e),le(this,r),a,a&&a.type||"range")},setBookmark:function(e,r){var a={replacedWith:r&&(r.nodeType==null?r.widget:r),insertLeft:r&&r.insertLeft,clearWhenEmpty:!1,shared:r&&r.shared,handleMouseEvents:r&&r.handleMouseEvents};return e=le(this,e),zi(this,e,e,a,"bookmark")},findMarksAt:function(e){e=le(this,e);var r=[],a=de(this,e.line).markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];(l.from==null||l.from<=e.ch)&&(l.to==null||l.to>=e.ch)&&r.push(l.marker.parent||l.marker)}return r},findMarks:function(e,r,a){e=le(this,e),r=le(this,r);var s=[],l=e.line;return this.iter(e.line,r.line+1,function(d){var h=d.markedSpans;if(h)for(var g=0;g<h.length;g++){var v=h[g];!(v.to!=null&&l==e.line&&e.ch>=v.to||v.from==null&&l!=e.line||v.from!=null&&l==r.line&&v.from>=r.ch)&&(!a||a(v.marker))&&s.push(v.marker.parent||v.marker)}++l}),s},getAllMarks:function(){var e=[];return this.iter(function(r){var a=r.markedSpans;if(a)for(var s=0;s<a.length;++s)a[s].from!=null&&e.push(a[s].marker)}),e},posFromIndex:function(e){var r,a=this.first,s=this.lineSeparator().length;return this.iter(function(l){var d=l.text.length+s;if(d>e)return r=e,!0;e-=d,++a}),le(this,ee(a,r))},indexFromPos:function(e){e=le(this,e);var r=e.ch;if(e.line<this.first||e.ch<0)return 0;var a=this.lineSeparator().length;return this.iter(this.first,e.line,function(s){r+=s.text.length+a}),r},copy:function(e){var r=new mn(ko(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return r.scrollTop=this.scrollTop,r.scrollLeft=this.scrollLeft,r.sel=this.sel,r.extend=!1,e&&(r.history.undoDepth=this.history.undoDepth,r.setHistory(this.getHistory())),r},linkedDoc:function(e){e||(e={});var r=this.first,a=this.first+this.size;e.from!=null&&e.from>r&&(r=e.from),e.to!=null&&e.to<a&&(a=e.to);var s=new mn(ko(this,r,a),e.mode||this.modeOption,r,this.lineSep,this.direction);return e.sharedHist&&(s.history=this.history),(this.linked||(this.linked=[])).push({doc:s,sharedHist:e.sharedHist}),s.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Sw(s,Jd(this)),s},unlinkDoc:function(e){if(e instanceof Pt&&(e=e.doc),this.linked)for(var r=0;r<this.linked.length;++r){var a=this.linked[r];if(a.doc==e){this.linked.splice(r,1),e.unlinkDoc(this),Cw(Jd(this));break}}if(e.history==this.history){var s=[e.id];jr(e,function(l){return s.push(l.id)},!0),e.history=new Js(null),e.history.done=Ii(this.history.done,s),e.history.undone=Ii(this.history.undone,s)}},iterLinkedDocs:function(e){jr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):yo(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Jt(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(r){return r.order=null}),this.cm&&pw(this.cm))})}),mn.prototype.eachLine=mn.prototype.iter;var Qd=0;function Lw(e){var r=this;if(Zd(r),!(Bt(r,e)||wr(r.display,e))){nn(e),f&&(Qd=+new Date);var a=ni(r,e,!0),s=e.dataTransfer.files;if(!(!a||r.isReadOnly()))if(s&&s.length&&window.FileReader&&window.File)for(var l=s.length,d=Array(l),h=0,g=function(){++h==l&&Kt(r,function(){a=le(r.doc,a);var z={from:a,to:a,text:r.doc.splitLines(d.filter(function(G){return G!=null}).join(r.doc.lineSeparator())),origin:"paste"};Ri(r.doc,z),Rd(r.doc,_r(le(r.doc,a),le(r.doc,Rr(z))))})()},v=function(z,G){if(r.options.allowDropFileTypes&&ge(r.options.allowDropFileTypes,z.type)==-1){g();return}var Q=new FileReader;Q.onerror=function(){return g()},Q.onload=function(){var re=Q.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(re)){g();return}d[G]=re,g()},Q.readAsText(z)},b=0;b<s.length;b++)v(s[b],b);else{if(r.state.draggingText&&r.doc.sel.contains(a)>-1){r.state.draggingText(e),setTimeout(function(){return r.display.input.focus()},20);return}try{var A=e.dataTransfer.getData("Text");if(A){var P;if(r.state.draggingText&&!r.state.draggingText.copy&&(P=r.listSelections()),Xs(r.doc,_r(a,a)),P)for(var B=0;B<P.length;++B)ji(r.doc,"",P[B].anchor,P[B].head,"drag");r.replaceSelection(A,"around","paste"),r.display.input.focus()}}catch{}}}}function Ew(e,r){if(f&&(!e.state.draggingText||+new Date-Qd<100)){Zr(r);return}if(!(Bt(e,r)||wr(e.display,r))&&(r.dataTransfer.setData("Text",e.getSelection()),r.dataTransfer.effectAllowed="copyMove",r.dataTransfer.setDragImage&&!k)){var a=U("img",null,null,"position: fixed; left: 0; top: 0;");a.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",S&&(a.width=a.height=1,e.display.wrapper.appendChild(a),a._top=a.offsetTop),r.dataTransfer.setDragImage(a,0,0),S&&a.parentNode.removeChild(a)}}function Mw(e,r){var a=ni(e,r);if(a){var s=document.createDocumentFragment();Pl(e,a,s),e.display.dragCursor||(e.display.dragCursor=U("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),W(e.display.dragCursor,s)}}function Zd(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Xd(e){if(document.getElementsByClassName){for(var r=document.getElementsByClassName("CodeMirror"),a=[],s=0;s<r.length;s++){var l=r[s].CodeMirror;l&&a.push(l)}a.length&&a[0].operation(function(){for(var d=0;d<a.length;d++)e(a[d])})}}var ep=!1;function Aw(){ep||(Ow(),ep=!0)}function Ow(){var e;Be(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Xd(Nw)},100))}),Be(window,"blur",function(){return Xd(Ni)})}function Nw(e){var r=e.display;r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.scrollbarsClipped=!1,e.setSize()}for(var Fr={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},qo=0;qo<10;qo++)Fr[qo+48]=Fr[qo+96]=String(qo);for(var na=65;na<=90;na++)Fr[na]=String.fromCharCode(na);for(var Uo=1;Uo<=12;Uo++)Fr[Uo+111]=Fr[Uo+63235]="F"+Uo;var kr={};kr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},kr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},kr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},kr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},kr.default=C?kr.macDefault:kr.pcDefault;function Pw(e){var r=e.split(/-(?!$)/);e=r[r.length-1];for(var a,s,l,d,h=0;h<r.length-1;h++){var g=r[h];if(/^(cmd|meta|m)$/i.test(g))d=!0;else if(/^a(lt)?$/i.test(g))a=!0;else if(/^(c|ctrl|control)$/i.test(g))s=!0;else if(/^s(hift)?$/i.test(g))l=!0;else throw new Error("Unrecognized modifier name: "+g)}return a&&(e="Alt-"+e),s&&(e="Ctrl-"+e),d&&(e="Cmd-"+e),l&&(e="Shift-"+e),e}function Dw(e){var r={};for(var a in e)if(e.hasOwnProperty(a)){var s=e[a];if(/^(name|fallthrough|(de|at)tach)$/.test(a))continue;if(s=="..."){delete e[a];continue}for(var l=gt(a.split(" "),Pw),d=0;d<l.length;d++){var h=void 0,g=void 0;d==l.length-1?(g=l.join(" "),h=s):(g=l.slice(0,d+1).join(" "),h="...");var v=r[g];if(!v)r[g]=h;else if(v!=h)throw new Error("Inconsistent bindings for "+g)}delete e[a]}for(var b in r)e[b]=r[b];return e}function Fi(e,r,a,s){r=ra(r);var l=r.call?r.call(e,s):r[e];if(l===!1)return"nothing";if(l==="...")return"multi";if(l!=null&&a(l))return"handled";if(r.fallthrough){if(Object.prototype.toString.call(r.fallthrough)!="[object Array]")return Fi(e,r.fallthrough,a,s);for(var d=0;d<r.fallthrough.length;d++){var h=Fi(e,r.fallthrough[d],a,s);if(h)return h}}}function tp(e){var r=typeof e=="string"?e:Fr[e.keyCode];return r=="Ctrl"||r=="Alt"||r=="Shift"||r=="Mod"}function np(e,r,a){var s=e;return r.altKey&&s!="Alt"&&(e="Alt-"+e),(j?r.metaKey:r.ctrlKey)&&s!="Ctrl"&&(e="Ctrl-"+e),(j?r.ctrlKey:r.metaKey)&&s!="Mod"&&(e="Cmd-"+e),!a&&r.shiftKey&&s!="Shift"&&(e="Shift-"+e),e}function rp(e,r){if(S&&e.keyCode==34&&e.char)return!1;var a=Fr[e.keyCode];return a==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(a=e.code),np(a,e,r))}function ra(e){return typeof e=="string"?kr[e]:e}function Hi(e,r){for(var a=e.doc.sel.ranges,s=[],l=0;l<a.length;l++){for(var d=r(a[l]);s.length&&w(d.from,tt(s).to)<=0;){var h=s.pop();if(w(h.from,d.from)<0){d.from=h.from;break}}s.push(d)}Tn(e,function(){for(var g=s.length-1;g>=0;g--)ji(e.doc,"",s[g].from,s[g].to,"+delete");Pi(e)})}function Kl(e,r,a){var s=ln(e.text,r+a,a);return s<0||s>e.text.length?null:s}function Jl(e,r,a){var s=Kl(e,r.ch,a);return s==null?null:new ee(r.line,s,a<0?"after":"before")}function Ql(e,r,a,s,l){if(e){r.doc.direction=="rtl"&&(l=-l);var d=Sn(a,r.doc.direction);if(d){var h=l<0?tt(d):d[0],g=l<0==(h.level==1),v=g?"after":"before",b;if(h.level>0||r.doc.direction=="rtl"){var A=Mi(r,a);b=l<0?a.text.length-1:0;var P=ur(r,A,b).top;b=nr(function(B){return ur(r,A,B).top==P},l<0==(h.level==1)?h.from:h.to-1,b),v=="before"&&(b=Kl(a,b,1))}else b=l<0?h.to:h.from;return new ee(s,b,v)}}return new ee(s,l<0?a.text.length:0,l<0?"before":"after")}function Iw(e,r,a,s){var l=Sn(r,e.doc.direction);if(!l)return Jl(r,a,s);a.ch>=r.text.length?(a.ch=r.text.length,a.sticky="before"):a.ch<=0&&(a.ch=0,a.sticky="after");var d=Rt(l,a.ch,a.sticky),h=l[d];if(e.doc.direction=="ltr"&&h.level%2==0&&(s>0?h.to>a.ch:h.from<a.ch))return Jl(r,a,s);var g=function(oe,ae){return Kl(r,oe instanceof ee?oe.ch:oe,ae)},v,b=function(oe){return e.options.lineWrapping?(v=v||Mi(e,r),ld(e,r,v,oe)):{begin:0,end:r.text.length}},A=b(a.sticky=="before"?g(a,-1):a.ch);if(e.doc.direction=="rtl"||h.level==1){var P=h.level==1==s<0,B=g(a,P?1:-1);if(B!=null&&(P?B<=h.to&&B<=A.end:B>=h.from&&B>=A.begin)){var z=P?"before":"after";return new ee(a.line,B,z)}}var G=function(oe,ae,se){for(var ue=function(Tt,Qt){return Qt?new ee(a.line,g(Tt,1),"before"):new ee(a.line,Tt,"after")};oe>=0&&oe<l.length;oe+=ae){var Fe=l[oe],me=ae>0==(Fe.level!=1),Xe=me?se.begin:g(se.end,-1);if(Fe.from<=Xe&&Xe<Fe.to||(Xe=me?Fe.from:g(Fe.to,-1),se.begin<=Xe&&Xe<se.end))return ue(Xe,me)}},Q=G(d+s,s,A);if(Q)return Q;var re=s>0?A.end:g(A.begin,-1);return re!=null&&!(s>0&&re==r.text.length)&&(Q=G(s>0?0:l.length-1,s,b(re)),Q)?Q:null}var Vo={selectAll:Bd,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),ft)},killLine:function(e){return Hi(e,function(r){if(r.empty()){var a=de(e.doc,r.head.line).text.length;return r.head.ch==a&&r.head.line<e.lastLine()?{from:r.head,to:ee(r.head.line+1,0)}:{from:r.head,to:ee(r.head.line,a)}}else return{from:r.from(),to:r.to()}})},deleteLine:function(e){return Hi(e,function(r){return{from:ee(r.from().line,0),to:le(e.doc,ee(r.to().line+1,0))}})},delLineLeft:function(e){return Hi(e,function(r){return{from:ee(r.from().line,0),to:r.from()}})},delWrappedLineLeft:function(e){return Hi(e,function(r){var a=e.charCoords(r.head,"div").top+5,s=e.coordsChar({left:0,top:a},"div");return{from:s,to:r.from()}})},delWrappedLineRight:function(e){return Hi(e,function(r){var a=e.charCoords(r.head,"div").top+5,s=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:a},"div");return{from:r.from(),to:s}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(ee(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(ee(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(r){return ip(e,r.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(r){return op(e,r.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(r){return _w(e,r.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(r){var a=e.cursorCoords(r.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:a},"div")},Ge)},goLineLeft:function(e){return e.extendSelectionsBy(function(r){var a=e.cursorCoords(r.head,"div").top+5;return e.coordsChar({left:0,top:a},"div")},Ge)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(r){var a=e.cursorCoords(r.head,"div").top+5,s=e.coordsChar({left:0,top:a},"div");return s.ch<e.getLine(s.line).search(/\S/)?op(e,r.head):s},Ge)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var r=[],a=e.listSelections(),s=e.options.tabSize,l=0;l<a.length;l++){var d=a[l].from(),h=qt(e.getLine(d.line),d.ch,s);r.push(Ar(s-h%s))}e.replaceSelections(r)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Tn(e,function(){for(var r=e.listSelections(),a=[],s=0;s<r.length;s++)if(r[s].empty()){var l=r[s].head,d=de(e.doc,l.line).text;if(d){if(l.ch==d.length&&(l=new ee(l.line,l.ch-1)),l.ch>0)l=new ee(l.line,l.ch+1),e.replaceRange(d.charAt(l.ch-1)+d.charAt(l.ch-2),ee(l.line,l.ch-2),l,"+transpose");else if(l.line>e.doc.first){var h=de(e.doc,l.line-1).text;h&&(l=new ee(l.line,1),e.replaceRange(d.charAt(0)+e.doc.lineSeparator()+h.charAt(h.length-1),ee(l.line-1,h.length-1),l,"+transpose"))}}a.push(new vt(l,l))}e.setSelections(a)})},newlineAndIndent:function(e){return Tn(e,function(){for(var r=e.listSelections(),a=r.length-1;a>=0;a--)e.replaceRange(e.doc.lineSeparator(),r[a].anchor,r[a].head,"+input");r=e.listSelections();for(var s=0;s<r.length;s++)e.indentLine(r[s].from().line,null,!0);Pi(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function ip(e,r){var a=de(e.doc,r),s=Qn(a);return s!=a&&(r=mt(s)),Ql(!0,e,s,r,1)}function _w(e,r){var a=de(e.doc,r),s=yb(a);return s!=a&&(r=mt(s)),Ql(!0,e,a,r,-1)}function op(e,r){var a=ip(e,r.line),s=de(e.doc,a.line),l=Sn(s,e.doc.direction);if(!l||l[0].level==0){var d=Math.max(a.ch,s.text.search(/\S/)),h=r.line==a.line&&r.ch<=d&&r.ch;return ee(a.line,h?0:d,a.sticky)}return a}function ia(e,r,a){if(typeof r=="string"&&(r=Vo[r],!r))return!1;e.display.input.ensurePolled();var s=e.display.shift,l=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),a&&(e.display.shift=!1),l=r(e)!=et}finally{e.display.shift=s,e.state.suppressEdits=!1}return l}function Rw(e,r,a){for(var s=0;s<e.state.keyMaps.length;s++){var l=Fi(r,e.state.keyMaps[s],a,e);if(l)return l}return e.options.extraKeys&&Fi(r,e.options.extraKeys,a,e)||Fi(r,e.options.keyMap,a,e)}var jw=new Et;function Go(e,r,a,s){var l=e.state.keySeq;if(l){if(tp(r))return"handled";if(/\'$/.test(r)?e.state.keySeq=null:jw.set(50,function(){e.state.keySeq==l&&(e.state.keySeq=null,e.display.input.reset())}),sp(e,l+" "+r,a,s))return!0}return sp(e,r,a,s)}function sp(e,r,a,s){var l=Rw(e,r,s);return l=="multi"&&(e.state.keySeq=r),l=="handled"&&Yt(e,"keyHandled",e,r,a),(l=="handled"||l=="multi")&&(nn(a),Dl(e)),!!l}function ap(e,r){var a=rp(r,!0);return a?r.shiftKey&&!e.state.keySeq?Go(e,"Shift-"+a,r,function(s){return ia(e,s,!0)})||Go(e,a,r,function(s){if(typeof s=="string"?/^go[A-Z]/.test(s):s.motion)return ia(e,s)}):Go(e,a,r,function(s){return ia(e,s)}):!1}function zw(e,r,a){return Go(e,"'"+a+"'",r,function(s){return ia(e,s,!0)})}var Zl=null;function lp(e){var r=this;if(!(e.target&&e.target!=r.display.input.getField())&&(r.curOp.focus=he(),!Bt(r,e))){f&&p<11&&e.keyCode==27&&(e.returnValue=!1);var a=e.keyCode;r.display.shift=a==16||e.shiftKey;var s=ap(r,e);S&&(Zl=s?a:null,!s&&a==88&&!Ps&&(C?e.metaKey:e.ctrlKey)&&r.replaceSelection("",null,"cut")),i&&!C&&!s&&a==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),a==18&&!/\bCodeMirror-crosshair\b/.test(r.display.lineDiv.className)&&Fw(r)}}function Fw(e){var r=e.display.lineDiv;yt(r,"CodeMirror-crosshair");function a(s){(s.keyCode==18||!s.altKey)&&(H(r,"CodeMirror-crosshair"),pn(document,"keyup",a),pn(document,"mouseover",a))}Be(document,"keyup",a),Be(document,"mouseover",a)}function up(e){e.keyCode==16&&(this.doc.sel.shift=!1),Bt(this,e)}function cp(e){var r=this;if(!(e.target&&e.target!=r.display.input.getField())&&!(wr(r.display,e)||Bt(r,e)||e.ctrlKey&&!e.altKey||C&&e.metaKey)){var a=e.keyCode,s=e.charCode;if(S&&a==Zl){Zl=null,nn(e);return}if(!(S&&(!e.which||e.which<10)&&ap(r,e))){var l=String.fromCharCode(s??a);l!="\b"&&(zw(r,e,l)||r.display.input.onKeyPress(e))}}}var Hw=400,Xl=function(e,r,a){this.time=e,this.pos=r,this.button=a};Xl.prototype.compare=function(e,r,a){return this.time+Hw>e&&w(r,this.pos)==0&&a==this.button};var Yo,Ko;function Bw(e,r){var a=+new Date;return Ko&&Ko.compare(a,e,r)?(Yo=Ko=null,"triple"):Yo&&Yo.compare(a,e,r)?(Ko=new Xl(a,e,r),Yo=null,"double"):(Yo=new Xl(a,e,r),Ko=null,"single")}function fp(e){var r=this,a=r.display;if(!(Bt(r,e)||a.activeTouch&&a.input.supportsTouch())){if(a.input.ensurePolled(),a.shift=e.shiftKey,wr(a,e)){m||(a.scroller.draggable=!1,setTimeout(function(){return a.scroller.draggable=!0},100));return}if(!eu(r,e)){var s=ni(r,e),l=As(e),d=s?Bw(s,l):"single";window.focus(),l==1&&r.state.selectingText&&r.state.selectingText(e),!(s&&Ww(r,l,s,d,e))&&(l==1?s?qw(r,s,d,e):Or(e)==a.scroller&&nn(e):l==2?(s&&Zs(r.doc,s),setTimeout(function(){return a.input.focus()},20)):l==3&&(F?r.display.input.onContextMenu(e):Il(r)))}}}function Ww(e,r,a,s,l){var d="Click";return s=="double"?d="Double"+d:s=="triple"&&(d="Triple"+d),d=(r==1?"Left":r==2?"Middle":"Right")+d,Go(e,np(d,l),l,function(h){if(typeof h=="string"&&(h=Vo[h]),!h)return!1;var g=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),g=h(e,a)!=et}finally{e.state.suppressEdits=!1}return g})}function $w(e,r,a){var s=e.getOption("configureMouse"),l=s?s(e,r,a):{};if(l.unit==null){var d=I?a.shiftKey&&a.metaKey:a.altKey;l.unit=d?"rectangle":r=="single"?"char":r=="double"?"word":"line"}return(l.extend==null||e.doc.extend)&&(l.extend=e.doc.extend||a.shiftKey),l.addNew==null&&(l.addNew=C?a.metaKey:a.ctrlKey),l.moveOnDrag==null&&(l.moveOnDrag=!(C?a.altKey:a.ctrlKey)),l}function qw(e,r,a,s){f?setTimeout(Kr(dd,e),0):e.curOp.focus=he();var l=$w(e,a,s),d=e.doc.sel,h;e.options.dragDrop&&mo&&!e.isReadOnly()&&a=="single"&&(h=d.contains(r))>-1&&(w((h=d.ranges[h]).from(),r)<0||r.xRel>0)&&(w(h.to(),r)>0||r.xRel<0)?Uw(e,s,r,l):Vw(e,s,r,l)}function Uw(e,r,a,s){var l=e.display,d=!1,h=Kt(e,function(b){m&&(l.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:Il(e)),pn(l.wrapper.ownerDocument,"mouseup",h),pn(l.wrapper.ownerDocument,"mousemove",g),pn(l.scroller,"dragstart",v),pn(l.scroller,"drop",h),d||(nn(b),s.addNew||Zs(e.doc,a,null,null,s.extend),m&&!k||f&&p==9?setTimeout(function(){l.wrapper.ownerDocument.body.focus({preventScroll:!0}),l.input.focus()},20):l.input.focus())}),g=function(b){d=d||Math.abs(r.clientX-b.clientX)+Math.abs(r.clientY-b.clientY)>=10},v=function(){return d=!0};m&&(l.scroller.draggable=!0),e.state.draggingText=h,h.copy=!s.moveOnDrag,Be(l.wrapper.ownerDocument,"mouseup",h),Be(l.wrapper.ownerDocument,"mousemove",g),Be(l.scroller,"dragstart",v),Be(l.scroller,"drop",h),e.state.delayingBlurEvent=!0,setTimeout(function(){return l.input.focus()},20),l.scroller.dragDrop&&l.scroller.dragDrop()}function dp(e,r,a){if(a=="char")return new vt(r,r);if(a=="word")return e.findWordAt(r);if(a=="line")return new vt(ee(r.line,0),le(e.doc,ee(r.line+1,0)));var s=a(e,r);return new vt(s.from,s.to)}function Vw(e,r,a,s){f&&Il(e);var l=e.display,d=e.doc;nn(r);var h,g,v=d.sel,b=v.ranges;if(s.addNew&&!s.extend?(g=d.sel.contains(a),g>-1?h=b[g]:h=new vt(a,a)):(h=d.sel.primary(),g=d.sel.primIndex),s.unit=="rectangle")s.addNew||(h=new vt(a,a)),a=ni(e,r,!0,!0),g=-1;else{var A=dp(e,a,s.unit);s.extend?h=Gl(h,A.anchor,A.head,s.extend):h=A}s.addNew?g==-1?(g=b.length,on(d,Xn(e,b.concat([h]),g),{scroll:!1,origin:"*mouse"})):b.length>1&&b[g].empty()&&s.unit=="char"&&!s.extend?(on(d,Xn(e,b.slice(0,g).concat(b.slice(g+1)),0),{scroll:!1,origin:"*mouse"}),v=d.sel):Yl(d,g,h,it):(g=0,on(d,new Rn([h],0),it),v=d.sel);var P=a;function B(se){if(w(P,se)!=0)if(P=se,s.unit=="rectangle"){for(var ue=[],Fe=e.options.tabSize,me=qt(de(d,a.line).text,a.ch,Fe),Xe=qt(de(d,se.line).text,se.ch,Fe),Tt=Math.min(me,Xe),Qt=Math.max(me,Xe),Dt=Math.min(a.line,se.line),Ln=Math.min(e.lastLine(),Math.max(a.line,se.line));Dt<=Ln;Dt++){var vn=de(d,Dt).text,Wt=Vt(vn,Tt,Fe);Tt==Qt?ue.push(new vt(ee(Dt,Wt),ee(Dt,Wt))):vn.length>Wt&&ue.push(new vt(ee(Dt,Wt),ee(Dt,Vt(vn,Qt,Fe))))}ue.length||ue.push(new vt(a,a)),on(d,Xn(e,v.ranges.slice(0,g).concat(ue),g),{origin:"*mouse",scroll:!1}),e.scrollIntoView(se)}else{var yn=h,tn=dp(e,se,s.unit),Ut=yn.anchor,$t;w(tn.anchor,Ut)>0?($t=tn.head,Ut=Ve(yn.from(),tn.anchor)):($t=tn.anchor,Ut=ne(yn.to(),tn.head));var zt=v.ranges.slice(0);zt[g]=Gw(e,new vt(le(d,Ut),$t)),on(d,Xn(e,zt,g),it)}}var z=l.wrapper.getBoundingClientRect(),G=0;function Q(se){var ue=++G,Fe=ni(e,se,!0,s.unit=="rectangle");if(Fe)if(w(Fe,P)!=0){e.curOp.focus=he(),B(Fe);var me=Vs(l,d);(Fe.line>=me.to||Fe.line<me.from)&&setTimeout(Kt(e,function(){G==ue&&Q(se)}),150)}else{var Xe=se.clientY<z.top?-20:se.clientY>z.bottom?20:0;Xe&&setTimeout(Kt(e,function(){G==ue&&(l.scroller.scrollTop+=Xe,Q(se))}),50)}}function re(se){e.state.selectingText=!1,G=1/0,se&&(nn(se),l.input.focus()),pn(l.wrapper.ownerDocument,"mousemove",oe),pn(l.wrapper.ownerDocument,"mouseup",ae),d.history.lastSelOrigin=null}var oe=Kt(e,function(se){se.buttons===0||!As(se)?re(se):Q(se)}),ae=Kt(e,re);e.state.selectingText=ae,Be(l.wrapper.ownerDocument,"mousemove",oe),Be(l.wrapper.ownerDocument,"mouseup",ae)}function Gw(e,r){var a=r.anchor,s=r.head,l=de(e.doc,a.line);if(w(a,s)==0&&a.sticky==s.sticky)return r;var d=Sn(l);if(!d)return r;var h=Rt(d,a.ch,a.sticky),g=d[h];if(g.from!=a.ch&&g.to!=a.ch)return r;var v=h+(g.from==a.ch==(g.level!=1)?0:1);if(v==0||v==d.length)return r;var b;if(s.line!=a.line)b=(s.line-a.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var A=Rt(d,s.ch,s.sticky),P=A-h||(s.ch-a.ch)*(g.level==1?-1:1);A==v-1||A==v?b=P<0:b=P>0}var B=d[v+(b?-1:0)],z=b==(B.level==1),G=z?B.from:B.to,Q=z?"after":"before";return a.ch==G&&a.sticky==Q?r:new vt(new ee(a.line,G,Q),s)}function pp(e,r,a,s){var l,d;if(r.touches)l=r.touches[0].clientX,d=r.touches[0].clientY;else try{l=r.clientX,d=r.clientY}catch{return!1}if(l>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;s&&nn(r);var h=e.display,g=h.lineDiv.getBoundingClientRect();if(d>g.bottom||!en(e,a))return Pn(r);d-=g.top-h.viewOffset;for(var v=0;v<e.display.gutterSpecs.length;++v){var b=h.gutters.childNodes[v];if(b&&b.getBoundingClientRect().right>=l){var A=sr(e.doc,d),P=e.display.gutterSpecs[v];return Ue(e,a,e,A,P.className,r),Pn(r)}}}function eu(e,r){return pp(e,r,"gutterClick",!0)}function hp(e,r){wr(e.display,r)||Yw(e,r)||Bt(e,r,"contextmenu")||F||e.display.input.onContextMenu(r)}function Yw(e,r){return en(e,"gutterContextMenu")?pp(e,r,"gutterContextMenu",!1):!1}function gp(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ao(e)}var Bi={toString:function(){return"CodeMirror.Init"}},mp={},oa={};function Kw(e){var r=e.optionHandlers;function a(s,l,d,h){e.defaults[s]=l,d&&(r[s]=h?function(g,v,b){b!=Bi&&d(g,v,b)}:d)}e.defineOption=a,e.Init=Bi,a("value","",function(s,l){return s.setValue(l)},!0),a("mode",null,function(s,l){s.doc.modeOption=l,ql(s)},!0),a("indentUnit",2,ql,!0),a("indentWithTabs",!1),a("smartIndent",!0),a("tabSize",4,function(s){jo(s),Ao(s),gn(s)},!0),a("lineSeparator",null,function(s,l){if(s.doc.lineSep=l,!!l){var d=[],h=s.doc.first;s.doc.iter(function(v){for(var b=0;;){var A=v.text.indexOf(l,b);if(A==-1)break;b=A+l.length,d.push(ee(h,A))}h++});for(var g=d.length-1;g>=0;g--)ji(s.doc,l,d[g],ee(d[g].line,d[g].ch+l.length))}}),a("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(s,l,d){s.state.specialChars=new RegExp(l.source+(l.test("	")?"":"|	"),"g"),d!=Bi&&s.refresh()}),a("specialCharPlaceholder",Cb,function(s){return s.refresh()},!0),a("electricChars",!0),a("inputStyle",_?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),a("spellcheck",!1,function(s,l){return s.getInputField().spellcheck=l},!0),a("autocorrect",!1,function(s,l){return s.getInputField().autocorrect=l},!0),a("autocapitalize",!1,function(s,l){return s.getInputField().autocapitalize=l},!0),a("rtlMoveVisually",!N),a("wholeLineUpdateBefore",!0),a("theme","default",function(s){gp(s),Ro(s)},!0),a("keyMap","default",function(s,l,d){var h=ra(l),g=d!=Bi&&ra(d);g&&g.detach&&g.detach(s,h),h.attach&&h.attach(s,g||null)}),a("extraKeys",null),a("configureMouse",null),a("lineWrapping",!1,Qw,!0),a("gutters",[],function(s,l){s.display.gutterSpecs=Wl(l,s.options.lineNumbers),Ro(s)},!0),a("fixedGutter",!0,function(s,l){s.display.gutters.style.left=l?Ol(s.display)+"px":"0",s.refresh()},!0),a("coverGutterNextToScrollbar",!1,function(s){return Di(s)},!0),a("scrollbarStyle","native",function(s){yd(s),Di(s),s.display.scrollbars.setScrollTop(s.doc.scrollTop),s.display.scrollbars.setScrollLeft(s.doc.scrollLeft)},!0),a("lineNumbers",!1,function(s,l){s.display.gutterSpecs=Wl(s.options.gutters,l),Ro(s)},!0),a("firstLineNumber",1,Ro,!0),a("lineNumberFormatter",function(s){return s},Ro,!0),a("showCursorWhenSelecting",!1,Oo,!0),a("resetSelectionOnContextMenu",!0),a("lineWiseCopyCut",!0),a("pasteLinesPerSelection",!0),a("selectionsMayTouch",!1),a("readOnly",!1,function(s,l){l=="nocursor"&&(Ni(s),s.display.input.blur()),s.display.input.readOnlyChanged(l)}),a("screenReaderLabel",null,function(s,l){l=l===""?null:l,s.display.input.screenReaderLabelChanged(l)}),a("disableInput",!1,function(s,l){l||s.display.input.reset()},!0),a("dragDrop",!0,Jw),a("allowDropFileTypes",null),a("cursorBlinkRate",530),a("cursorScrollMargin",0),a("cursorHeight",1,Oo,!0),a("singleCursorHeightPerLine",!0,Oo,!0),a("workTime",100),a("workDelay",100),a("flattenSpans",!0,jo,!0),a("addModeClass",!1,jo,!0),a("pollInterval",100),a("undoDepth",200,function(s,l){return s.doc.history.undoDepth=l}),a("historyEventDelay",1250),a("viewportMargin",10,function(s){return s.refresh()},!0),a("maxHighlightLength",1e4,jo,!0),a("moveInputWithCursor",!0,function(s,l){l||s.display.input.resetPosition()}),a("tabindex",null,function(s,l){return s.display.input.getField().tabIndex=l||""}),a("autofocus",null),a("direction","ltr",function(s,l){return s.doc.setDirection(l)},!0),a("phrases",null)}function Jw(e,r,a){var s=a&&a!=Bi;if(!r!=!s){var l=e.display.dragFunctions,d=r?Be:pn;d(e.display.scroller,"dragstart",l.start),d(e.display.scroller,"dragenter",l.enter),d(e.display.scroller,"dragover",l.over),d(e.display.scroller,"dragleave",l.leave),d(e.display.scroller,"drop",l.drop)}}function Qw(e){e.options.lineWrapping?(yt(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(H(e.display.wrapper,"CodeMirror-wrap"),wl(e)),Nl(e),gn(e),Ao(e),setTimeout(function(){return Di(e)},100)}function Pt(e,r){var a=this;if(!(this instanceof Pt))return new Pt(e,r);this.options=r=r?Xt(r):{},Xt(mp,r,!1);var s=r.value;typeof s=="string"?s=new mn(s,r.mode,null,r.lineSeparator,r.direction):r.mode&&(s.modeOption=r.mode),this.doc=s;var l=new Pt.inputStyles[r.inputStyle](this),d=this.display=new cw(e,s,l,r);d.wrapper.CodeMirror=this,gp(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),yd(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Et,keySeq:null,specialChars:null},r.autofocus&&!_&&d.input.focus(),f&&p<11&&setTimeout(function(){return a.display.input.reset(!0)},20),Zw(this),Aw(),si(this),this.curOp.forceUpdate=!0,Md(this,s),r.autofocus&&!_||this.hasFocus()?setTimeout(function(){a.hasFocus()&&!a.state.focused&&_l(a)},20):Ni(this);for(var h in oa)oa.hasOwnProperty(h)&&oa[h](this,r[h],Bi);xd(this),r.finishInit&&r.finishInit(this);for(var g=0;g<tu.length;++g)tu[g](this);ai(this),m&&r.lineWrapping&&getComputedStyle(d.lineDiv).textRendering=="optimizelegibility"&&(d.lineDiv.style.textRendering="auto")}Pt.defaults=mp,Pt.optionHandlers=oa;function Zw(e){var r=e.display;Be(r.scroller,"mousedown",Kt(e,fp)),f&&p<11?Be(r.scroller,"dblclick",Kt(e,function(v){if(!Bt(e,v)){var b=ni(e,v);if(!(!b||eu(e,v)||wr(e.display,v))){nn(v);var A=e.findWordAt(b);Zs(e.doc,A.anchor,A.head)}}})):Be(r.scroller,"dblclick",function(v){return Bt(e,v)||nn(v)}),Be(r.scroller,"contextmenu",function(v){return hp(e,v)}),Be(r.input.getField(),"contextmenu",function(v){r.scroller.contains(v.target)||hp(e,v)});var a,s={end:0};function l(){r.activeTouch&&(a=setTimeout(function(){return r.activeTouch=null},1e3),s=r.activeTouch,s.end=+new Date)}function d(v){if(v.touches.length!=1)return!1;var b=v.touches[0];return b.radiusX<=1&&b.radiusY<=1}function h(v,b){if(b.left==null)return!0;var A=b.left-v.left,P=b.top-v.top;return A*A+P*P>20*20}Be(r.scroller,"touchstart",function(v){if(!Bt(e,v)&&!d(v)&&!eu(e,v)){r.input.ensurePolled(),clearTimeout(a);var b=+new Date;r.activeTouch={start:b,moved:!1,prev:b-s.end<=300?s:null},v.touches.length==1&&(r.activeTouch.left=v.touches[0].pageX,r.activeTouch.top=v.touches[0].pageY)}}),Be(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),Be(r.scroller,"touchend",function(v){var b=r.activeTouch;if(b&&!wr(r,v)&&b.left!=null&&!b.moved&&new Date-b.start<300){var A=e.coordsChar(r.activeTouch,"page"),P;!b.prev||h(b,b.prev)?P=new vt(A,A):!b.prev.prev||h(b,b.prev.prev)?P=e.findWordAt(A):P=new vt(ee(A.line,0),le(e.doc,ee(A.line+1,0))),e.setSelection(P.anchor,P.head),e.focus(),nn(v)}l()}),Be(r.scroller,"touchcancel",l),Be(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Po(e,r.scroller.scrollTop),ii(e,r.scroller.scrollLeft,!0),Ue(e,"scroll",e))}),Be(r.scroller,"mousewheel",function(v){return Cd(e,v)}),Be(r.scroller,"DOMMouseScroll",function(v){return Cd(e,v)}),Be(r.wrapper,"scroll",function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(v){Bt(e,v)||Zr(v)},over:function(v){Bt(e,v)||(Mw(e,v),Zr(v))},start:function(v){return Ew(e,v)},drop:Kt(e,Lw),leave:function(v){Bt(e,v)||Zd(e)}};var g=r.input.getField();Be(g,"keyup",function(v){return up.call(e,v)}),Be(g,"keydown",Kt(e,lp)),Be(g,"keypress",Kt(e,cp)),Be(g,"focus",function(v){return _l(e,v)}),Be(g,"blur",function(v){return Ni(e,v)})}var tu=[];Pt.defineInitHook=function(e){return tu.push(e)};function Jo(e,r,a,s){var l=e.doc,d;a==null&&(a="add"),a=="smart"&&(l.mode.indent?d=Co(e,r).state:a="prev");var h=e.options.tabSize,g=de(l,r),v=qt(g.text,null,h);g.stateAfter&&(g.stateAfter=null);var b=g.text.match(/^\s*/)[0],A;if(!s&&!/\S/.test(g.text))A=0,a="not";else if(a=="smart"&&(A=l.mode.indent(d,g.text.slice(b.length),g.text),A==et||A>150)){if(!s)return;a="prev"}a=="prev"?r>l.first?A=qt(de(l,r-1).text,null,h):A=0:a=="add"?A=v+e.options.indentUnit:a=="subtract"?A=v-e.options.indentUnit:typeof a=="number"&&(A=v+a),A=Math.max(0,A);var P="",B=0;if(e.options.indentWithTabs)for(var z=Math.floor(A/h);z;--z)B+=h,P+="	";if(B<A&&(P+=Ar(A-B)),P!=b)return ji(l,P,ee(r,0),ee(r,b.length),"+input"),g.stateAfter=null,!0;for(var G=0;G<l.sel.ranges.length;G++){var Q=l.sel.ranges[G];if(Q.head.line==r&&Q.head.ch<b.length){var re=ee(r,b.length);Yl(l,G,new vt(re,re));break}}}var er=null;function sa(e){er=e}function nu(e,r,a,s,l){var d=e.doc;e.display.shift=!1,s||(s=d.sel);var h=+new Date-200,g=l=="paste"||e.state.pasteIncoming>h,v=yo(r),b=null;if(g&&s.ranges.length>1)if(er&&er.text.join(`
`)==r){if(s.ranges.length%er.text.length==0){b=[];for(var A=0;A<er.text.length;A++)b.push(d.splitLines(er.text[A]))}}else v.length==s.ranges.length&&e.options.pasteLinesPerSelection&&(b=gt(v,function(oe){return[oe]}));for(var P=e.curOp.updateInput,B=s.ranges.length-1;B>=0;B--){var z=s.ranges[B],G=z.from(),Q=z.to();z.empty()&&(a&&a>0?G=ee(G.line,G.ch-a):e.state.overwrite&&!g?Q=ee(Q.line,Math.min(de(d,Q.line).text.length,Q.ch+tt(v).length)):g&&er&&er.lineWise&&er.text.join(`
`)==v.join(`
`)&&(G=Q=ee(G.line,0)));var re={from:G,to:Q,text:b?b[B%b.length]:v,origin:l||(g?"paste":e.state.cutIncoming>h?"cut":"+input")};Ri(e.doc,re),Yt(e,"inputRead",e,re)}r&&!g&&yp(e,r),Pi(e),e.curOp.updateInput<2&&(e.curOp.updateInput=P),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function vp(e,r){var a=e.clipboardData&&e.clipboardData.getData("Text");if(a)return e.preventDefault(),!r.isReadOnly()&&!r.options.disableInput&&Tn(r,function(){return nu(r,a,0,null,"paste")}),!0}function yp(e,r){if(!(!e.options.electricChars||!e.options.smartIndent))for(var a=e.doc.sel,s=a.ranges.length-1;s>=0;s--){var l=a.ranges[s];if(!(l.head.ch>100||s&&a.ranges[s-1].head.line==l.head.line)){var d=e.getModeAt(l.head),h=!1;if(d.electricChars){for(var g=0;g<d.electricChars.length;g++)if(r.indexOf(d.electricChars.charAt(g))>-1){h=Jo(e,l.head.line,"smart");break}}else d.electricInput&&d.electricInput.test(de(e.doc,l.head.line).text.slice(0,l.head.ch))&&(h=Jo(e,l.head.line,"smart"));h&&Yt(e,"electricInput",e,l.head.line)}}}function bp(e){for(var r=[],a=[],s=0;s<e.doc.sel.ranges.length;s++){var l=e.doc.sel.ranges[s].head.line,d={anchor:ee(l,0),head:ee(l+1,0)};a.push(d),r.push(e.getRange(d.anchor,d.head))}return{text:r,ranges:a}}function wp(e,r,a,s){e.setAttribute("autocorrect",a?"":"off"),e.setAttribute("autocapitalize",s?"":"off"),e.setAttribute("spellcheck",!!r)}function xp(){var e=U("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),r=U("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return m?e.style.width="1000px":e.setAttribute("wrap","off"),E&&(e.style.border="1px solid black"),wp(e),r}function Xw(e){var r=e.optionHandlers,a=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(s,l){var d=this.options,h=d[s];d[s]==l&&s!="mode"||(d[s]=l,r.hasOwnProperty(s)&&Kt(this,r[s])(this,l,h),Ue(this,"optionChange",this,s))},getOption:function(s){return this.options[s]},getDoc:function(){return this.doc},addKeyMap:function(s,l){this.state.keyMaps[l?"push":"unshift"](ra(s))},removeKeyMap:function(s){for(var l=this.state.keyMaps,d=0;d<l.length;++d)if(l[d]==s||l[d].name==s)return l.splice(d,1),!0},addOverlay:un(function(s,l){var d=s.token?s:e.getMode(this.options,s);if(d.startState)throw new Error("Overlays may not be stateful.");Gt(this.state.overlays,{mode:d,modeSpec:s,opaque:l&&l.opaque,priority:l&&l.priority||0},function(h){return h.priority}),this.state.modeGen++,gn(this)}),removeOverlay:un(function(s){for(var l=this.state.overlays,d=0;d<l.length;++d){var h=l[d].modeSpec;if(h==s||typeof s=="string"&&h.name==s){l.splice(d,1),this.state.modeGen++,gn(this);return}}}),indentLine:un(function(s,l,d){typeof l!="string"&&typeof l!="number"&&(l==null?l=this.options.smartIndent?"smart":"prev":l=l?"add":"subtract"),Xr(this.doc,s)&&Jo(this,s,l,d)}),indentSelection:un(function(s){for(var l=this.doc.sel.ranges,d=-1,h=0;h<l.length;h++){var g=l[h];if(g.empty())g.head.line>d&&(Jo(this,g.head.line,s,!0),d=g.head.line,h==this.doc.sel.primIndex&&Pi(this));else{var v=g.from(),b=g.to(),A=Math.max(d,v.line);d=Math.min(this.lastLine(),b.line-(b.ch?0:1))+1;for(var P=A;P<d;++P)Jo(this,P,s);var B=this.doc.sel.ranges;v.ch==0&&l.length==B.length&&B[h].from().ch>0&&Yl(this.doc,h,new vt(v,B[h].to()),ft)}}}),getTokenAt:function(s,l){return Of(this,s,l)},getLineTokens:function(s,l){return Of(this,ee(s),l,!0)},getTokenTypeAt:function(s){s=le(this.doc,s);var l=Ef(this,de(this.doc,s.line)),d=0,h=(l.length-1)/2,g=s.ch,v;if(g==0)v=l[2];else for(;;){var b=d+h>>1;if((b?l[b*2-1]:0)>=g)h=b;else if(l[b*2+1]<g)d=b+1;else{v=l[b*2+2];break}}var A=v?v.indexOf("overlay "):-1;return A<0?v:A==0?null:v.slice(0,A-1)},getModeAt:function(s){var l=this.doc.mode;return l.innerMode?e.innerMode(l,this.getTokenAt(s).state).mode:l},getHelper:function(s,l){return this.getHelpers(s,l)[0]},getHelpers:function(s,l){var d=[];if(!a.hasOwnProperty(l))return d;var h=a[l],g=this.getModeAt(s);if(typeof g[l]=="string")h[g[l]]&&d.push(h[g[l]]);else if(g[l])for(var v=0;v<g[l].length;v++){var b=h[g[l][v]];b&&d.push(b)}else g.helperType&&h[g.helperType]?d.push(h[g.helperType]):h[g.name]&&d.push(h[g.name]);for(var A=0;A<h._global.length;A++){var P=h._global[A];P.pred(g,this)&&ge(d,P.val)==-1&&d.push(P.val)}return d},getStateAfter:function(s,l){var d=this.doc;return s=ct(d,s??d.first+d.size-1),Co(this,s+1,l).state},cursorCoords:function(s,l){var d,h=this.doc.sel.primary();return s==null?d=h.head:typeof s=="object"?d=le(this.doc,s):d=s?h.from():h.to(),Zn(this,d,l||"page")},charCoords:function(s,l){return Ws(this,le(this.doc,s),l||"page")},coordsChar:function(s,l){return s=od(this,s,l||"page"),El(this,s.left,s.top)},lineAtHeight:function(s,l){return s=od(this,{top:s,left:0},l||"page").top,sr(this.doc,s+this.display.viewOffset)},heightAtLine:function(s,l,d){var h=!1,g;if(typeof s=="number"){var v=this.doc.first+this.doc.size-1;s<this.doc.first?s=this.doc.first:s>v&&(s=v,h=!0),g=de(this.doc,s)}else g=s;return Bs(this,g,{top:0,left:0},l||"page",d||h).top+(h?this.doc.height-br(g):0)},defaultTextHeight:function(){return Ai(this.display)},defaultCharWidth:function(){return Oi(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(s,l,d,h,g){var v=this.display;s=Zn(this,le(this.doc,s));var b=s.bottom,A=s.left;if(l.style.position="absolute",l.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(l),v.sizer.appendChild(l),h=="over")b=s.top;else if(h=="above"||h=="near"){var P=Math.max(v.wrapper.clientHeight,this.doc.height),B=Math.max(v.sizer.clientWidth,v.lineSpace.clientWidth);(h=="above"||s.bottom+l.offsetHeight>P)&&s.top>l.offsetHeight?b=s.top-l.offsetHeight:s.bottom+l.offsetHeight<=P&&(b=s.bottom),A+l.offsetWidth>B&&(A=B-l.offsetWidth)}l.style.top=b+"px",l.style.left=l.style.right="",g=="right"?(A=v.sizer.clientWidth-l.offsetWidth,l.style.right="0px"):(g=="left"?A=0:g=="middle"&&(A=(v.sizer.clientWidth-l.offsetWidth)/2),l.style.left=A+"px"),d&&Jb(this,{left:A,top:b,right:A+l.offsetWidth,bottom:b+l.offsetHeight})},triggerOnKeyDown:un(lp),triggerOnKeyPress:un(cp),triggerOnKeyUp:up,triggerOnMouseDown:un(fp),execCommand:function(s){if(Vo.hasOwnProperty(s))return Vo[s].call(null,this)},triggerElectric:un(function(s){yp(this,s)}),findPosH:function(s,l,d,h){var g=1;l<0&&(g=-1,l=-l);for(var v=le(this.doc,s),b=0;b<l&&(v=ru(this.doc,v,g,d,h),!v.hitSide);++b);return v},moveH:un(function(s,l){var d=this;this.extendSelectionsBy(function(h){return d.display.shift||d.doc.extend||h.empty()?ru(d.doc,h.head,s,l,d.options.rtlMoveVisually):s<0?h.from():h.to()},Ge)}),deleteH:un(function(s,l){var d=this.doc.sel,h=this.doc;d.somethingSelected()?h.replaceSelection("",null,"+delete"):Hi(this,function(g){var v=ru(h,g.head,s,l,!1);return s<0?{from:v,to:g.head}:{from:g.head,to:v}})}),findPosV:function(s,l,d,h){var g=1,v=h;l<0&&(g=-1,l=-l);for(var b=le(this.doc,s),A=0;A<l;++A){var P=Zn(this,b,"div");if(v==null?v=P.left:P.left=v,b=kp(this,P,g,d),b.hitSide)break}return b},moveV:un(function(s,l){var d=this,h=this.doc,g=[],v=!this.display.shift&&!h.extend&&h.sel.somethingSelected();if(h.extendSelectionsBy(function(A){if(v)return s<0?A.from():A.to();var P=Zn(d,A.head,"div");A.goalColumn!=null&&(P.left=A.goalColumn),g.push(P.left);var B=kp(d,P,s,l);return l=="page"&&A==h.sel.primary()&&jl(d,Ws(d,B,"div").top-P.top),B},Ge),g.length)for(var b=0;b<h.sel.ranges.length;b++)h.sel.ranges[b].goalColumn=g[b]}),findWordAt:function(s){var l=this.doc,d=de(l,s.line).text,h=s.ch,g=s.ch;if(d){var v=this.getHelper(s,"wordChars");(s.sticky=="before"||g==d.length)&&h?--h:++g;for(var b=d.charAt(h),A=$(b,v)?function(P){return $(P,v)}:/\s/.test(b)?function(P){return/\s/.test(P)}:function(P){return!/\s/.test(P)&&!$(P)};h>0&&A(d.charAt(h-1));)--h;for(;g<d.length&&A(d.charAt(g));)++g}return new vt(ee(s.line,h),ee(s.line,g))},toggleOverwrite:function(s){s!=null&&s==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?yt(this.display.cursorDiv,"CodeMirror-overwrite"):H(this.display.cursorDiv,"CodeMirror-overwrite"),Ue(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==he()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:un(function(s,l){No(this,s,l)}),getScrollInfo:function(){var s=this.display.scroller;return{left:s.scrollLeft,top:s.scrollTop,height:s.scrollHeight-lr(this)-this.display.barHeight,width:s.scrollWidth-lr(this)-this.display.barWidth,clientHeight:Sl(this),clientWidth:ei(this)}},scrollIntoView:un(function(s,l){s==null?(s={from:this.doc.sel.primary().head,to:null},l==null&&(l=this.options.cursorScrollMargin)):typeof s=="number"?s={from:ee(s,0),to:null}:s.from==null&&(s={from:s,to:null}),s.to||(s.to=s.from),s.margin=l||0,s.from.line!=null?Qb(this,s):hd(this,s.from,s.to,s.margin)}),setSize:un(function(s,l){var d=this,h=function(v){return typeof v=="number"||/^\d+$/.test(String(v))?v+"px":v};s!=null&&(this.display.wrapper.style.width=h(s)),l!=null&&(this.display.wrapper.style.height=h(l)),this.options.lineWrapping&&nd(this);var g=this.display.viewFrom;this.doc.iter(g,this.display.viewTo,function(v){if(v.widgets){for(var b=0;b<v.widgets.length;b++)if(v.widgets[b].noHScroll){Dr(d,g,"widget");break}}++g}),this.curOp.forceUpdate=!0,Ue(this,"refresh",this)}),operation:function(s){return Tn(this,s)},startOperation:function(){return si(this)},endOperation:function(){return ai(this)},refresh:un(function(){var s=this.display.cachedTextHeight;gn(this),this.curOp.forceUpdate=!0,Ao(this),No(this,this.doc.scrollLeft,this.doc.scrollTop),Hl(this.display),(s==null||Math.abs(s-Ai(this.display))>.5||this.options.lineWrapping)&&Nl(this),Ue(this,"refresh",this)}),swapDoc:un(function(s){var l=this.doc;return l.cm=null,this.state.selectingText&&this.state.selectingText(),Md(this,s),Ao(this),this.display.input.reset(),No(this,s.scrollLeft,s.scrollTop),this.curOp.forceScroll=!0,Yt(this,"swapDoc",this,l),l}),phrase:function(s){var l=this.options.phrases;return l&&Object.prototype.hasOwnProperty.call(l,s)?l[s]:s},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},rr(e),e.registerHelper=function(s,l,d){a.hasOwnProperty(s)||(a[s]=e[s]={_global:[]}),a[s][l]=d},e.registerGlobalHelper=function(s,l,d,h){e.registerHelper(s,l,h),a[s]._global.push({pred:d,val:h})}}function ru(e,r,a,s,l){var d=r,h=a,g=de(e,r.line),v=l&&e.direction=="rtl"?-a:a;function b(){var ae=r.line+v;return ae<e.first||ae>=e.first+e.size?!1:(r=new ee(ae,r.ch,r.sticky),g=de(e,ae))}function A(ae){var se;if(s=="codepoint"){var ue=g.text.charCodeAt(r.ch+(a>0?0:-1));if(isNaN(ue))se=null;else{var Fe=a>0?ue>=55296&&ue<56320:ue>=56320&&ue<57343;se=new ee(r.line,Math.max(0,Math.min(g.text.length,r.ch+a*(Fe?2:1))),-a)}}else l?se=Iw(e.cm,g,r,a):se=Jl(g,r,a);if(se==null)if(!ae&&b())r=Ql(l,e.cm,g,r.line,v);else return!1;else r=se;return!0}if(s=="char"||s=="codepoint")A();else if(s=="column")A(!0);else if(s=="word"||s=="group")for(var P=null,B=s=="group",z=e.cm&&e.cm.getHelper(r,"wordChars"),G=!0;!(a<0&&!A(!G));G=!1){var Q=g.text.charAt(r.ch)||`
`,re=$(Q,z)?"w":B&&Q==`
`?"n":!B||/\s/.test(Q)?null:"p";if(B&&!G&&!re&&(re="s"),P&&P!=re){a<0&&(a=1,A(),r.sticky="after");break}if(re&&(P=re),a>0&&!A(!G))break}var oe=ea(e,r,d,h,!0);return D(d,oe)&&(oe.hitSide=!0),oe}function kp(e,r,a,s){var l=e.doc,d=r.left,h;if(s=="page"){var g=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),v=Math.max(g-.5*Ai(e.display),3);h=(a>0?r.bottom:r.top)+a*v}else s=="line"&&(h=a>0?r.bottom+3:r.top-3);for(var b;b=El(e,d,h),!!b.outside;){if(a<0?h<=0:h>=l.height){b.hitSide=!0;break}h+=a*5}return b}var bt=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Et,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};bt.prototype.init=function(e){var r=this,a=this,s=a.cm,l=a.div=e.lineDiv;l.contentEditable=!0,wp(l,s.options.spellcheck,s.options.autocorrect,s.options.autocapitalize);function d(g){for(var v=g.target;v;v=v.parentNode){if(v==l)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(v.className))break}return!1}Be(l,"paste",function(g){!d(g)||Bt(s,g)||vp(g,s)||p<=11&&setTimeout(Kt(s,function(){return r.updateFromDOM()}),20)}),Be(l,"compositionstart",function(g){r.composing={data:g.data,done:!1}}),Be(l,"compositionupdate",function(g){r.composing||(r.composing={data:g.data,done:!1})}),Be(l,"compositionend",function(g){r.composing&&(g.data!=r.composing.data&&r.readFromDOMSoon(),r.composing.done=!0)}),Be(l,"touchstart",function(){return a.forceCompositionEnd()}),Be(l,"input",function(){r.composing||r.readFromDOMSoon()});function h(g){if(!(!d(g)||Bt(s,g))){if(s.somethingSelected())sa({lineWise:!1,text:s.getSelections()}),g.type=="cut"&&s.replaceSelection("",null,"cut");else if(s.options.lineWiseCopyCut){var v=bp(s);sa({lineWise:!0,text:v.text}),g.type=="cut"&&s.operation(function(){s.setSelections(v.ranges,0,ft),s.replaceSelection("",null,"cut")})}else return;if(g.clipboardData){g.clipboardData.clearData();var b=er.text.join(`
`);if(g.clipboardData.setData("Text",b),g.clipboardData.getData("Text")==b){g.preventDefault();return}}var A=xp(),P=A.firstChild;s.display.lineSpace.insertBefore(A,s.display.lineSpace.firstChild),P.value=er.text.join(`
`);var B=he();An(P),setTimeout(function(){s.display.lineSpace.removeChild(A),B.focus(),B==l&&a.showPrimarySelection()},50)}}Be(l,"copy",h),Be(l,"cut",h)},bt.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},bt.prototype.prepareSelection=function(){var e=fd(this.cm,!1);return e.focus=he()==this.div,e},bt.prototype.showSelection=function(e,r){!e||!this.cm.display.view.length||((e.focus||r)&&this.showPrimarySelection(),this.showMultipleSelections(e))},bt.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},bt.prototype.showPrimarySelection=function(){var e=this.getSelection(),r=this.cm,a=r.doc.sel.primary(),s=a.from(),l=a.to();if(r.display.viewTo==r.display.viewFrom||s.line>=r.display.viewTo||l.line<r.display.viewFrom){e.removeAllRanges();return}var d=aa(r,e.anchorNode,e.anchorOffset),h=aa(r,e.focusNode,e.focusOffset);if(!(d&&!d.bad&&h&&!h.bad&&w(Ve(d,h),s)==0&&w(ne(d,h),l)==0)){var g=r.display.view,v=s.line>=r.display.viewFrom&&Sp(r,s)||{node:g[0].measure.map[2],offset:0},b=l.line<r.display.viewTo&&Sp(r,l);if(!b){var A=g[g.length-1].measure,P=A.maps?A.maps[A.maps.length-1]:A.map;b={node:P[P.length-1],offset:P[P.length-2]-P[P.length-3]}}if(!v||!b){e.removeAllRanges();return}var B=e.rangeCount&&e.getRangeAt(0),z;try{z=Z(v.node,v.offset,b.offset,b.node)}catch{}z&&(!i&&r.state.focused?(e.collapse(v.node,v.offset),z.collapsed||(e.removeAllRanges(),e.addRange(z))):(e.removeAllRanges(),e.addRange(z)),B&&e.anchorNode==null?e.addRange(B):i&&this.startGracePeriod()),this.rememberSelection()}},bt.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},bt.prototype.showMultipleSelections=function(e){W(this.cm.display.cursorDiv,e.cursors),W(this.cm.display.selectionDiv,e.selection)},bt.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},bt.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var r=e.getRangeAt(0).commonAncestorContainer;return X(this.div,r)},bt.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||he()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},bt.prototype.blur=function(){this.div.blur()},bt.prototype.getField=function(){return this.div},bt.prototype.supportsTouch=function(){return!0},bt.prototype.receivedFocus=function(){var e=this,r=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):Tn(this.cm,function(){return r.cm.curOp.selectionChanged=!0});function a(){r.cm.state.focused&&(r.pollSelection(),r.polling.set(r.cm.options.pollInterval,a))}this.polling.set(this.cm.options.pollInterval,a)},bt.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},bt.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),r=this.cm;if(M&&x&&this.cm.display.gutterSpecs.length&&e1(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var a=aa(r,e.anchorNode,e.anchorOffset),s=aa(r,e.focusNode,e.focusOffset);a&&s&&Tn(r,function(){on(r.doc,_r(a,s),ft),(a.bad||s.bad)&&(r.curOp.selectionChanged=!0)})}}},bt.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,r=e.display,a=e.doc.sel.primary(),s=a.from(),l=a.to();if(s.ch==0&&s.line>e.firstLine()&&(s=ee(s.line-1,de(e.doc,s.line-1).length)),l.ch==de(e.doc,l.line).text.length&&l.line<e.lastLine()&&(l=ee(l.line+1,0)),s.line<r.viewFrom||l.line>r.viewTo-1)return!1;var d,h,g;s.line==r.viewFrom||(d=ri(e,s.line))==0?(h=mt(r.view[0].line),g=r.view[0].node):(h=mt(r.view[d].line),g=r.view[d-1].node.nextSibling);var v=ri(e,l.line),b,A;if(v==r.view.length-1?(b=r.viewTo-1,A=r.lineDiv.lastChild):(b=mt(r.view[v+1].line)-1,A=r.view[v+1].node.previousSibling),!g)return!1;for(var P=e.doc.splitLines(t1(e,g,A,h,b)),B=or(e.doc,ee(h,0),ee(b,de(e.doc,b).text.length));P.length>1&&B.length>1;)if(tt(P)==tt(B))P.pop(),B.pop(),b--;else if(P[0]==B[0])P.shift(),B.shift(),h++;else break;for(var z=0,G=0,Q=P[0],re=B[0],oe=Math.min(Q.length,re.length);z<oe&&Q.charCodeAt(z)==re.charCodeAt(z);)++z;for(var ae=tt(P),se=tt(B),ue=Math.min(ae.length-(P.length==1?z:0),se.length-(B.length==1?z:0));G<ue&&ae.charCodeAt(ae.length-G-1)==se.charCodeAt(se.length-G-1);)++G;if(P.length==1&&B.length==1&&h==s.line)for(;z&&z>s.ch&&ae.charCodeAt(ae.length-G-1)==se.charCodeAt(se.length-G-1);)z--,G++;P[P.length-1]=ae.slice(0,ae.length-G).replace(/^\u200b+/,""),P[0]=P[0].slice(z).replace(/\u200b+$/,"");var Fe=ee(h,z),me=ee(b,B.length?tt(B).length-G:0);if(P.length>1||P[0]||w(Fe,me))return ji(e.doc,P,Fe,me,"+input"),!0},bt.prototype.ensurePolled=function(){this.forceCompositionEnd()},bt.prototype.reset=function(){this.forceCompositionEnd()},bt.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},bt.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},bt.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&Tn(this.cm,function(){return gn(e.cm)})},bt.prototype.setUneditable=function(e){e.contentEditable="false"},bt.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Kt(this.cm,nu)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},bt.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},bt.prototype.onContextMenu=function(){},bt.prototype.resetPosition=function(){},bt.prototype.needsContentAttribute=!0;function Sp(e,r){var a=Cl(e,r.line);if(!a||a.hidden)return null;var s=de(e.doc,r.line),l=Qf(a,s,r.line),d=Sn(s,e.doc.direction),h="left";if(d){var g=Rt(d,r.ch);h=g%2?"right":"left"}var v=ed(l.map,r.ch,h);return v.offset=v.collapse=="right"?v.end:v.start,v}function e1(e){for(var r=e;r;r=r.parentNode)if(/CodeMirror-gutter-wrapper/.test(r.className))return!0;return!1}function Wi(e,r){return r&&(e.bad=!0),e}function t1(e,r,a,s,l){var d="",h=!1,g=e.doc.lineSeparator(),v=!1;function b(z){return function(G){return G.id==z}}function A(){h&&(d+=g,v&&(d+=g),h=v=!1)}function P(z){z&&(A(),d+=z)}function B(z){if(z.nodeType==1){var G=z.getAttribute("cm-text");if(G){P(G);return}var Q=z.getAttribute("cm-marker"),re;if(Q){var oe=e.findMarks(ee(s,0),ee(l+1,0),b(+Q));oe.length&&(re=oe[0].find(0))&&P(or(e.doc,re.from,re.to).join(g));return}if(z.getAttribute("contenteditable")=="false")return;var ae=/^(pre|div|p|li|table|br)$/i.test(z.nodeName);if(!/^br$/i.test(z.nodeName)&&z.textContent.length==0)return;ae&&A();for(var se=0;se<z.childNodes.length;se++)B(z.childNodes[se]);/^(pre|p)$/i.test(z.nodeName)&&(v=!0),ae&&(h=!0)}else z.nodeType==3&&P(z.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;B(r),r!=a;)r=r.nextSibling,v=!1;return d}function aa(e,r,a){var s;if(r==e.display.lineDiv){if(s=e.display.lineDiv.childNodes[a],!s)return Wi(e.clipPos(ee(e.display.viewTo-1)),!0);r=null,a=0}else for(s=r;;s=s.parentNode){if(!s||s==e.display.lineDiv)return null;if(s.parentNode&&s.parentNode==e.display.lineDiv)break}for(var l=0;l<e.display.view.length;l++){var d=e.display.view[l];if(d.node==s)return n1(d,r,a)}}function n1(e,r,a){var s=e.text.firstChild,l=!1;if(!r||!X(s,r))return Wi(ee(mt(e.line),0),!0);if(r==s&&(l=!0,r=s.childNodes[a],a=0,!r)){var d=e.rest?tt(e.rest):e.line;return Wi(ee(mt(d),d.text.length),l)}var h=r.nodeType==3?r:null,g=r;for(!h&&r.childNodes.length==1&&r.firstChild.nodeType==3&&(h=r.firstChild,a&&(a=h.nodeValue.length));g.parentNode!=s;)g=g.parentNode;var v=e.measure,b=v.maps;function A(re,oe,ae){for(var se=-1;se<(b?b.length:0);se++)for(var ue=se<0?v.map:b[se],Fe=0;Fe<ue.length;Fe+=3){var me=ue[Fe+2];if(me==re||me==oe){var Xe=mt(se<0?e.line:e.rest[se]),Tt=ue[Fe]+ae;return(ae<0||me!=re)&&(Tt=ue[Fe+(ae?1:0)]),ee(Xe,Tt)}}}var P=A(h,g,a);if(P)return Wi(P,l);for(var B=g.nextSibling,z=h?h.nodeValue.length-a:0;B;B=B.nextSibling){if(P=A(B,B.firstChild,0),P)return Wi(ee(P.line,P.ch-z),l);z+=B.textContent.length}for(var G=g.previousSibling,Q=a;G;G=G.previousSibling){if(P=A(G,G.firstChild,-1),P)return Wi(ee(P.line,P.ch+Q),l);Q+=G.textContent.length}}var Ht=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Et,this.hasSelection=!1,this.composing=null};Ht.prototype.init=function(e){var r=this,a=this,s=this.cm;this.createField(e);var l=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),E&&(l.style.width="0px"),Be(l,"input",function(){f&&p>=9&&r.hasSelection&&(r.hasSelection=null),a.poll()}),Be(l,"paste",function(h){Bt(s,h)||vp(h,s)||(s.state.pasteIncoming=+new Date,a.fastPoll())});function d(h){if(!Bt(s,h)){if(s.somethingSelected())sa({lineWise:!1,text:s.getSelections()});else if(s.options.lineWiseCopyCut){var g=bp(s);sa({lineWise:!0,text:g.text}),h.type=="cut"?s.setSelections(g.ranges,null,ft):(a.prevInput="",l.value=g.text.join(`
`),An(l))}else return;h.type=="cut"&&(s.state.cutIncoming=+new Date)}}Be(l,"cut",d),Be(l,"copy",d),Be(e.scroller,"paste",function(h){if(!(wr(e,h)||Bt(s,h))){if(!l.dispatchEvent){s.state.pasteIncoming=+new Date,a.focus();return}var g=new Event("paste");g.clipboardData=h.clipboardData,l.dispatchEvent(g)}}),Be(e.lineSpace,"selectstart",function(h){wr(e,h)||nn(h)}),Be(l,"compositionstart",function(){var h=s.getCursor("from");a.composing&&a.composing.range.clear(),a.composing={start:h,range:s.markText(h,s.getCursor("to"),{className:"CodeMirror-composing"})}}),Be(l,"compositionend",function(){a.composing&&(a.poll(),a.composing.range.clear(),a.composing=null)})},Ht.prototype.createField=function(e){this.wrapper=xp(),this.textarea=this.wrapper.firstChild},Ht.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Ht.prototype.prepareSelection=function(){var e=this.cm,r=e.display,a=e.doc,s=fd(e);if(e.options.moveInputWithCursor){var l=Zn(e,a.sel.primary().head,"div"),d=r.wrapper.getBoundingClientRect(),h=r.lineDiv.getBoundingClientRect();s.teTop=Math.max(0,Math.min(r.wrapper.clientHeight-10,l.top+h.top-d.top)),s.teLeft=Math.max(0,Math.min(r.wrapper.clientWidth-10,l.left+h.left-d.left))}return s},Ht.prototype.showSelection=function(e){var r=this.cm,a=r.display;W(a.cursorDiv,e.cursors),W(a.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Ht.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing)){var r=this.cm;if(r.somethingSelected()){this.prevInput="";var a=r.getSelection();this.textarea.value=a,r.state.focused&&An(this.textarea),f&&p>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",f&&p>=9&&(this.hasSelection=null))}},Ht.prototype.getField=function(){return this.textarea},Ht.prototype.supportsTouch=function(){return!1},Ht.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!_||he()!=this.textarea))try{this.textarea.focus()}catch{}},Ht.prototype.blur=function(){this.textarea.blur()},Ht.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Ht.prototype.receivedFocus=function(){this.slowPoll()},Ht.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Ht.prototype.fastPoll=function(){var e=!1,r=this;r.pollingFast=!0;function a(){var s=r.poll();!s&&!e?(e=!0,r.polling.set(60,a)):(r.pollingFast=!1,r.slowPoll())}r.polling.set(20,a)},Ht.prototype.poll=function(){var e=this,r=this.cm,a=this.textarea,s=this.prevInput;if(this.contextMenuPending||!r.state.focused||Ns(a)&&!s&&!this.composing||r.isReadOnly()||r.options.disableInput||r.state.keySeq)return!1;var l=a.value;if(l==s&&!r.somethingSelected())return!1;if(f&&p>=9&&this.hasSelection===l||C&&/[\uf700-\uf7ff]/.test(l))return r.display.input.reset(),!1;if(r.doc.sel==r.display.selForContextMenu){var d=l.charCodeAt(0);if(d==8203&&!s&&(s="\u200B"),d==8666)return this.reset(),this.cm.execCommand("undo")}for(var h=0,g=Math.min(s.length,l.length);h<g&&s.charCodeAt(h)==l.charCodeAt(h);)++h;return Tn(r,function(){nu(r,l.slice(h),s.length-h,null,e.composing?"*compose":null),l.length>1e3||l.indexOf(`
`)>-1?a.value=e.prevInput="":e.prevInput=l,e.composing&&(e.composing.range.clear(),e.composing.range=r.markText(e.composing.start,r.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Ht.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Ht.prototype.onKeyPress=function(){f&&p>=9&&(this.hasSelection=null),this.fastPoll()},Ht.prototype.onContextMenu=function(e){var r=this,a=r.cm,s=a.display,l=r.textarea;r.contextMenuPending&&r.contextMenuPending();var d=ni(a,e),h=s.scroller.scrollTop;if(!d||S)return;var g=a.options.resetSelectionOnContextMenu;g&&a.doc.sel.contains(d)==-1&&Kt(a,on)(a.doc,_r(d),ft);var v=l.style.cssText,b=r.wrapper.style.cssText,A=r.wrapper.offsetParent.getBoundingClientRect();r.wrapper.style.cssText="position: static",l.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-A.top-5)+"px; left: "+(e.clientX-A.left-5)+`px;
      z-index: 1000; background: `+(f?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var P;m&&(P=window.scrollY),s.input.focus(),m&&window.scrollTo(null,P),s.input.reset(),a.somethingSelected()||(l.value=r.prevInput=" "),r.contextMenuPending=z,s.selForContextMenu=a.doc.sel,clearTimeout(s.detectingSelectAll);function B(){if(l.selectionStart!=null){var Q=a.somethingSelected(),re="\u200B"+(Q?l.value:"");l.value="\u21DA",l.value=re,r.prevInput=Q?"":"\u200B",l.selectionStart=1,l.selectionEnd=re.length,s.selForContextMenu=a.doc.sel}}function z(){if(r.contextMenuPending==z&&(r.contextMenuPending=!1,r.wrapper.style.cssText=b,l.style.cssText=v,f&&p<9&&s.scrollbars.setScrollTop(s.scroller.scrollTop=h),l.selectionStart!=null)){(!f||f&&p<9)&&B();var Q=0,re=function(){s.selForContextMenu==a.doc.sel&&l.selectionStart==0&&l.selectionEnd>0&&r.prevInput=="\u200B"?Kt(a,Bd)(a):Q++<10?s.detectingSelectAll=setTimeout(re,500):(s.selForContextMenu=null,s.input.reset())};s.detectingSelectAll=setTimeout(re,200)}}if(f&&p>=9&&B(),F){Zr(e);var G=function(){pn(window,"mouseup",G),setTimeout(z,20)};Be(window,"mouseup",G)}else setTimeout(z,50)},Ht.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Ht.prototype.setUneditable=function(){},Ht.prototype.needsContentAttribute=!1;function r1(e,r){if(r=r?Xt(r):{},r.value=e.value,!r.tabindex&&e.tabIndex&&(r.tabindex=e.tabIndex),!r.placeholder&&e.placeholder&&(r.placeholder=e.placeholder),r.autofocus==null){var a=he();r.autofocus=a==e||e.getAttribute("autofocus")!=null&&a==document.body}function s(){e.value=g.getValue()}var l;if(e.form&&(Be(e.form,"submit",s),!r.leaveSubmitMethodAlone)){var d=e.form;l=d.submit;try{var h=d.submit=function(){s(),d.submit=l,d.submit(),d.submit=h}}catch{}}r.finishInit=function(v){v.save=s,v.getTextArea=function(){return e},v.toTextArea=function(){v.toTextArea=isNaN,s(),e.parentNode.removeChild(v.getWrapperElement()),e.style.display="",e.form&&(pn(e.form,"submit",s),!r.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=l))}},e.style.display="none";var g=Pt(function(v){return e.parentNode.insertBefore(v,e.nextSibling)},r);return g}function i1(e){e.off=pn,e.on=Be,e.wheelEventPixels=fw,e.Doc=mn,e.splitLines=yo,e.countColumn=qt,e.findColumn=Vt,e.isWordChar=Ct,e.Pass=et,e.signal=Ue,e.Line=Li,e.changeEnd=Rr,e.scrollbarModel=vd,e.Pos=ee,e.cmpPos=w,e.modes=Hn,e.mimeModes=Dn,e.resolveMode=Si,e.getMode=Ci,e.modeExtensions=Kn,e.extendMode=Jn,e.copyState=In,e.startState=xo,e.innerMode=wo,e.commands=Vo,e.keyMap=kr,e.keyName=rp,e.isModifierKey=tp,e.lookupKey=Fi,e.normalizeKeyMap=Dw,e.StringStream=jt,e.SharedTextMarker=$o,e.TextMarker=zr,e.LineWidget=Wo,e.e_preventDefault=nn,e.e_stopPropagation=ki,e.e_stop=Zr,e.addClass=yt,e.contains=X,e.rmClass=H,e.keyNames=Fr}Kw(Pt),Xw(Pt);var o1="iter insert remove copy getEditor constructor".split(" ");for(var la in mn.prototype)mn.prototype.hasOwnProperty(la)&&ge(o1,la)<0&&(Pt.prototype[la]=function(e){return function(){return e.apply(this.doc,arguments)}}(mn.prototype[la]));return rr(mn),Pt.inputStyles={textarea:Ht,contenteditable:bt},Pt.defineMode=function(e){!Pt.defaults.mode&&e!="null"&&(Pt.defaults.mode=e),Ds.apply(this,arguments)},Pt.defineMIME=vr,Pt.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Pt.defineMIME("text/plain","null"),Pt.defineExtension=function(e,r){Pt.prototype[e]=r},Pt.defineDocExtension=function(e,r){mn.prototype[e]=r},Pt.fromTextArea=r1,i1(Pt),Pt.version="5.65.2",Pt})});var gu=It((oh,sh)=>{(function(n){typeof oh=="object"&&typeof sh=="object"?n(Cr()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("javascript",function(t,i){var o=t.indentUnit,u=i.statementIndent,c=i.jsonld,f=i.json||c,p=i.trackScope!==!1,m=i.typescript,y=i.wordCharacters||/[\w$\xa1-\uffff]/,x=function(){function w(rn){return{type:rn,style:"keyword"}}var D=w("keyword a"),J=w("keyword b"),ne=w("keyword c"),Ve=w("keyword d"),ct=w("operator"),le={type:"atom",style:"atom"};return{if:w("if"),while:D,with:D,else:J,do:J,try:J,finally:J,return:Ve,break:Ve,continue:Ve,new:w("new"),delete:ne,void:ne,throw:ne,debugger:w("debugger"),var:w("var"),const:w("var"),let:w("var"),function:w("function"),catch:w("catch"),for:w("for"),switch:w("switch"),case:w("case"),default:w("default"),in:ct,typeof:ct,instanceof:ct,true:le,false:le,null:le,undefined:le,NaN:le,Infinity:le,this:w("this"),class:w("class"),super:w("atom"),yield:ne,export:w("export"),import:w("import"),extends:ne,await:ne}}(),S=/[+\-*&%=<>!?|~^@]/,k=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function T(w){for(var D=!1,J,ne=!1;(J=w.next())!=null;){if(!D){if(J=="/"&&!ne)return;J=="["?ne=!0:ne&&J=="]"&&(ne=!1)}D=!D&&J=="\\"}}var O,E;function M(w,D,J){return O=w,E=J,D}function _(w,D){var J=w.next();if(J=='"'||J=="'")return D.tokenize=C(J),D.tokenize(w,D);if(J=="."&&w.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return M("number","number");if(J=="."&&w.match(".."))return M("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(J))return M(J);if(J=="="&&w.eat(">"))return M("=>","operator");if(J=="0"&&w.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return M("number","number");if(/\d/.test(J))return w.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),M("number","number");if(J=="/")return w.eat("*")?(D.tokenize=I,I(w,D)):w.eat("/")?(w.skipToEnd(),M("comment","comment")):ee(w,D,1)?(T(w),w.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),M("regexp","string-2")):(w.eat("="),M("operator","operator",w.current()));if(J=="`")return D.tokenize=N,N(w,D);if(J=="#"&&w.peek()=="!")return w.skipToEnd(),M("meta","meta");if(J=="#"&&w.eatWhile(y))return M("variable","property");if(J=="<"&&w.match("!--")||J=="-"&&w.match("->")&&!/\S/.test(w.string.slice(0,w.start)))return w.skipToEnd(),M("comment","comment");if(S.test(J))return(J!=">"||!D.lexical||D.lexical.type!=">")&&(w.eat("=")?(J=="!"||J=="=")&&w.eat("="):/[<>*+\-|&?]/.test(J)&&(w.eat(J),J==">"&&w.eat(J))),J=="?"&&w.eat(".")?M("."):M("operator","operator",w.current());if(y.test(J)){w.eatWhile(y);var ne=w.current();if(D.lastType!="."){if(x.propertyIsEnumerable(ne)){var Ve=x[ne];return M(Ve.type,Ve.style,ne)}if(ne=="async"&&w.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return M("async","keyword",ne)}return M("variable","variable",ne)}}function C(w){return function(D,J){var ne=!1,Ve;if(c&&D.peek()=="@"&&D.match(k))return J.tokenize=_,M("jsonld-keyword","meta");for(;(Ve=D.next())!=null&&!(Ve==w&&!ne);)ne=!ne&&Ve=="\\";return ne||(J.tokenize=_),M("string","string")}}function I(w,D){for(var J=!1,ne;ne=w.next();){if(ne=="/"&&J){D.tokenize=_;break}J=ne=="*"}return M("comment","comment")}function N(w,D){for(var J=!1,ne;(ne=w.next())!=null;){if(!J&&(ne=="`"||ne=="$"&&w.eat("{"))){D.tokenize=_;break}J=!J&&ne=="\\"}return M("quasi","string-2",w.current())}var R="([{}])";function j(w,D){D.fatArrowAt&&(D.fatArrowAt=null);var J=w.string.indexOf("=>",w.start);if(!(J<0)){if(m){var ne=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(w.string.slice(w.start,J));ne&&(J=ne.index)}for(var Ve=0,ct=!1,le=J-1;le>=0;--le){var rn=w.string.charAt(le),_n=R.indexOf(rn);if(_n>=0&&_n<3){if(!Ve){++le;break}if(--Ve==0){rn=="("&&(ct=!0);break}}else if(_n>=3&&_n<6)++Ve;else if(y.test(rn))ct=!0;else if(/["'\/`]/.test(rn))for(;;--le){if(le==0)return;var Ti=w.string.charAt(le-1);if(Ti==rn&&w.string.charAt(le-2)!="\\"){le--;break}}else if(ct&&!Ve){++le;break}}ct&&!Ve&&(D.fatArrowAt=le)}}var F={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function q(w,D,J,ne,Ve,ct){this.indented=w,this.column=D,this.type=J,this.prev=Ve,this.info=ct,ne!=null&&(this.align=ne)}function H(w,D){if(!p)return!1;for(var J=w.localVars;J;J=J.next)if(J.name==D)return!0;for(var ne=w.context;ne;ne=ne.prev)for(var J=ne.vars;J;J=J.next)if(J.name==D)return!0}function te(w,D,J,ne,Ve){var ct=w.cc;for(W.state=w,W.stream=Ve,W.marked=null,W.cc=ct,W.style=D,w.lexical.hasOwnProperty("align")||(w.lexical.align=!0);;){var le=ct.length?ct.pop():f?Ge:ft;if(le(J,ne)){for(;ct.length&&ct[ct.length-1].lex;)ct.pop()();return W.marked?W.marked:J=="variable"&&H(w,ne)?"variable-2":D}}}var W={state:null,column:null,marked:null,cc:null};function U(){for(var w=arguments.length-1;w>=0;w--)W.cc.push(arguments[w])}function L(){return U.apply(null,arguments),!0}function Z(w,D){for(var J=D;J;J=J.next)if(J.name==w)return!0;return!1}function X(w){var D=W.state;if(W.marked="def",!!p){if(D.context){if(D.lexical.info=="var"&&D.context&&D.context.block){var J=he(w,D.context);if(J!=null){D.context=J;return}}else if(!Z(w,D.localVars)){D.localVars=new An(w,D.localVars);return}}i.globalVars&&!Z(w,D.globalVars)&&(D.globalVars=new An(w,D.globalVars))}}function he(w,D){if(D)if(D.block){var J=he(w,D.prev);return J?J==D.prev?D:new _t(J,D.vars,!0):null}else return Z(w,D.vars)?D:new _t(D.prev,new An(w,D.vars),!1);else return null}function yt(w){return w=="public"||w=="private"||w=="protected"||w=="abstract"||w=="readonly"}function _t(w,D,J){this.prev=w,this.vars=D,this.block=J}function An(w,D){this.name=w,this.next=D}var Kr=new An("this",new An("arguments",null));function Xt(){W.state.context=new _t(W.state.context,W.state.localVars,!1),W.state.localVars=Kr}function qt(){W.state.context=new _t(W.state.context,W.state.localVars,!0),W.state.localVars=null}Xt.lex=qt.lex=!0;function Et(){W.state.localVars=W.state.context.vars,W.state.context=W.state.context.prev}Et.lex=!0;function ge(w,D){var J=function(){var ne=W.state,Ve=ne.indented;if(ne.lexical.type=="stat")Ve=ne.lexical.indented;else for(var ct=ne.lexical;ct&&ct.type==")"&&ct.align;ct=ct.prev)Ve=ct.indented;ne.lexical=new q(Ve,W.stream.column(),w,null,ne.lexical,D)};return J.lex=!0,J}function qe(){var w=W.state;w.lexical.prev&&(w.lexical.type==")"&&(w.indented=w.lexical.indented),w.lexical=w.lexical.prev)}qe.lex=!0;function et(w){function D(J){return J==w?L():w==";"||J=="}"||J==")"||J=="]"?U():L(D)}return D}function ft(w,D){return w=="var"?L(ge("vardef",D),mo,et(";"),qe):w=="keyword a"?L(ge("form"),Yn,ft,qe):w=="keyword b"?L(ge("form"),ft,qe):w=="keyword d"?W.stream.match(/^\s*$/,!1)?L():L(ge("stat"),tt,et(";"),qe):w=="debugger"?L(et(";")):w=="{"?L(ge("}"),qt,Sn,qe,Et):w==";"?L():w=="if"?(W.state.lexical.info=="else"&&W.state.cc[W.state.cc.length-1]==qe&&W.state.cc.pop()(),L(ge("form"),Yn,ft,qe,Ns)):w=="function"?L(Hn):w=="for"?L(ge("form"),qt,Ps,ft,Et,qe):w=="class"||m&&D=="interface"?(W.marked="keyword",L(ge("form",w=="class"?w:D),Ci,qe)):w=="variable"?m&&D=="declare"?(W.marked="keyword",L(ft)):m&&(D=="module"||D=="enum"||D=="type")&&W.stream.match(/^\s*\w/,!1)?(W.marked="keyword",D=="enum"?L(sr):D=="type"?L(Ds,et("operator"),Ue,et(";")):L(ge("form"),hn,et("{"),ge("}"),Sn,qe,qe)):m&&D=="namespace"?(W.marked="keyword",L(ge("form"),Ge,ft,qe)):m&&D=="abstract"?(W.marked="keyword",L(ft)):L(ge("stat"),ot):w=="switch"?L(ge("form"),Yn,et("{"),ge("}","switch"),qt,Sn,qe,qe,Et):w=="case"?L(Ge,et(":")):w=="default"?L(et(":")):w=="catch"?L(ge("form"),Xt,it,ft,qe,Et):w=="export"?L(ge("stat"),wo,qe):w=="import"?L(ge("stat"),jt,qe):w=="async"?L(ft):D=="@"?L(Ge,ft):U(ge("stat"),Ge,et(";"),qe)}function it(w){if(w=="(")return L(vr,et(")"))}function Ge(w,D){return Ar(w,D,!1)}function Vt(w,D){return Ar(w,D,!0)}function Yn(w){return w!="("?U():L(ge(")"),tt,et(")"),qe)}function Ar(w,D,J){if(W.state.fatArrowAt==W.stream.start){var ne=J?Ct:Jr;if(w=="(")return L(Xt,ge(")"),Rt(vr,")"),qe,et("=>"),ne,Et);if(w=="variable")return U(Xt,hn,et("=>"),ne,Et)}var Ve=J?Gt:gt;return F.hasOwnProperty(w)?L(Ve):w=="function"?L(Hn,Ve):w=="class"||m&&D=="interface"?(W.marked="keyword",L(ge("form"),Si,qe)):w=="keyword c"||w=="async"?L(J?Vt:Ge):w=="("?L(ge(")"),tt,et(")"),qe,Ve):w=="operator"||w=="spread"?L(J?Vt:Ge):w=="["?L(ge("]"),mt,qe,Ve):w=="{"?Qr(nr,"}",null,Ve):w=="quasi"?U(On,Ve):w=="new"?L($(J)):L()}function tt(w){return w.match(/[;\}\)\],]/)?U():U(Ge)}function gt(w,D){return w==","?L(tt):Gt(w,D,!1)}function Gt(w,D,J){var ne=J==!1?gt:Gt,Ve=J==!1?Ge:Vt;if(w=="=>")return L(Xt,J?Ct:Jr,Et);if(w=="operator")return/\+\+|--/.test(D)||m&&D=="!"?L(ne):m&&D=="<"&&W.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?L(ge(">"),Rt(Ue,">"),qe,ne):D=="?"?L(Ge,et(":"),Ve):L(Ve);if(w=="quasi")return U(On,ne);if(w!=";"){if(w=="(")return Qr(Vt,")","call",ne);if(w==".")return L(ln,ne);if(w=="[")return L(ge("]"),tt,et("]"),qe,ne);if(m&&D=="as")return W.marked="keyword",L(Ue,ne);if(w=="regexp")return W.state.lastType=W.marked="operator",W.stream.backUp(W.stream.pos-W.stream.start-1),L(Ve)}}function On(w,D){return w!="quasi"?U():D.slice(D.length-2)!="${"?L(On):L(tt,Fn)}function Fn(w){if(w=="}")return W.marked="string-2",W.state.tokenize=N,L(On)}function Jr(w){return j(W.stream,W.state),U(w=="{"?ft:Ge)}function Ct(w){return j(W.stream,W.state),U(w=="{"?ft:Vt)}function $(w){return function(D){return D=="."?L(w?Y:ie):D=="variable"&&m?L(Zr,w?Gt:gt):U(w?Vt:Ge)}}function ie(w,D){if(D=="target")return W.marked="keyword",L(gt)}function Y(w,D){if(D=="target")return W.marked="keyword",L(Gt)}function ot(w){return w==":"?L(qe,ft):U(gt,et(";"),qe)}function ln(w){if(w=="variable")return W.marked="property",L()}function nr(w,D){if(w=="async")return W.marked="property",L(nr);if(w=="variable"||W.style=="keyword"){if(W.marked="property",D=="get"||D=="set")return L(pl);var J;return m&&W.state.fatArrowAt==W.stream.start&&(J=W.stream.match(/^\s*:\s*/,!1))&&(W.state.fatArrowAt=W.stream.pos+J[0].length),L(Nn)}else{if(w=="number"||w=="string")return W.marked=c?"property":W.style+" property",L(Nn);if(w=="jsonld-keyword")return L(Nn);if(m&&yt(D))return W.marked="keyword",L(nr);if(w=="[")return L(Ge,mr,et("]"),Nn);if(w=="spread")return L(Vt,Nn);if(D=="*")return W.marked="keyword",L(nr);if(w==":")return U(Nn)}}function pl(w){return w!="variable"?U(Nn):(W.marked="property",L(Hn))}function Nn(w){if(w==":")return L(Vt);if(w=="(")return U(Hn)}function Rt(w,D,J){function ne(Ve,ct){if(J?J.indexOf(Ve)>-1:Ve==","){var le=W.state.lexical;return le.info=="call"&&(le.pos=(le.pos||0)+1),L(function(rn,_n){return rn==D||_n==D?U():U(w)},ne)}return Ve==D||ct==D?L():J&&J.indexOf(";")>-1?U(w):L(et(D))}return function(Ve,ct){return Ve==D||ct==D?L():U(w,ne)}}function Qr(w,D,J){for(var ne=3;ne<arguments.length;ne++)W.cc.push(arguments[ne]);return L(ge(D,J),Rt(w,D),qe)}function Sn(w){return w=="}"?L():U(ft,Sn)}function mr(w,D){if(m){if(w==":")return L(Ue);if(D=="?")return L(mr)}}function Be(w,D){if(m&&(w==":"||D=="in"))return L(Ue)}function wi(w){if(m&&w==":")return W.stream.match(/^\s*\w+\s+is\b/,!1)?L(Ge,pn,Ue):L(Ue)}function pn(w,D){if(D=="is")return W.marked="keyword",L()}function Ue(w,D){if(D=="keyof"||D=="typeof"||D=="infer"||D=="readonly")return W.marked="keyword",L(D=="typeof"?Vt:Ue);if(w=="variable"||D=="void")return W.marked="type",L(Pn);if(D=="|"||D=="&")return L(Ue);if(w=="string"||w=="number"||w=="atom")return L(Pn);if(w=="[")return L(ge("]"),Rt(Ue,"]",","),qe,Pn);if(w=="{")return L(ge("}"),xi,qe,Pn);if(w=="(")return L(Rt(ki,")"),Bt,Pn);if(w=="<")return L(Rt(Ue,">"),Ue);if(w=="quasi")return U(rr,Pn)}function Bt(w){if(w=="=>")return L(Ue)}function xi(w){return w.match(/[\}\)\]]/)?L():w==","||w==";"?L(xi):U(en,xi)}function en(w,D){if(w=="variable"||W.style=="keyword")return W.marked="property",L(en);if(D=="?"||w=="number"||w=="string")return L(en);if(w==":")return L(Ue);if(w=="[")return L(et("variable"),Be,et("]"),en);if(w=="(")return U(Dn,en);if(!w.match(/[;\}\)\],]/))return L()}function rr(w,D){return w!="quasi"?U():D.slice(D.length-2)!="${"?L(rr):L(Ue,nn)}function nn(w){if(w=="}")return W.marked="string-2",W.state.tokenize=N,L(rr)}function ki(w,D){return w=="variable"&&W.stream.match(/^\s*[?:]/,!1)||D=="?"?L(ki):w==":"?L(Ue):w=="spread"?L(ki):U(Ue)}function Pn(w,D){if(D=="<")return L(ge(">"),Rt(Ue,">"),qe,Pn);if(D=="|"||w=="."||D=="&")return L(Ue);if(w=="[")return L(Ue,et("]"),Pn);if(D=="extends"||D=="implements")return W.marked="keyword",L(Ue);if(D=="?")return L(Ue,et(":"),Ue)}function Zr(w,D){if(D=="<")return L(ge(">"),Rt(Ue,">"),qe,Pn)}function Or(){return U(Ue,As)}function As(w,D){if(D=="=")return L(Ue)}function mo(w,D){return D=="enum"?(W.marked="keyword",L(sr)):U(hn,mr,ir,yo)}function hn(w,D){if(m&&yt(D))return W.marked="keyword",L(hn);if(w=="variable")return X(D),L();if(w=="spread")return L(hn);if(w=="[")return Qr(vo,"]");if(w=="{")return Qr(Os,"}")}function Os(w,D){return w=="variable"&&!W.stream.match(/^\s*:/,!1)?(X(D),L(ir)):(w=="variable"&&(W.marked="property"),w=="spread"?L(hn):w=="}"?U():w=="["?L(Ge,et("]"),et(":"),Os):L(et(":"),hn,ir))}function vo(){return U(hn,ir)}function ir(w,D){if(D=="=")return L(Vt)}function yo(w){if(w==",")return L(mo)}function Ns(w,D){if(w=="keyword b"&&D=="else")return L(ge("form","else"),ft,qe)}function Ps(w,D){if(D=="await")return L(Ps);if(w=="(")return L(ge(")"),bo,qe)}function bo(w){return w=="var"?L(mo,Nr):w=="variable"?L(Nr):U(Nr)}function Nr(w,D){return w==")"?L():w==";"?L(Nr):D=="in"||D=="of"?(W.marked="keyword",L(Ge,Nr)):U(Ge,Nr)}function Hn(w,D){if(D=="*")return W.marked="keyword",L(Hn);if(w=="variable")return X(D),L(Hn);if(w=="(")return L(Xt,ge(")"),Rt(vr,")"),qe,wi,ft,Et);if(m&&D=="<")return L(ge(">"),Rt(Or,">"),qe,Hn)}function Dn(w,D){if(D=="*")return W.marked="keyword",L(Dn);if(w=="variable")return X(D),L(Dn);if(w=="(")return L(Xt,ge(")"),Rt(vr,")"),qe,wi,Et);if(m&&D=="<")return L(ge(">"),Rt(Or,">"),qe,Dn)}function Ds(w,D){if(w=="keyword"||w=="variable")return W.marked="type",L(Ds);if(D=="<")return L(ge(">"),Rt(Or,">"),qe)}function vr(w,D){return D=="@"&&L(Ge,vr),w=="spread"?L(vr):m&&yt(D)?(W.marked="keyword",L(vr)):m&&w=="this"?L(mr,ir):U(hn,mr,ir)}function Si(w,D){return w=="variable"?Ci(w,D):Kn(w,D)}function Ci(w,D){if(w=="variable")return X(D),L(Kn)}function Kn(w,D){if(D=="<")return L(ge(">"),Rt(Or,">"),qe,Kn);if(D=="extends"||D=="implements"||m&&w==",")return D=="implements"&&(W.marked="keyword"),L(m?Ue:Ge,Kn);if(w=="{")return L(ge("}"),Jn,qe)}function Jn(w,D){if(w=="async"||w=="variable"&&(D=="static"||D=="get"||D=="set"||m&&yt(D))&&W.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return W.marked="keyword",L(Jn);if(w=="variable"||W.style=="keyword")return W.marked="property",L(In,Jn);if(w=="number"||w=="string")return L(In,Jn);if(w=="[")return L(Ge,mr,et("]"),In,Jn);if(D=="*")return W.marked="keyword",L(Jn);if(m&&w=="(")return U(Dn,Jn);if(w==";"||w==",")return L(Jn);if(w=="}")return L();if(D=="@")return L(Ge,Jn)}function In(w,D){if(D=="!"||D=="?")return L(In);if(w==":")return L(Ue,ir);if(D=="=")return L(Vt);var J=W.state.lexical.prev,ne=J&&J.info=="interface";return U(ne?Dn:Hn)}function wo(w,D){return D=="*"?(W.marked="keyword",L(Cn,et(";"))):D=="default"?(W.marked="keyword",L(Ge,et(";"))):w=="{"?L(Rt(xo,"}"),Cn,et(";")):U(ft)}function xo(w,D){if(D=="as")return W.marked="keyword",L(et("variable"));if(w=="variable")return U(Vt,xo)}function jt(w){return w=="string"?L():w=="("?U(Ge):w=="."?U(gt):U(de,or,Cn)}function de(w,D){return w=="{"?Qr(de,"}"):(w=="variable"&&X(D),D=="*"&&(W.marked="keyword"),L(ko))}function or(w){if(w==",")return L(de,or)}function ko(w,D){if(D=="as")return W.marked="keyword",L(de)}function Cn(w,D){if(D=="from")return W.marked="keyword",L(Ge)}function mt(w){return w=="]"?L():U(Rt(Vt,"]"))}function sr(){return U(ge("form"),hn,et("{"),ge("}"),Rt(Xr,"}"),qe,qe)}function Xr(){return U(hn,ir)}function So(w,D){return w.lastType=="operator"||w.lastType==","||S.test(D.charAt(0))||/[,.]/.test(D.charAt(0))}function ee(w,D,J){return D.tokenize==_&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(D.lastType)||D.lastType=="quasi"&&/\{\s*$/.test(w.string.slice(0,w.pos-(J||0)))}return{startState:function(w){var D={tokenize:_,lastType:"sof",cc:[],lexical:new q((w||0)-o,0,"block",!1),localVars:i.localVars,context:i.localVars&&new _t(null,null,!1),indented:w||0};return i.globalVars&&typeof i.globalVars=="object"&&(D.globalVars=i.globalVars),D},token:function(w,D){if(w.sol()&&(D.lexical.hasOwnProperty("align")||(D.lexical.align=!1),D.indented=w.indentation(),j(w,D)),D.tokenize!=I&&w.eatSpace())return null;var J=D.tokenize(w,D);return O=="comment"?J:(D.lastType=O=="operator"&&(E=="++"||E=="--")?"incdec":O,te(D,J,O,E,w))},indent:function(w,D){if(w.tokenize==I||w.tokenize==N)return n.Pass;if(w.tokenize!=_)return 0;var J=D&&D.charAt(0),ne=w.lexical,Ve;if(!/^\s*else\b/.test(D))for(var ct=w.cc.length-1;ct>=0;--ct){var le=w.cc[ct];if(le==qe)ne=ne.prev;else if(le!=Ns&&le!=Et)break}for(;(ne.type=="stat"||ne.type=="form")&&(J=="}"||(Ve=w.cc[w.cc.length-1])&&(Ve==gt||Ve==Gt)&&!/^[,\.=+\-*:?[\(]/.test(D));)ne=ne.prev;u&&ne.type==")"&&ne.prev.type=="stat"&&(ne=ne.prev);var rn=ne.type,_n=J==rn;return rn=="vardef"?ne.indented+(w.lastType=="operator"||w.lastType==","?ne.info.length+1:0):rn=="form"&&J=="{"?ne.indented:rn=="form"?ne.indented+o:rn=="stat"?ne.indented+(So(w,D)?u||o:0):ne.info=="switch"&&!_n&&i.doubleIndentSwitch!=!1?ne.indented+(/^(?:case|default)\b/.test(D)?o:2*o):ne.align?ne.column+(_n?0:1):ne.indented+(_n?0:o)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:f?null:"/*",blockCommentEnd:f?null:"*/",blockCommentContinue:f?null:" * ",lineComment:f?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:f?"json":"javascript",jsonldMode:c,jsonMode:f,expressionAllowed:ee,skipExpression:function(w){te(w,"atom","atom","true",new n.StringStream("",2,null))}}}),n.registerHelper("wordChars","javascript",/[\w$]/),n.defineMIME("text/javascript","javascript"),n.defineMIME("text/ecmascript","javascript"),n.defineMIME("application/javascript","javascript"),n.defineMIME("application/x-javascript","javascript"),n.defineMIME("application/ecmascript","javascript"),n.defineMIME("application/json",{name:"javascript",json:!0}),n.defineMIME("application/x-json",{name:"javascript",json:!0}),n.defineMIME("application/manifest+json",{name:"javascript",json:!0}),n.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),n.defineMIME("text/typescript",{name:"javascript",typescript:!0}),n.defineMIME("application/typescript",{name:"javascript",typescript:!0})})});var ba=It((X6,dg)=>{function X1(n,t){switch(n.charCodeAt(t)){default:return 0;case 10:return 1;case 13:return t+1<n.length&&n.charCodeAt(t+1)===10?2:1}}dg.exports={newLineLength:X1}});var hg=It((eT,pg)=>{var{newLineLength:e0}=ba();pg.exports=(n,t)=>{let i=1,o=0;for(let u=0;u<n.length;u++){let c=e0(n,u);c!==0&&(t(o,u+c,i++),o=u+c,u+=c-1)}t(o,n.length,i++)}});var mg=It((tT,gg)=>{var{newLineLength:t0}=ba();gg.exports=(n,t)=>{let i=1,o=0;for(let u=0;u<n.length;u++){let c=t0(n,u);c!==0&&(t(o,u,i++),o=u+c,u+=c-1)}t(o,n.length,i++)}});var yg=It((nT,vg)=>{vg.exports=function(n){if(n instanceof RegExp){let t=n.flags.indexOf("g")!==-1?n.flags:n.flags+"g",i=new RegExp(n,t);return function(o,u){let c;for(;c=i.exec(o);)u(c.index,c.index+c[0].length)}}return n=String(n),function(t,i){let o=-1;for(;o=t.indexOf(n,o+1),o!==-1;)i(o,o+n.length)}}});var wg=It((rT,bg)=>{var{newLineLength:n0}=ba();bg.exports=(n,t)=>{let i=1;for(let o=0;o<n.length;o++){let u=n0(n,o);u!==0&&(t(o,o+u,i++),o+=u-1)}}});var kg=It((iT,xg)=>{xg.exports={lines:hg(),lineContents:mg(),matches:yg(),newlines:wg()}});var wa=It((oT,Tg)=>{function Sg(n){return Pu.call(null,n)}function Pu(n){let t=this===window?{}:this||{},i={};return Object.assign(i,t,n,{fork:Pu.bind(i),ranges:Object.assign({},t.ranges,n&&n.ranges)}),typeof i.createHook!="function"&&(i.createHook=o=>o()),i}function Cg(n){let t=Object.assign({},this);for(let i in n){let o=n[i];if(!(!o||typeof o!="object"))if(hasOwnProperty.call(t,i)){let u=t[i];t[i]=u&&typeof u.fork=="function"?u.fork(n[i]):u}else t[i]=Sg(n[i])}return t.fork=Cg.bind(t),t}Tg.exports={createPrinter:Sg,forkPrinter:Pu,forkPrinterSet:Cg}});var Du=It((sT,Lg)=>{Lg.exports=wa().createPrinter()});var Mg=It((aT,Eg)=>{var{createPrinter:r0}=wa();Eg.exports=r0({print:n=>n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")})});var Og=It((lT,Ag)=>{var{forkPrinterSet:i0}=wa();Ag.exports=i0.call({},{noop:Du(),html:Mg(),tty:Du()})});var Pg=It((uT,Ng)=>{Ng.exports=function(t,i){let o=[];return i.forEach(({generate:u,marker:c})=>u(t,(f,p,m)=>o.push({type:c,start:f,end:p,data:m}))),o}});var Ig=It((cT,Dg)=>{var xa=()=>"",o0=function(){};function hi(n,t){return typeof n=="function"?n:t||o0}Dg.exports=function(t,i,o){let u=hi(o.print,I=>I),c=Object.assign(Object.defineProperties(Object.create(null),{offset:{get:()=>S},line:{get:()=>k},column:{get:()=>T},start:{get:()=>p.start},end:{get:()=>p.end},data:{get:()=>p.data}}),hi(o.createContext)()),f=[],p={start:0,end:t.length},m=o.ranges||{},y=[],x=1/0,S=0,k=1,T=1,O="";O+=hi(o.open,xa)(c),m=[].concat(Object.getOwnPropertyNames(m),Object.getOwnPropertySymbols(m)).reduce((I,N)=>{let R=m[N];return typeof R=="function"&&(m[N]=R=o.createHook(R)),R&&(y.push(N),I[N]={open:hi(R.open,xa),close:hi(R.close,xa),print:hi(R.print,u)}),I},{}),i=i.slice().sort((I,N)=>I.start-N.start||N.end-I.end||y.indexOf(I.type)-y.indexOf(N.type));let E=I=>m[(p=f[I]).type].open(c)||"",M=I=>m[(p=f[I]).type].close(c)||"",_=I=>{if(S!==I){let N=t.substring(S,I),R=f.length?m[f[f.length-1].type].print:u;for(let j=S;j<I;j++){let F=t.charCodeAt(j);F===10||F===13&&(j>=t.length||t.charCodeAt(j+1)!==10)?(k++,T=1):T++}O+=R(N,c),S=I}},C=I=>{for(;x<=I;){_(x);for(let N=f.length-1;N>=0&&f[N].end===x;N--)O+=M(N),f.pop();x=1/0;for(let N=0;N<f.length;N++)f[N].end<x&&(x=f[N].end)}};for(let I=0;I<i.length;I++){let N=i[I],R=0;if(m.hasOwnProperty(N.type)!==!1&&!(N.start>N.end||!Number.isFinite(N.start)||!Number.isFinite(N.end))){for(C(N.start),_(N.start),R=0;R<f.length;R++)if(f[R].end<N.end){for(let j=f.length-1;j>=R;j--)O+=M(j);break}for(f.splice(R,0,N);R<f.length;R++)O+=E(R);N.end<x&&(x=N.end)}}C(t.length),_(t.length);for(let I=f.length-1;I>=0;I--)O+=M(I);return O+=hi(o.close,xa)(c)||"",O}});var jg=It((fT,Rg)=>{var s0=kg(),Ru=Og(),_g=Pg(),a0=Ig();function l0(n,t){return{marker:n,generate:t}}function u0(n,t){let i={};for(let o in t)i[o]={ranges:{[n]:t[o]}};return i}function _u(n,t,i){let o=(u,c)=>{let f=t[c||i]||Ru.noop,p=_g(u,n);return a0(u,p,f)};return Object.assign(o,{print:o,generateRanges(u){return _g(u,n)},use(u,c){let f=Symbol(u.name),p=u.ranges||u,m=Array.isArray(p)?(y,x)=>p.forEach(S=>x(...S)):p;return typeof m!="function"||(c||(c=u.printer),!c)?o:_u(n.concat(l0(f,m)),t.fork(u0(f,c)),i)},printer(u){return _u(n,t,u)}})}function Iu(n,t,i){let o=_u([],i||Ru,t);return Array.isArray(n)&&(o=n.reduce((u,c)=>Array.isArray(c)?u.use(...c):u.use(c),o)),o}Rg.exports=Object.assign(Iu,{gen:s0,printer:Object.assign((...n)=>Iu().printer(...n),Ru),use(...n){return Iu().use(...n)}})});var Hg=It((zg,Fg)=>{(function(n){typeof zg=="object"&&typeof Fg=="object"?n(Cr()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("css",function(q,H){var te=H.inline;H.propertyKeywords||(H=n.resolveMode("text/css"));var W=q.indentUnit,U=H.tokenHooks,L=H.documentTypes||{},Z=H.mediaTypes||{},X=H.mediaFeatures||{},he=H.mediaValueKeywords||{},yt=H.propertyKeywords||{},_t=H.nonStandardPropertyKeywords||{},An=H.fontProperties||{},Kr=H.counterDescriptors||{},Xt=H.colorKeywords||{},qt=H.valueKeywords||{},Et=H.allowNested,ge=H.lineComment,qe=H.supportsAtComponent===!0,et=q.highlightNonStandardPropertyKeywords!==!1,ft,it;function Ge($,ie){return ft=ie,$}function Vt($,ie){var Y=$.next();if(U[Y]){var ot=U[Y]($,ie);if(ot!==!1)return ot}if(Y=="@")return $.eatWhile(/[\w\\\-]/),Ge("def",$.current());if(Y=="="||(Y=="~"||Y=="|")&&$.eat("="))return Ge(null,"compare");if(Y=='"'||Y=="'")return ie.tokenize=Yn(Y),ie.tokenize($,ie);if(Y=="#")return $.eatWhile(/[\w\\\-]/),Ge("atom","hash");if(Y=="!")return $.match(/^\s*\w*/),Ge("keyword","important");if(/\d/.test(Y)||Y=="."&&$.eat(/\d/))return $.eatWhile(/[\w.%]/),Ge("number","unit");if(Y==="-"){if(/[\d.]/.test($.peek()))return $.eatWhile(/[\w.%]/),Ge("number","unit");if($.match(/^-[\w\\\-]*/))return $.eatWhile(/[\w\\\-]/),$.match(/^\s*:/,!1)?Ge("variable-2","variable-definition"):Ge("variable-2","variable");if($.match(/^\w+-/))return Ge("meta","meta")}else return/[,+>*\/]/.test(Y)?Ge(null,"select-op"):Y=="."&&$.match(/^-?[_a-z][_a-z0-9-]*/i)?Ge("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(Y)?Ge(null,Y):$.match(/^[\w-.]+(?=\()/)?(/^(url(-prefix)?|domain|regexp)$/i.test($.current())&&(ie.tokenize=Ar),Ge("variable callee","variable")):/[\w\\\-]/.test(Y)?($.eatWhile(/[\w\\\-]/),Ge("property","word")):Ge(null,null)}function Yn($){return function(ie,Y){for(var ot=!1,ln;(ln=ie.next())!=null;){if(ln==$&&!ot){$==")"&&ie.backUp(1);break}ot=!ot&&ln=="\\"}return(ln==$||!ot&&$!=")")&&(Y.tokenize=null),Ge("string","string")}}function Ar($,ie){return $.next(),$.match(/^\s*[\"\')]/,!1)?ie.tokenize=null:ie.tokenize=Yn(")"),Ge(null,"(")}function tt($,ie,Y){this.type=$,this.indent=ie,this.prev=Y}function gt($,ie,Y,ot){return $.context=new tt(Y,ie.indentation()+(ot===!1?0:W),$.context),Y}function Gt($){return $.context.prev&&($.context=$.context.prev),$.context.type}function On($,ie,Y){return Ct[Y.context.type]($,ie,Y)}function Fn($,ie,Y,ot){for(var ln=ot||1;ln>0;ln--)Y.context=Y.context.prev;return On($,ie,Y)}function Jr($){var ie=$.current().toLowerCase();qt.hasOwnProperty(ie)?it="atom":Xt.hasOwnProperty(ie)?it="keyword":it="variable"}var Ct={};return Ct.top=function($,ie,Y){if($=="{")return gt(Y,ie,"block");if($=="}"&&Y.context.prev)return Gt(Y);if(qe&&/@component/i.test($))return gt(Y,ie,"atComponentBlock");if(/^@(-moz-)?document$/i.test($))return gt(Y,ie,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/i.test($))return gt(Y,ie,"atBlock");if(/^@(font-face|counter-style)/i.test($))return Y.stateArg=$,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test($))return"keyframes";if($&&$.charAt(0)=="@")return gt(Y,ie,"at");if($=="hash")it="builtin";else if($=="word")it="tag";else{if($=="variable-definition")return"maybeprop";if($=="interpolation")return gt(Y,ie,"interpolation");if($==":")return"pseudo";if(Et&&$=="(")return gt(Y,ie,"parens")}return Y.context.type},Ct.block=function($,ie,Y){if($=="word"){var ot=ie.current().toLowerCase();return yt.hasOwnProperty(ot)?(it="property","maybeprop"):_t.hasOwnProperty(ot)?(it=et?"string-2":"property","maybeprop"):Et?(it=ie.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(it+=" error","maybeprop")}else return $=="meta"?"block":!Et&&($=="hash"||$=="qualifier")?(it="error","block"):Ct.top($,ie,Y)},Ct.maybeprop=function($,ie,Y){return $==":"?gt(Y,ie,"prop"):On($,ie,Y)},Ct.prop=function($,ie,Y){if($==";")return Gt(Y);if($=="{"&&Et)return gt(Y,ie,"propBlock");if($=="}"||$=="{")return Fn($,ie,Y);if($=="(")return gt(Y,ie,"parens");if($=="hash"&&!/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(ie.current()))it+=" error";else if($=="word")Jr(ie);else if($=="interpolation")return gt(Y,ie,"interpolation");return"prop"},Ct.propBlock=function($,ie,Y){return $=="}"?Gt(Y):$=="word"?(it="property","maybeprop"):Y.context.type},Ct.parens=function($,ie,Y){return $=="{"||$=="}"?Fn($,ie,Y):$==")"?Gt(Y):$=="("?gt(Y,ie,"parens"):$=="interpolation"?gt(Y,ie,"interpolation"):($=="word"&&Jr(ie),"parens")},Ct.pseudo=function($,ie,Y){return $=="meta"?"pseudo":$=="word"?(it="variable-3",Y.context.type):On($,ie,Y)},Ct.documentTypes=function($,ie,Y){return $=="word"&&L.hasOwnProperty(ie.current())?(it="tag",Y.context.type):Ct.atBlock($,ie,Y)},Ct.atBlock=function($,ie,Y){if($=="(")return gt(Y,ie,"atBlock_parens");if($=="}"||$==";")return Fn($,ie,Y);if($=="{")return Gt(Y)&&gt(Y,ie,Et?"block":"top");if($=="interpolation")return gt(Y,ie,"interpolation");if($=="word"){var ot=ie.current().toLowerCase();ot=="only"||ot=="not"||ot=="and"||ot=="or"?it="keyword":Z.hasOwnProperty(ot)?it="attribute":X.hasOwnProperty(ot)?it="property":he.hasOwnProperty(ot)?it="keyword":yt.hasOwnProperty(ot)?it="property":_t.hasOwnProperty(ot)?it=et?"string-2":"property":qt.hasOwnProperty(ot)?it="atom":Xt.hasOwnProperty(ot)?it="keyword":it="error"}return Y.context.type},Ct.atComponentBlock=function($,ie,Y){return $=="}"?Fn($,ie,Y):$=="{"?Gt(Y)&&gt(Y,ie,Et?"block":"top",!1):($=="word"&&(it="error"),Y.context.type)},Ct.atBlock_parens=function($,ie,Y){return $==")"?Gt(Y):$=="{"||$=="}"?Fn($,ie,Y,2):Ct.atBlock($,ie,Y)},Ct.restricted_atBlock_before=function($,ie,Y){return $=="{"?gt(Y,ie,"restricted_atBlock"):$=="word"&&Y.stateArg=="@counter-style"?(it="variable","restricted_atBlock_before"):On($,ie,Y)},Ct.restricted_atBlock=function($,ie,Y){return $=="}"?(Y.stateArg=null,Gt(Y)):$=="word"?(Y.stateArg=="@font-face"&&!An.hasOwnProperty(ie.current().toLowerCase())||Y.stateArg=="@counter-style"&&!Kr.hasOwnProperty(ie.current().toLowerCase())?it="error":it="property","maybeprop"):"restricted_atBlock"},Ct.keyframes=function($,ie,Y){return $=="word"?(it="variable","keyframes"):$=="{"?gt(Y,ie,"top"):On($,ie,Y)},Ct.at=function($,ie,Y){return $==";"?Gt(Y):$=="{"||$=="}"?Fn($,ie,Y):($=="word"?it="tag":$=="hash"&&(it="builtin"),"at")},Ct.interpolation=function($,ie,Y){return $=="}"?Gt(Y):$=="{"||$==";"?Fn($,ie,Y):($=="word"?it="variable":$!="variable"&&$!="("&&$!=")"&&(it="error"),"interpolation")},{startState:function($){return{tokenize:null,state:te?"block":"top",stateArg:null,context:new tt(te?"block":"top",$||0,null)}},token:function($,ie){if(!ie.tokenize&&$.eatSpace())return null;var Y=(ie.tokenize||Vt)($,ie);return Y&&typeof Y=="object"&&(ft=Y[1],Y=Y[0]),it=Y,ft!="comment"&&(ie.state=Ct[ie.state](ft,$,ie)),it},indent:function($,ie){var Y=$.context,ot=ie&&ie.charAt(0),ln=Y.indent;return Y.type=="prop"&&(ot=="}"||ot==")")&&(Y=Y.prev),Y.prev&&(ot=="}"&&(Y.type=="block"||Y.type=="top"||Y.type=="interpolation"||Y.type=="restricted_atBlock")?(Y=Y.prev,ln=Y.indent):(ot==")"&&(Y.type=="parens"||Y.type=="atBlock_parens")||ot=="{"&&(Y.type=="at"||Y.type=="atBlock"))&&(ln=Math.max(0,Y.indent-W))),ln},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:ge,fold:"brace"}});function t(q){for(var H={},te=0;te<q.length;++te)H[q[te].toLowerCase()]=!0;return H}var i=["domain","regexp","url","url-prefix"],o=t(i),u=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],c=t(u),f=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover","prefers-color-scheme","dynamic-range","video-dynamic-range"],p=t(f),m=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive","dark","light","standard","high"],y=t(m),x=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","all","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","binding","bleed","block-size","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-content","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-height-step","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotate","rotation","rotation-point","row-gap","ruby-align","ruby-overhang","ruby-position","ruby-span","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-type","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-orientation","text-outline","text-overflow","text-rendering","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","touch-action","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","paint-order","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],S=t(x),k=["accent-color","aspect-ratio","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","content-visibility","margin-block","margin-block-end","margin-block-start","margin-inline","margin-inline-end","margin-inline-start","overflow-anchor","overscroll-behavior","padding-block","padding-block-end","padding-block-start","padding-inline","padding-inline-end","padding-inline-start","scroll-snap-stop","scrollbar-3d-light-color","scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-track-color","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","shape-inside","zoom"],T=t(k),O=["font-display","font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],E=t(O),M=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],_=t(M),C=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],I=t(C),N=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","blur","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","brightness","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","conic-gradient","contain","content","contents","content-box","context-menu","continuous","contrast","copy","counter","counters","cover","crop","cross","crosshair","cubic-bezier","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","drop-shadow","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","grayscale","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","hue-rotate","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","manipulation","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiple_mask_images","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeating-conic-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturate","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","sepia","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],R=t(N),j=i.concat(u).concat(f).concat(m).concat(x).concat(k).concat(C).concat(N);n.registerHelper("hintWords","css",j);function F(q,H){for(var te=!1,W;(W=q.next())!=null;){if(te&&W=="/"){H.tokenize=null;break}te=W=="*"}return["comment","comment"]}n.defineMIME("text/css",{documentTypes:o,mediaTypes:c,mediaFeatures:p,mediaValueKeywords:y,propertyKeywords:S,nonStandardPropertyKeywords:T,fontProperties:E,counterDescriptors:_,colorKeywords:I,valueKeywords:R,tokenHooks:{"/":function(q,H){return q.eat("*")?(H.tokenize=F,F(q,H)):!1}},name:"css"}),n.defineMIME("text/x-scss",{mediaTypes:c,mediaFeatures:p,mediaValueKeywords:y,propertyKeywords:S,nonStandardPropertyKeywords:T,colorKeywords:I,valueKeywords:R,fontProperties:E,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(q,H){return q.eat("/")?(q.skipToEnd(),["comment","comment"]):q.eat("*")?(H.tokenize=F,F(q,H)):["operator","operator"]},":":function(q){return q.match(/^\s*\{/,!1)?[null,null]:!1},$:function(q){return q.match(/^[\w-]+/),q.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(q){return q.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),n.defineMIME("text/x-less",{mediaTypes:c,mediaFeatures:p,mediaValueKeywords:y,propertyKeywords:S,nonStandardPropertyKeywords:T,colorKeywords:I,valueKeywords:R,fontProperties:E,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(q,H){return q.eat("/")?(q.skipToEnd(),["comment","comment"]):q.eat("*")?(H.tokenize=F,F(q,H)):["operator","operator"]},"@":function(q){return q.eat("{")?[null,"interpolation"]:q.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,!1)?!1:(q.eatWhile(/[\w\\\-]/),q.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),n.defineMIME("text/x-gss",{documentTypes:o,mediaTypes:c,mediaFeatures:p,propertyKeywords:S,nonStandardPropertyKeywords:T,fontProperties:E,counterDescriptors:_,colorKeywords:I,valueKeywords:R,supportsAtComponent:!0,tokenHooks:{"/":function(q,H){return q.eat("*")?(H.tokenize=F,F(q,H)):!1}},name:"css",helperType:"gss"})})});var $g=It((Bg,Wg)=>{(function(n){typeof Bg=="object"&&typeof Wg=="object"?n(Cr()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},i={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};n.defineMode("xml",function(o,u){var c=o.indentUnit,f={},p=u.htmlMode?t:i;for(var m in p)f[m]=p[m];for(var m in u)f[m]=u[m];var y,x;function S(L,Z){function X(_t){return Z.tokenize=_t,_t(L,Z)}var he=L.next();if(he=="<")return L.eat("!")?L.eat("[")?L.match("CDATA[")?X(O("atom","]]>")):null:L.match("--")?X(O("comment","-->")):L.match("DOCTYPE",!0,!0)?(L.eatWhile(/[\w\._\-]/),X(E(1))):null:L.eat("?")?(L.eatWhile(/[\w\._\-]/),Z.tokenize=O("meta","?>"),"meta"):(y=L.eat("/")?"closeTag":"openTag",Z.tokenize=k,"tag bracket");if(he=="&"){var yt;return L.eat("#")?L.eat("x")?yt=L.eatWhile(/[a-fA-F\d]/)&&L.eat(";"):yt=L.eatWhile(/[\d]/)&&L.eat(";"):yt=L.eatWhile(/[\w\.\-:]/)&&L.eat(";"),yt?"atom":"error"}else return L.eatWhile(/[^&<]/),null}S.isInText=!0;function k(L,Z){var X=L.next();if(X==">"||X=="/"&&L.eat(">"))return Z.tokenize=S,y=X==">"?"endTag":"selfcloseTag","tag bracket";if(X=="=")return y="equals",null;if(X=="<"){Z.tokenize=S,Z.state=N,Z.tagName=Z.tagStart=null;var he=Z.tokenize(L,Z);return he?he+" tag error":"tag error"}else return/[\'\"]/.test(X)?(Z.tokenize=T(X),Z.stringStartCol=L.column(),Z.tokenize(L,Z)):(L.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function T(L){var Z=function(X,he){for(;!X.eol();)if(X.next()==L){he.tokenize=k;break}return"string"};return Z.isInAttribute=!0,Z}function O(L,Z){return function(X,he){for(;!X.eol();){if(X.match(Z)){he.tokenize=S;break}X.next()}return L}}function E(L){return function(Z,X){for(var he;(he=Z.next())!=null;){if(he=="<")return X.tokenize=E(L+1),X.tokenize(Z,X);if(he==">")if(L==1){X.tokenize=S;break}else return X.tokenize=E(L-1),X.tokenize(Z,X)}return"meta"}}function M(L){return L&&L.toLowerCase()}function _(L,Z,X){this.prev=L.context,this.tagName=Z||"",this.indent=L.indented,this.startOfLine=X,(f.doNotIndent.hasOwnProperty(Z)||L.context&&L.context.noIndent)&&(this.noIndent=!0)}function C(L){L.context&&(L.context=L.context.prev)}function I(L,Z){for(var X;;){if(!L.context||(X=L.context.tagName,!f.contextGrabbers.hasOwnProperty(M(X))||!f.contextGrabbers[M(X)].hasOwnProperty(M(Z))))return;C(L)}}function N(L,Z,X){return L=="openTag"?(X.tagStart=Z.column(),R):L=="closeTag"?j:N}function R(L,Z,X){return L=="word"?(X.tagName=Z.current(),x="tag",H):f.allowMissingTagName&&L=="endTag"?(x="tag bracket",H(L,Z,X)):(x="error",R)}function j(L,Z,X){if(L=="word"){var he=Z.current();return X.context&&X.context.tagName!=he&&f.implicitlyClosed.hasOwnProperty(M(X.context.tagName))&&C(X),X.context&&X.context.tagName==he||f.matchClosing===!1?(x="tag",F):(x="tag error",q)}else return f.allowMissingTagName&&L=="endTag"?(x="tag bracket",F(L,Z,X)):(x="error",q)}function F(L,Z,X){return L!="endTag"?(x="error",F):(C(X),N)}function q(L,Z,X){return x="error",F(L,Z,X)}function H(L,Z,X){if(L=="word")return x="attribute",te;if(L=="endTag"||L=="selfcloseTag"){var he=X.tagName,yt=X.tagStart;return X.tagName=X.tagStart=null,L=="selfcloseTag"||f.autoSelfClosers.hasOwnProperty(M(he))?I(X,he):(I(X,he),X.context=new _(X,he,yt==X.indented)),N}return x="error",H}function te(L,Z,X){return L=="equals"?W:(f.allowMissing||(x="error"),H(L,Z,X))}function W(L,Z,X){return L=="string"?U:L=="word"&&f.allowUnquoted?(x="string",H):(x="error",H(L,Z,X))}function U(L,Z,X){return L=="string"?U:H(L,Z,X)}return{startState:function(L){var Z={tokenize:S,state:N,indented:L||0,tagName:null,tagStart:null,context:null};return L!=null&&(Z.baseIndent=L),Z},token:function(L,Z){if(!Z.tagName&&L.sol()&&(Z.indented=L.indentation()),L.eatSpace())return null;y=null;var X=Z.tokenize(L,Z);return(X||y)&&X!="comment"&&(x=null,Z.state=Z.state(y||X,L,Z),x&&(X=x=="error"?X+" error":x)),X},indent:function(L,Z,X){var he=L.context;if(L.tokenize.isInAttribute)return L.tagStart==L.indented?L.stringStartCol+1:L.indented+c;if(he&&he.noIndent)return n.Pass;if(L.tokenize!=k&&L.tokenize!=S)return X?X.match(/^(\s*)/)[0].length:0;if(L.tagName)return f.multilineTagIndentPastTag!==!1?L.tagStart+L.tagName.length+2:L.tagStart+c*(f.multilineTagIndentFactor||1);if(f.alignCDATA&&/<!\[CDATA\[/.test(Z))return 0;var yt=Z&&/^<(\/)?([\w_:\.-]*)/.exec(Z);if(yt&&yt[1])for(;he;)if(he.tagName==yt[2]){he=he.prev;break}else if(f.implicitlyClosed.hasOwnProperty(M(he.tagName)))he=he.prev;else break;else if(yt)for(;he;){var _t=f.contextGrabbers[M(he.tagName)];if(_t&&_t.hasOwnProperty(M(yt[2])))he=he.prev;else break}for(;he&&he.prev&&!he.startOfLine;)he=he.prev;return he?he.indent+c:L.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:f.htmlMode?"html":"xml",helperType:f.htmlMode?"html":"xml",skipAttribute:function(L){L.state==W&&(L.state=H)},xmlCurrentTag:function(L){return L.tagName?{name:L.tagName,close:L.type=="closeTag"}:null},xmlCurrentContext:function(L){for(var Z=[],X=L.context;X;X=X.prev)Z.push(X.tagName);return Z.reverse()}}}),n.defineMIME("text/xml","xml"),n.defineMIME("application/xml","xml"),n.mimeModes.hasOwnProperty("text/html")||n.defineMIME("text/html",{name:"xml",htmlMode:!0})})});var Kg=It((ST,Yg)=>{Yg.exports="0.5.7"});var zu=It((CT,Qg)=>{var v0={8:"\\b",9:"\\t",10:"\\n",12:"\\f",13:"\\r",34:'\\"',92:"\\\\"};function y0(n){return n>=55296&&n<=56319}function b0(n){return n>=56320&&n<=57343}function Jg(n){return typeof n.pipe=="function"&&typeof n._read=="function"&&typeof n._readableState=="object"&&n._readableState!==null}function w0(n,t,i,o){switch(i&&typeof i.toJSON=="function"&&(i=i.toJSON()),o!==null&&(i=o.call(n,String(t),i)),typeof i){case"function":case"symbol":i=void 0;break;case"object":if(i!==null){let u=i.constructor;(u===String||u===Number||u===Boolean)&&(i=i.valueOf())}break}return i}function x0(n){return n===null||typeof n!="object"?1:Array.isArray(n)?3:2}function k0(n){return n===null||typeof n!="object"?1:typeof n.then=="function"?4:Jg(n)?n._readableState.objectMode?6:5:Array.isArray(n)?3:2}function S0(n){return typeof n=="function"?n:Array.isArray(n)?[...new Set(n.map(i=>{let o=i&&i.constructor;return o===String||o===Number?String(i):null}).filter(i=>typeof i=="string"))]:null}function C0(n){return typeof n=="number"?!Number.isFinite(n)||n<1?!1:" ".repeat(Math.min(n,10)):typeof n=="string"&&n.slice(0,10)||!1}Qg.exports={escapableCharCodeSubstitution:v0,isLeadingSurrogate:y0,isTrailingSurrogate:b0,type:{PRIMITIVE:1,PROMISE:4,ARRAY:3,OBJECT:2,STRING_STREAM:5,OBJECT_STREAM:6},isReadableStream:Jg,replaceValue:w0,getTypeNative:x0,getTypeAsync:k0,normalizeReplacer:S0,normalizeSpace:C0}});var tm=It((TT,em)=>{var{normalizeReplacer:T0,normalizeSpace:L0,replaceValue:E0,getTypeNative:M0,getTypeAsync:A0,isLeadingSurrogate:O0,isTrailingSurrogate:N0,escapableCharCodeSubstitution:P0,type:{PRIMITIVE:Zg,OBJECT:D0,ARRAY:I0,PROMISE:_0,STRING_STREAM:R0,OBJECT_STREAM:j0}}=zu(),z0=Array.from({length:2048}).map((n,t)=>P0.hasOwnProperty(t)?2:t<32?6:t<128?1:2);function Xg(n){let t=0,i=!1;for(let o=0;o<n.length;o++){let u=n.charCodeAt(o);if(u<2048)t+=z0[u];else if(O0(u)){t+=6,i=!0;continue}else N0(u)?t=i?t-2:t+6:t+=3;i=!1}return t+2}function F0(n){switch(typeof n){case"string":return Xg(n);case"number":return Number.isFinite(n)?String(n).length:4;case"boolean":return n?4:5;case"undefined":case"object":return 4;default:return 0}}function H0(n){return n=L0(n),typeof n=="string"?n.length:0}em.exports=function(t,i,o,u){function c(M,_,C){if(O)return;C=E0(M,_,C,i);let I=k(C);if(I!==Zg&&m.has(C)){x.add(C),E+=4,u.continueOnCircular||(O=!0);return}switch(I){case Zg:C!==void 0||Array.isArray(M)?E+=F0(C):M===T&&(E+=9);break;case D0:{if(p.has(C)){y.add(C),E+=p.get(C);break}let N=E,R=0;E+=2,m.add(C);for(let j in C)if(hasOwnProperty.call(C,j)&&(f===null||f.has(j))){let F=E;c(C,j,C[j]),F!==E&&(E+=Xg(j)+1,R++)}R>1&&(E+=R-1),m.delete(C),o>0&&R>0&&(E+=(1+(m.size+1)*o+1)*R,E+=1+m.size*o),p.set(C,E-N);break}case I0:{if(p.has(C)){y.add(C),E+=p.get(C);break}let N=E;E+=2,m.add(C);for(let R=0;R<C.length;R++)c(C,R,C[R]);C.length>1&&(E+=C.length-1),m.delete(C),o>0&&C.length>0&&(E+=(1+(m.size+1)*o)*C.length,E+=1+m.size*o),p.set(C,E-N);break}case _0:case R0:S.add(C);break;case j0:E+=2,S.add(C);break}}let f=null;i=T0(i),Array.isArray(i)&&(f=new Set(i),i=null),o=H0(o),u=u||{};let p=new Map,m=new Set,y=new Set,x=new Set,S=new Set,k=u.async?A0:M0,T={"":t},O=!1,E=0;return c(T,"",t),{minLength:isNaN(E)?1/0:E,circular:[...x],duplicate:[...y],async:[...S]}}});var rm=It((LT,nm)=>{nm.exports=()=>{throw new Error("Method is not supported")}});var om=It((ET,im)=>{im.exports=TextDecoder});var Bu=It((MT,am)=>{var{isReadableStream:B0}=zu(),W0=om(),ds=1,$0=2,q0=new W0;function sm(n){return n!==null&&typeof n=="object"}function Fu(n,t){return n.name==="SyntaxError"&&t.jsonParseOffset&&(n.message=n.message.replace(/at position (\d+)/,(i,o)=>"at position "+(Number(o)+t.jsonParseOffset))),n}function U0(n,t){let i=n.length;n.length+=t.length;for(let o=0;o<t.length;o++)n[i+o]=t[o]}am.exports=function(n){let t=new Hu;if(sm(n)&&B0(n))return new Promise((i,o)=>{n.on("data",u=>{try{t.push(u)}catch(c){o(Fu(c,t)),t=null}}).on("error",u=>{t=null,o(u)}).on("end",()=>{try{i(t.finish())}catch(u){o(Fu(u,t))}finally{t=null}})});if(typeof n=="function"){let i=n();if(sm(i)&&(Symbol.iterator in i||Symbol.asyncIterator in i))return new Promise(async(o,u)=>{try{for await(let c of i)t.push(c);o(t.finish())}catch(c){u(Fu(c,t))}finally{t=null}})}throw new Error("Chunk emitter should be readable stream, generator, async generator or function returning an iterable object")};var Hu=class{constructor(){this.value=void 0,this.valueStack=null,this.stack=new Array(100),this.lastFlushDepth=0,this.flushDepth=0,this.stateString=!1,this.stateStringEscape=!1,this.pendingByteSeq=null,this.pendingChunk=null,this.chunkOffset=0,this.jsonParseOffset=0}parseAndAppend(t,i){this.stack[this.lastFlushDepth-1]===ds?(i&&(this.jsonParseOffset--,t="{"+t+"}"),Object.assign(this.valueStack.value,JSON.parse(t))):(i&&(this.jsonParseOffset--,t="["+t+"]"),U0(this.valueStack.value,JSON.parse(t)))}prepareAddition(t){let{value:i}=this.valueStack;if(Array.isArray(i)?i.length!==0:Object.keys(i).length!==0){if(t[0]===",")return this.jsonParseOffset++,t.slice(1);if(t[0]!=="}"&&t[0]!=="]")return this.jsonParseOffset-=3,"[[]"+t}return t}flush(t,i,o){let u=t.slice(i,o);if(this.jsonParseOffset=this.chunkOffset+i,this.pendingChunk!==null&&(u=this.pendingChunk+u,this.jsonParseOffset-=this.pendingChunk.length,this.pendingChunk=null),this.flushDepth===this.lastFlushDepth)this.flushDepth>0?this.parseAndAppend(this.prepareAddition(u),!0):(this.value=JSON.parse(u),this.valueStack={value:this.value,prev:null});else if(this.flushDepth>this.lastFlushDepth){for(let c=this.flushDepth-1;c>=this.lastFlushDepth;c--)u+=this.stack[c]===ds?"}":"]";this.lastFlushDepth===0?(this.value=JSON.parse(u),this.valueStack={value:this.value,prev:null}):this.parseAndAppend(this.prepareAddition(u),!0);for(let c=this.lastFlushDepth||1;c<this.flushDepth;c++){let f=this.valueStack.value;if(this.stack[c-1]===ds){let p;for(p in f);f=f[p]}else f=f[f.length-1];this.valueStack={value:f,prev:this.valueStack}}}else{u=this.prepareAddition(u);for(let c=this.lastFlushDepth-1;c>=this.flushDepth;c--)this.jsonParseOffset--,u=(this.stack[c]===ds?"{":"[")+u;this.parseAndAppend(u,!1);for(let c=this.lastFlushDepth-1;c>=this.flushDepth;c--)this.valueStack=this.valueStack.prev}this.lastFlushDepth=this.flushDepth}push(t){if(typeof t!="string"){if(this.pendingByteSeq!==null){let c=t;t=new Uint8Array(this.pendingByteSeq.length+c.length),t.set(this.pendingByteSeq),t.set(c,this.pendingByteSeq.length),this.pendingByteSeq=null}if(t[t.length-1]>127)for(let c=0;c<t.length;c++){let f=t[t.length-1-c];if(f>>6===3){c++,(c!==4&&f>>3===30||c!==3&&f>>4===14||c!==2&&f>>5===6)&&(this.pendingByteSeq=t.slice(t.length-c),t=t.slice(0,-c));break}}t=q0.decode(t)}let i=t.length,o=0,u=0;e:for(let c=0;c<i;c++){if(this.stateString){for(;c<i;c++)if(this.stateStringEscape)this.stateStringEscape=!1;else switch(t.charCodeAt(c)){case 34:this.stateString=!1;continue e;case 92:this.stateStringEscape=!0}break}switch(t.charCodeAt(c)){case 34:this.stateString=!0,this.stateStringEscape=!1;break;case 44:u=c;break;case 123:u=c+1,this.stack[this.flushDepth++]=ds;break;case 91:u=c+1,this.stack[this.flushDepth++]=$0;break;case 93:case 125:u=c+1,this.flushDepth--,this.flushDepth<this.lastFlushDepth&&(this.flush(t,o,u),o=u);break;case 9:case 10:case 13:case 32:o===c&&o++,u===c&&u++;break}}u>o&&this.flush(t,o,u),u<i&&(this.pendingChunk!==null?this.pendingChunk+=t:this.pendingChunk=t.slice(u,i)),this.chunkOffset+=i}finish(){return this.pendingChunk!==null&&(this.flush("",0,0),this.pendingChunk=null),this.value}}});var um=It((AT,lm)=>{lm.exports={version:Kg(),stringifyInfo:tm(),stringifyStream:rm(),parseChunked:Bu()}});function Tp(n){let t=[].filter(i=>{if(typeof i=="function")return!0;console.warn('[discovery-cli] "prepare" module should return a function, but got '+typeof i)});t.length&&n.setPrepare(async(i,...o)=>{for(let u of t)i=await u(i,...o)||i;return i})}var Lp=[];var ca="1.0.0-beta.76";var tr=class{constructor(){this.listeners=Object.create(null)}on(t,i){return this.listeners[t]={callback:i,next:this.listeners[t]||null},this}once(t,i){return this.on(t,function o(...u){i.apply(this,u),this.off(t,o)})}off(t,i){let o=this.listeners[t]||null,u=null;for(;o!==null;){if(o.callback===i){o.callback=null,u?u.next=o.next:this.listeners[t]=o.next;break}u=o,o=o.next}return this}emit(t,...i){let o=this.listeners[t]||null,u=!1;for(;o!==null;)typeof o.callback=="function"&&o.callback.apply(this,i),u=!0,o=o.next;return u}};var fr=new WeakMap,jn=class extends tr{constructor(t){super(),fr.set(this,new Map),t&&(this.revoke=i=>{fr.get(this).delete(i),this.emit("revoke",i)})}define(t,i){return fr.get(this).set(t,i),this.emit("define",t,i),i}isDefined(t){return fr.get(this).has(t)}has(t){return fr.get(this).has(t)}get(t){return fr.get(this).get(t)}get names(){return[...fr.get(this).keys()]}get keys(){return fr.get(this).keys()}get values(){return fr.get(this).values()}get entries(){return fr.get(this).entries()}};var Ui=new WeakMap,Qo=class extends jn{constructor(){super(!0),Ui.set(this,Object.create(null))}define(t,i){if(typeof i!="function")throw new Error("callback is not a function");Ui.set(this,Object.freeze({...Ui.get(this),[t]:i})),super.define(t,Object.freeze({name:t,callback:i}))}revoke(t){if(this.has(t)){let i={...Ui.get(this)};delete i[t],Ui.set(this,Object.freeze(i))}super.revoke(t)}get actionMap(){return Ui.get(this)}call(t,...i){if(!this.has(t))throw new Error(`action "${t}" doesn't exist`);let{callback:o}=this.get(t);return o(...i)}};var su=Object.freeze({}),{hasOwnProperty:h1}=Object,Ap=new WeakMap,au=new WeakMap,Vi=new WeakMap,ci=new WeakMap,Op=new WeakMap,g1=new Set(["view","when","data","whenData","postRender","className"]);function Br(n,t){return Op.set(n,t),n}function Np(n,t,i){if(!i.has(n)){if(ci.has(n))for(let o of ci.get(n)){let u=t.children.find(c=>c.view===o);u?t=u:t.children.push(t={node:null,parent:t,view:o,children:[]})}if(Vi.has(n)?t.children.push(t={node:n,parent:t,view:Vi.get(n),children:[]}):au.has(n)&&t.children.push(t={node:n,parent:t,viewRoot:au.get(n),children:[]}),n.nodeType===1)for(let o=n.firstChild;o;o=o.nextSibling)Np(o,t,i)}}function m1(n){return{name:!1,options:su,render(t,i){if(t.className="discovery-buildin-view-render-error",t.dataset.type=i.type,t.textContent=i.reason,"config"in i){let o=t.appendChild(document.createElement("span"));o.className="toggle-config",o.textContent="show config...",o.addEventListener("click",()=>{t.classList.toggle("expanded")?(o.textContent="hide config...",n.render(t,{view:"struct",expanded:1},i.config)):(o.textContent="show config...",t.lastChild.remove())})}}}}function Ep(n,t,i,o,u,c,f,p){return!h1.call(i,n)||i[n]===void 0||t.queryBool(i[n]===!0?"":i[n],o,u)?!0:(Vi.set(p,{skipped:n,config:i,inputData:c,inputDataIndex:f,data:o,context:u}),!1)}function Pp(n,t,i,o){let u=t;return typeof u=="string"&&u.startsWith("=")&&(u=n.queryFn(u.slice(1))),typeof u=="function"&&(u=u(i,o)),typeof u=="string"&&(u=u.trim().split(/\s+/)),Array.isArray(u)&&(u=u.map(c=>typeof c=="function"?c(i,o):c).filter(Boolean),u.length)?u:null}function Mp(n,t,i,o,u,c,f,p,m){let{tag:y}=t.options,x=y===!1||y===null?document.createDocumentFragment():document.createElement(y||"div"),S=Promise.resolve(t.render(x,u,c,f));return typeof o.postRender=="function"&&(S=S.then(()=>o.postRender(x,o,c,f))),S.then(function(){let k={config:o,props:u,inputData:p,inputDataIndex:m,data:c,context:f};if(x.nodeType!==Node.DOCUMENT_FRAGMENT_NODE){if(Vi.set(x,k),t.name&&x.classList.add(`view-${t.name}`),o.className){let T=Pp(n,o.className,c,f);T!==null&&x.classList.add(...T)}u.tooltip&&Dp(n,x,u.tooltip,c,f)}else for(let T of x.childNodes)ci.has(T)?ci.get(T).unshift(k):ci.set(T,[k]);i.replaceWith(x)})}function v1(n,t){return{name:t,normalizeConfig:n.normalizeConfig.bind(n),ensureValidConfig:n.ensureValidConfig.bind(n),composeConfig:n.composeConfig.bind(n),propsFromConfig:n.propsFromConfig.bind(n),render:n.render.bind(n),listLimit:n.listLimit.bind(n),renderList:n.renderList.bind(n),maybeMoreButtons:n.maybeMoreButtons.bind(n),renderMoreButton:n.renderMoreButton.bind(n),tooltip(i,o,u,c){i&&i.nodeType===1?Dp(n.host,i,o,u,c):console.warn("A tooltip can be attached to a HTML element only")}}}function Dp(n,t,i,o,u){t.classList.add("discovery-view-has-tooltip"),Ap.set(t,[i,o,u]),n.view.tooltip||(n.view.tooltip=y1(n))}function y1(n){let t=null,i=new n.view.Popup({className:"discovery-buildin-view-tooltip",hoverTriggers:".discovery-view-has-tooltip",position:"pointer",render(o,u){let[c,f,p]=Ap.get(u)||[],m="pointer";if(t!==null&&(o.classList.remove(...t),t=null),c&&!Array.isArray(c)&&typeof c!="string"&&typeof c!="function"&&!c.view&&(t=Pp(n,c.className,f,p),t!==null&&o.classList.add(...t),m=c.position==="trigger"?"trigger":"pointer",c=c.content),i.options.position=m,c)return n.view.render(o,c,f,p);n.view.render(o,{view:n.view.defaultRenderErrorRenderer.render,reason:"Element marked as having a tooltip but related data is not found"})}});return i}function Ip(n,t,i,o,u,c){if(Array.isArray(i))return Promise.all(i.map(y=>Ip(n,t,y,o,u,c)));let f=o&&typeof u=="number"?o[u]:o,p=null;switch(typeof i.view){case"function":p={name:!1,options:su,render:i.view};break;case"string":if(i.view==="render"){let{config:y="",context:x=""}=i;p={name:!1,options:{tag:!1},render:(S,k,T)=>{let O=y!==""?n.host.query(y,f,c):T,E=n.host.query(x,c,f);return n.render(S,O,T!==O?T:f,E)}}}else if(i.view.startsWith("preset/")){let y=i.view.substr(7);p={name:!1,options:{tag:!1},render:n.host.preset.isDefined(y)?n.host.preset.get(y).render:()=>{}}}else p=n.get(i.view);break}if(!p){let y=typeof i.view=="string"?"View `"+i.view+"` is not found":"Render is not a function";console.error(y,i),p=n.defaultRenderErrorRenderer,i={type:"config",reason:y,config:i}}t||(t=document.createDocumentFragment());let m=t.appendChild(document.createComment(""));return Ep("when",n.host,i,f,c,o,u,m)?("data"in i?Promise.resolve(n.host.query(i.data,f,c)):Promise.resolve(f)).then(x=>Ep("whenData",n.host,i,x,c,o,u,m)?Mp(n.host,p,m,i,n.propsFromConfig(i,x,c),x,c,o,u):null).catch(x=>{Mp(n.host,n.defaultRenderErrorRenderer,m,su,{type:"render",reason:String(x),config:i}),console.error(x)}):Promise.resolve()}var Zo=class extends jn{constructor(t){super(),this.host=t,this.defaultRenderErrorRenderer=m1(this)}define(t,i,o){super.define(t,Object.freeze({name:t,options:Object.freeze({...o}),render:typeof i=="function"?i.bind(v1(this,t)):(u,c,f,p)=>this.render(u,i,f,p)}))}normalizeConfig(t){if(!t)return null;if(Array.isArray(t))return t.reduce((i,o)=>i.concat(this.normalizeConfig(o)||[]),[]);if(typeof t=="string"){let[,i,o,u]=t.match(/^(\S+?)([:{])((?:.|\s)+)$/)||[];if(i){if(o==="{")try{return Br(this.host.queryToConfig(i,o+u),t)}catch(c){return Br(this.badConfig(t,c),t)}return Br({view:i,data:u},t)}return Br({view:t},t)}else if(typeof t=="function")return Br({view:t},t);return t}badConfig(t,i){let o=i&&i.message||"Unknown error";return console.error(o,{config:t,error:i}),{view:this.defaultRenderErrorRenderer.render,type:"config",reason:o,config:t}}ensureValidConfig(t){return Array.isArray(t)?t.map(i=>this.ensureValidConfig(i)):!t||!t.view?this.badConfig(t,new Error(t?"Option `view` is missed":"Config is not a valid value")):t}composeConfig(t,i){return t=this.normalizeConfig(t),i=this.normalizeConfig(i),t&&i?Array.isArray(t)?t.map(o=>Br({...o,...i},[o,i])):Br({...t,...i},[t,i]):t||i}propsFromConfig(t,i,o){let u=Br({},t);for(let[c,f]of Object.entries(t))g1.has(c)||(u[c]=typeof f=="string"&&f.startsWith("=")?this.host.query(f.slice(1),i,o):f);return u}render(t,i,o,u,c){return Ip(this,t,this.ensureValidConfig(this.normalizeConfig(i)),o,c,u)}listLimit(t,i){return t===!1?!1:!t||isNaN(t)?i:Math.max(parseInt(t,10),0)||i}renderList(t,i,o,u,c=0,f=!1,p){f===!1&&(f=o.length);let m=Promise.all(o.slice(c,c+f).map((y,x,S)=>this.render(t,i,o,{...u,index:c+x,array:o,sliceIndex:x,slice:S},c+x)));return this.maybeMoreButtons(p||t,null,o.length,c+f,f,(y,x)=>this.renderList(t,i,o,u,y,x,p)),m}maybeMoreButtons(t,i,o,u,c,f){let p=o-u,m=p<=0?null:document.createElement("span");return p>c&&this.renderMoreButton(m,"Show "+c+" more...",()=>f(u,c)),p>0&&this.renderMoreButton(m,"Show all the rest "+p+" items...",()=>f(u,1/0)),m!==null&&(m.className="more-buttons",t.insertBefore(m,i)),m}renderMoreButton(t,i,o){let u=document.createElement("button");u.className="more-button",u.innerHTML=i,u.addEventListener("click",()=>{t.remove(),o()}),t.appendChild(u)}adoptFragment(t,i){let o=ci.get(i);if(o)for(let u of t.childNodes)ci.set(u,o)}setViewRoot(t,i,o){au.set(t,{name:i,...o})}getViewTree(t){let i=new Set(t||[]),o=[];return Np(this.host.dom.container,{parent:null,children:o},i),o}getViewStackTrace(t){let{container:i}=this.host.dom;if(!i||!(t instanceof Node)||!i.contains(t))return null;let o=[],u=t;for(;u!==i;)Vi.has(u)&&o.push(Vi.get(u)),u=u.parentNode;return o.length===0?null:o.reverse()}getViewConfigTransitionTree(t){let i=Op.get(t)||[];return Array.isArray(i)||(i=[i]),{value:t,deps:i.map(this.getViewConfigTransitionTree,this)}}};var Xo=class extends jn{constructor(t){super(),this.view=t}define(t,i){i=JSON.parse(JSON.stringify(i)),super.define(t,Object.freeze({name:t,render:(o,u,c,f)=>this.view.render(o,i,c,f),config:i}))}render(t,i,o,u){let c=this.get(i);if(!c){let f="Preset `"+i+"` is not found";console.error(f,i);let p=t.appendChild(document.createElement("div"));return p.className="discovery-buildin-view-config-error",p.textContent=f,Promise.resolve()}return c.render(t,null,o,u)}};var wn=class{static setValue(t,i){if(!t.shouldPublish(i,t.value))return!1;let o=[],u=t.subscriber;for(t.value=i;u!==null;){let{callback:c,thisArg:f}=u;c!==null&&o.push(c.call(f,i,()=>t.unsubscribe(c,f))),u=u.subscriber}return o}constructor(t,i){this.value=t,this.shouldPublish=typeof i=="function"?i:this.shouldPublish,this.subscriber=null}get readonly(){let t=this;return{subscribe:this.subscribe.bind(this),subscribeSync:this.subscribeSync.bind(this),unsubscribe:this.unsubscribe.bind(this),get value(){return t.value}}}subscribe(t,i){return this.subscriber={callback:t,thisArg:i,subscriber:this.subscriber},()=>this.unsubscribe(t,i)}subscribeSync(t,i){let o=this.subscribe(t,i);return t.call(i,this.value,o),o}unsubscribe(t,i){let o=this,u=this.subscriber;for(;u!==null;){if(u.callback===t&&u.thisArg===i){u.callback=null,u.thisArg=null,o.subscriber=u.subscriber;break}o=u,u=u.subscriber}}shouldPublish(t,i){return t!==i}set(t){return this.constructor.setValue(this,t)!==!1}asyncSet(t){let i=this.constructor.setValue(this,t);return i===!1?Promise.resolve(!1):Promise.all(i).then(o=>o!==!1)}};var lu={};Ke(lu,{createElement:()=>V,createFragment:()=>fi,createText:()=>xn,passiveCaptureOptions:()=>Wn,passiveSupported:()=>_p});function V(n,t,i){let o=document.createElement(n);typeof t=="string"&&(t={class:t});for(let u in t)if(hasOwnProperty.call(t,u)){if(t[u]===void 0)continue;u.startsWith("on")?o.addEventListener(u.substr(2),t[u]):o.setAttribute(u,t[u])}return Array.isArray(i)?i.forEach(u=>o.appendChild(u instanceof Node?u:xn(u))):typeof i=="string"&&(o.innerHTML=i),o}function xn(n){return document.createTextNode(String(n))}function fi(...n){let t=document.createDocumentFragment();return n.forEach(i=>t.appendChild(i instanceof Node?i:xn(i))),t}var _p=(()=>{let n=!1;try{let t={get passive(){return n=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return n})(),Wn=_p?Object.freeze({passive:!0,capture:!0}):!0;var Rp=Symbol("config"),b1={name:"not-found",render:(n,{name:t})=>{n.style.cssText="color:#a00",n.innerText=`Page \`${t}\` not found`}},es=class extends jn{constructor(t){if(super(),this.view=t.view,this.lastPage=null,this.lastPageId=null,this.pageOverscrolled=new wn(!1),this.setPageOverscroll=()=>{},typeof IntersectionObserver=="function"){let i=V("div",{style:"position:absolute"}),o=t.dom.content,u=null,c=()=>{};u&&(u.disconnect(),u=null),o&&(u=new IntersectionObserver(f=>this.pageOverscrolled.set(!f[f.length-1].isIntersecting),{root:o}),this.setPageOverscroll=f=>{u.unobserve(i),c(),f&&(f.prepend(i),u.observe(i),c=this.pageOverscrolled.subscribeSync(p=>f.classList.toggle("page_overscrolled",p)))})}}define(t,i,o){super.define(t,Object.freeze({name:t,render:typeof i=="function"?i.bind(this.view):(u,c,f)=>this.view.render(u,i,c,f),options:Object.freeze({...o}),[Rp]:i}))}render(t,i,o,u){let c=Date.now(),f=this.get(i),p;f||(f=this.get("not-found")||b1,o={name:i});let{reuseEl:m,init:y,keepScrollOffset:x=!0}=f.options||{},S=this.lastPage!==i,k=u&&u.id,T=this.lastPageId!==k,O=m&&!S?t:document.createElement("article"),E=t.parentNode;this.lastPage=i,this.lastPageId=k,O.id=t.id,O.classList.add("page","page-"+i),S&&typeof y=="function"&&y(O);try{p=f.render(O,o,u)}catch(M){p=this.view.render(O,"alert-danger",String(M)+" (see details in console)"),console.error(M)}return(S||T||!x)&&(E.scrollTop=0),O!==t&&(t.replaceWith(O),this.setPageOverscroll(O)),{pageEl:O,config:f[Rp],renderState:Promise.resolve(p).then(()=>console.log("[Discovery] Page `"+f.name+"` rendered in "+(Date.now()-c)+"ms"))}}};var La={};Ke(La,{alerts:()=>jp,autoLink:()=>zp,badges:()=>Hp,block:()=>Wp,button:()=>$p,checkbox:()=>Gp,checkboxList:()=>Up,column:()=>Yp,columns:()=>Kp,contentFilter:()=>Qp,context:()=>Xp,dropdown:()=>nh,editors:()=>uh,expand:()=>fh,headers:()=>Sh,hstack:()=>Th,html:()=>Eh,image:()=>Ah,imagePreview:()=>Nh,indicator:()=>Dh,input:()=>Rh,link:()=>zh,listItem:()=>Fh,lists:()=>Hh,markdown:()=>Bh,menu:()=>$h,menuItem:()=>Uh,navButton:()=>Gh,pageHeader:()=>Kh,popup:()=>eg,progressbar:()=>ng,section:()=>ig,select:()=>sg,signature:()=>Nu,source:()=>Gg,struct:()=>Vu,switch:()=>Tm,tab:()=>_m,table:()=>Am,tableCell:()=>Nm,tableRow:()=>Om,tabs:()=>Dm,text:()=>jm,textMatch:()=>Wm,textNumeric:()=>qm,tocSection:()=>Um,toggle:()=>Vm,toggleGroup:()=>Gm,tree:()=>Jm,treeItem:()=>Qm});var Gi=(n,t)=>({demo:{view:n,data:'"Alert"'},examples:[{title:"Variations",demo:t.map(i=>`${i}:"${i}"`)},{title:"Complex content",demo:{view:n,content:['h3:"Some header"','text:"Hello world!"']}}]});function jp(n){function t(i,o,u,c){let{content:f="text"}=o;return i.classList.add("view-alert"),n.view.render(i,f,u,c)}n.view.define("alert",t,{usage:Gi}),n.view.define("alert-primary",t,{usage:Gi}),n.view.define("alert-success",t,{usage:Gi}),n.view.define("alert-danger",t,{usage:Gi}),n.view.define("alert-warning",t,{usage:Gi})}function zp(n){n.view.define("auto-link",function(t,i,o,u){let{content:c,fallback:f,href:p}=i;if(!o)return;let m=n.resolveValueLinks(o),x=m?(typeof p=="function"?p:S=>S)(m[0].href,o,u):null;return x?n.view.render(t,{view:"link",content:c},{...m[0],href:x},u):n.view.render(t,f||c||"text",o,u)},{tag:!1})}var uu=(n,t)=>({demo:{view:n,data:JSON.stringify(n)},examples:[{title:"Variations",demo:t.map(i=>`${i}:"${i}"`)},{title:"Custom colors",beforeDemo:{view:"md",source:["Data properties to setup a custom colors:","* `color` \u2013 default background color","* `textColor` \u2013 default text color","* `darkColor` \u2013 background color in dark mode","* `textColor` \u2013 text color in dark mode"].join(`
`)},demo:{view:n,data:{text:"Colored badge",color:"rgba(237, 177, 9, 0.35)",textColor:"orange",darkColor:"#ffff00",darkTextColor:"black"}}},{title:"As a link",demo:{view:n,data:{text:"Link to something",href:"#",external:!0}}},{title:"Prefix and postfix",demo:{view:n,data:{prefix:"prefix",text:"link",postfix:"postfix"}}},{title:"With a hint",demo:{view:n,data:{text:"text",hint:"hint"}}}]});function Fp(n,t,i){if(!i)return;let o=n.appendChild(document.createElement("span"));o.className=t,o.textContent=i}function Hp(n){function t(i,o,u,c){let{content:f}=o,{color:p,textColor:m,darkColor:y,darkTextColor:x,text:S,href:k,external:T,prefix:O,postfix:E,hint:M}=u||{},_;return(typeof u=="string"||typeof u=="number"||typeof u=="boolean")&&(S=u),p&&i.style.setProperty("--discovery-view-badge-color",p),y&&i.style.setProperty("--discovery-view-badge-dark-color",y),m&&i.style.setProperty("--discovery-view-badge-text-color",m),x&&i.style.setProperty("--discovery-view-badge-dark-text-color",x),k&&(i.href=k),T&&(i.target="_blank"),M&&(i.title=M),Fp(i,"prefix",O),f?_=this.render(i,f,u,c):i.append(document.createTextNode(S)),Fp(i,"postfix",E),_}n.view.define("badge",t,{tag:"a",usage:uu}),n.view.define("pill-badge",t,{tag:"a",usage:uu})}var Bp={beforeDemo:"A block has no its own look. It's using for wrapping some content with a `className` (btw `className` is a common property for any view when appropriate)",demo:{view:"block",className:"foo",content:['text:"Content inside block"']}};function Wp(n){n.view.define("block",function(t,i,o,u){let{content:c=[],onInit:f,onChange:p}=i,m=typeof f!="function"&&typeof p!="function"?c:this.composeConfig(c,{onInit:f,onChange:p});return n.view.render(t,m,o,u)},{usage:Bp})}var ts=(n,t)=>({demo:{view:n,onClick:Function('return () => alert("Hello world!")')(),data:{text:"Button"}},examples:[{title:"Variations",demo:t.map(i=>`${i}:{ text: "${i}" }`)},{title:"Disabled state",demo:t.map(i=>({view:i,disabled:!0,data:{text:i}}))},{title:"Button as a link",demo:{view:"button",data:{text:"Click me",href:"#url",external:!0}}}]});function $p(n){function t(i,o,u,c){let{content:f,disabled:p=!1,onClick:m}=o,{text:y="",href:x,external:S}=u||{};if(i.classList.add("view-button"),n.query(p,u,c)?i.disabled=!0:typeof m=="function"?(i.addEventListener("click",()=>m(i,u,c)),i.classList.add("onclick")):x&&i.addEventListener("click",()=>V("a",{href:x,target:S?"_blank":""}).click()),f)return n.view.render(i,f,u,c);i.textContent=y}n.view.define("button",t,{tag:"button",usage:ts}),n.view.define("button-primary",t,{tag:"button",usage:ts}),n.view.define("button-danger",t,{tag:"button",usage:ts}),n.view.define("button-warning",t,{tag:"button",usage:ts})}var qp={demo:{view:"checkbox-list",checkbox:{content:"text"},data:["one","two","three"]}};function Up(n){n.view.define("checkbox-list",function(t,i,o,u){let{name:c="filter",checkbox:f,checkboxValue:p="$",emptyText:m,limit:y,onChange:x,onInit:S}=i,k=new Set;if(m!==!1&&m!==""&&t.setAttribute("emptyText",m||"Empty list"),!Array.isArray(o)&&o&&(o=[o]),Array.isArray(o))return n.view.renderList(t,this.composeConfig({view:"checkbox",...f,onInit:(T,O,E,M)=>{T&&k.add(n.query(p,E,M))},onChange:(T,O,E,M)=>{let _=k.size,C=n.query(p,E,M);T?k.add(C):k.delete(C),_!==k.size&&typeof x=="function"&&x([...k],c)}}),o,u,0,n.view.listLimit(y,25)).then(()=>{typeof S=="function"&&S([...k],c)})},{usage:qp})}var Vp={demo:{view:"checkbox",content:'text:"checkbox caption"'},examples:[{title:"Checked state",beforeDemo:"Checked state is set up with `checked` property. Its value can be a query",demo:[{view:"checkbox",checked:!0,content:'text:"should be checked"'},{view:"checkbox",checked:"1 > 5",content:`text:"shouldn't be checked"`},{view:"checkbox",checked:"1 < 5",content:'text:"should be checked"'}]},{title:"Readonly checkbox",demo:{view:"checkbox",readonly:!0,content:'text:"checkbox caption"'}},{title:"On change",demo:{view:"checkbox",onChange:new Function("return (value, name, data, context) => alert(`Changed to ${value}!`)")(),content:'text:"click me!"'}}]};function Gp(n){function t(i,o,u,c,f,p){if(i===null)return;let m=f?{...c,[f]:p.checked}:c;return i.innerHTML="",n.view.render(i,o,u,m)}n.view.define("checkbox",function(i,o,u,c){let{name:f,checked:p,readonly:m,content:y,onInit:x,onChange:S}=o,k=i.appendChild(V("input")),T=y?i.appendChild(V("span","view-checkbox__label")):null;return k.type="checkbox",k.checked=p!==void 0?n.queryBool(p,u,c):!!c[f],k.readOnly=m,k.addEventListener("click",O=>{m&&O.preventDefault()}),k.addEventListener("change",()=>{typeof S=="function"&&(S(k.checked,f,u,c),t(T,y,u,c,f,k))}),typeof x=="function"&&x(k.checked,f,u,c),t(T,y,u,c,f,k)},{tag:"label",usage:Vp})}var fa={demo:{view:"columns",data:["one","two","three","four"],column:"text"}};function Yp(n){n.view.define("column",function(t,i,o,u){let{content:c=[]}=i;return n.view.render(t,c,o,u)},{usage:fa})}function Kp(n){n.view.define("columns",function(i,o,u,c){let{column:f,columnConfig:p,emptyText:m,limit:y}=o;if(m!==!1&&m!==""&&i.setAttribute("emptyText",m||"Empty"),!Array.isArray(u)&&u&&(u=[u]),Array.isArray(u))return n.view.renderList(i,this.composeConfig({view:"column",content:f},p),u,c,0,n.view.listLimit(y,25))},{usage:fa})}var Jp={demo:{view:"content-filter",data:["foo","bar","baz"],content:{view:"list",data:".[$ ~= #.filter]"}},examples:[{title:"Using with text-match",demo:{view:"content-filter",data:[{name:"foo"},{name:"bar"},{name:"baz"}],name:"customName",content:{view:"list",data:".[name ~= #.customName]",item:"text-match:{ text: name, match: #.customName }"}}}]};function Qp(n){n.view.define("content-filter",function(t,i,o,u){let{name:c="filter",type:f="regexp",placeholder:p,content:m,onInit:y,onChange:x}=i;return n.view.render(t,{view:"context",modifiers:{view:"input",name:c,type:f,placeholder:p||"Filter"},content:{view:"block",className:"content",content:m,onInit:y,onChange:x}},o,u)},{usage:Jp})}var Zp={demo:{view:"context",data:{name:"text",demo:123},content:["text:name","table"]},examples:[{title:"Using with modifiers",demo:{view:"context",modifiers:['h2:"Modifiers"',{view:"input",name:"inputValue"},{view:"select",name:"selectValue",data:["foo","bar","baz"]}],content:['h2:"Values"',"struct:#"]}}]};function Xp(n){n.view.define("context",function(t,i,o,u){function c(){let C=y.previousSibling;for(;C&&C!==m;)C=C.previousSibling,C.nextSibling.remove();let I=x=document.createDocumentFragment();return n.view.render(I,T,o,p).then(()=>{I===x&&(n.view.adoptFragment(I,m),m.after(I))})}function f(C,I){I&&(!hasOwnProperty.call(p,I)||p[I]!==C)&&(p={...p,[I]:C},S?(c(),O&&typeof M=="function"&&M(C,I)):typeof E=="function"&&E(C,I))}let p=u,m=null,y=null,x=null,S=!1,{modifiers:k=[],content:T=[]}=i,{proxy:O,onInit:E,onChange:M}=i;Array.isArray(k)||(k=[k]);let _=n.view.render(t,this.composeConfig(k,{onInit:f,onChange:f}),o,u);return m=t.appendChild(document.createComment('{ view: "context" } content start')),y=t.appendChild(document.createComment('{ view: "context" } content end')),O&&(E||M)&&(T=this.composeConfig(T,{onInit:E,onChange:M})),_.then(()=>(S=!0,c()))},{tag:!1,usage:Zp})}var eh={demo:{view:"context",modifiers:{view:"dropdown",name:"demo",value:{foo:"two",bar:"hello"},resetValue:{foo:"one",bar:""},caption:"text:`${#.demo.foo} / ${#.demo.bar}`",content:[{view:"select",name:"foo",data:["one","two","three","four"]},{view:"input",name:"bar"}]},content:[{view:"block",content:'text:"Modified context (see values in \\"demo\\" section):"'},{view:"struct",expanded:1,data:"#"}]}};var{hasOwnProperty:th}=Object.prototype;function w1(n,t){if(!n||!t||typeof n!="object"||typeof t!="object")return n===t;for(let i in n)if(th.call(n,i)&&n[i]!==t[i])return!1;for(let i in t)if(th.call(t,i)&&n[i]!==t[i])return!1;return!0}function nh(n){n.view.define("dropdown",function(t,i,o,u){function c(j,F){return typeof E=="function"?E(j,F):w1(j,F)}function f(){return N.innerHTML="",n.view.render(N,T||"text",o,{...u,[y||"__self"]:C})}function p(j){C=j,typeof _=="function"&&_(C,y,o,u),I.hide(),f()}function m(j,F){if(R){let q={changed:!c(j,F)};R.innerHTML="",n.view.render(R,[{view:"button-primary",disabled:"=not changed",content:'text:"Apply"',onClick(H,te,W){p(W)}},{view:"button",when:()=>x&&!c(x,C),content:'text:"Reset"',onClick(){p(x)}},{view:"button",disabled:"=not changed",content:'text:"Cancel"',onClick(){I.hide()}}],q,F)}}let{name:y,resetValue:x,value:S,placeholder:k,caption:T,content:O,compare:E,onInit:M,onChange:_}=i,C="value"in i?S:u[y],I=null,N=t.appendChild(document.createElement("div")),R;return k&&(t.dataset.placeholder=k),t.tabIndex=0,t.addEventListener("click",()=>{I===null&&(I=new n.view.Popup({className:"view-dropdown-popup"}));let j={...C},F;I.toggle(t,q=>n.view.render(q,[{view:"block",className:"content",content:n.view.composeConfig(O,{onInit(H,te){j[te]=H},onChange(H,te){j[te]=H,m(F,j)}})},{view:"block",className:"confirm",postRender(H){R=H}}],o,{...u,...C}).then(()=>{F={...j},m(F,j)}))}),N.className="view-dropdown__caption",typeof M=="function"&&M(C,y,o,u),f()},{usage:eh})}var cu={};Ke(cu,{escapeHtml:()=>Mt,numDelim:()=>$n});function Mt(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function $n(n,t=!0){let i=t&&typeof n!="number"?Mt(String(n)):String(n);return i.length>3?i.replace(/\.\d+(eE[-+]?\d+)?|\B(?=(\d{3})+(\D|$))/g,o=>o||'<span class="num-delim"></span>'):i}var is=Bn(Cr(),1);var pu=Bn(Cr(),1);function hu(n){let t=pu.default.getMode(n,{name:"javascript",json:!0});return{...t,indent(i,o){return i.indented+n.indentUnit*(i.lastType==="{"&&o.trim()[0]!=="}"||i.lastType==="("&&o.trim()[0]!==")"||i.lastType==="["&&o.trim()[0]!=="]")},token(i,o){let u=i.peek();return u==="#"||u==="@"?(t.token(new pu.default.StringStream("$",4,i.lineOracle),o),i.pos++,"variable"):t.token(i,o)}}}var rh=Bn(Cr(),1);function ih(n,t){let i=typeof t.isDiscoveryViewDefined=="function"?t.isDiscoveryViewDefined:()=>{},o=rh.default.getMode(n,{name:"javascript",json:!0});return{...o,indent(u,c){return u.indented+n.indentUnit*(u.lastType==="{"&&c.trim()[0]!=="}"||u.lastType==="("&&c.trim()[0]!==")"||u.lastType==="["&&c.trim()[0]!=="]")},token:function(u,c){if(c.suspendTokens){let{pos:m,token:y}=c.suspendTokens.shift();return u.pos=m,c.suspendTokens.length===0&&(c.suspendTokens=null),y}let f=u.pos,p=o.token(u,c);if(p==="string"){let m=u.pos,[,y]=u.string.slice(f+1,m-1).match(/^(.+?)([:{]|$)/)||[];i(y)&&(u.pos=f+1,c.suspendTokens=[{pos:f+1+y.length,token:"string discovery-view-name"},{pos:m,token:p}])}return p}}}var rC=Bn(gu(),1);var En=Bn(Cr(),1);var yu={};Ke(yu,{getBoundingRect:()=>dr,getOffsetParent:()=>ns,getOverflowParent:()=>rs,getPageOffset:()=>mu,getViewportRect:()=>vu});var{documentElement:Yi}=document,ah=document.compatMode==="CSS1Compat";function ns(n){let t=n.offsetParent;for(;t!==null&&t!==Yi&&getComputedStyle(t).position==="static";)t=t.offsetParent;return t||Yi}function rs(n){let t=n.parentNode;for(;t!==null&&t!==Yi&&getComputedStyle(t).overflow==="visible";)t=t.parentNode;return t||Yi}function mu(n){let t=0,i=0;if(n&&n.getBoundingClientRect){let o=n.getBoundingClientRect();t=-o.top,i=-o.left}else if(ah)t=window.pageYOffset||Yi.scrollTop,i=window.pageXOffset||Yi.scrollLeft;else{let{body:o}=document;n!==o&&(t=o.scrollTop-o.clientTop,i=o.scrollLeft-o.clientLeft)}return{left:i,top:t}}function dr(n,t){let i=mu(t),o=0,u=0,c=0,f=0;return n&&n.getBoundingClientRect&&({top:o,left:u,right:c,bottom:f}=n.getBoundingClientRect()),{top:o+i.top,left:u+i.left,right:c+i.left,bottom:f+i.top,width:c-u,height:f-o}}function vu(n,t){let i=ah?document.documentElement:document.body,{top:o,left:u}=n===i&&!t?mu():dr(n,t),c,f;return!n||n===window?(c=window.innerWidth||0,f=window.innerHeight||0):(o+=n.clientTop,u+=n.clientLeft,c=n.clientWidth,f=n.clientHeight),{top:o,left:u,right:u+c,bottom:o+f,width:c,height:f}}var x1="discovery-view-editor-hints-popup",k1="discovery-view-editor-hint",bu="active",S1=window.requestAnimationFrame||(n=>setTimeout(n,1e3/60)),C1=window.cancelAnimationFrame||clearTimeout;En.default.commands.autocomplete=En.default.showHint;En.default.defineOption("showHintOptions",null);En.default.defineExtension("showHint",function(n){n={closeOnUnfocus:!0,container:null,...this.options.showHintOptions,...n},this.state.completionActive&&this.state.completionActive.close(),!(this.listSelections().length>1)&&(this.somethingSelected()||typeof n.hint=="function"&&(this.state.completionActive=new wu(this,n),this.state.completionActive.update(!0),En.default.signal(this,"startCompletion",this)))});var wu=class{constructor(t,i){if(this.cm=t,this.options=i,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,t.on("cursorActivity",this.activityFunc=()=>this.cursorActivity()),i.closeOnUnfocus){let o;this.onFocus=()=>clearTimeout(o),this.onBlur=()=>o=setTimeout(()=>this.close(),100),t.on("focus",this.onFocus),t.on("blur",this.onBlur)}}close(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.options.closeOnUnfocus&&(this.cm.off("blur",this.onBlur),this.cm.off("focus",this.onFocus)),this.widget&&(this.data&&En.default.signal(this.data,"close"),this.widget.close()),En.default.signal(this.cm,"endCompletion",this.cm))}active(){return this.cm.state.completionActive===this}pick(t,i){let o=t.list[i];this.cm.state.completionEnabled=!1,o.hint?o.hint(this.cm,t,o):this.cm.replaceRange(lh(o),o.from||t.from,o.to||t.to,"complete"),En.default.signal(t,"pick",o),this.close()}cursorActivity(){this.debounce&&(C1(this.debounce),this.debounce=0);let t=this.cm.getCursor(),i=this.cm.getLine(t.line);t.line!=this.startPos.line||i.length-t.ch!=this.startLen-this.startPos.ch||t.ch<this.startPos.ch||this.cm.somethingSelected()?this.close():(this.debounce=S1(()=>this.update()),this.widget&&this.widget.disable())}update(t){if(this.tick===null)return;let i=++this.tick;Promise.resolve(this.options.hint(this.cm,this.options)).then(o=>{this.tick==i&&this.finishUpdate(o,t)})}finishUpdate(t){this.data&&En.default.signal(this.data,"update");let i=this.widget&&this.widget.picked;this.widget&&this.widget.close(),this.data=t,t&&t.list.length&&(i&&t.list.length==1?this.pick(t,0):(this.widget=new xu(this,t),En.default.signal(t,"shown")))}};function lh(n){return typeof n=="string"?n:n.text}function T1(n,t){for(;t&&t.parentNode!==n;)t=t.parentNode;return t}var xu=class{constructor(t,i){let o=t.cm,u=this.hintsEl=document.createElement("ul"),c=[x1,t.cm.options.theme].filter(Boolean),f=t.options.container||document.body;this.rootEls=new Set([f.getRootNode()]),this.completion=t,this.data=i,this.picked=!1,this.selectedHint=i.selectedHint||0,u.style.visibility="hidden",c.forEach(p=>u.classList.add(p)),f.appendChild(u),this.items=i.list.map((p,m)=>{let y=u.appendChild(document.createElement("li"));return y.className=k1,m===this.selectedHint&&y.classList.add(bu),p.render?p.render(y,i,p):y.appendChild(document.createTextNode(p.displayText||lh(p))),y}),o.addKeyMap(this.keyMap={Up:()=>this.changeActive(this.selectedHint-1),Down:()=>this.changeActive(this.selectedHint+1),Enter:()=>this.pick(),Tab:()=>this.pick(),Esc:()=>{o.state.completionEnabled=!1,t.close()}}),this.updatePosSize(),this.onScroll=()=>this.updatePosSize();for(let p of this.rootEls)p.addEventListener("scroll",this.onScroll,Wn);En.default.on(u,"mousedown",p=>{let m=T1(u,p.target),y=this.items.indexOf(m);y!==-1&&(this.close(),this.selectedHint=y,this.pick(),setTimeout(()=>o.focus(),1))}),En.default.signal(i,"select",i.list[this.selectedHint],this.items[this.selectedHint])}close(){if(this.completion.widget===this){this.completion.widget=null,this.completion.cm.removeKeyMap(this.keyMap),this.hintsEl.remove();for(let t of this.rootEls)t.removeEventListener("scroll",this.onScroll,Wn)}}disable(){this.completion.cm.removeKeyMap(this.keyMap),this.keyMap={Enter:()=>this.picked=!0},this.completion.cm.addKeyMap(this.keyMap)}pick(){this.completion.pick(this.data,this.selectedHint)}changeActive(t,i){t>=this.items.length?t=i?this.items.length-1:0:t<0&&(t=i?0:this.items.length-1);let o=this.items[this.selectedHint],u=this.items[this.selectedHint=t];u!==o&&(o&&o.classList.remove(bu),u.classList.add(bu),u.offsetTop<this.hintsEl.scrollTop?this.hintsEl.scrollTop=u.offsetTop-3:u.offsetTop+u.offsetHeight>this.hintsEl.scrollTop+this.hintsEl.clientHeight&&(this.hintsEl.scrollTop=u.offsetTop+u.offsetHeight-this.hintsEl.clientHeight+3),En.default.signal(this.data,"select",this.data.list[this.selectedHint],u))}getCursorCoords(){let{completion:t,hintsEl:i}=this,o=t.cm,u=ns(i),c=o.cursorCoords(null,"local"),f=dr(o.display.wrapper,u);return{top:f.top+c.top+5,left:f.left+c.left+9,bottom:f.top+c.bottom+5,right:f.left+c.right+9}}updatePosSize(){let{hintsEl:o}=this,u=this.getCursorCoords(),{clientWidth:c,clientHeight:f}=rs(o);o.style.left="0px",o.style.top="0px";let{width:p,height:m}=o.getBoundingClientRect(),y=f-u.bottom,x=u.top;y<m&&x>y?(o.style.top=`${u.top-1-Math.min(m,x-6)-1}px`,o.style.maxHeight=`${x-1-6}px`):(o.style.top=`${u.bottom+1}px`,o.style.maxHeight=`${y-1-6}px`);let S=c-u.right,k=u.left;S<p&&k>S?(o.style.left=`${u.left+1-Math.min(p,k-6)}px`,o.style.maxWidth=`${k-6}px`):(o.style.left=`${u.right}px`,o.style.maxWidth=`${S-6}px`),o.style.visibility="visible"}};function L1(n,t,{entry:{type:i,text:o,value:u}}){let c=o[0],f=o[o.length-1],p=c==='"'||c==="'"?1:0,m=f==='"'||f==="'"?1:0,y=o.toLowerCase().substring(p,o.length-m),x=y?u.toLowerCase().indexOf(y,u[0]==='"'||u[0]==="'"?1:0):-1;x!==-1&&(u=Mt(u.substring(0,x))+'<span class="match">'+Mt(u.substr(x,y.length))+"</span>"+Mt(u.substr(x+y.length))),n.classList.add("type-"+i),n.appendChild(V("span","name",u))}var da=class extends tr{constructor({hint:t,mode:i}){super(),this.el=document.createElement("div"),this.el.className="discovery-editor";let o=this,u=(0,is.default)(this.el,{extraKeys:{"Alt-Space":"autocomplete"},mode:i||"javascript",theme:"neo",indentUnit:0,showHintOptions:{hint:t,get container(){return o.container}}});u.on("change",()=>this.emit("change",u.getValue())),typeof t=="function"&&(u.on("cursorActivity",c=>{c.state.completionEnabled&&c.state.focused&&c.showHint()}),u.on("focus",c=>{c.getValue()===""&&(c.state.completionEnabled=!0),c.state.completionEnabled&&!c.state.completionActive&&c.showHint()}),u.on("change",(c,f)=>{f.origin!=="complete"&&(u.state.completionEnabled=!0)})),this.cm=u}getValue(){return this.cm.getValue()}setValue(t){Promise.resolve().then(()=>this.cm.refresh()),typeof t=="string"&&this.getValue()!==t&&this.cm.setValue(t||"")}focus(){this.cm.focus()}},ku=class extends da{constructor(t){super({mode:"discovery-query",hint:i=>{let o=i.getCursor(),u=t(i.getValue(),i.doc.indexFromPos(o),this.queryData,this.queryContext);if(u)return{list:u.slice(0,50).map(c=>({entry:c,text:c.value,render:L1,from:i.posFromIndex(c.from),to:i.posFromIndex(c.to)}))}}})}setValue(t,i,o){this.queryData=i,this.queryContext=o,super.setValue(t)}},Su=class extends da{constructor(){super({mode:{name:"discovery-view",isDiscoveryViewDefined:t=>this.isViewDefined(t)}})}};is.default.defineMode("jora",hu);is.default.defineMode("discovery-query",hu);is.default.defineMode("discovery-view",ih);function uh(n){Object.assign(n.view,{QueryEditor:class extends ku{get container(){return n.dom.container}},ViewEditor:class extends Su{isViewDefined(t){return n.view.isDefined(t)}}})}var ch={demo:{view:"expand",header:'text:"Expand me!"',content:'text:"Content"'}};function fh(n){n.view.define("expand",function(t,i,o,u){function c(){if(t.classList.toggle("expanded",f),f)return k=V("div","content"),n.view.render(k,m,o,u).then(()=>t.appendChild(k));k!==null&&(k.remove(),k=null)}let{expanded:f,header:p,content:m,onToggle:y}=i,x=t.appendChild(V("div","header")),S=x.appendChild(V("div","header-content")),k=null;return!p&&i.title&&(p=i.title,console.warn("expand.title is deprecated, use expand.header instead")),f=n.queryBool(f,o,u),x.appendChild(V("div","trigger")),x.addEventListener("click",()=>{f=!f,c(),typeof y=="function"&&y(f)}),Promise.all([n.view.render(S,p||'text:"\xA0"',o,u),c()])},{usage:ch})}function yh(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var di=yh();function E1(n){di=n}var bh=/[&<>"']/,M1=new RegExp(bh.source,"g"),wh=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,A1=new RegExp(wh.source,"g"),O1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dh=n=>O1[n];function fn(n,t){if(t){if(bh.test(n))return n.replace(M1,dh)}else if(wh.test(n))return n.replace(A1,dh);return n}var N1=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function xh(n){return n.replace(N1,(t,i)=>(i=i.toLowerCase(),i==="colon"?":":i.charAt(0)==="#"?i.charAt(1)==="x"?String.fromCharCode(parseInt(i.substring(2),16)):String.fromCharCode(+i.substring(1)):""))}var P1=/(^|[^\[])\^/g;function At(n,t){n=typeof n=="string"?n:n.source,t=t||"";let i={replace:(o,u)=>(u=u.source||u,u=u.replace(P1,"$1"),n=n.replace(o,u),i),getRegex:()=>new RegExp(n,t)};return i}var D1=/[^\w:]/g,I1=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function ph(n,t,i){if(n){let o;try{o=decodeURIComponent(xh(i)).replace(D1,"").toLowerCase()}catch{return null}if(o.indexOf("javascript:")===0||o.indexOf("vbscript:")===0||o.indexOf("data:")===0)return null}t&&!I1.test(i)&&(i=z1(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}var pa={},_1=/^[^:]+:\/*[^/]*$/,R1=/^([^:]+:)[\s\S]*$/,j1=/^([^:]+:\/*[^/]*)[\s\S]*$/;function z1(n,t){pa[" "+n]||(_1.test(n)?pa[" "+n]=n+"/":pa[" "+n]=ha(n,"/",!0)),n=pa[" "+n];let i=n.indexOf(":")===-1;return t.substring(0,2)==="//"?i?t:n.replace(R1,"$1")+t:t.charAt(0)==="/"?i?t:n.replace(j1,"$1")+t:n+t}var ga={exec:function(){}};function hh(n,t){let i=n.replace(/\|/g,(c,f,p)=>{let m=!1,y=f;for(;--y>=0&&p[y]==="\\";)m=!m;return m?"|":" |"}),o=i.split(/ \|/),u=0;if(o[0].trim()||o.shift(),o.length>0&&!o[o.length-1].trim()&&o.pop(),o.length>t)o.splice(t);else for(;o.length<t;)o.push("");for(;u<o.length;u++)o[u]=o[u].trim().replace(/\\\|/g,"|");return o}function ha(n,t,i){let o=n.length;if(o===0)return"";let u=0;for(;u<o;){let c=n.charAt(o-u-1);if(c===t&&!i)u++;else if(c!==t&&i)u++;else break}return n.slice(0,o-u)}function F1(n,t){if(n.indexOf(t[1])===-1)return-1;let i=n.length,o=0,u=0;for(;u<i;u++)if(n[u]==="\\")u++;else if(n[u]===t[0])o++;else if(n[u]===t[1]&&(o--,o<0))return u;return-1}function H1(n){n&&n.sanitize&&!n.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function gh(n,t){if(t<1)return"";let i="";for(;t>1;)t&1&&(i+=n),t>>=1,n+=n;return i+n}function mh(n,t,i,o){let u=t.href,c=t.title?fn(t.title):null,f=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){o.state.inLink=!0;let p={type:"link",raw:i,href:u,title:c,text:f,tokens:o.inlineTokens(f)};return o.state.inLink=!1,p}return{type:"image",raw:i,href:u,title:c,text:fn(f)}}function B1(n,t){let i=n.match(/^(\s+)(?:```)/);if(i===null)return t;let o=i[1];return t.split(`
`).map(u=>{let c=u.match(/^\s+/);if(c===null)return u;let[f]=c;return f.length>=o.length?u.slice(o.length):u}).join(`
`)}var os=class{constructor(t){this.options=t||di}space(t){let i=this.rules.block.newline.exec(t);if(i&&i[0].length>0)return{type:"space",raw:i[0]}}code(t){let i=this.rules.block.code.exec(t);if(i){let o=i[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:this.options.pedantic?o:ha(o,`
`)}}}fences(t){let i=this.rules.block.fences.exec(t);if(i){let o=i[0],u=B1(o,i[3]||"");return{type:"code",raw:o,lang:i[2]?i[2].trim().replace(this.rules.inline._escapes,"$1"):i[2],text:u}}}heading(t){let i=this.rules.block.heading.exec(t);if(i){let o=i[2].trim();if(/#$/.test(o)){let u=ha(o,"#");(this.options.pedantic||!u||/ $/.test(u))&&(o=u.trim())}return{type:"heading",raw:i[0],depth:i[1].length,text:o,tokens:this.lexer.inline(o)}}}hr(t){let i=this.rules.block.hr.exec(t);if(i)return{type:"hr",raw:i[0]}}blockquote(t){let i=this.rules.block.blockquote.exec(t);if(i){let o=i[0].replace(/^ *>[ \t]?/gm,""),u=this.lexer.state.top;this.lexer.state.top=!0;let c=this.lexer.blockTokens(o);return this.lexer.state.top=u,{type:"blockquote",raw:i[0],tokens:c,text:o}}}list(t){let i=this.rules.block.list.exec(t);if(i){let o,u,c,f,p,m,y,x,S,k,T,O,E=i[1].trim(),M=E.length>1,_={type:"list",raw:"",ordered:M,start:M?+E.slice(0,-1):"",loose:!1,items:[]};E=M?`\\d{1,9}\\${E.slice(-1)}`:`\\${E}`,this.options.pedantic&&(E=M?E:"[*+-]");let C=new RegExp(`^( {0,3}${E})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;t&&(O=!1,!(!(i=C.exec(t))||this.rules.block.hr.test(t)));){if(o=i[0],t=t.substring(o.length),x=i[2].split(`
`,1)[0].replace(/^\t+/,N=>" ".repeat(3*N.length)),S=t.split(`
`,1)[0],this.options.pedantic?(f=2,T=x.trimLeft()):(f=i[2].search(/[^ ]/),f=f>4?1:f,T=x.slice(f),f+=i[1].length),m=!1,!x&&/^ *$/.test(S)&&(o+=S+`
`,t=t.substring(S.length+1),O=!0),!O){let N=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),R=new RegExp(`^ {0,${Math.min(3,f-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),j=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:\`\`\`|~~~)`),F=new RegExp(`^ {0,${Math.min(3,f-1)}}#`);for(;t&&(k=t.split(`
`,1)[0],S=k,this.options.pedantic&&(S=S.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(j.test(S)||F.test(S)||N.test(S)||R.test(t)));){if(S.search(/[^ ]/)>=f||!S.trim())T+=`
`+S.slice(f);else{if(m||x.search(/[^ ]/)>=4||j.test(x)||F.test(x)||R.test(x))break;T+=`
`+S}!m&&!S.trim()&&(m=!0),o+=k+`
`,t=t.substring(k.length+1),x=S.slice(f)}}_.loose||(y?_.loose=!0:/\n *\n *$/.test(o)&&(y=!0)),this.options.gfm&&(u=/^\[[ xX]\] /.exec(T),u&&(c=u[0]!=="[ ] ",T=T.replace(/^\[[ xX]\] +/,""))),_.items.push({type:"list_item",raw:o,task:!!u,checked:c,loose:!1,text:T}),_.raw+=o}_.items[_.items.length-1].raw=o.trimRight(),_.items[_.items.length-1].text=T.trimRight(),_.raw=_.raw.trimRight();let I=_.items.length;for(p=0;p<I;p++)if(this.lexer.state.top=!1,_.items[p].tokens=this.lexer.blockTokens(_.items[p].text,[]),!_.loose){let N=_.items[p].tokens.filter(j=>j.type==="space"),R=N.length>0&&N.some(j=>/\n.*\n/.test(j.raw));_.loose=R}if(_.loose)for(p=0;p<I;p++)_.items[p].loose=!0;return _}}html(t){let i=this.rules.block.html.exec(t);if(i){let o={type:"html",raw:i[0],pre:!this.options.sanitizer&&(i[1]==="pre"||i[1]==="script"||i[1]==="style"),text:i[0]};if(this.options.sanitize){let u=this.options.sanitizer?this.options.sanitizer(i[0]):fn(i[0]);o.type="paragraph",o.text=u,o.tokens=this.lexer.inline(u)}return o}}def(t){let i=this.rules.block.def.exec(t);if(i){let o=i[1].toLowerCase().replace(/\s+/g," "),u=i[2]?i[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",c=i[3]?i[3].substring(1,i[3].length-1).replace(this.rules.inline._escapes,"$1"):i[3];return{type:"def",tag:o,raw:i[0],href:u,title:c}}}table(t){let i=this.rules.block.table.exec(t);if(i){let o={type:"table",header:hh(i[1]).map(u=>({text:u})),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:i[3]&&i[3].trim()?i[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(o.header.length===o.align.length){o.raw=i[0];let u=o.align.length,c,f,p,m;for(c=0;c<u;c++)/^ *-+: *$/.test(o.align[c])?o.align[c]="right":/^ *:-+: *$/.test(o.align[c])?o.align[c]="center":/^ *:-+ *$/.test(o.align[c])?o.align[c]="left":o.align[c]=null;for(u=o.rows.length,c=0;c<u;c++)o.rows[c]=hh(o.rows[c],o.header.length).map(y=>({text:y}));for(u=o.header.length,f=0;f<u;f++)o.header[f].tokens=this.lexer.inline(o.header[f].text);for(u=o.rows.length,f=0;f<u;f++)for(m=o.rows[f],p=0;p<m.length;p++)m[p].tokens=this.lexer.inline(m[p].text);return o}}}lheading(t){let i=this.rules.block.lheading.exec(t);if(i)return{type:"heading",raw:i[0],depth:i[2].charAt(0)==="="?1:2,text:i[1],tokens:this.lexer.inline(i[1])}}paragraph(t){let i=this.rules.block.paragraph.exec(t);if(i){let o=i[1].charAt(i[1].length-1)===`
`?i[1].slice(0,-1):i[1];return{type:"paragraph",raw:i[0],text:o,tokens:this.lexer.inline(o)}}}text(t){let i=this.rules.block.text.exec(t);if(i)return{type:"text",raw:i[0],text:i[0],tokens:this.lexer.inline(i[0])}}escape(t){let i=this.rules.inline.escape.exec(t);if(i)return{type:"escape",raw:i[0],text:fn(i[1])}}tag(t){let i=this.rules.inline.tag.exec(t);if(i)return!this.lexer.state.inLink&&/^<a /i.test(i[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(i[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:i[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):fn(i[0]):i[0]}}link(t){let i=this.rules.inline.link.exec(t);if(i){let o=i[2].trim();if(!this.options.pedantic&&/^</.test(o)){if(!/>$/.test(o))return;let f=ha(o.slice(0,-1),"\\");if((o.length-f.length)%2===0)return}else{let f=F1(i[2],"()");if(f>-1){let m=(i[0].indexOf("!")===0?5:4)+i[1].length+f;i[2]=i[2].substring(0,f),i[0]=i[0].substring(0,m).trim(),i[3]=""}}let u=i[2],c="";if(this.options.pedantic){let f=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(u);f&&(u=f[1],c=f[3])}else c=i[3]?i[3].slice(1,-1):"";return u=u.trim(),/^</.test(u)&&(this.options.pedantic&&!/>$/.test(o)?u=u.slice(1):u=u.slice(1,-1)),mh(i,{href:u&&u.replace(this.rules.inline._escapes,"$1"),title:c&&c.replace(this.rules.inline._escapes,"$1")},i[0],this.lexer)}}reflink(t,i){let o;if((o=this.rules.inline.reflink.exec(t))||(o=this.rules.inline.nolink.exec(t))){let u=(o[2]||o[1]).replace(/\s+/g," ");if(u=i[u.toLowerCase()],!u){let c=o[0].charAt(0);return{type:"text",raw:c,text:c}}return mh(o,u,o[0],this.lexer)}}emStrong(t,i,o=""){let u=this.rules.inline.emStrong.lDelim.exec(t);if(!u||u[3]&&o.match(/[\p{L}\p{N}]/u))return;let c=u[1]||u[2]||"";if(!c||c&&(o===""||this.rules.inline.punctuation.exec(o))){let f=u[0].length-1,p,m,y=f,x=0,S=u[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(S.lastIndex=0,i=i.slice(-1*t.length+f);(u=S.exec(i))!=null;){if(p=u[1]||u[2]||u[3]||u[4]||u[5]||u[6],!p)continue;if(m=p.length,u[3]||u[4]){y+=m;continue}else if((u[5]||u[6])&&f%3&&!((f+m)%3)){x+=m;continue}if(y-=m,y>0)continue;m=Math.min(m,m+y+x);let k=t.slice(0,f+u.index+(u[0].length-p.length)+m);if(Math.min(f,m)%2){let O=k.slice(1,-1);return{type:"em",raw:k,text:O,tokens:this.lexer.inlineTokens(O)}}let T=k.slice(2,-2);return{type:"strong",raw:k,text:T,tokens:this.lexer.inlineTokens(T)}}}}codespan(t){let i=this.rules.inline.code.exec(t);if(i){let o=i[2].replace(/\n/g," "),u=/[^ ]/.test(o),c=/^ /.test(o)&&/ $/.test(o);return u&&c&&(o=o.substring(1,o.length-1)),o=fn(o,!0),{type:"codespan",raw:i[0],text:o}}}br(t){let i=this.rules.inline.br.exec(t);if(i)return{type:"br",raw:i[0]}}del(t){let i=this.rules.inline.del.exec(t);if(i)return{type:"del",raw:i[0],text:i[2],tokens:this.lexer.inlineTokens(i[2])}}autolink(t,i){let o=this.rules.inline.autolink.exec(t);if(o){let u,c;return o[2]==="@"?(u=fn(this.options.mangle?i(o[1]):o[1]),c="mailto:"+u):(u=fn(o[1]),c=u),{type:"link",raw:o[0],text:u,href:c,tokens:[{type:"text",raw:u,text:u}]}}}url(t,i){let o;if(o=this.rules.inline.url.exec(t)){let u,c;if(o[2]==="@")u=fn(this.options.mangle?i(o[0]):o[0]),c="mailto:"+u;else{let f;do f=o[0],o[0]=this.rules.inline._backpedal.exec(o[0])[0];while(f!==o[0]);u=fn(o[0]),o[1]==="www."?c="http://"+o[0]:c=o[0]}return{type:"link",raw:o[0],text:u,href:c,tokens:[{type:"text",raw:u,text:u}]}}}inlineText(t,i){let o=this.rules.inline.text.exec(t);if(o){let u;return this.lexer.state.inRawBlock?u=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):fn(o[0]):o[0]:u=fn(this.options.smartypants?i(o[0]):o[0]),{type:"text",raw:o[0],text:u}}}},$e={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:ga,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};$e._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;$e._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;$e.def=At($e.def).replace("label",$e._label).replace("title",$e._title).getRegex();$e.bullet=/(?:[*+-]|\d{1,9}[.)])/;$e.listItemStart=At(/^( *)(bull) */).replace("bull",$e.bullet).getRegex();$e.list=At($e.list).replace(/bull/g,$e.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+$e.def.source+")").getRegex();$e._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";$e._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;$e.html=At($e.html,"i").replace("comment",$e._comment).replace("tag",$e._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();$e.paragraph=At($e._paragraph).replace("hr",$e.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$e._tag).getRegex();$e.blockquote=At($e.blockquote).replace("paragraph",$e.paragraph).getRegex();$e.normal={...$e};$e.gfm={...$e.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};$e.gfm.table=At($e.gfm.table).replace("hr",$e.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$e._tag).getRegex();$e.gfm.paragraph=At($e._paragraph).replace("hr",$e.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",$e.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$e._tag).getRegex();$e.pedantic={...$e.normal,html:At(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",$e._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ga,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:At($e.normal._paragraph).replace("hr",$e.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",$e.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};var pe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:ga,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:ga,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};pe._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";pe.punctuation=At(pe.punctuation).replace(/punctuation/g,pe._punctuation).getRegex();pe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;pe.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;pe._comment=At($e._comment).replace("(?:-->|$)","-->").getRegex();pe.emStrong.lDelim=At(pe.emStrong.lDelim).replace(/punct/g,pe._punctuation).getRegex();pe.emStrong.rDelimAst=At(pe.emStrong.rDelimAst,"g").replace(/punct/g,pe._punctuation).getRegex();pe.emStrong.rDelimUnd=At(pe.emStrong.rDelimUnd,"g").replace(/punct/g,pe._punctuation).getRegex();pe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;pe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;pe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;pe.autolink=At(pe.autolink).replace("scheme",pe._scheme).replace("email",pe._email).getRegex();pe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;pe.tag=At(pe.tag).replace("comment",pe._comment).replace("attribute",pe._attribute).getRegex();pe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;pe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;pe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;pe.link=At(pe.link).replace("label",pe._label).replace("href",pe._href).replace("title",pe._title).getRegex();pe.reflink=At(pe.reflink).replace("label",pe._label).replace("ref",$e._label).getRegex();pe.nolink=At(pe.nolink).replace("ref",$e._label).getRegex();pe.reflinkSearch=At(pe.reflinkSearch,"g").replace("reflink",pe.reflink).replace("nolink",pe.nolink).getRegex();pe.normal={...pe};pe.pedantic={...pe.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:At(/^!?\[(label)\]\((.*?)\)/).replace("label",pe._label).getRegex(),reflink:At(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pe._label).getRegex()};pe.gfm={...pe.normal,escape:At(pe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};pe.gfm.url=At(pe.gfm.url,"i").replace("email",pe.gfm._extended_email).getRegex();pe.breaks={...pe.gfm,br:At(pe.br).replace("{2,}","*").getRegex(),text:At(pe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function W1(n){return n.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function vh(n){let t="",i,o,u=n.length;for(i=0;i<u;i++)o=n.charCodeAt(i),Math.random()>.5&&(o="x"+o.toString(16)),t+="&#"+o+";";return t}var pr=class{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||di,this.options.tokenizer=this.options.tokenizer||new os,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let i={block:$e.normal,inline:pe.normal};this.options.pedantic?(i.block=$e.pedantic,i.inline=pe.pedantic):this.options.gfm&&(i.block=$e.gfm,this.options.breaks?i.inline=pe.breaks:i.inline=pe.gfm),this.tokenizer.rules=i}static get rules(){return{block:$e,inline:pe}}static lex(t,i){return new pr(i).lex(t)}static lexInline(t,i){return new pr(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let i;for(;i=this.inlineQueue.shift();)this.inlineTokens(i.src,i.tokens);return this.tokens}blockTokens(t,i=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(p,m,y)=>m+"    ".repeat(y.length));let o,u,c,f;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(p=>(o=p.call({lexer:this},t,i))?(t=t.substring(o.raw.length),i.push(o),!0):!1))){if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length),o.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length),u=i[i.length-1],u&&(u.type==="paragraph"||u.type==="text")?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue[this.inlineQueue.length-1].src=u.text):i.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length),u=i[i.length-1],u&&(u.type==="paragraph"||u.type==="text")?(u.raw+=`
`+o.raw,u.text+=`
`+o.raw,this.inlineQueue[this.inlineQueue.length-1].src=u.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),i.push(o);continue}if(c=t,this.options.extensions&&this.options.extensions.startBlock){let p=1/0,m=t.slice(1),y;this.options.extensions.startBlock.forEach(function(x){y=x.call({lexer:this},m),typeof y=="number"&&y>=0&&(p=Math.min(p,y))}),p<1/0&&p>=0&&(c=t.substring(0,p+1))}if(this.state.top&&(o=this.tokenizer.paragraph(c))){u=i[i.length-1],f&&u.type==="paragraph"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=u.text):i.push(o),f=c.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length),u=i[i.length-1],u&&u.type==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=u.text):i.push(o);continue}if(t){let p="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,i}inline(t,i=[]){return this.inlineQueue.push({src:t,tokens:i}),i}inlineTokens(t,i=[]){let o,u,c,f=t,p,m,y;if(this.tokens.links){let x=Object.keys(this.tokens.links);if(x.length>0)for(;(p=this.tokenizer.rules.inline.reflinkSearch.exec(f))!=null;)x.includes(p[0].slice(p[0].lastIndexOf("[")+1,-1))&&(f=f.slice(0,p.index)+"["+gh("a",p[0].length-2)+"]"+f.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(p=this.tokenizer.rules.inline.blockSkip.exec(f))!=null;)f=f.slice(0,p.index)+"["+gh("a",p[0].length-2)+"]"+f.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(p=this.tokenizer.rules.inline.escapedEmSt.exec(f))!=null;)f=f.slice(0,p.index+p[0].length-2)+"++"+f.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;t;)if(m||(y=""),m=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(x=>(o=x.call({lexer:this},t,i))?(t=t.substring(o.raw.length),i.push(o),!0):!1))){if(o=this.tokenizer.escape(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.tag(t)){t=t.substring(o.raw.length),u=i[i.length-1],u&&o.type==="text"&&u.type==="text"?(u.raw+=o.raw,u.text+=o.text):i.push(o);continue}if(o=this.tokenizer.link(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(o.raw.length),u=i[i.length-1],u&&o.type==="text"&&u.type==="text"?(u.raw+=o.raw,u.text+=o.text):i.push(o);continue}if(o=this.tokenizer.emStrong(t,f,y)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.codespan(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.br(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.del(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.autolink(t,vh)){t=t.substring(o.raw.length),i.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(t,vh))){t=t.substring(o.raw.length),i.push(o);continue}if(c=t,this.options.extensions&&this.options.extensions.startInline){let x=1/0,S=t.slice(1),k;this.options.extensions.startInline.forEach(function(T){k=T.call({lexer:this},S),typeof k=="number"&&k>=0&&(x=Math.min(x,k))}),x<1/0&&x>=0&&(c=t.substring(0,x+1))}if(o=this.tokenizer.inlineText(c,W1)){t=t.substring(o.raw.length),o.raw.slice(-1)!=="_"&&(y=o.raw.slice(-1)),m=!0,u=i[i.length-1],u&&u.type==="text"?(u.raw+=o.raw,u.text+=o.text):i.push(o);continue}if(t){let x="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(x);break}else throw new Error(x)}}return i}},ss=class{constructor(t){this.options=t||di}code(t,i,o){let u=(i||"").match(/\S*/)[0];if(this.options.highlight){let c=this.options.highlight(t,u);c!=null&&c!==t&&(o=!0,t=c)}return t=t.replace(/\n$/,"")+`
`,u?'<pre><code class="'+this.options.langPrefix+fn(u)+'">'+(o?t:fn(t,!0))+`</code></pre>
`:"<pre><code>"+(o?t:fn(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t){return t}heading(t,i,o,u){if(this.options.headerIds){let c=this.options.headerPrefix+u.slug(o);return`<h${i} id="${c}">${t}</h${i}>
`}return`<h${i}>${t}</h${i}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,i,o){let u=i?"ol":"ul",c=i&&o!==1?' start="'+o+'"':"";return"<"+u+c+`>
`+t+"</"+u+`>
`}listitem(t){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>
`}table(t,i){return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,i){let o=i.header?"th":"td";return(i.align?`<${o} align="${i.align}">`:`<${o}>`)+t+`</${o}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,i,o){if(t=ph(this.options.sanitize,this.options.baseUrl,t),t===null)return o;let u='<a href="'+t+'"';return i&&(u+=' title="'+i+'"'),u+=">"+o+"</a>",u}image(t,i,o){if(t=ph(this.options.sanitize,this.options.baseUrl,t),t===null)return o;let u=`<img src="${t}" alt="${o}"`;return i&&(u+=` title="${i}"`),u+=this.options.xhtml?"/>":">",u}text(t){return t}},ma=class{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,i,o){return""+o}image(t,i,o){return""+o}br(){return""}},Ji=class{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,i){let o=t,u=0;if(this.seen.hasOwnProperty(o)){u=this.seen[t];do u++,o=t+"-"+u;while(this.seen.hasOwnProperty(o))}return i||(this.seen[t]=u,this.seen[o]=0),o}slug(t,i={}){let o=this.serialize(t);return this.getNextSafeSlug(o,i.dryrun)}},hr=class{constructor(t){this.options=t||di,this.options.renderer=this.options.renderer||new ss,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ma,this.slugger=new Ji}static parse(t,i){return new hr(i).parse(t)}static parseInline(t,i){return new hr(i).parseInline(t)}parse(t,i=!0){let o="",u,c,f,p,m,y,x,S,k,T,O,E,M,_,C,I,N,R,j,F=t.length;for(u=0;u<F;u++){if(T=t[u],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[T.type]&&(j=this.options.extensions.renderers[T.type].call({parser:this},T),j!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(T.type))){o+=j||"";continue}switch(T.type){case"space":continue;case"hr":{o+=this.renderer.hr();continue}case"heading":{o+=this.renderer.heading(this.parseInline(T.tokens),T.depth,xh(this.parseInline(T.tokens,this.textRenderer)),this.slugger);continue}case"code":{o+=this.renderer.code(T.text,T.lang,T.escaped);continue}case"table":{for(S="",x="",p=T.header.length,c=0;c<p;c++)x+=this.renderer.tablecell(this.parseInline(T.header[c].tokens),{header:!0,align:T.align[c]});for(S+=this.renderer.tablerow(x),k="",p=T.rows.length,c=0;c<p;c++){for(y=T.rows[c],x="",m=y.length,f=0;f<m;f++)x+=this.renderer.tablecell(this.parseInline(y[f].tokens),{header:!1,align:T.align[f]});k+=this.renderer.tablerow(x)}o+=this.renderer.table(S,k);continue}case"blockquote":{k=this.parse(T.tokens),o+=this.renderer.blockquote(k);continue}case"list":{for(O=T.ordered,E=T.start,M=T.loose,p=T.items.length,k="",c=0;c<p;c++)C=T.items[c],I=C.checked,N=C.task,_="",C.task&&(R=this.renderer.checkbox(I),M?C.tokens.length>0&&C.tokens[0].type==="paragraph"?(C.tokens[0].text=R+" "+C.tokens[0].text,C.tokens[0].tokens&&C.tokens[0].tokens.length>0&&C.tokens[0].tokens[0].type==="text"&&(C.tokens[0].tokens[0].text=R+" "+C.tokens[0].tokens[0].text)):C.tokens.unshift({type:"text",text:R}):_+=R),_+=this.parse(C.tokens,M),k+=this.renderer.listitem(_,N,I);o+=this.renderer.list(k,O,E);continue}case"html":{o+=this.renderer.html(T.text);continue}case"paragraph":{o+=this.renderer.paragraph(this.parseInline(T.tokens));continue}case"text":{for(k=T.tokens?this.parseInline(T.tokens):T.text;u+1<F&&t[u+1].type==="text";)T=t[++u],k+=`
`+(T.tokens?this.parseInline(T.tokens):T.text);o+=i?this.renderer.paragraph(k):k;continue}default:{let q='Token with "'+T.type+'" type was not found.';if(this.options.silent){console.error(q);return}else throw new Error(q)}}}return o}parseInline(t,i){i=i||this.renderer;let o="",u,c,f,p=t.length;for(u=0;u<p;u++){if(c=t[u],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[c.type]&&(f=this.options.extensions.renderers[c.type].call({parser:this},c),f!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(c.type))){o+=f||"";continue}switch(c.type){case"escape":{o+=i.text(c.text);break}case"html":{o+=i.html(c.text);break}case"link":{o+=i.link(c.href,c.title,this.parseInline(c.tokens,i));break}case"image":{o+=i.image(c.href,c.title,c.text);break}case"strong":{o+=i.strong(this.parseInline(c.tokens,i));break}case"em":{o+=i.em(this.parseInline(c.tokens,i));break}case"codespan":{o+=i.codespan(c.text);break}case"br":{o+=i.br();break}case"del":{o+=i.del(this.parseInline(c.tokens,i));break}case"text":{o+=i.text(c.text);break}default:{let m='Token with "'+c.type+'" type was not found.';if(this.options.silent){console.error(m);return}else throw new Error(m)}}}return o}},Ki=class{constructor(t){this.options=t||di}preprocess(t){return t}postprocess(t){return t}};Cp(Ki,"passThroughHooks",new Set(["preprocess","postprocess"]));function $1(n,t,i){return o=>{if(o.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let u="<p>An error occurred:</p><pre>"+fn(o.message+"",!0)+"</pre>";if(t)return Promise.resolve(u);if(i){i(null,u);return}return u}if(t)return Promise.reject(o);if(i){i(o);return}throw o}}function kh(n,t){return(i,o,u)=>{typeof o=="function"&&(u=o,o=null);let c={...o};o={...We.defaults,...c};let f=$1(o.silent,o.async,u);if(typeof i>"u"||i===null)return f(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return f(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(H1(o),o.hooks&&(o.hooks.options=o),u){let p=o.highlight,m;try{o.hooks&&(i=o.hooks.preprocess(i)),m=n(i,o)}catch(S){return f(S)}let y=function(S){let k;if(!S)try{o.walkTokens&&We.walkTokens(m,o.walkTokens),k=t(m,o),o.hooks&&(k=o.hooks.postprocess(k))}catch(T){S=T}return o.highlight=p,S?f(S):u(null,k)};if(!p||p.length<3||(delete o.highlight,!m.length))return y();let x=0;We.walkTokens(m,function(S){S.type==="code"&&(x++,setTimeout(()=>{p(S.text,S.lang,function(k,T){if(k)return y(k);T!=null&&T!==S.text&&(S.text=T,S.escaped=!0),x--,x===0&&y()})},0))}),x===0&&y();return}if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(i):i).then(p=>n(p,o)).then(p=>o.walkTokens?Promise.all(We.walkTokens(p,o.walkTokens)).then(()=>p):p).then(p=>t(p,o)).then(p=>o.hooks?o.hooks.postprocess(p):p).catch(f);try{o.hooks&&(i=o.hooks.preprocess(i));let p=n(i,o);o.walkTokens&&We.walkTokens(p,o.walkTokens);let m=t(p,o);return o.hooks&&(m=o.hooks.postprocess(m)),m}catch(p){return f(p)}}}function We(n,t,i){return kh(pr.lex,hr.parse)(n,t,i)}We.options=We.setOptions=function(n){return We.defaults={...We.defaults,...n},E1(We.defaults),We};We.getDefaults=yh;We.defaults=di;We.use=function(...n){let t=We.defaults.extensions||{renderers:{},childTokens:{}};n.forEach(i=>{let o={...i};if(o.async=We.defaults.async||o.async||!1,i.extensions&&(i.extensions.forEach(u=>{if(!u.name)throw new Error("extension name required");if(u.renderer){let c=t.renderers[u.name];c?t.renderers[u.name]=function(...f){let p=u.renderer.apply(this,f);return p===!1&&(p=c.apply(this,f)),p}:t.renderers[u.name]=u.renderer}if(u.tokenizer){if(!u.level||u.level!=="block"&&u.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[u.level]?t[u.level].unshift(u.tokenizer):t[u.level]=[u.tokenizer],u.start&&(u.level==="block"?t.startBlock?t.startBlock.push(u.start):t.startBlock=[u.start]:u.level==="inline"&&(t.startInline?t.startInline.push(u.start):t.startInline=[u.start]))}u.childTokens&&(t.childTokens[u.name]=u.childTokens)}),o.extensions=t),i.renderer){let u=We.defaults.renderer||new ss;for(let c in i.renderer){let f=u[c];u[c]=(...p)=>{let m=i.renderer[c].apply(u,p);return m===!1&&(m=f.apply(u,p)),m}}o.renderer=u}if(i.tokenizer){let u=We.defaults.tokenizer||new os;for(let c in i.tokenizer){let f=u[c];u[c]=(...p)=>{let m=i.tokenizer[c].apply(u,p);return m===!1&&(m=f.apply(u,p)),m}}o.tokenizer=u}if(i.hooks){let u=We.defaults.hooks||new Ki;for(let c in i.hooks){let f=u[c];Ki.passThroughHooks.has(c)?u[c]=p=>{if(We.defaults.async)return Promise.resolve(i.hooks[c].call(u,p)).then(y=>f.call(u,y));let m=i.hooks[c].call(u,p);return f.call(u,m)}:u[c]=(...p)=>{let m=i.hooks[c].apply(u,p);return m===!1&&(m=f.apply(u,p)),m}}o.hooks=u}if(i.walkTokens){let u=We.defaults.walkTokens;o.walkTokens=function(c){let f=[];return f.push(i.walkTokens.call(this,c)),u&&(f=f.concat(u.call(this,c))),f}}We.setOptions(o)})};We.walkTokens=function(n,t){let i=[];for(let o of n)switch(i=i.concat(t.call(We,o)),o.type){case"table":{for(let u of o.header)i=i.concat(We.walkTokens(u.tokens,t));for(let u of o.rows)for(let c of u)i=i.concat(We.walkTokens(c.tokens,t));break}case"list":{i=i.concat(We.walkTokens(o.items,t));break}default:We.defaults.extensions&&We.defaults.extensions.childTokens&&We.defaults.extensions.childTokens[o.type]?We.defaults.extensions.childTokens[o.type].forEach(function(u){i=i.concat(We.walkTokens(o[u],t))}):o.tokens&&(i=i.concat(We.walkTokens(o.tokens,t)))}return i};We.parseInline=kh(pr.lexInline,hr.parseInline);We.Parser=hr;We.parser=hr.parse;We.Renderer=ss;We.TextRenderer=ma;We.Lexer=pr;We.lexer=pr.lex;We.Tokenizer=os;We.Slugger=Ji;We.Hooks=Ki;We.parse=We;var dC=We.options,pC=We.setOptions,hC=We.use,gC=We.walkTokens,mC=We.parseInline;var vC=hr.parse,yC=pr.lex;var pi=(n,t)=>({demo:`${n}:"Header \\"${n}\\""`,examples:[{title:"Variations",view:t.map(i=>`${i}:"Header \\"${i}\\""`)},{title:"Complex content",demo:{view:n,content:['text:"Text "','link:{ text: "Link" }']}},{title:"Using anchor",demo:[{view:n,anchor:"foo",content:'text:"Explicit value for an anchor"'},{view:n,anchor:!0,content:'text:"Auto generated anchor based on text content of header"'}]}]});function Sh(n){let t=new Ji;function i(o,u,c,f){let{content:p,anchor:m=!1}=u;o.classList.add("view-header");let y=n.view.render(o,p||"text",c,f);return m&&y.then(()=>{let x=t.slug(m===!0?o.textContent:String(m),{dryrun:!0}),S=n.encodePageHash(n.pageId,n.pageRef,{...n.pageParams,"!anchor":x});o.prepend(V("a",{class:"view-header__anchor",id:`!anchor:${x}`,href:S}))}),y}n.view.define("header",i,{tag:"h4",usage:pi}),n.view.define("h1",i,{tag:"h1",usage:pi}),n.view.define("h2",i,{tag:"h2",usage:pi}),n.view.define("h3",i,{tag:"h3",usage:pi}),n.view.define("h4",i,{tag:"h4",usage:pi}),n.view.define("h5",i,{tag:"h5",usage:pi})}var Ch={demo:{view:"hstack",content:['button:{text:"First button"}','button-primary:{text:"Second button"}']}};function Th(n){n.view.define("hstack",function(t,i,o,u){let{content:c=[]}=i;return n.view.render(t,c,o,u)},{usage:Ch})}var Lh={demo:{view:"html",data:'"<h1>I am inner HTML</h1>"'}};function Eh(n){let t=document.createElement("div");n.view.define("html",function(i,o,u){t.innerHTML=u,i.append(...t.childNodes)},{tag:null,usage:Lh})}var Cu="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMjggMTI4Ij4KICAgIDxyZWN0IHg9IjY1LjYiIHk9IjI0LjYiIHRyYW5zZm9ybT0ibWF0cml4KDAuOTM5NyAtMC4zNDIgMC4zNDIgMC45Mzk3IC05Ljk0MjYgMzEuODI4KSIgZmlsbD0iI0ZGRkZGRiIgd2lkdGg9IjM5LjMiIGhlaWdodD0iMzkiPjwvcmVjdD4KICAgIDxyZWN0IHg9IjcwLjYiIHk9IjUyLjciIHRyYW5zZm9ybT0ibWF0cml4KC0wLjkzOTcgMC4zNDIgLTAuMzQyIC0wLjkzOTcgMTk0Ljc4NTIgODEuMTIwNCkiIGZpbGw9IiNDN0Q3RTIiIHdpZHRoPSIzOS4zIiBoZWlnaHQ9IjEwIj48L3JlY3Q+CiAgICA8cGF0aCBmaWxsPSIjOThCRUQ4IiBkPSJNMTExLjUsNTQuNmwtMS4xLDEuMUw5Ny4xLDE5LjFsMS41LDAuMmM4LDAuOSwxNC43LDYuMiwxNy40LDEzLjdsMCwwQzExOC44LDQwLjQsMTE3LDQ4LjgsMTExLjUsNTQuNnoiPjwvcGF0aD4KICAgIDxwYXRoIGZpbGw9IiM0NTRCNTQiIGQ9Ik03My41LDcyLjJjLTEuMiwwLTIuNC0wLjgtMi44LTJMNTcuMywzMy41Yy0wLjMtMC43LTAuMi0xLjYsMC4xLTIuM2MwLjMtMC43LDAuOS0xLjMsMS43LTEuNmwzNi45LTEzLjRjMS42LTAuNiwzLjMsMC4yLDMuOCwxLjhsMTMuMywzNi42YzAuMywwLjcsMC4yLDEuNi0wLjEsMi4zYy0wLjMsMC43LTAuOSwxLjMtMS43LDEuNkw3NC41LDcyQzc0LjIsNzIuMSw3My44LDcyLjIsNzMuNSw3Mi4yek02NCwzNC4zbDExLjMsMzFsMzEuMy0xMS40bC0xMS4zLTMxTDY0LDM0LjN6Ij48L3BhdGg+CiAgICA8cmVjdCB4PSIzNSIgeT0iNDYuNyIgdHJhbnNmb3JtPSJtYXRyaXgoMC45Mzk3IC0wLjM0MiAwLjM0MiAwLjkzOTcgLTE2LjIwMTEgMjAuOTg4KSIgZmlsbD0iI0ZGRkZGRiIgd2lkdGg9IjMyLjgiIGhlaWdodD0iMTkuNSI+PC9yZWN0PgogICAgPHJlY3QgeD0iMzcuMyIgeT0iNTkuOCIgdHJhbnNmb3JtPSJtYXRyaXgoLTAuOTM5NyAwLjM0MiAtMC4zNDIgLTAuOTM5NyAxMjUuNjc2MyAxMDMuMzk0NikiIGZpbGw9IiNDN0Q3RTIiIHdpZHRoPSIzMi44IiBoZWlnaHQ9IjYiPjwvcmVjdD4KICAgIDxwYXRoIGZpbGw9IiM0NTRCNTQiIGQ9Ik0zOS40LDc0LjJjLTAuNCwwLTAuOS0wLjEtMS4zLTAuM2MtMC43LTAuMy0xLjMtMC45LTEuNi0xLjdsLTYuNy0xOC4zYy0wLjMtMC43LTAuMi0xLjYsMC4xLTIuM2MwLjMtMC43LDAuOS0xLjMsMS43LTEuNmwzMC44LTExLjJjMC43LTAuMywxLjYtMC4yLDIuMywwLjFjMC43LDAuMywxLjMsMC45LDEuNiwxLjdMNzMsNTljMC42LDEuNi0wLjIsMy4zLTEuOCwzLjhMNDAuNCw3NEM0MCw3NC4xLDM5LjcsNzQuMiwzOS40LDc0LjJ6IE0zNi41LDU0LjdsNC42LDEyLjdsMjUuMi05LjJsLTQuNi0xMi43TDM2LjUsNTQuN3oiPjwvcGF0aD4KICAgIDxwYXRoIGZpbGw9IiM0NTRCNTQiIGQ9Ik03MCwxMTguOWMtMS4yLDAtMi40LTAuNy0yLjgtMS45bC0xNC0zNy4ybC04LjQsMy4xbC0xNy4yLDM0LjRjLTAuNywxLjUtMi41LDIuMS00LDEuM2MtMS41LTAuNy0yLjEtMi41LTEuMy00TDQwLDc5YzAuMy0wLjcsMC45LTEuMiwxLjctMS41TDU0LDczLjFjMS41LTAuNiwzLjMsMC4yLDMuOCwxLjhsMTUsNDBjMC42LDEuNi0wLjIsMy4zLTEuOCwzLjlDNzAuNywxMTguOCw3MC40LDExOC45LDcwLDExOC45eiI+PC9wYXRoPgogICAgPHBhdGggZmlsbD0iIzQ1NEI1NCIgZD0iTTEzLjYsODAuMWMtMS4yLDAtMi40LTAuOC0yLjgtMkw2LjMsNjUuOWMtMC42LTEuNiwwLjItMy4zLDEuOC0zLjhjMS42LTAuNiwzLjMsMC4yLDMuOCwxLjhsNC40LDEyLjJjMC42LDEuNi0wLjIsMy4zLTEuOCwzLjhDMTQuMyw4MC4xLDE0LDgwLjEsMTMuNiw4MC4xeiI+PC9wYXRoPgogICAgPHBhdGggZmlsbD0iIzQ1NEI1NCIgZD0iTTEzLjIsNzMuM2MtMS4yLDAtMi40LTAuOC0yLjgtMmMtMC42LTEuNiwwLjItMy4zLDEuOC0zLjhMMzUsNTkuMmMxLjYtMC42LDMuMywwLjIsMy44LDEuOGMwLjYsMS42LTAuMiwzLjMtMS44LDMuOGwtMjIuOCw4LjNDMTMuOSw3My4zLDEzLjYsNzMuMywxMy4yLDczLjN6Ij48L3BhdGg+Cjwvc3ZnPgo=",Mh={demo:{view:"image",src:Cu,height:100},examples:[{title:"Src is not defined",demo:"image"},{title:"Bad url",demo:'image{ src: "<bad url>" }'}]};function Ah(n){n.view.define("image",function(t,i){Object.assign(t,i),t.onerror=()=>t.classList.add("error"),t.onload=()=>t.classList.add("loaded")},{tag:"img",usage:Mh})}var Oh={beforeDemo:['md:"The same as `image` view but with "'],demo:{view:"image-preview",src:Cu,height:100},examples:[{title:"Src is not defined",demo:"image-preview"},{title:"Bad url",demo:'image-preview{ src: "<bad url>" }'}]};function Nh(n){n.view.define("image-preview",function(t,i,o,u){this.render(t,{view:"image",...i},o,u)},{usage:Oh})}var Ph={demo:{view:"indicator",data:{label:"Label",value:"1234"}},examples:[{title:"Indicator as link",demo:{view:"indicator",data:{label:"Label",value:"4321",href:"#"}}}]};function Dh(n){n.view.define("indicator",function(t,i,o,u){let{value:c,label:f}=i,{href:p}=o||{},m=document.createElement("div"),y=document.createElement("div");return m.className="value",y.className="label",p&&(t.href=p),Promise.all([n.view.render(m,c||"text:value",o,u),n.view.render(y,f||"text:label",o,u)]).then(()=>t.append(m,y))},{tag:"a",usage:Ph})}var Ih=new Function("return (value) => alert(`Changed to ${value}!`)")(),_h={examples:[{title:"Input with value",demo:{view:"input",value:'"value"'}},{title:"Input with placeholder",demo:{view:"input",placeholder:"placeholder"}},{title:"Input type number with min and max",demo:{view:"input",htmlType:"number",htmlMin:10,htmlMax:20}},{title:"Input with onChange",demo:{view:"input",onChange:Ih}},{title:"Input with onChange debounced",demo:{view:"input",onChange:Ih,debounce:300}}]};function q1(n,t){try{return new RegExp("((?:"+n+")+)",t)}catch{}return new RegExp("((?:"+n.replace(/[\[\]\(\)\?\+\*\{\}\\]/g,"\\$&")+")+)",t)}function as(n,t="i"){let i=q1(n,t);return i.rawSource=n,i}function U1(n){let t=typeof n;return n!=null&&(t==="object"||t==="function")}function Tr(n,t){if(typeof t=="number"&&(t={wait:t}),!U1(t))return n;let{wait:i}=t,o,u,c,f,p,m,y=0,x=!1,S=!1,k=!0;if(typeof n!="function")throw new TypeError("Expected a function");i=Math.max(0,Number(i)||0),x=!!t.leading,S="maxWait"in t,c=S?Math.max(Number(t.maxWait)||0,i):c,k="trailing"in t?!!t.trailing:k;function T(H){let te=o,W=u;return o=u=void 0,y=H,f=n.apply(W,te),f}function O(H,te){return setTimeout(H,te)}function E(H){clearTimeout(H)}function M(H){return y=H,p=O(I,i),x?T(H):f}function _(H){let te=H-m,W=H-y,U=i-te;return S?Math.min(U,c-W):U}function C(H){let te=H-m,W=H-y;return m===void 0||te>=i||te<0||S&&W>=c}function I(){let H=Date.now();if(C(H))return N(H);p=O(I,_(H))}function N(H){return p=void 0,k&&o?T(H):(o=u=void 0,f)}function R(){p!==void 0&&E(p),y=0,o=m=u=p=void 0}function j(){return p===void 0?f:N(Date.now())}function F(){return p!==void 0}function q(...H){let te=Date.now(),W=C(te);if(o=H,u=this,m=te,W){if(p===void 0)return M(m);if(S)return p=O(I,i),T(m)}return p===void 0&&(p=O(I,i)),f}return q.cancel=R,q.flush=j,q.pending=F,q}function Rh(n){let t={regexp:i=>i?as(i):null,text:i=>i};n.view.define("input",function(i,o,u,c){let{name:f,value:p,type:m="text",placeholder:y,onInit:x,onChange:S,htmlType:k="text",htmlMin:T,htmlMax:O,debounce:E}=o,M=t[m]||t.text,_=i.appendChild(document.createElement("input")),C=p?n.query(p,u,c):c[f];typeof C!="string"&&(C=""),_.type=k,_.value=C,_.placeholder=[y||"",M!==t.text?"("+m+")":""].filter(Boolean).join(" "),typeof T<"u"&&(_.min=T),O&&(_.max=O),_.addEventListener("input",Tr(()=>{let I=_.value.trim();C!==I&&(C=I,typeof S=="function"&&S(M(I),f,u,c))},E)),typeof x=="function"&&x(M(_.value.trim()),f,u,c)},{usage:_h})}var jh={demo:{view:"link",data:{text:"I am link",href:"#"}},examples:[{title:"Link opened in new tab",demo:{view:"link",data:{text:"Discovery github",href:"https://github.com/discoveryjs/discovery",external:!0}}}]};function zh(n){n.view.define("link",function(t,i,o,u){let{content:c,onClick:f}=i,{href:p,text:m,external:y}=o||{};if(typeof o=="string"&&(p=m=o),m===void 0&&p?m=p:p===void 0&&m&&(p=m),p&&(t.href=p),y&&t.setAttribute("target","_blank"),typeof f=="function"&&(t.classList.add("onclick"),t.addEventListener("click",x=>{x.preventDefault(),f(t,o,u)})),c)return n.view.render(t,c,o,u);t.textContent=m},{tag:"a",usage:jh})}function Fh(n){n.view.define("list-item",function(t,i,o,u){let{content:c="text"}=i;return n.view.render(t,c,o,u)},{tag:"li"})}var Qi=(n,t)=>({demo:{view:n,data:["one","two","three","four"]},examples:[{title:"Variations",demo:{view:"context",data:["foo","bar","baz"],content:t.map(i=>[`header{ content: 'md:${JSON.stringify('`view: \\"'+i+'\\"`')}' }`,i])}},{title:"Configure item's content",demo:[{view:n,data:["one","two","three","four"],item:['text:"<item> "',{view:"link",data:'{ href: "#" + $ }'}]}]},{title:"Configure item's config",demo:{view:n,data:["one","two","three","four"],itemConfig:{className:"special"},item:{view:"text",data:'"prefix-" + $'}}}]});function Hh(n){function t(i,o,u,c){let{item:f,itemConfig:p,limit:m,emptyText:y}=o;if(y!==!1&&y!==""&&i.setAttribute("emptyText",y||"Empty list"),!Array.isArray(u)&&u&&(u=[u]),Array.isArray(u))return n.view.renderList(i,this.composeConfig({view:"list-item",content:f},p),u,c,0,n.view.listLimit(m,25))}n.view.define("list",t,{usage:Qi}),n.view.define("inline-list",t,{usage:Qi}),n.view.define("comma-list",t,{usage:Qi}),n.view.define("ol",t,{tag:"ol",usage:Qi}),n.view.define("ul",t,{tag:"ul",usage:Qi})}var Tu={demo:{view:"markdown",source:`# Markdown example

> NOTE: The \`markdown\` view is based on [marked](https://github.com/markedjs/marked) package

Markdown is good because:
* You'll get **formatted** *text* with _no tags_
* It's much simpler than \`HTML\`

\`\`\`html
<b>bold</b><i>italic</i>
\`\`\`
[Read more](https://guides.github.com/features/mastering-markdown/)`},examples:[{title:"Inline config",demo:'markdown{ source: "**Hello** `world`!" }'},{title:"Shorthand syntax",beforeDemo:['md:"You can use `md` as an alias for `markdown` with a string as data. That\'s a **shortest** definition for a marked text"'],demo:'md:"**Hello** `world`!"'},{title:"Array of strings as a source",beforeDemo:['md:"Array of strings might be passed as a value for `source` property which is useful for a long sources\\n> NOTE: This doesn\'t work a source passed via data"'],demo:{view:"markdown",source:["Array","of","`strings`"]}},{title:"Interpolation",beforeDemo:['md:"Interpolation can be used almost anywhere in a markdown to embed the result of a jora query into resulting HTML. Just place a jora query between `{{`{{`}}` and `{{`}`+`}`}}`:"'],demo:{view:"md",source:["Simple evaluation: 2 + 2 = `{{ 2 + 2 }}`","","Markdown view has {{ viewDef.examples.size() }} examples"]}},{title:"Disable anchors for headers",highlightProps:["anchors"],beforeDemo:"Hover a header to see a chain icon on the left side of header when anchors are enabled:",demo:[{view:"markdown",source:"## header with default settings"},{view:"markdown",anchors:!1,source:"## header with disabled anchor"}]},{title:"Sections prelude and postlude",highlightProps:["sectionPrelude","sectionPostlude"],demo:{view:"markdown",sectionPrelude:"struct",sectionPostlude:{view:"link",data:'{ href: "#top", text: "Scroll to top \u2191" }'},source:`Some text

## Header level 2

Some text

### Header level 3

Some text

## Header level 2

Some text`}},{title:"Additional action buttons for code blocks",highlightProps:["codeActionButtons"],beforeDemo:['md:"Use `codeActionButtons` to add additional buttons to code blocks. The option is the same as `actionButtons` for `source` view."'],demo:{view:"markdown",codeActionButtons:[{view:"button",content:'text:"Say \\"Hello world\\""',onClick:new Function('return () => alert("Hello world!")')()}],source:'```js\nconsole.log("Hello world")\n```'}},{title:"Configuration for code blocks",highlightProps:["codeConfig"],beforeDemo:['md:"Use `codeConfig` to specify any settings for code blocks available for `source` view."'],demo:{view:"markdown",codeConfig:{prelude:{view:"block",content:["badge:syntax",'text:"Length: " + content.size()']},postlude:"struct:{ data: $, context: # }"},source:`# Header 1

\`\`\`js
console.log("Hello world")
\`\`\`

## Header 2

text

## Header 3



\`\`\`jora
foo.bar.baz
\`\`\``}},{title:"Showcase",demo:{view:"markdown",source:`
# Header
## Header
### Header
#### Header
##### Header
* One
* Two
    * Three

4. Four
5. Five
    6. Six
- [{{ true }}] Task 1
- [x] Task 2

Interpolation in text: 2 + 2 = \`{{ 2 + 2 }}\`, or in attribute: [link](#dummy-link/{{"exam" + "ple"}} "{{ "example" + " title" }}")

Paragraph **bold** __bold__ *italic* _italic_ ~line-through~ \`code\` [link](#href)

>Blockquote
> > Line 2

\`\`\`js
var some = "code";
\`\`\`

foo | bar
----|-----
1 | A
2 | C
3 | E
`.trim().split(/\n/)}}]};var Lu=class extends We.Renderer{heading(t,i,o,u){let{discovery:c,anchors:f}=this.options,p=u.slug(o),m="";if(f){let y=c.encodePageHash(c.pageId,c.pageRef,{...c.pageParams,"!anchor":p});m=`<a class="view-header__anchor" id="!anchor:${Mt(p)}" href="${y}"></a>`}return`<h${i} class="view-header view-h${i}" data-slug="${p}">${m}${t}</h${i}>
`}link(t,i,o){if(t===null)return o;let u='<a class="view-link" href="'+Mt(t)+'"';return i&&(u+=' title="'+Mt(i)+'"'),t.startsWith("#")||(u+=' target="_blank"'),u+=">"+o+"</a>",u}checkbox(t){return'<label class="view-checkbox"><input type="checkbox" disabled'+(t?" checked":"")+"/></label> "}list(t,i,o){let u=i?"ol":"ul",c=i&&o!==1?` start="${o}"`:"";return`<${u} class="view-${u}"${c}>
`+t+`
</${u}>
`}listitem(t){return'<li class="view-list-item">'+t+`</li>
`}table(t,i){return`<table class="view-table">
<thead>
`+t.replace(/ class="view-table-row"/g,"")+`</thead>
`+(i?"<tbody>"+i+"</tbody>":"")+`</table>
`}tablerow(t){return`<tr class="view-table-row">
`+t+`</tr>
`}tablecell(t,i){let o=i.header?"th":"td";return`<${o} class="view-table-cell"${i.align?` align="${i.align}"`:""}>`+t+`</${o}>
`}};We.setOptions({smartLists:!0,langPrefix:"discovery-markdown-",renderer:new Lu});function Bh(n){let t={discovery:n};function i(c,f){return c.replace(/{{(\d+)}}/gs,(p,m)=>f[m])}function o(c,f){for(let p of c.childNodes)switch(p.nodeType){case document.ELEMENT_NODE:if(!p.classList.contains("view-source")){o(p,f);for(let m of p.attributes)m.nodeValue=i(m.nodeValue,f)}break;case document.TEXT_NODE:p.nodeValue=i(p.nodeValue,f);break}}function u(c,f,p,m){let{source:y,anchors:x=!0,sectionPrelude:S,sectionPostlude:k,codeConfig:T}=f,O=new Map,E=typeof p=="string"?p:y||"";return Array.isArray(E)&&(E=E.join(`
`)),E=E.replace(/{{(.+?)}}/gs,(M,_)=>(_=_.trim(),O.has(_)||O.set(_,O.size),`{{${O.get(_)}}}`)),c.classList.add("view-markdown"),new Promise(M=>{We(E,{...t,anchors:x},(_,C)=>{let I=[];if(c.innerHTML=C,O.size>0){let j=new Array(O.size);for(let[F,q]of O.entries())try{j[q]=n.query(F,p,m)}catch(H){console.error("Interpolation query error: "+H.message)}o(c,j)}let N=new Map,R={after:j=>c.prepend(j)};if(T||S||k){let{firstElementChild:j}=c,F={next:null,data:{sectionIdx:0,slug:null,text:null,href:null}};N.set(R,F);for(let q of[...c.querySelectorAll(":scope > :is(h1, h2, h3, h4, h5, h6)")]){q===j&&(N.delete(R),R=q,F=null);let H=q.querySelector(':scope > a[id^="!anchor:"]'),te={next:null,data:{sectionIdx:N.size,slug:q.dataset.slug,text:q.textContent.trim(),href:H?.hash}};N.set(q,te),F&&(F.next=q),F=te}}for(let j of[...c.querySelectorAll("pre > code")]){let F=document.createDocumentFragment(),q=j.textContent.replace(/\n$/,""),H=(j.className.match(/discovery-markdown-(\S+)/)||[])[1],te=N.get(R),W=j.parentNode;for(;W!==null&&W!==c;){if(N.has(W)){te=N.get(W);break}W=W.previousSibling||W.parentNode}I.push(this.render(F,typeof T=="object"?{view:"source",...T}:T||"source",{syntax:H,content:q},{...m,section:te?.data}).then(()=>j.parentNode.replaceWith(F)))}if(S||k){let j=(F,q,H)=>{let te=document.createDocumentFragment();I.push(this.render(te,F,p,{...m,section:q.data}).then(()=>H(te)))};for(let[F,q]of N)S&&j(S,q,H=>F.after(H)),k&&j(k,q,H=>q.next?q.next.before(H):c.append(H))}Promise.all(I).then(M)})})}n.view.define("markdown",u,{usage:Tu}),n.view.define("md",u,{usage:Tu})}var V1=new Function("return (value) => alert(`Changed to ${value.text}!`)")(),Wh={demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}]},examples:[{title:"With limit",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}],limit:2}},{title:"With custom item",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}],item:"h1:text"}},{title:"On chage handler",demo:{view:"menu",onChange:V1,data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}]}}]};function $h(n){n.view.define("menu",function(t,i,o,u){let{name:c="filter",item:f,itemConfig:p,limit:m,emptyText:y,onClick:x,onInit:S,onChange:k}=i;if(y!==!1&&y!==""&&t.setAttribute("emptyText",y||"No items"),Array.isArray(o)){let T=this.composeConfig({view:"menu-item",content:f,onClick:typeof x=="function"?x:typeof k=="function"?O=>k(O,c):void 0},p);return n.view.renderList(t,T,o,u,0,n.view.listLimit(m,25)).then(()=>{typeof S=="function"&&S(n.query(".[selected].pick()",o,u),c)})}},{usage:Wh})}var qh={demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}]},examples:[{title:"Preselected item",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#",selected:!0},{text:"three",href:"#"}]}},{title:"Disabled item",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#",disabled:!0},{text:"three",href:"#"}]}},{title:"External links",demo:{view:"menu",data:[{text:"one",external:!0,href:"https://github.com/discoveryjs/discovery"},{text:"two",external:!0,href:"https://github.com/discoveryjs/discovery"},{text:"three",external:!0,href:"https://github.com/discoveryjs/discovery"}]}}]};function Uh(n){n.view.define("menu-item",function(t,i,o,u){let{content:c,onClick:f}=i,{text:p,selected:m=!1,disabled:y=!1,href:x,external:S}=o||{};if(y?t.classList.add("disabled"):typeof f=="function"?(t.addEventListener("click",()=>f(o,u)),t.classList.add("onclick")):x&&(t.href=x,t.target=S?"_blank":""),m&&t.classList.add("selected"),c)return n.view.render(t,c,o,u);t.textContent=typeof o=="string"?o:p||"Untitled item"},{tag:"a",usage:qh})}var G1=()=>alert("changed!"),Vh={demo:{view:"nav-button",data:{text:"I am nav button"}},examples:[{title:"With href",demo:{view:"nav-button",data:{text:"I am nav button",href:"#"}}},{title:"External link",demo:{view:"nav-button",data:{text:"I am nav button",external:!0,href:"https://github.com/discoveryjs/discovery"}}},{title:"On click handler",demo:{view:"nav-button",data:{text:"I am nav button"},onClick:G1}}]};function Gh(n){n.view.define("nav-button",function(t,i,o,u){let{name:c,content:f,disabled:p=!1,onClick:m}=i,{text:y="",href:x,external:S}=o||{};if(c&&(t.dataset.name=c),n.query(p,o,u)?t.classList.add("disabled"):typeof m=="function"?(t.addEventListener("click",()=>m(t,o,u)),t.classList.add("onclick")):x&&(t.href=x,t.target=S?"_blank":""),f)return n.view.render(t,f,o,u);t.textContent=y},{tag:"a",usage:Vh})}var Yh=n=>({beforeDemo:['md:"A special view to be used as the first view in the body of the page. This view stays in place as the page scrolls (although it may move slightly to the top of the page at the start of the scroll), so that the most relevant information and important action elements can remain accessible despite page scrolling."'],demoFixed:100,demo:`${n}:"That's a \\"${n}\\""`,examples:[{title:"Prelude",demoFixed:150,highlightProps:["prelude"],demo:{view:n,prelude:['badge:{ text: "demo" }','badge:{ text: "demo", prefix: "prelude", postfix: "postfix" }'],content:'h1:"Header"'}}]});function Kh(n){n.view.define("page-header",function(i,o,u,c){let{prelude:f,content:p,onInit:m,onChange:y}=o,x=i.appendChild(V("div","view-page-header__prelude")),S=i.appendChild(V("div","view-page-header__content")),k=T=>typeof m!="function"&&typeof y!="function"?T:this.composeConfig(T,{onInit:m,onChange:y});return Promise.all([n.view.render(x,k(f||[]),u,c),n.view.render(S,k(p||"text"),u,c)])},{usage:Yh})}var Eu={};Ke(Eu,{pointerXY:()=>Wr});var Jh=new wn({x:0,y:0},(n,t)=>n.x!==t.x||n.y!==t.y);document.addEventListener("pointermove",({x:n,y:t})=>Jh.set({x:n,y:t}),Wn);var Wr=Jh.readonly;var qn=[],Qh=[!1,"popup-hover","trigger-click"],Y1={position:"trigger",hoverTriggers:null,hoverPin:!1,hideIfEventOutside:!0,hideOnResize:!0,render:void 0};function Mu(n,t){return n.el.contains(t)?n:n.relatedPopups.reduce((i,o)=>i||Mu(o,t),null)}function Zh(n){return n?n.getRootNode({composed:!0})===document:!0}function va(n){qn.slice().forEach(t=>t.hideIfEventOutside(n))}function K1(){qn.slice().forEach(n=>n.hideIfTriggerElementNotInDocument())}function Xh(n){qn.slice().forEach(t=>t.hideOnResize(n))}function eg(n){let t=[],i=new Set,o=null,u=null,c=()=>{o===null&&(o=[n.addHostElEventListener("mouseenter",({target:f})=>{if(f!==document)for(let p of t){let m=Mu(p,f),y=m?m.el:f.closest(p.options.hoverTriggers);y&&(p.hideTimer=clearTimeout(p.hideTimer),y!==p.lastHoverTriggerEl&&((!m||!m.hoverPinned)&&(p.lastHoverTriggerEl=y),m||(p.hoverPinned=!1,p.el.classList.remove("pinned"),p.show(y))))}},Wn),n.addHostElEventListener("mouseleave",({target:f})=>{for(let p of t)p.lastHoverTriggerEl===f&&(p.lastHoverTriggerEl=null,p.hideTimer=setTimeout(p.hide,100))},Wn),n.addGlobalEventListener("scroll",f=>{u=setTimeout(()=>va(f),0)},!0),n.addHostElEventListener("scroll",f=>{clearTimeout(u),va(f)}),n.addGlobalEventListener("click",f=>{u=setTimeout(()=>va(f),0)},!0),n.addHostElEventListener("click",f=>{clearTimeout(u),va(f),setTimeout(K1,50);for(let p of t)p.options.hoverPin==="trigger-click"&&p.lastHoverTriggerEl&&p.lastTriggerEl.contains(f.target)&&(p.lastHoverTriggerEl=null,p.hoverPinned=!0,p.el.classList.add("pinned"),f.stopPropagation())},!0)])};Wr.subscribe(()=>{for(let f of qn)f.options.position==="pointer"&&!f.hoverPinned&&!f.frozen&&f.updatePosition()}),n.inspectMode.subscribe(f=>f?qn.forEach(p=>i.add(p)):i.clear()),n.view.Popup=class{constructor(p){this.options={...Y1,...p},this.el=document.createElement("div"),this.el.classList.add("discovery-view-popup"),this.hide=this.hide.bind(this),this.hideTimer=null,this.lastTriggerEl=null,this.lastHoverTriggerEl=null,this.hoverPinned=!1,this.frozen=!1,this.options.className&&this.el.classList.add(this.options.className),Qh.includes(this.options.hoverPin)||(console.warn(`Bad value for \`Popup#options.hoverPin\` (should be ${Qh.join(", ")}):`,this.options.hoverPin),this.options.hoverPin=!1),this.options.hoverTriggers&&(this.el.classList.add("show-on-hover"),this.el.dataset.pinMode=this.options.hoverPin||"none",t.push(this),c())}get relatedPopups(){return qn.filter(p=>this.el.contains(p.lastTriggerEl))}get visible(){return qn.includes(this)}toggle(...p){this.visible?this.hide():this.show(...p)}show(p,m=this.options.render){let y=n.dom.container;this.hideTimer=clearTimeout(this.hideTimer),this.relatedPopups.forEach(x=>x.hide()),this.el.classList.toggle("inspect",n.inspectMode.value),typeof m=="function"&&(this.el.innerHTML="",m(this.el,p,this.hide)),this.lastTriggerEl&&this.lastTriggerEl.classList.remove("discovery-view-popup-active"),p&&p.classList.add("discovery-view-popup-active"),this.lastTriggerEl=p||null,this.visible||(qn.push(this),qn.length===1&&window.addEventListener("resize",Xh)),this.updatePosition(),y.appendChild(this.el)}updatePosition(){if(!this.visible||this.options.position!=="pointer"&&!this.lastTriggerEl)return;let p=n.dom.container,m=ns(p.firstChild),y=vu(window,m),{x,y:S}=Wr.value,k=3,T=this.options.position!=="pointer"?dr(this.lastTriggerEl,p):{left:parseInt(x)+k,right:parseInt(x)-k,top:parseInt(S)-k,bottom:parseInt(S)+k},O=T.top-y.top-3,E=y.bottom-T.bottom-3,M=T.right-y.left-3,_=y.right-T.left-3;O>E?(this.el.style.maxHeight=O+"px",this.el.style.top="auto",this.el.style.bottom=y.bottom-T.top+"px",this.el.dataset.vTo="top"):(this.el.style.maxHeight=E+"px",this.el.style.top=T.bottom-y.top+"px",this.el.style.bottom="auto",this.el.dataset.vTo="bottom"),M>_?(this.el.style.left="auto",this.el.style.right=y.right-T.right+"px",this.el.style.maxWidth=M+"px",this.el.dataset.hTo="left"):(this.el.style.left=T.left-y.left+"px",this.el.style.right="auto",this.el.style.maxWidth=_+"px",this.el.dataset.hTo="right"),this.relatedPopups.forEach(C=>C.updatePosition())}freeze(){this.frozen=!0,this.el.classList.add("frozen")}unfreeze(){this.frozen=!1,this.el.classList.remove("frozen"),this.updatePosition()}hide(){this.hideTimer=clearTimeout(this.hideTimer),this.visible&&!i.has(this)&&(this.relatedPopups.forEach(p=>p.hide()),qn.splice(qn.indexOf(this),1),this.el.remove(),this.unfreeze(),this.lastTriggerEl&&(this.lastTriggerEl.classList.remove("discovery-view-popup-active"),this.lastTriggerEl=null),qn.length===0&&window.removeEventListener("resize",Xh))}hideIfEventOutside({target:p}){!this.options.hideIfEventOutside||i.has(this)||this.lastTriggerEl&&this.lastTriggerEl.contains(p)||Mu(this,p)||this.hide()}hideIfTriggerElementNotInDocument(){(!Zh(this.lastHoverTriggerEl)||!Zh(this.lastTriggerEl))&&this.hide()}hideOnResize(){!this.options.hideOnResize||i.has(this)||this.hide()}destroy(){i.delete(this);let p=t.indexOf(this);p!==-1&&t.splice(p,1),this.hide(),this.el=null,this.lastTriggerEl=null,this.lastHoverTriggerEl=null}}}var tg={demo:{view:"progress",progress:.5,content:'text:"Loading..."'},examples:[{title:"With no label (content)",demo:{view:"progress",progress:.25}},{title:"Custom color",demo:{view:"progress",progress:.85,color:"#bdab77",content:'text:"Yellow progress"'}}]};function ng(n){n.view.define("progress",function(t,i,o,u){let{content:c,progress:f,color:p}=i,m=t.appendChild(V("div",{class:"progress",style:`--progress: ${Math.max(0,Math.min(1,Number(f)))};--color: ${p||"unset"};`}));if(c){let y=t.insertBefore(V("div",{class:"content"}),m);return n.view.render(y,c,o,u)}},{usage:tg})}var rg={demo:{view:"section",header:'text:"I am section"',content:['text:"content"']}};function ig(n){n.view.define("section",function(t,i,o,u){let{header:c,content:f}=i;return n.view.render(t,[{view:"header",content:c},f],o,u)},{usage:rg})}var J1=new Function("return (value) => alert(`Changed to ${value}!`)")(),og={demo:{view:"select",data:["one","two","three","four"]},examples:[{title:"Select with value",demo:{view:"select",value:'"three"',data:["one","two","three","four"]}},{title:"Select with reset option",demo:{view:"select",resetItem:!0,value:'"three"',data:["one","two","three","four"]}},{title:"Select with placeholder",demo:{view:"select",placeholder:"placeholder",data:["one","two","three","four"]}},{title:"Select with onChange",demo:{view:"select",onChange:J1,data:["one","two","three","four"]}},{title:"Select with custom options",demo:{view:"select",item:"h1:text",data:["one","two","three","four"]}}]};function sg(n){let t="text-match:{ text, match: #.filter }",i="{ value: $, text: #.selectVariantTextQuery.query($, #) }",o=new n.view.Popup({className:"view-select-popup"});n.view.define("select",function(u,c,f,p){function m(){if(u.innerHTML="",j!==void 0)return n.view.render(u,n.view.composeConfig({view:"menu-item",data:i,content:M},_),j,F)}let{name:y,value:x,text:S="$",placeholder:k,limit:T,minItemsFilter:O=10,resetItem:E=!1,item:M=t,itemConfig:_,beforeItems:C,afterItems:I,onInit:N,onChange:R}=c,j=x?n.query(x,f,p):p[y],F={...p,selectMinItemsFilter:O,selectCurrentValue:j,selectVariantTextQuery:S,selectResetItem:E?[{value:void 0,text:"",...E,resetItem:!0}]:[]},q=[];return C&&q.push(n.view.composeConfig(C,{onInit:N,onChange:R})),q.push({view:"context",data:`.(${i})`,modifiers:{view:"input",when:"size() >= #.selectMinItemsFilter",type:"regexp",name:"filter",className:"view-select__filter",placeholder:"Filter"},content:{view:"menu",className:"view-select__variants",data:"#.selectResetItem + .[no #.filter or text~=#.filter]",limit:T,itemConfig:n.view.composeConfig({className:[H=>H.resetItem?"reset-item":"",H=>H.value===j?"selected":""]},_),item:M,onClick(H){o.hide(),j!==H.value&&(j=H.value,F={...F,selectCurrentValue:j},m(),typeof R=="function"&&R(H.value,y,H,p))}}}),I&&q.push(n.view.composeConfig(I,{onInit:N,onChange:R})),k&&(u.dataset.placeholder=k),u.tabIndex=0,u.addEventListener("click",()=>{o.toggle(u,H=>n.view.render(H,q,f,F).then(()=>(H.querySelector(".view-select__filter input")||{focus(){}}).focus()))}),typeof N=="function"&&N(j,y,f,p),m()},{usage:og})}function Au(n,t,i){for(let o in n){if(!hasOwnProperty.call(n,o))continue;if(!t){i.properties=null;break}let u;i.dictMode?(u=i.dictMode,u.count++,u.keys.add(o)):i.properties.has(o)?(u=i.properties.get(o),u.count++):(u={count:1,map:Object.create(null)},i.properties.set(o,u)),ls(n[o],t-1,u.map)}}function ls(n,t,i=Object.create(null)){let o=n===null?"null":Array.isArray(n)?"array":typeof n;switch(o){default:o in i||(i[o]=new Map),i[o].set(n,(i[o].get(n)||0)+1);break;case"object":"object"in i||(i.object=new Map,i.object.count=0,i.object.properties=new Map,i.object.dictMode=null,i.object.sortKeys=!1),i.object.count++,i.object.has(n)?i.object.set(n,i.object.get(n)+1):(i.object.set(n,1),Au(n,t,i.object));break;case"array":"array"in i||(i.array=new Map,i.array.count=0,i.array.map=Object.create(null)),i.array.count++,i.array.set(n,(i.array.get(n)||0)+1);for(let u=0;u<n.length;u++)ls(n[u],t,i.array.map);break}return i}var ya=["rgba(83,211,75,0.75)","rgba(241,235,44,0.75)","rgba(244,152,99,0.75)","rgba(148,99,244,0.75)","rgba(44,132,241,0.75)","rgba(233,117,117,0.75)","rgba(85,187,155,0.75)","rgba(151,147,99,0.75)","rgba(216,107,196,0.75)","rgba(108,204,227,0.75)","rgba(164,164,164,0.75)"],us=["null","undefined","string","number","bigint","boolean","symbol","function","array","object"];function cs(n,t,i,o=[],u=""){Object.keys(t).sort((c,f)=>us.indexOf(c)-us.indexOf(f)).forEach((c,f)=>{switch(f>0&&n.appendChild(xn(" | ")),c){default:{let p=n.appendChild(V("span","type",c));i.set(p,{type:"type",path:o,stat:t,name:c});break}case"object":{let p=t[c],{properties:m,dictMode:y,sortKeys:x}=p;if(m===null){i.set(n.appendChild(V("span","expand","{\u2026}")),{type:"expand",path:o,map:t[c],offset:u});break}if(m.size===0){n.appendChild(V("span","object","{}"));break}let S=p.size,k=y?[["[key]",y]]:[...m.entries()],T=u+"    ",O=n.appendChild(V("span","object",["{",V("span",{"data-action":"collapse"})]));m.size>1&&(O.appendChild(V("span",{title:"Toggle dictionary mode (collapse all the values in a single signature)","data-action":"dict-mode","data-enabled":y!==null})),k.some(([E],M)=>M!==0&&E<k[M-1][0])&&O.appendChild(V("span",{title:"Toggle keys sorting","data-action":"sort-keys","data-enabled":x}))),i.set(O,{type:"shape",path:o,map:t[c],offset:u}),S>1&&(O.appendChild(V("span","count")).dataset.value=String(S)),x&&k.sort(([E],[M])=>E<M?-1:E>M?1:0);for(let[E,{count:M,map:_}]of k){let C=V("span","property",[E]);i.set(C,{type:"property",path:o,stat:t,name:E,map:_}),O.appendChild(xn(`
${T}`)),O.appendChild(C),M!==S&&y===null&&C.appendChild(V("span","optional","?")),O.appendChild(xn(": ")),cs(O,_,i,o.concat(y?"*":E),T),O.appendChild(xn(";"))}O.lastChild.nodeValue===";"&&O.appendChild(xn(`
${u}`)),O.appendChild(xn("}"));break}case"array":n.appendChild(xn("[")),cs(n,t[c].map,i,o,u),n.appendChild(xn("]"));break}})}function Zi(n,t){return n.toFixed(t).replace(/\.?0+$/,"")}function ag(n){let t=Math.cos(2*Math.PI*n),i=Math.sin(2*Math.PI*n);return[t,i]}function lg(n){let t=0;return['<svg viewBox="-1 -1 2 2" class="pie">',...n.map(i=>{let[o,u]=ag(t),[c,f]=ag(t+=i.percent),p=i.percent>.5?1:0;return`<path d="${[`M ${o} ${u}`,`A 1 1 0 ${p} 1 ${c} ${f}`,"L 0 0"].join(" ")}" fill="${i.color}"/>`}),"</svg>"].join(`
`)}function Q1(n){let t=0;for(let i in n)n[i].forEach(o=>t+=o);return t}function Z1(n){let t=Object.create(null);for(let i in n)t[i]=0,n[i].forEach(o=>t[i]+=o);return t}function ug(n,t,i){let{count:o,map:u}=t.stat.object.dictMode||t.stat.object.properties.get(t.name),c=(t.stat.object.dictMode||t.stat.object).count,f={name:t.name,path:t.path,total:c,count:o,percent:Zi(100*o/c,1)+"%"};i.view.render(n,[{view:"block",when:"path",className:"path",data:p=>i.pathToQuery(p.path),content:"text:$"},{view:"h1",className:"property",content:["text:name",{view:"html",when:"count != total",data:`"<span class=\\"usage-stat optional\\">" + (
                        "(in <span class=\\"num\\">" + count + "</span> of <span class=\\"num\\">" + total + "</span> objects, <span class=\\"num\\">" + percent + "</span>)"
                    ) + "</span>"`}]}],f),cg(n,{map:u,count:o},i)}function cg(n,{map:t,count:i},o){let u=Z1(t),c=[],f=us.filter(p=>p in t);Object.entries(u).sort(([,p],[,m])=>p-m).reverse().forEach(([p,m],y)=>{c.push({name:Mt(p),count:m,percent:m/i,percent100:Zi(100*m/i,1),color:ya[y]})}),o.view.render(n,{view:"block",when:"typeStat.size() > 1",data:"typeStat",className:"pie-stat",content:[{view:"block",content:{view:"html",data:lg}},{view:"block",content:['html:"<span class=\\"list-header\\">Types usage:</span>"',{view:"list",item:`html:
                            "<span class=\\"dot\\" style=\\"--size: 10px; background-color: " + color + "\\"></span> " +
                            "<span class=\\"caption\\">" + name + "</span>" +
                            "<span class=\\"times\\"> \xD7 " + count + " (" + percent100 + "%)</span>"
                        `}]}]},c),f.forEach(p=>Ou(n,{name:p,stat:t},o))}function Ou(n,t,i){let o=t.stat[t.name],u=Q1(t.stat),c=[],f;switch(t.name){case"number":{let p=[],m=0,y=0,x=0,S=1/0,k=-1/0;o.forEach((T,O)=>{p.push({count:T,value:O}),m+=O*T,y+=T,T>1&&x++,O<S&&(S=O),O>k&&(k=O)}),f={type:t.name,count:y,distinct:o.size,duplicated:x,min:S,max:k,sum:m,avg:Zi(m/y,3),values:p.sort((T,O)=>O.count-T.count||T.value-O.value)},f.distinct>1&&c.push({view:"block",className:"overview-stat",content:`html:
                        "range: (min) <span class=\\"num\\">" + min + "</span> ... " +
                        "<span class=\\"num\\">" + max + "</span> (max), " +
                        "avg: <span class=\\"num\\">" + avg + "</span>"
                    `});break}default:{let p=[],m=0,y=0;o.forEach((x,S)=>{p.push({count:x,value:S}),m+=x,x>1&&y++}),f={type:t.name,count:m,distinct:o.size,duplicated:y,values:t.name==="object"||t.name==="array"?p.sort((x,S)=>S.count-x.count):p.sort((x,S)=>S.count-x.count||x.value>S.value||-(x.value<S.value))};break}}if(t.name!=="undefined"&&t.name!=="null"){if(c.unshift({view:"block",className:"overview-stat",content:['html:"<span class=\\"num\\">" + count + "</span> " + (count > 1 ? "values, " : "value")',{view:"switch",when:"count > 1",content:[{when:"distinct = 1",content:'text:"a single unique value:"'},{when:"distinct = count",content:'text:"all unique, no duplicates"'},{content:['html:"<span class=\\"num\\">" + distinct + "</span> unique, "','html:duplicated = distinct ? "all occur more than once" : "<span class=\\"num\\">" + duplicated + "</span> occur more than once"']}]}]}),f.values.length>1&&f.duplicated&&t.name!=="object"&&t.name!=="array"){let p=[],m=f.values.length===10?10:Math.min(9,f.values.length),y=0;for(let x=0;x<m;x++){let{count:S,value:k}=f.values[x];y+=S,p.push({name:Mt(String(k)),count:S,percent:S/f.count,percent100:Zi(100*S/f.count,1),color:ya[x]})}if(p.length){let x=f.count-y;x>0&&p.push({name:"...",count:x,percent:x/f.count,percent100:Zi(100*x/f.count,1),color:ya[p.length]}),c.push({view:"block",className:"pie-stat",data:p,content:[{view:"block",content:{view:"html",data:lg}},{view:"block",content:['html:"<span class=\\"list-header\\">Dominators:</span>"',{view:"list",item:`html:
                                        "<span class=\\"dot\\" style=\\"--size: 10px; background-color: " + color + "\\"></span> " +
                                        "<span class=\\"caption\\" title=\\"" + name + "\\">" + name + "</span>" +
                                        "<span class=\\"times\\"> \xD7 " + count + " (" + percent100 + "%)</span>"
                                    `}]}]})}}f.values.length>1?(t.name==="number"||t.name==="string")&&c.push({view:"content-filter",name:"filter",content:{view:"menu",data:"values.[no #.filter or value~=#.filter].sort(<value>)",item:[{view:"block",className:"caption",content:"text-match:{ text: value, match: #.filter }"},{view:"block",when:"count > 1",className:"count",content:'text:" \xD7 " + count'}]}}):(t.name==="number"||t.name==="string"||t.name==="boolean")&&c.push({view:"struct",data:"values.pick().value"}),t.name==="object"&&c.push({view:"list",className:"struct-list",data:"values",item:["struct:value",{view:"block",when:"count > 1",className:"count",content:'text:" \xD7 " + count'}]}),t.name==="array"&&Object.keys(o.map).length&&c.push({view:"block",className:"array-types",content:p=>cg(p,o,i)})}i.view.render(n,[{view:"block",when:"path",className:"path",data:p=>i.pathToQuery(p.path),content:"text"},{view:"h1",className:"type",content:["text:name",`html:"<span class=\\"usage-stat\\">" + (
                    count = total
                        ? "only this type is used"
                        : "used in <span class=\\"num\\">" + count + "</span> of <span class=\\"num\\">" + total + "</span> cases (<span class=\\"num\\">" + percent + "</span>)"
                ) + "</span>"`]},...c],{...f,name:t.name,path:t.path,total:u,percent:Zi(100*f.count/u,1)+"%"},{})}var fg={beforeDemo:['md:"The `signature` view is used to output a type definition for current data using TypeScript like style:"'],demo:{view:"signature",expanded:!0}};function Nu(n){let t=new WeakMap,i=({target:o})=>{let u="expand",c=o.closest(`
            .view-signature .expand,
            .view-signature [data-action]
        `);if(!c)return;c.dataset.action&&(u=c.dataset.action,c=c.parentNode);let f=t.get(c);if(f){let{path:p,map:m,offset:y}=f,x=document.createDocumentFragment();switch(u){case"sort-keys":m.sortKeys=!m.sortKeys;break;case"dict-mode":if(m.dictMode)m.dictMode=null;else{let S=m.dictMode={keys:new Set,count:0,map:Object.create(null)};m.forEach((k,T)=>{for(let O in T)hasOwnProperty.call(T,O)&&(S.keys.add(O),S.count++,ls(T[O],1,S.map))})}break;default:m.properties===null?(m.properties=new Map,m.forEach((S,k)=>Au(k,1,m))):m.properties=null}cs(x,{object:m},t,p,y),c.replaceWith(x)}};n.addHostElEventListener("click",i,!1),new n.view.Popup({className:"signature-details",hoverPin:"trigger-click",hoverTriggers:`
            .view-signature .property,
            .view-signature .type
        `,render:function(o,u){let c=t.get(u);switch(c.type){case"property":return ug(o,c,n);case"type":return Ou(o,c,n)}}}),n.view.define("signature",function(o,u,c){let{expanded:f,path:p}=u,m=ls(c,f),y=Array.isArray(p)?p:void 0;cs(o,m,t,y)},{usage:fg})}var Vg=Bn(jg(),1),Un=Bn(Cr(),1),gT=Bn(gu(),1),mT=Bn(Hg(),1),vT=Bn($g(),1);var ju={};Ke(ju,{equal:()=>fs});var{hasOwnProperty:ka}=Object;function fs(n,t){if(n===t)return!0;for(let i in n)if(ka.call(n,i)&&(!ka.call(t,i)||n[i]!==t[i]))return!1;for(let i in t)if(ka.call(t,i)&&(!ka.call(n,i)||n[i]!==t[i]))return!1;return!0}var gi='let name = "world";\n\nconsole.log(`Hello, ${name}!`);',c0=new Function("return num => num + 5")(),qg={demo:{view:"source",data:{syntax:"js",content:gi}},examples:[{title:"Supported syntaxes",beforeDemo:['md:"Following values (for both `name` and `mime`) are supported for `syntax` option:"','html:"<br>"',{view:"table",data:"#.options.syntaxes",cols:{name:{content:"comma-list:name"},mime:{content:"comma-list:mime"}}},'html:"<br>"',"md:\"More syntaxes may be added via `import 'codemirror/mode/[name]/[name]';`\""],source:!1},{title:"Custom line numbers",highlightProps:["lineNum"],demo:{view:"source",data:{content:gi,syntax:"js",lineNum:c0}}},{title:"Hide line numbers",highlightProps:["lineNum"],beforeDemo:['md:"Pass falsy value to `lineNum` option to hide line numbers:"'],demo:{view:"source",data:{content:gi,syntax:"js",lineNum:!1}}},{title:"Additional action buttons",highlightProps:["actionButtons"],demo:{view:"source",actionButtons:[{view:"button",content:'text:"Say \\"Hello world\\""',onClick:new Function('return () => alert("Hello world!")')()}],data:{content:gi,syntax:"js"}}},{title:"Prelude and postlude slots",highlightProps:["prelude","postlude"],demo:{view:"source",prelude:['text:"Prelude:"',"struct:{ data: $, context: # }"],postlude:['text:"Postlude:"',"struct:{ data: $, context: # }"],data:{content:gi,syntax:"js"}}},{title:"Highlight ranges",highlightProps:["refs"],demo:{view:"source",data:{syntax:"js",content:gi,refs:[{range:[4,8]},{range:[21,28],type:"link",href:"#example",tooltip:{position:"trigger",content:['text:"Link to "',"text:href"]}}]}}},{title:"Max content size for syntax highlight",highlightProps:["maxSourceSizeToHighlight"],beforeDemo:['md:"By default a syntax highlighing is not appling to a source longer than 250Kb. Option `maxSourceSizeToHighlight` is using to change max size of source to be syntax highlighted."'],demo:{view:"source",data:{content:gi,syntax:"js",maxSourceSizeToHighlight:4}}}]};var Sa=V("div",{style:["position: fixed","overflow: hidden","font-size: 1px","width: 1px","height: 1px","top: 0","left: 0","white-space: pre"].join(";")},["text"]);function f0(n){document.body.append(Sa);try{let t=window.getSelection(),i=document.createRange();Sa.firstChild.nodeValue=n,i.selectNodeContents(Sa),t.removeAllRanges(),t.addRange(i),document.execCommand("copy")}finally{Sa.remove()}}async function kn(n){try{if(navigator.clipboard){let t=await navigator.permissions.query({name:"clipboard-write"});if(t.state==="granted"||t.state==="prompt")return navigator.clipboard.writeText(n)}}catch{}f0(n)}var d0=250*1024;Un.default.modeToMime={js:"application/javascript",ts:"application/typescript",typescript:"application/typescript",json:"application/json",html:"text/html",css:"text/css",scss:"text/x-scss",less:"text/x-less"};function p0(){let n=new Set,t=new Map,i=o=>{let u=Un.default.resolveMode(o),c=[...t.keys()].find(f=>fs(f,u));return c||(t.set(u,{name:new Set,mime:new Set}),u)};for(let[o,u]of Object.entries(Un.default.modeToMime)){let c=t.get(i(u));c.mime.add(u),c.name.add(o),n.add(o)}for(let[o,u]of Object.entries(Un.default.mimeModes)){let c=t.get(i(o));c.mime.add(o),typeof u=="string"&&(c.name.add(u),n.add(u))}for(let[o]of Object.entries(Un.default.modes))if(!n.has(o)){let u=Un.default.modes[o];t.has(u)||t.set(u,{name:new Set,mime:[]}),t.get(u).name.add(o)}return[...t.values()].map(o=>({name:[...o.name],mime:[...o.mime]}))}function h0(n,t){let i=Un.default.getMode(Un.default.defaults,{name:Un.default.modeToMime[n]||n,isDiscoveryViewDefined:o=>t.view.isDefined(o)});return(o,u)=>{let c=Un.default.startState(i),f=o.split(/(\n|\r\n?)/),p=0;for(let m=0;m<f.length;m++){if(m%2===0){let y=new Un.default.StringStream(f[m],4,{lookAhead:x=>f[m+x],baseToken:function(){}});for(;!y.eol();){let x=i.token(y,c);x&&u(p+y.start,p+y.pos,x),y.start=y.pos}}p+=f[m].length}}}function g0(n,t){let i=n&&n.className,o=[t,Array.isArray(i)?i.join(" "):typeof i=="string"?i:!1].filter(Boolean).join(" ");return o?` class="${o}"`:""}function Ug(n){return`${g0(n,"spotlight")}${n.marker?` data-marker="${n.marker}"`:""}${typeof n.tooltipId=="number"?` data-tooltip-id="${n.tooltipId}"`:""}`}var m0={html:{open({data:n}){switch(n.type){case"link":return`<a href="${n.href}"${Ug(n)}>`;case"spotlight":return`<span${Ug(n)}>`}},close({data:n}){switch(n.type){case"link":return"</a>";case"spotlight":return"</span>"}}}};function Gg(n){n.view.define("source",function(t,i,o,u){let c=t.appendChild(V("div","view-source__prelude")),f=t.appendChild(V("div","view-source__content")),p=t.appendChild(V("div","view-source__postlude")),m=new Map,y=[],{mime:x,binary:S,size:k,maxSourceSizeToHighlight:T=d0,syntax:O,lineNum:E=!0,content:M,refs:_}=o;if(typeof M=="string")if(M.length<T&&y.push([h0(O||x,n),{html:{open({data:C}){return'<span class="token '+C+'">'},close(){return"</span>"}}}]),Array.isArray(_)&&y.push([(C,I)=>_.forEach(N=>{if(N.range){let R;N.tooltip&&m.set(R=m.size,N),I(N.range[0],N.range[1],{type:"spotlight",...N,tooltipId:R})}}),m0]),S)f.innerHTML="Binary content"+(typeof k=="number"?" ("+k+" bytes)":"");else{let C=typeof E=="function"?E:R=>R+1,I=E?'<div class="view-source__lines">'+M.split(/\r\n?|\n/g).map((R,j)=>"<span>"+C(j)+"</span>").join("")+"</div>":"";f.innerHTML=I+`<div class="view-source__source">${(0,Vg.default)(y,"html")(M)}</div>`;let N=V("div","view-source__action-buttons");n.view.render(N,[i.actionButtons,{view:"button",className:"copy",async onClick(R){clearTimeout(R.copiedTimer),await kn(M),R.classList.add("copied"),R.copiedTimer=setTimeout(()=>R.classList.remove("copied"),1250)}}],o,u),f.prepend(N);for(let R of f.querySelectorAll(":scope [data-tooltip-id]")){let j=m.get(Number(R.dataset.tooltipId));delete R.dataset.tooltipId,this.tooltip(R,j.tooltip,j,u)}i.prelude&&n.view.render(c,i.prelude,o,u),i.postlude&&n.view.render(p,i.postlude,o,u)}},{usage:qg,tag:"pre",get syntaxes(){return p0()}})}var Wu={};Ke(Wu,{jsonStringifyAsJavaScript:()=>$r,jsonStringifyInfo:()=>Ca});var fm=Bn(um(),1),{stringifyInfo:Ca}=fm.default;function V0(n,t,i){let o=String(n),[u,c]=o.match(/^(?:\S+\s+)?(\S+)\(/)||[];if(u!=="function"&&u!=="function*"&&c===i.trim().slice(0,-1)&&(i=""),o.indexOf(`
`)===-1)return i+o;let f=o.split(/\n/),p=f[f.length-1].match(/^\s*/)[0].length,m=new RegExp("^\\s{0,"+p+"}");return i+f.map((y,x)=>x&&y.length?y.replace(m,t):y).join(`
`)}function G0(n,t,i){return typeof n=="function"?V0(n,t,i):n instanceof Date?`${i}new Date("${n.toISOString()}")`:i+String(n)}var{toString:cm}=Object.prototype,Y0=new Set(["[object Function]","[object RegExp]","[object Date]"]);function $r(n,t,i=4){let o=[];return String(JSON.stringify(n,t||function(c,f){return typeof f=="string"&&cm.call(this[c])==="[object Date]"&&(f=this[c]),f!==null&&Y0.has(cm.call(f))?(o.push(f),"{{{__placeholder__}}}"):f},i)).replace(/"((?:\\.|[^"])*)"(:?)/g,(c,f,p)=>p&&/^[a-z$_][a-z$_\d]*$/i.test(f)?f+p:`'${f.replace(/\\"/g,'"').replace(/'/g,"\\'")}'`+p).replace(/(^|\n)([ \t]*)(.*?)([a-zA-Z$_][a-zA-Z0-9$_]+:\s*)?'{{{__placeholder__}}}'/g,(c,f,p,m,y)=>f+p+m+G0(o.shift(),p,y))}var K0=/^(?:https?:)?\/\/(?:[a-z0-9\-]+(?:\.[a-z0-9\-]+)+|\d+(?:\.\d+){3})(?:\:\d+)?(?:\/\S*?)?$/i;function Lr(n,t){return`<span class="${n}">${t}</span>`}function $u(n){return Lr("more",`\u2026${$n(n)} more\u2026`)}function Xi(n,t,i){switch(typeof n){case"boolean":case"undefined":return Lr("keyword",n);case"number":case"bigint":return Lr("number",$n(n));case"symbol":return Lr("symbol",String(n));case"function":return"\u0192n";case"string":{let o=t?i.maxCompactStringLength:i.maxStringLength,u=n.length>o+i.allowedExcessStringLength,c=u?Mt(JSON.stringify(n.slice(0,o)).slice(1,-1)):Mt(JSON.stringify(n).slice(1,-1)),f=u?$u(n.length-o):"";return Lr("string",!t&&(n[0]==="h"||n[0]==="/")&&K0.test(n)?`"<a href="${Mt(n)}" target="_blank">${c}</a>${f}"`:`"${c}${f}"`)}case"object":{if(n===null)return Lr("keyword","null");switch(toString.call(n)){case"[object Array]":{let f=i.limitCollapsed===!1?n.length:i.limitCollapsed,p=n.slice(0,f).map(m=>Xi(m,!0,i));return n.length>f&&p.push(`${$u(n.length-f)} `),`[${p.join(", ")}]`}case"[object Date]":return Lr("date",n);case"[object RegExp]":return Lr("regexp",n)}if(t&&i.limitCompactObjectEntries===0){for(let f in n)if(hasOwnProperty.call(n,f))return"{\u2026}";return"{}"}let o=t?i.limitCompactObjectEntries===!1?1/0:i.limitCompactObjectEntries:i.limitCollapsed===!1?1/0:i.limitCollapsed,u=[],c=0;for(let f in n)if(hasOwnProperty.call(n,f)){if(c<o){let p=Mt(f.length>i.maxCompactPropertyLength?f.slice(0,i.maxCompactPropertyLength)+"\u2026":f);u.push(`${Lr("property",p)}: ${Xi(n[f],!0,i)}`)}c++}return c>o&&u.push($u(c-o)),u.length?`{ ${u.join(", ")} }`:"{}"}default:return`unknown type "${typeof n}"`}}var J0=["none","default","badge"];function qu(n){let t=Date.now()+8,i=0;for(;i<n.length&&!(Date.now()>t);i++){let{el:o,config:u,renderer:c,data:f,context:p}=n[i],{place:m="after",className:y,text:x=typeof u!="object"?String(u):"",icon:S,href:k,external:T,tooltip:O}=u,E=J0.includes(u.style)?u.style:m==="before"?"none":"default",M=x!=="",_=["value-annotation","style-"+E,m==="before"?"before":"after",M?"has-text":"",y||""].join(" "),C=V(k?"a":"span",{class:_,href:k,target:T?"_blank":void 0},M?[x]:void 0);S&&(C.classList.add("icon"),/^[a-z_$][a-z0-9_$-]*$/i.test(S)?C.classList.add("icon-"+S):C.style.setProperty("--annotation-image",`url("${S}")`)),O&&c.tooltip(C,O,f,{...p,config:u}),m==="before"?o.before(C):o.parentNode.append(C)}n.splice(0,i)}var dm={level_1:{level_2_1:{level_3_1:{level_4_1:{}},level_3_2:2,level_3_3:3,level_3_4:4,level_3_5:5,level_3_6:6},level_2_2:[{foo:1,bar:2},{foo:3}],level_2_3:3,level_2_4:4,level_2_5:5,level_2_6:6},level_1_2:2,level_1_3:3,level_1_4:4,level_1_5:5,level_1_6:6,level_1_7:7},pm={beforeDemo:['md:"View to display the structure of any value. This is the simplest yet powerful way to enable data exploration."'],demo:{view:"struct",data:{foo:"bar",baz:[1,2,3]}},examples:[{title:"Default expanded depth",highlightProps:["expanded"],beforeDemo:['md:"By default `struct` view is collapsed in one line. The `expanded` option is using to specify an initial expanded depth. A value for the option can be a boolean (`false` \u2192 `0`, `true` \u2192 `1`) or a positive number."'],demoData:dm,demo:['badge:"Default (expanded option is not used)"',{view:"struct"},'badge:"expanded = true"',{view:"struct",expanded:!0},'badge:"expanded = 2"',{view:"struct",expanded:2}]},{title:"Annotations",highlightProps:["annotations"],beforeDemo:[{view:"md",source:["Clarity of data can be improved by adding annotations. An annotation is special marker before or after a value which displaying for expanded objects and arrays only.","Any number of annotations can be applied to a single value.","","Annotations are adding with `annotations` option which should contain an array of strings (jora queries) and functions to compute an annotation config. An annotation config is an object with following fields:","```ts","type AnnotationConfig = {",'   place?: "before" | "after"; // the placement of an annotation, "after" is by default','   style?: "none" | "badge" | "default"; // appereance of annotation, "default" is by default',"   className?: string;         // a class to add to an annotation element","   text?: any;                 // text content of an annotation element","   icon?: string;              // name of icon or url to an image","   href?: string;              // annotation is a link and that's an URL","   external?: boolean;         // open a link in new tab, make sence when `href` is specified only","   tooltip?: TooltipConfig;    // configuration for a tooltip, the same as for any view","}","```","",'An annotation is not displayed (not rendered) when computed annotation config is a falsy value. Any other value (truthy, but not an object) is used as value for `text` option, i.e. `"example"` is the same as `{ text: "example" }`.',"","In addition to a string or function, an object can be used as an element of `annotations` array","* `query` \u2013 a string (jora query) or a function to compute an annotation config","* `debug` (optional) - when truthy a debug information is output to the console; when value is a string, it's used in debug message"]}],demoData:{items:[{id:1,value:"example"},{id:2,value:"bar"},{id:3,value:"baz"}],"annotation styles":["none","default","badge"]},demo:{view:"struct",expanded:3,annotations:['#.key = "items" ? { place: "before", style: "badge", text: "view as table", tooltip: "table" } : null',`$ ~= /az/ and "Value has 'az' substring!"`,'$ in ["none", "default", "badge"] and { style: $, place: "before", text: $ + " before" }','$ in ["none", "default", "badge"] and { style: $, text: $ + " after" }']}},{title:"Limit number of array elements and object entries",beforeDemo:{view:"md",source:["The following options define the maximum number of elements in array or entries in object:","* `limit` (default: `50`) \u2013 max number of elements/entries for expanded array/object","* `limitCollapsed` (default: `4`) \u2013 max of elements/entries for collapsed array/object","* `limitCompactObjectEntries` (default: `0`) \u2013 max number of entries in a object which appears in a collapsed array or object","","> Use `false` for any of these options to disable a limitation"]},highlightProps:["limit","limitCollapsed","limitCompactObjectEntries"],demoData:dm,demo:{view:"struct",limit:4,limitCollapsed:1,expanded:2}},{title:"Maximum length for strings",beforeDemo:{view:"md",source:["The following options define the maximum string length in various cases:","* `maxStringLength` (default: `150`) \u2013 max string length when a host value is expanded","* `maxCompactStringLength` (default: `40`) \u2013 max of string length when a host value is collapsed",'* `allowedExcessStringLength` (default: `10`) \u2013 allowed excess in length before a string will be cut and \\"N more\\" label will be added',"* `maxPropertyLength` (default: `Infinity`) \u2013 max of property name length","* `maxCompactPropertyLength` (default: `35`) \u2013 max of property name length in collapsed objects","","> Expand and collapse `level2` branch to see difference in a value presentation"]},highlightProps:["maxStringLength","maxCompactStringLength","allowedExcessStringLength","maxPropertyLength","maxCompactPropertyLength"],demo:{view:"struct",maxStringLength:30,maxCompactStringLength:10,allowedExcessStringLength:5,maxPropertyLength:30,maxCompactPropertyLength:15,expanded:1},demoData:{stringsInExpandedObject:"Quite a long string value Quite a long string value",string_34_chars:"String with 34 chars length demo x",string_35_chars:"String with 35 chars length demo xx",string_36_chars:"String with 36 chars length demo xxx",very_very_very_very_very_very_very_very_very_very_long_property_name:"a property name should be truncated due to settings, but will not be by default",level2:{stringsInCollapsedObject:"Quite a long string value Quite a long string value",string_14_chars:"Short string x",string_15_chars:"Short string xx",string_16_chars:"Short string xxx"}}}]};var Vn={get collapse(){return V("span",{class:"struct-action-button struct-collapse-value","data-action":"collapse"})},get signature(){return V("span",{class:"struct-action-button show-signature","data-action":"show-signature"})},get actions(){return V("span",{class:"struct-action-button",title:"Value actions","data-action":"value-actions"})},get stringMode(){return V("span",{class:"struct-action-button",title:"Toggle string show mode","data-action":"toggle-string-mode"})},get viewAsTable(){return V("span",{class:"struct-action-button",title:"Toggle view as table","data-action":"toggle-view-as-table"})},get sortKeys(){return V("span",{class:"struct-action-button",title:"Toggle key sorting","data-action":"toggle-sort-keys"})}},hm=fi('"',Vn.collapse,Vn.actions,Vn.stringMode,V("span","string-length"),V("span","string-text-wrapper",[V("span","string-text")]),'"'),gm=fi("[",Vn.collapse,Vn.signature,Vn.actions,Vn.viewAsTable,V("span","value-size"),"]"),mm=fi("{",Vn.collapse,Vn.signature,Vn.actions,Vn.viewAsTable,Vn.sortKeys,V("span","value-size"),"}"),vm=V("div","entry-line"),ym=V("span","value"),bm=V("span","label",["\xA0\xA0\xA0\xA0",V("span","property"),":\xA0"]);var Q0=Object.prototype.hasOwnProperty,Z0=Object.prototype.toString,wm=50,X0=4,ex=0,tx=150,nx=40,rx=10,ix=1/0,ox=35;function ps(n,t){return typeof n=="number"&&isFinite(n)&&n>=1?parseInt(n,10):t}function xm(n,t){if(Array.isArray(n))return n.length>0;if(typeof n=="string"&&(n.length>t.maxStringLength||/[\r\n\f\t]/.test(n)))return!0;if(n&&Z0.call(n)==="[object Object]"){for(let i in n)if(Q0.call(n,i))return!0}return!1}function Uu(n,t){n.appendChild(document.createTextNode(t))}function km(n){return n?", "+$n(n)+" bytes":""}function Sm(n,t,i){t.length>1&&(n.lastElementChild.innerHTML=$n(t.length)+" "+i)}function sx(n,t,i){t.length<=1||t.every(([u],c)=>c===0||u>t[c-1][0])?n.querySelector('[data-action="toggle-sort-keys"]').remove():i&&t.sort(([u],[c])=>u<c?-1:u>c?1:0)}function ax(n,t,i){let o=bm.cloneNode(!0),u=t.length>i?t.slice(0,i)+"\u2026":t;Uu(o.firstElementChild,u),n.appendChild(o)}function Vu(n){function t(C){let I=S.get(C),N=y.get(C);C.classList.add("struct-expand-value"),C.innerHTML=Xi(N,!1,I)}function i(C,I,N){let R=y.get(C);if(C.classList.remove("struct-expand-value"),typeof R=="string"){let j=hm.cloneNode(!0),F=j.lastChild.previousSibling,q=JSON.stringify(R);Uu(F.firstChild,q.slice(1,-1)),F.previousSibling.innerHTML=`length: ${$n(q.length)} chars`,C.innerHTML="",C.appendChild(j)}else if(Array.isArray(R)){let j=x.get(C),F=S.get(C);C.innerHTML="",C.appendChild(gm.cloneNode(!0)),Sm(C,R,"elements"),u(C,C.lastChild,R,(q,H,te)=>{o(q,H,I,F,Object.freeze({parent:j,host:R,key:te,index:te}))},0,F.limit)}else{let j=x.get(C),F=S.get(C),q=Object.entries(R);C.innerHTML="",C.appendChild(mm.cloneNode(!0)),Sm(C,q,"entries"),sx(C,q,N),u(C,C.lastChild,q,(H,[te,W],U)=>{ax(H,te,F.maxPropertyLength),o(H,W,I,F,Object.freeze({parent:j,host:R,key:te,index:U}))},0,F.limit)}}function o(C,I,N,R,j){let F=xm(I,R),q=ym.cloneNode(!0);y.set(q,I),x.set(q,j),S.set(q,R),F&&typeof I!="string"&&N?(C.classList.add("struct-expanded-value"),i(q,N-1)):(F&&q.classList.add("struct-expand-value"),q.innerHTML=Xi(I,!1,R)),p(q,I,R,j),C.appendChild(q)}function u(C,I,N,R,j=0,F=wm){let q=N.length-j-1,H=document.createDocumentFragment();F===!1&&(F=N.length),N.slice(j,j+F).forEach((te,W)=>{let U=vm.cloneNode(!0);R(U,te,j+W),W!==q&&Uu(U,","),H.appendChild(U)}),C.insertBefore(H,I),n.view.maybeMoreButtons(C,I,N.length,j+F,F,(te,W)=>u(C,I,N,R,te,W))}function c(C){let I=y.get(C);Array.isArray(I)||(I=Object.entries(I).map(([N,R])=>({"[key]":N,"[value]":R}))),n.view.render(C,"table",I,{}),C.append(C.lastChild.previousSibling)}function f(C){let I=[],N=x.get(C);for(;N!==null&&N.parent!==null;)I.unshift(N.key),N=N.parent;return I}function p(C,I,N,R){if(N.annotations.length){for(let j of N.annotations)try{let{query:F,debug:q}=j,H={...R,context:N.context},te=n.query(F,I,H);q&&console.info(`Compute struct view annotation${typeof q=="string"?` "${q}"`:""}:`,{data:I,context:H,query:F,queryResult:te}),te&&T.push(te.tooltip?{el:C,config:te,renderer:N.renderer,data:I,context:H}:{el:C,config:te})}catch(F){console.error(F)}m()}}function m(){O===null&&T.length&&(O=Promise.resolve().then(()=>{O=null,qu(T),T.length&&m()},0))}let y=new WeakMap,x=new WeakMap,S=new WeakMap,k=new WeakSet,T=[],O=null,E=new n.view.Popup({className:"view-struct-actions-popup",render:(C,I)=>{let N=I.parentNode,R=y.get(N),j=[];if(typeof R=="string")j=[{text:"Copy as quoted string",action:()=>kn(JSON.stringify(R))},{text:"Copy as unquoted string",action:()=>kn(JSON.stringify(R).slice(1,-1))},{text:"Copy a value (unescaped)",action:()=>kn(R)}];else{let F=n.pathToQuery(f(N)),q=1024*1024*1024,H=!1,te=!1,W=0,U=0;try{let{minLength:L,circular:Z}=Ca(R);W=L,Z.length?te="Converting circular structure to JSON":W>q?te="Resulting JSON is over 1 Gb":(U=Ca(R,null,4).minLength,U>q&&(H="Resulting JSON is over 1 Gb"))}catch(L){te=/Maximum call stack size|too much recursion/i.test(L.message)?"Too much nested structure":L.message}te&&(te="Can't be copied: "+te,H||(H=te)),F&&j.push({text:"Copy path:",notes:Mt(F),action:()=>kn(F)}),j.push({text:"Copy as JSON",notes:`(formatted${km(U)})`,error:H,disabled:!!H,action:()=>kn(JSON.stringify(R,null,4))}),j.push({text:"Copy as JSON",notes:`(compact${te?"":km(W)})`,error:te,disabled:!!te,action:()=>kn(JSON.stringify(R))})}n.view.render(C,{view:"menu",onClick(F){E.hide(),F.action()},item:["html:text",{view:"block",when:"notes",className:"notes",content:"html:notes"},{view:"block",when:"error",className:"error",content:"text:error"}]},j)}}),M=new n.view.Popup({hoverPin:"popup-hover",hoverTriggers:".view-struct .show-signature",render:function(C,I){let N=I.parentNode,R=y.get(N);n.view.render(C,{view:"signature",expanded:2,path:f(N)},R)}}),_=({target:C})=>{let I="expand",N=C.closest(`
            .view-struct.struct-expand,
            .view-struct .struct-expand-value,
            .view-struct .struct-action-button
        `);if(N)switch(N.dataset.action&&(I=N.dataset.action),I){case"expand":N.classList.contains("struct-expand")&&(N=N.lastChild),i(N,0),m(),N.parentNode.classList.add("struct-expanded-value"),k.has(N.parentNode)&&N.parentNode.classList.remove("struct-expand");break;case"collapse":N=N.parentNode,t(N),m(),N.parentNode.classList.remove("struct-expanded-value"),N.classList.remove("view-as-table"),k.has(N.parentNode)&&N.parentNode.classList.add("struct-expand");break;case"show-signature":M.show(N);break;case"value-actions":E.show(N);break;case"toggle-sort-keys":i(N.parentNode,0,N.parentNode.classList.toggle("sort-keys")),m();break;case"toggle-string-mode":N=N.parentNode;let R=N.querySelector(".string-text").firstChild;R.nodeValue=N.classList.toggle("string-value-as-text")?JSON.parse(`"${R.nodeValue}"`):JSON.stringify(R.nodeValue).slice(1,-1);break;case"toggle-view-as-table":if(N=N.parentNode,N.classList.toggle("view-as-table"))c(N);else{let F=N.querySelector(":scope > .view-table");F&&F.remove()}break}};return n.addHostElEventListener("click",_,!1),n.view.define("struct",function(C,I,N,R){let{annotations:j,expanded:F,limit:q,limitCollapsed:H,limitCompactObjectEntries:te,maxStringLength:W,maxCompactStringLength:U,allowedExcessStringLength:L,maxPropertyLength:Z,maxCompactPropertyLength:X}=I,he=j?(n.annotations||[]).concat(j.map(_t=>typeof _t=="string"||typeof _t=="function"?{query:_t}:_t)):n.annotations,yt={renderer:this,context:R,annotations:he,limit:n.view.listLimit(q,wm),limitCollapsed:n.view.listLimit(H,X0),limitCompactObjectEntries:n.view.listLimit(te,ex),maxStringLength:ps(W,tx),maxCompactStringLength:ps(U,nx),allowedExcessStringLength:ps(L,rx),maxPropertyLength:ps(Z,ix),maxCompactPropertyLength:ps(X,ox)};k.add(C),o(C,N,F,yt,{parent:null,host:{"":N},key:"",index:0}),m(),!F&&xm(N,yt)&&C.classList.add("struct-expand")},{usage:pm}),()=>{document.removeEventListener("click",_,!1)}}var Cm={demo:{view:"switch",data:{enabled:!0},content:[{when:"not enabled",content:'text:"I am disabled"'},{when:"enabled",content:'text:"I am enabled"'}]},examples:[{title:"Using with tabs",demo:{view:"context",modifiers:{view:"tabs",tabs:["foo","bar","baz"],name:"section"},content:{view:"switch",content:[{when:'#.section="foo"',content:'text:"FOO!"'},{when:'#.section="bar"',content:'text:"BAR!!"'},{content:'text:"When no other conditions are met"'}]}}}]};function Tm(n){n.view.define("switch",function(t,i,o,u){let{content:c}=i,f='alert-warning:"No case choosen"';if(Array.isArray(c))for(let p=0;p<c.length;p++){let m=c[p];if(m&&n.queryBool(m.when||!0,o,u)){f="data"in m?{view:"context",data:m.data,content:m.content}:m.content;break}}return n.view.render(t,f,o,u)},{tag:!1,usage:Cm})}var Lm={demo:{view:"table",data:[{foo:1,bar:"bar",baz:"zab"},{foo:2,baz:"xyz"},{foo:3,bar:"qux",baz:"baz"},{foo:4,bar:"aaa",baz:"abc"}]},examples:[{title:"Columns setup",demo:{view:"table",cols:[{header:"Header Col 1",data:"col1",content:'text:"prefix-" + $'},{header:"Header Col 3",data:"col3",content:'text:$ + "-suffix"'}],data:[{col1:"foo",col2:"bar",col3:"baz"},{col1:"qux",col2:"oof",col3:"zab"}]}}]};var eo=Object.hasOwnProperty;function Gu(n){return{header:n,view:"table-cell",data:t=>t[n],sorting:`$[${JSON.stringify(n)}] ascN`}}function lx(n,t,i){let o="",u="";if("data"in n&&n.data!==void 0)switch(typeof n.data){case"string":u=`(${n.data})`;break;case"function":o="$dataQuery;",u="$dataQuery(#)";break;default:o="$dataQuery;",u="$dataQuery"}if(typeof n.content=="string"){let c=n.content.indexOf(":"),f=n.content.slice(0,c);if(c===-1||!t.view.has(f))return;let p=n.content.slice(c+1);p&&(u=u?`(${u} | ${p})`:`(${p})`)}return u?t.query(`${o} ${u} ascN`,{dataQuery:n.data},i):!1}function ux(n,t){return typeof t=="string"&&(t={content:t}),eo.call(t,"content")||eo.call(t,"data")?{header:n,view:"table-cell",...t}:{...Gu(n),...t}}function Em(n,t){if(typeof t!="function")return!1;let i=0;try{for(let o=1;o<n.length;o++){let u=Math.sign(t(n[o-1],n[o]));if(u){if(i&&u!==i)return!1;i=u}}}catch(o){return console.error("[Discovery] Error on column order detection in table view",o),0}return-i}function Mm(n){return n===null||typeof n!="object"||n instanceof RegExp}function Am(n){n.view.define("table",function(t,i,o,u){let{cols:c,rowConfig:f,limit:p}=i,m;Array.isArray(o)||(o=o?[o]:[]);let y=t.appendChild(V("thead")).appendChild(V("tr")),x=[],S=t.appendChild(V("tbody")),k=t.appendChild(V("tbody")),T=k.appendChild(V("tr")).appendChild(V("td")),O=E=>{S.innerHTML="",T.innerHTML="";for(let M of x){let _=Em(E,M.sorting);M.el.classList.toggle("asc",_===1),M.el.classList.toggle("desc",_===-1)}return n.view.renderList(S,m,E,{...u,isScalar:Mm,cols:c},0,n.view.listLimit(p,25),T).then(()=>k.hidden=!T.firstChild)};if(Array.isArray(c))c=c.map((E,M)=>typeof E=="string"?Gu(E):{header:"col"+M,view:"table-cell",...E});else{let E=new Set,M=c&&typeof c=="object"?c:{},_=!1;c=[];for(let C of o)if(Mm(C))_=!0;else for(let I of Object.keys(C))E.add(I);for(let C of Object.keys(M))M[C]?E.add(C):E.delete(C);_&&c.push({header:"[value]",view:"table-cell",sorting:"$ ascN",scalarAsStruct:!0,colSpan:"=$isScalar:#.isScalar;$isScalar() ? #.cols.size() : 1"});for(let C of E)c.push(eo.call(M,C)?ux(C,M[C]):Gu(C))}c=c.filter(E=>!eo.call(E,"when")||n.queryBool(E.when,o,u));for(let E of c){if(eo.call(E,"whenData")&&E.whenData!==void 0){let{whenData:N,content:R}=E;E.whenData=void 0,E.content=(j,F)=>n.queryBool(N,j,F)?{content:R}:void 0}let M=y.appendChild(V("th")),_={el:M};x.push(_),M.textContent=E.header;let C=eo.call(E,"sorting")?n.query(E.sorting,null,u):lx(E,n,u),I=typeof C=="function"?Em(o,C):0;I!==0?(E.sorting=C,_.sorting=C,M.classList.add("sortable"),M.addEventListener("click",()=>{M.classList.contains("asc")?O(o.slice().sort((N,R)=>-C(N,R))):M.classList.contains("desc")&&!I?O(o):O(o.slice().sort(C))})):E.sorting=!1}return T.colSpan=c.length,m=this.composeConfig({view:"table-row",cols:"=$isScalar:#.isScalar;$isScalar() ? [#.cols[]] : #.cols"},f),O(o)},{tag:"table",usage:Lm})}function Om(n){n.view.define("table-row",function(t,i,o,u){let{cols:c}=i;if(Array.isArray(c))return Promise.all(c.map((f,p)=>n.view.render(t,f,o,{...u,colIndex:p})))},{tag:"tr"})}var cx={view:"struct",expanded:1},fx=Object.hasOwnProperty;function dx(n,t,i){if(Array.isArray(t)){n.classList.add("complex"),n.textContent=t.length?"[\u2026]":"[]";return}if(i){n.classList.add("complex");for(let o in t)if(fx.call(t,o)){n.textContent="{\u2026}";return}n.textContent="{}";return}if(t!==void 0){if(typeof t=="number"){let o=String(t);n.classList.add("number"),o.length>3?n.innerHTML=$n(o,!1):n.textContent=o;return}n.textContent=String(t)}}function Nm(n){n.view.define("table-cell",function(t,i,o,u){let{content:c,details:f,colSpan:p,scalarAsStruct:m}=i,y=o!==null&&typeof o=="object"&&!(o instanceof RegExp);if(typeof p=="number"&&p>1&&(t.colSpan=p),typeof c=="function"){if(c=c(o,u),!c)return;c=c.content}if((f||!c&&y)&&(t.classList.add("details"),t.addEventListener("click",x=>{let S=x.target;if(S===t){let k=S.parentNode,T=k.parentNode,O=Array.from(T.querySelectorAll(".view-table-cell.details-expanded")).find(M=>M.parentNode.parentNode===T),E=null;if(O){let M=O.parentNode;if(O.classList.remove("details-expanded"),O===t){k.parentNode.removeChild(k.nextSibling);return}M!==k?M.parentNode.removeChild(M.nextSibling):(E=k.nextSibling.firstChild,E.innerHTML="")}E===null&&(E=k.parentNode.insertBefore(document.createElement("tr"),k.nextSibling).appendChild(document.createElement("td")),E.parentNode.className="view-table-cell-details-row",E.className="view-cell-details-content",E.colSpan=1e3),t.classList.add("details-expanded"),n.view.render(E,f||cx,o,u)}})),m&&!c&&!y&&(c="struct"),c)return n.view.render(t,c,o,u);dx(t,o,y)},{tag:"td"})}var Pm={demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}},examples:[{title:"With before and after content",demo:{view:"tabs",name:"example",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],beforeTabs:'text:"<Content before tabs>"',afterTabs:'text:"<Content after tabs>"',content:'text:"Selected: " + #.example'}},{title:"On change handler",demo:{view:"tabs",name:"example",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],onChange:new Function('return (value) => alert("changed to " + value)')(),content:'text:"Selected: " + #.example'}}]};function Dm(n){n.view.define("tabs",function(t,i,o,u){async function c(R){let j=C?x:y;if(I===R)return;let F=p||m||f?{...u,[S]:R}:null;I=R,C=!0,Array.isArray(k)&&(O.innerHTML="",p&&(M.innerHTML="",await n.view.render(M,p,o,F),O.appendChild(M)),await Promise.all(k.map(q=>n.view.render(O,n.view.composeConfig(q,{active:q.value===I}),o,u))),m&&(_.innerHTML="",await n.view.render(_,m,o,F),O.appendChild(_))),f&&(E.innerHTML="",await n.view.render(E,f,o,F)),typeof j=="function"&&j(I,S,o,u)}let{content:f,beforeTabs:p,afterTabs:m,onInit:y,onChange:x}=i,{name:S,tabs:k,tabConfig:T}=i,O=t.appendChild(document.createElement("div")),E=null,M=null,_=null,C=!1,I=NaN,N="value"in i?i.value:S in u?u[S]:void 0;return k=n.query(k,o,u),T=n.view.composeConfig({view:"tab",onClick:c},T),O.className="view-tabs-buttons",p&&(M=document.createElement("div"),M.className="view-tabs-buttons-before"),m&&(_=document.createElement("div"),_.className="view-tabs-buttons-after"),f&&(E=t.appendChild(document.createElement("div")),E.className="view-tabs-content"),typeof S!="string"&&(S="filter"),Array.isArray(k)?k=k.map(R=>{let j=typeof R;return(j==="string"||j==="number"||j==="boolean")&&(R={value:R}),(N===void 0||R.active)&&(N=R.value),n.view.composeConfig(T,R)}):k=[],c(N)},{usage:Pm})}var Yu=()=>alert("clicked!"),Im={demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}},examples:[{title:"Active & disabled tab",demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One"},{value:"two",text:"Two",active:!0},{value:"three",text:"Three",disabled:!0}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}}},{title:"On click handler",demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One",onClick:Yu},{value:"two",text:"Two",onClick:Yu},{value:"three",text:"Three",onClick:Yu}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}}}]};function _m(n){n.view.define("tab",function(t,i,o,u){let{content:c,active:f=!1,disabled:p=!1,onClick:m,value:y,text:x=String(y).replace(/^./,S=>S.toUpperCase())}=i;if(n.query(p,o,u)?t.classList.add("disabled"):typeof m=="function"&&(t.addEventListener("click",()=>m(y)),t.classList.add("onclick")),f&&t.classList.add("active"),c)return n.view.render(t,c,o,u);t.textContent=x},{usage:Im})}var Rm={demo:{view:"text",data:'"Hello world!"'},examples:[{title:"Shorthand usage",view:'text:"Hello world!"'}]};function jm(n){n.view.define("text",function(t,i,o){t.appendChild(document.createTextNode(String(o)))},{tag:!1,usage:Rm})}var Ju={};Ke(Ju,{has:()=>px,matchAll:()=>Ku});var{toString:Hm}=Object.prototype,zm=(n,t,i)=>{let o=n.slice(i).search(t);return o!==-1?{offset:i+o,length:RegExp.lastMatch.length}:null},Fm=(n,t,i)=>{let o=n.indexOf(t,i);return o!==-1?{offset:o,length:t.length}:null};function px(n,t,i){return Hm.call(t)==="[object RegExp]"?i&&!t.ignoreCase?new RegExp(t,t.flags+"i").test(n):t.test(n):typeof t=="string"?i?String(n).toLowerCase().indexOf(t.toLowerCase()):String(n).indexOf(t)!==-1:!1}function Ku(n,t,i,o,u){let c=Hm.call(t)==="[object RegExp]"?zm:typeof t=="string"?Fm:null,f=String(n);if(u)switch(c){case zm:t.ignoreCase||(t=new RegExp(t,t.flags+"i"));break;case Fm:f=f.toLowerCase(),t=t.toLowerCase();break}if(c===null){i(n);return}let p=0;do{let m=c(f,t,p);if(m===null||m.length===0&&m.offset===p){i(p>0?n.slice(p):n);break}m.length!==0&&(m.offset!==p&&i(n.slice(p,m.offset)),o(n.substr(m.offset,m.length))),p=m.offset+m.length}while(p!==n.length)}var Bm={demo:{view:"text-match",data:{text:"I am matched text or a text with matches!",match:/match/}},examples:[{title:"Raw string as match",demo:{view:"text-match",data:{text:"I am matched text or a text with matches!",match:"match"}}},{title:"Using with a link",demo:{view:"link",data:{href:"#"},content:'text-match:{ text: "Test link", match: /\\w+/i }'}},{title:"Various configurations",demo:{view:"table",cols:[{header:"text-match",content:"text-match"},{header:"Config",content:"struct"}],data:[null,{},{},{match:"test"},{match:"Test"},{match:"test",ignoreCase:!0},{match:"Test",ignoreCase:!0},{match:/test/},{match:/test/g},{match:/test/i},{match:/test/,ignoreCase:!0},{match:/test/g,ignoreCase:!0}].map((n,t)=>t>1?{text:"test Test",...n}:n)}}]};var hx=V("span","view-text-match");function Wm(n){n.view.define("text-match",function(t,i,o){let{text:u,match:c,ignoreCase:f=!1}=o||{};Ku(String(u),c,p=>t.appendChild(xn(p)),p=>t.appendChild(hx.cloneNode()).appendChild(xn(p)),f)},{tag:!1,usage:Bm})}var $m={demo:{view:"text-numeric",data:'"Like a `text` view but adds a thousands separator to integer part of numbers, e.g. 12345678 or 12345.67890"'},examples:[{title:"Shorthand usage",view:"text-numeric:1234567"}]};function qm(n){n.view.define("text-numeric",function(t,i,o){t.innerHTML=$n(o)},{tag:"span",usage:$m})}function Um(n){n.view.define("toc-section",function(t,i,o,u){let{header:c,content:f}=i;return n.view.render(t,[{view:"block",className:"header",content:c},{view:"block",className:"content",content:f}],o,u)},{tag:"section"})}var Ta={demo:{view:"context",modifiers:{view:"toggle-group",name:"toggleValue",data:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}]},content:{view:"switch",content:[{when:'#.toggleValue="one"',content:'text:"One"'},{when:'#.toggleValue="two"',content:'text:"Two"'},{when:'#.toggleValue="three"',content:'text:"Three"'}]}},examples:[{title:"With before and after content",demo:{view:"toggle-group",data:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],beforeToggles:'text:"<Content before toggles>"',afterToggles:'text:"<Content after toggles>"'}},{title:"On change handler",demo:{view:"toggle-group",name:"example",onChange:new Function('return (value) => alert("changed to " + value)')(),data:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}]}}]};function Vm(n){n.view.define("toggle",function(t,i,o,u){let{content:c,disabled:f=!1,onToggle:p,value:m,text:y=String(m).replace(/^./,S=>S.toUpperCase())}=i,{checked:x=!1}=i;if(f?t.classList.add("disabled"):typeof p=="function"&&(t.addEventListener("click",()=>{x=!x,p(x,m)}),t.classList.add("onclick")),x&&t.classList.add("checked"),c)return n.view.render(t,c,o,u);t.textContent=y},{usage:Ta})}function Gm(n){n.view.define("toggle-group",function(t,i,o,u){async function c(C,I){let N=E?y:m;M!==I&&(M=I,E=!0,Array.isArray(k)&&(t.innerHTML="",f&&(T.innerHTML="",await n.view.render(T,f,o,{...u,[x]:I}),t.appendChild(T)),p&&(O.innerHTML="",await n.view.render(O,p,o,{...u,[x]:I}),t.appendChild(O)),await Promise.all(k.map((R,j)=>n.view.render(t,n.view.composeConfig(R,{checked:R.value===M}),o[j],u)))),typeof N=="function"&&N(M,x,o,u))}let{beforeToggles:f,afterToggles:p,onInit:m,onChange:y}=i,{name:x,toggleConfig:S}=i,k=[],T=null,O=null,E=!1,M=NaN,_="value"in i?i.value:x in u?u[x]:void 0;return S=n.view.composeConfig({view:"toggle",onToggle:c},S),f&&(T=document.createElement("div"),T.className="view-toggle-group-before"),p&&(O=document.createElement("div"),O.className="view-toggle-group-after"),typeof x!="string"&&(x="filter"),Array.isArray(o)&&(k=o.map(C=>{let I=typeof C;return(I==="string"||I==="number"||I==="boolean")&&(C={value:C}),(_===void 0||C.active)&&(_=C.value),n.view.composeConfig(S,C)})),c(!0,_)},{usage:Ta})}var gx=()=>alert("toggled!"),Ym=([n,...t],i="")=>{let o=[];for(let u=0;u<n;u++){let c=i+"."+(u+1);o.push({title:c,children:t.length?Ym(t,c):null})}return o},Km={demo:{view:"tree",item:"text:text",data:{text:"Root",children:[{text:"Child"},{text:"Another child",children:[{text:"Lvl 2 child"},{text:"Lvl 2 child"}]}]}},examples:[{title:"Expanded tree",demo:{view:"tree",item:"text:text",expanded:999,data:{text:"Root",children:[{text:"Child"},{text:"Another child",children:[{text:"Lvl 2 child"},{text:"Lvl 2 child"}]}]}}},{title:"With empty text",demo:{view:"tree",emptyText:"This tree is empty",data:null}},{title:"With toggle handler",demo:{view:"tree",item:"text:text",onToggle:gx,data:{text:"Root",children:[{text:"Child"},{text:"Another child",children:[{text:"Lvl 2 child"},{text:"Lvl 2 child"}]}]}}},{title:"limitLines",demo:{view:"tree",item:"text:title",limitLines:7,data:Ym([5,3,3])}}]};function Jm(n){function t(o,u,c,f,p,m){return m===!1&&(m=c.length),o.classList.add("incomplete"),c.slice(p,p+m).reduce((y,x)=>y.then(()=>{let{container:S,itemConfig:k}=u;return n.view.render(S,n.view.composeConfig(k,{expanded:x.expanded,last:x.last,hasChildren:x.hasChildren,children:x.children}),x.data,f).then(()=>{if(x.expanded&&x.hasChildren){let T=S.lastChild.querySelector(".view-tree-leaf-children");T.classList.add("incomplete"),u={container:T,itemConfig:n.view.composeConfig(k,k.itemConfig),prev:u}}else for(;x.shift--;)u.container.classList.remove("incomplete"),u=u.prev})}),Promise.resolve()).then(()=>n.view.maybeMoreButtons(o,null,c.length,p+m,m,(y,x)=>t(o,u,c,f,y,x))||o.classList.remove("incomplete"))}function i(o,u,c,f){function p(x,S,k,T=0){x.forEach((O,E,M)=>{let _=n.query(k.children,O,u),C=Array.isArray(_)&&_.length>0,I=E===M.length-1,N=y.has(O)?0:typeof S=="function"?S(O,u):S;y.add(O),m.push({data:O,expanded:N,last:I,hasChildren:C,children:N?null:k.children,shift:I&&(!N||!C)?T+1:0}),C&&N&&p(_,typeof S=="number"?S-1:S,n.view.composeConfig(k,k.itemConfig),I?T+1:0)})}let m=[],y=new Set;return p(o,f,c),m}n.view.define("tree",function(u,c,f,p){let{children:m="children",item:y="text",itemConfig:x,collapsible:S,emptyText:k,onToggle:T}=c,{expanded:O,limit:E,limitLines:M=!0}=c;if(k!==!1&&k!==""&&u.setAttribute("emptyText",k||"Empty tree"),!Array.isArray(f)&&f&&(f=[f]),Array.isArray(f)){if(E=n.view.listLimit(E,25),M=n.view.listLimit(M,25),O=typeof O=="function"?O:n.view.listLimit(O,1),M){let _=i(f,p,this.composeConfig({children:m},x),O),C={container:u,itemConfig:this.composeConfig({view:"tree-leaf",itemConfig:x,content:y,collapsible:S,onToggle:T},x)};return t(u,C,_,p,0,M)}return this.renderList(u,this.composeConfig({view:"tree-leaf",itemConfig:x,content:y,collapsible:S,expanded:O,children:m,limit:E,onToggle:T},x),f,p,0,E)}},{tag:"ul",usage:Km})}function Qm(n){let t=new WeakMap,i=({target:o})=>{let u=o.closest(".view-tree-leaf-toggle");if(u){let c=t.get(u),f=!u.parentNode.classList.toggle("collapsed");typeof c.render=="function"&&c.render(),typeof c.onToggle=="function"&&c.onToggle(f,u.parentNode,c.data,c.context)}};n.addHostElEventListener("click",i,!1),n.view.define("tree-leaf",async function(o,u,c,f){let{expanded:p,content:m="text",itemConfig:y,collapsible:x=!0,last:S,hasChildren:k,children:T,limit:O,onToggle:E}=u,M=o.appendChild(V("span","view-tree-leaf-toggle")),_=o.appendChild(V("span","view-tree-leaf-content")),C=null,I=k;if(S&&o.classList.add("last"),x||o.classList.add("non-collapsible"),await this.render(_,m,c,f),T&&(C=n.query(T,c,f),I=Array.isArray(C)&&C.length>0),I){let N=o.appendChild(V("ul","view-tree-leaf-children")),R={data:c,context:f,onToggle:E,render:null},j=(F,q)=>{typeof q=="number"&&q--,this.renderList(N,this.composeConfig({view:"tree-leaf",expanded:q,itemConfig:y,content:m,collapsible:x,children:T,limit:O,onToggle:E},y),F,f,0,this.listLimit(O,25))};o.classList.add("has-children"),t.set(M,R),(typeof p=="function"?p(c,f):p)?C&&await j(C,p):(o.classList.add("collapsed"),C&&(R.render=()=>{R.render=null,j(C,p||1)}))}},{tag:"li"})}var Pa={};Ke(Pa,{default:()=>Zm,notFound:()=>Xm,report:()=>pv,viewsShowcase:()=>hv});function Zm(n){n.page.define("default",{view:"switch",content:[{when:"not #.datasets",content:[{view:"h1",className:"no-data-loaded",content:'text:"Discovery.js"'},{view:"markdown",when:"#.meta.description",source:"=#.meta.description"},'html:"<br>"',"preset/upload"]},{content:['page-header{ content: "h1:#.name" }',{view:"struct",expanded:1}]}]})}function Xm(n){n.page.define("not-found",['alert-warning:"Page `" + name + "` not found"'])}var Ma={};Ke(Ma,{decode:()=>vs,encode:()=>ms});var qr=[],gs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),Ea=gs.reduce(function(n,t,i){return n[t]=i,n},{});for(hs=0;hs<255;hs++)qr[hs]=String.fromCharCode(hs);var hs;function mx(n){let t="";for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?t+=qr[o]:o<2048?t+=qr[o>>6|192]+qr[o&63|128]:t+=qr[o>>12|224]+qr[o>>6&63|128]+qr[o&63|128]}return t}function vx(n){n=mx(n);let t=new Array(n.length);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t}function yx(n){let t="";for(let i=0;i<n.length;){let o=n.charCodeAt(i++);if(o<128)t+=String.fromCharCode(o);else{let u=n.charCodeAt(i++);if(o&32){let c=n.charCodeAt(i++);t+=String.fromCharCode((o&15)<<12|(u&63)<<6|c&63)}else t+=String.fromCharCode((o&31)<<6|u&63)}}return t}function bx(n){return yx(n.map(function(t){return qr[t]}).join(""))}function ms(n){let t="";Array.isArray(n)||(n=vx(n));for(let i=0;i<n.length;){let o=n[i++],u=n[i++],c=n[i++],f=o>>2,p=(o&3)<<4|u>>4,m=(u&15)<<2|c>>6,y=c&63;u==null?m=y=64:c==null&&(y=64),t+=gs[f]+gs[p]+gs[m]+gs[y]}return t}function vs(n){let t=[],i,o,u,c;n=n.replace(/[^a-zA-Z0-9\+\/]/g,"");for(let f=0;f<n.length;){i=Ea[n.charAt(f++)],o=Ea[n.charAt(f++)],u=Ea[n.charAt(f++)],c=Ea[n.charAt(f++)];let p=i<<2|o>>4,m=(o&15)<<4|u>>2,y=(u&3)<<6|c;t.push(p,m,y)}return(u==null||u==64)&&t.pop(),(c==null||c==64)&&t.pop(),bx(t)}function ev(n,t){return typeof n=="string"?n:t||""}var nv=["query","view","title","dzen","noedit"],wx=["q","v","title","dzen","noedit"];function rv(n){let{query:t,view:i,title:o,dzen:u,noedit:c,...f}=typeof n=="string"?{query:n}:n,p=[];return u&&p.push(["dzen"]),c&&p.push(["noedit"]),o&&p.push(["title",o]),t&&p.push(["q",ms(t)]),typeof i=="string"&&p.push(i?["v",ms(i)]:["v"]),Object.keys(f||{}).sort().forEach(m=>{nv.includes(m)||p.push([m,m.endsWith("-b64")&&typeof f[m]=="string"?ms(f[m]):f[m]])}),p}function iv(n){let t=Object.fromEntries(n),i={title:t.title||"",query:vs(ev(t.q,"")),view:"v"in t?vs(ev(t.v,"")):void 0,dzen:"dzen"in t,noedit:"noedit"in t};return Object.keys(t).forEach(o=>{wx.includes(o)||(i[o]=o.endsWith("-b64")&&typeof t[o]=="string"?vs(t[o]):t[o])}),i}function xx(n){return Object.fromEntries(Object.entries(n).filter(([t])=>!nv.includes(t)))}function tv(n,t,i){for(let o of Object.keys(n))if(o!==i&&n[o]!==t[o])return!1;for(let o of Object.keys(t))if(o!==i&&n[o]!==t[o])return!1;return!0}function Aa(n,t={}){let i={...n,params:xx(n.params)};return!tv(t,i,"params")||!tv(t.params,i.params)?i:t}function kx(n){let t=f=>f.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/'/g,"\\'"),{title:i,query:o,view:u}=n,c={title:i,query:o,view:u};return`{
${Object.keys(c).reduce((f,p)=>f.concat(c[p]?`    ${p}: '${t(c[p])}'`:[]),[]).join(`,
`)}
}`}function Sx(n){if(n&&(typeof n=="number"||typeof n=="string")){let t=new Date(n);return isNaN(t)?null:t}return n instanceof Date?n:null}function ov(n){let t=Sx(n);return t?t.toISOString().replace(/^(\d{4})-(\d{2})-(\d{2})T([\d:]+).*/,"$3/$2/$1 $4 UTC"):null}function sv(n,t){let i,o,u,c,f=new n.view.Popup({render:(x,S,k)=>n.view.render(x,{view:"menu",data:[{text:"Copy report permalink",disabled:"no #.actions.permalink",action:async()=>kn(await n.action.call("permalink",n.pageHash))},{text:"Copy report as JSON",action:()=>kn(kx(n.pageParams))}],onClick(T){k(),T.action()}})}),p=V("div","report-actions",[c=V("button",{class:"edit-mode discovery-hidden-in-dzen",title:"Toggle edit mode",onclick:({target:x})=>{x.blur(),t({noedit:!n.pageParams.noedit})}}),V("button",{class:"share",title:"Share ...",onclick:({target:x})=>{x.blur(),f.show(x)}}),V("button",{class:"toggle-fullscreen",title:"Toggle full page mode",onclick:({target:x})=>{x.blur(),t({dzen:!n.pageParams.dzen})}})]),m=x=>{x.parentNode.dataset.title=x.value||x.placeholder},y=V("div","report-header",[V("div",{class:"report-header-text","data-title":"\xA0"},[i=V("input",{class:"discovery-hidden-in-dzen",placeholder:"Untitled report",oninput:({target:x})=>{m(x)},onchange:({target:x})=>{m(x),t({title:x.value},!0)},onkeypress:x=>{(x.charCode===13||x.keyCode===13)&&x.target.blur()}}),V("span","timestamp",[o=V("span",null,"&nbsp;"),u=V("span")])])]);return{el:[p,y],render(x,S){let{title:k,noedit:T}=S.params,O=ov(S.datasets?.[0]?.resource?.createdAt);i.value=k,m(i),c.classList.toggle("disabled",T),o.innerText=O?"Data collected at "+O+" | ":"",u.innerText="Rendered at "+ov(new Date)}}}function av(n,t,i){return n.length?`${n.length} ${n.length===1?t:i}`:"empty"}function Cx(n){return Array.isArray(n)?`Array (${av(n,"element","elements")})`:n&&typeof n=="object"?`Object (${av(Object.keys(n),"key","keys")})`:`Scalar (${n===null?"null":typeof n})`}function lv(n,t){let i=!1,o={},u,c=(k,T,O,E)=>n.querySuggestions(k,T,O,E),f=new n.view.QueryEditor(c).on("change",k=>u.checked&&t({query:k},!0)),p=n.getQueryEngineInfo(),m=V("div","buttons"),y=V("div","data-query-result"),x=V("div","form query-editor-form",[V("div","query-editor",[f.el,V("div","editor-toolbar",[V("span","syntax-hint",`Use <a class="view-link" href="${p.link}" target="_blank">${p.name}</a> ${p.version||""} syntax for queries`),V("label","view-checkbox",[u=V("input",{class:"live-update",type:"checkbox",checked:!0,onchange:k=>{k.target.checked&&t({query:f.getValue()},!0)}}),V("span","view-checkbox__label","process on input")]),m])]),y]);n.view.render(m,{view:"button-primary",content:'text:"Process"',onClick:()=>{o={},t({query:f.getValue()},!0),n.scheduleRender("page")}});let S;return{el:x,perform(k,T){let O=Aa(T,o.context),E=T.params.query,M,_;if(f.setValue(E,k,O),o.query===E&&o.data===k&&o.context===O)_=o.results;else{S&&(S.clear(),S=null);try{M=Date.now(),_=n.query(E,k,O),M=Date.now()-M}catch(C){let I=C.details&&C.details.loc,N=f.cm.doc;if(I){let[R,j]=C.details.loc.range;S=C.details.token==="EOF"||R===j||E[R]===`
`?N.setBookmark(N.posFromIndex(R),{widget:V("span","discovery-editor-error"," ")}):N.markText(N.posFromIndex(R),N.posFromIndex(j),{className:"discovery-editor-error"})}return o={},y.innerHTML='<div class="report-error query-error">'+Mt(C.message)+"</div>",{error:C}}o={data:k,context:O,query:E,results:_},y.innerHTML="",n.view.render(y,{view:"expand",header:`text:"${Cx(_)} in ${parseInt(M,10)}ms"`,expanded:i,onToggle:C=>i=C,content:{view:"struct",expanded:1}},_)}return{data:_}}}}function Oa(n){return!!(n&&n.nodeType===Node.TEXT_NODE)}function Qu(n,t=`
`){let i="";for(let o of n.childNodes)!Oa(o)&&o.previousSibling&&!Oa(o.previousSibling)&&(i+=t),i+=Tx(o,t);return i}function Tx(n,t=`
`){switch(n.nodeType){case Node.ELEMENT_NODE:let[i,o=""]=n.cloneNode().outerHTML.split(/(?=<\/[^>]+>$)/);return i+(n.firstChild&&!Oa(n.firstChild)?t+"  ":"")+Qu(n,t+"  ")+(n.lastChild&&!Oa(n.lastChild)?t:"")+o;case Node.TEXT_NODE:return n.nodeValue;case Node.COMMENT_NODE:return"<!--"+n.nodeValue+"-->";case Node.DOCUMENT_FRAGMENT_NODE:return Qu(n,t)}return""}function uv(n,t){let i=[],o=[...Array.isArray(n.highlight)?n.highlight:n.highlight?[n.highlight]:[]];Array.isArray(n.highlightProps)&&o.push(`(")?(?:${n.highlightProps.join("|")})\\1(?=:)`);for(let u of o){let c=new RegExp(u,"gm"),f;for(;f=c.exec(t);)i.push({range:[f.index,f.index+f[0].length]})}return i}function Na(n){let t={view:"context",modifiers:[{view:"switch",when:"beforeDemo",content:[{when:({beforeDemo:i})=>typeof i=="string",content:'html:"<p>" + beforeDemo + "</p>"'},{content:{view:"render",config:"beforeDemo",context:"{ __demoContext: true, ...(viewDef | { name, group, options }) }"}}]},{view:"block",when:"demo or view",className:"usage-render",postRender:(i,{onInit:o},{demoFixed:u})=>{u&&(i.classList.add("demo-fixed"),i.style.height=u+"px"),o(i,"root")},content:{view:"render",config:"demo or view",data:"demoData",context:"{ __demoContext: true, ...(viewDef | { name, group, options }) }"}},{view:"switch",when:"afterDemo",content:[{when:({afterDemo:i})=>typeof i=="string",content:'html:"<p>" + afterDemo + "</p>"'},{content:{view:"render",config:"afterDemo",context:"{ __demoContext: true, ...(viewDef | { name, group, options }) }"}}]}],content:{view:"tabs",when:"source != false",className:"usage-sources",name:"code",tabs:[{value:"config",text:"Config (JS)"},{value:"config-json",text:"Config (JSON)"},{value:"html",text:"Rendered HTML"}],content:{view:"switch",content:[{when:'#.code="config"',content:[{view:"expand",when:'"demoData" in $',header:'text:"Input data"',content:{view:"struct",expanded:2,data:"demoData"}},{view:"source",className:"first-tab",data:i=>{let o=$r(i.demo||i.view);return{syntax:"discovery-view",content:o,refs:uv(i,o)}}}]},{when:'#.code="config-json"',content:[{view:"expand",when:'"demoData" in $',header:'text:"Input data"',content:{view:"struct",expanded:2,data:"demoData"}},{view:"source",data:i=>{let o=JSON.stringify(i.demo||i.view,null,4);return{syntax:"json",content:o,refs:uv(i,o)}}}]},{when:'#.code="html"',content:{view:"source",data:(i,o)=>({syntax:"html",content:Qu(o.root)})}}]}}};return{view:"block",className:"discovery-view-usage",data({name:i,options:o},u){let c=[...n.view.values].filter(f=>f.options.usage===o.usage).map(f=>f.name);return c.includes(i)||c.unshift(i),u.viewDef={demo:{view:i,data:'"'+i+'"'},...typeof o.usage=="function"?o.usage(i,c):Array.isArray(o.usage)?{examples:o.usage}:o.usage,name:i,group:c,options:o}},content:["h1:name",t,{view:"list",data:"examples",itemConfig:{className:"usage-section"},item:["h2{ anchor: true, data: title }",t]}]}}var cv=`{
    view: 'struct',
    expanded: 1
}`,fv=[{name:"Table",content:$r({view:"table"})},{name:"Auto-link list",content:$r({view:"ol",item:"auto-link"})},{name:"Signature",content:$r({view:"signature",expanded:2})}];function Lx(n,t,i){return V("div",{class:"report-editor-tab",onclick:()=>i({view:t})},n||"Untitled preset")}function dv(n,t){let i={},o=Array.isArray(n.options.viewPresets)?fv.concat(n.options.viewPresets):fv,u,c,f,p,m,y,x=new n.view.ViewEditor(n).on("change",O=>y.checked&&t({view:O},!0)),S=V("div","buttons"),k=V("div","form view-editor-form",[V("div","view-editor-form-header",[V("div","report-editor-tabs view-mode",m=["Default","Custom"].map(O=>V("div",{class:"report-editor-tab","data-mode":O.toLowerCase(),onclick:()=>t({view:O==="Default"?void 0:cv},!0)},O))),V("div","report-editor-tabs presets",o.map(({name:O,content:E})=>Lx(O,E,t))),V("div","view-editor-form-header-links",'<a href="#views-showcase" class="view-link">Views showcase</a>')]),u=V("div",{class:"view-editor-form-content",hidden:!0},[V("button",{class:"view-button formatting",title:"Prettify (input should be a JSON)",onclick(){x.focus();try{let O=x.getValue().trim(),E=new Function("return 0,"+O)();t({view:$r(E)})}catch(O){console.error("[Discovery] Prettify failed",O)}}}),x.el,V("div","editor-toolbar",[c=V("div","view-expand",[V("div",{class:"header",onclick:()=>{c.classList.toggle("expanded"),p.classList.toggle("visible")}},[f=V("div","header-content"),V("div","trigger")]),p=V("div","view-editor-view-list")]),V("label","view-checkbox",[y=V("input",{class:"live-update",type:"checkbox",checked:!0,onchange:O=>{O.target.checked&&t({view:x.getValue()},!0)}}),V("span","view-checkbox__label","build on input")]),S])])]);n.view.render(S,{view:"button-primary",content:'text:"Build"',onClick:()=>{i={},t({view:x.getValue()},!0),n.scheduleRender("page")}}),new n.view.Popup({className:"view-editor-view-list-hint",hoverTriggers:".view-editor-view-list .item.with-usage",render:function(O,E){n.view.render(O,Na(n),n.view.get(E.textContent),{})}}),f.textContent=`Available ${[...n.view.entries].filter(([,O])=>O.options.usage).length} views`;let T=()=>p.innerHTML='<a href="#views-showcase" class="view-link">Views showcase</a><br><br>'+[...n.view.entries].sort().map(([O,E])=>`<div><a class="item view-link${E.options.usage?" with-usage":""}" ${E.options.usage?'href="#views-showcase:'+O+'"':""}>${O}</a></div>`).join("");return T(),n.view.on("define",Tr(T,100)),{el:k,render(O,E,M){let _=Aa(E,i.context),C=typeof E.params.view=="string"?"custom":"default",I=E.params.view,N=null;if(x.setValue(I),u.hidden=C!=="custom",m.forEach(R=>R.classList.toggle("active",R.dataset.mode===C)),!I&&C==="default"&&(I=cv),i.view!==I||i.data!==O||i.context!==_){M.innerHTML="";try{N=Function("return "+(I?"0,"+I:"null"))(),n.view.render(M,N,O,_)}catch(R){n.view.render(M,j=>{j.className="report-error render-error",j.innerHTML=Mt(String(R))+"<br>(see details in console)",console.error(R)})}i={data:O,context:_,view:I}}}}}function pv(n){function t(u,c){return n.setPageParams({...n.pageParams,...u},c)}function i(){if(o!==null)return o;let u=sv(n,t),c=lv(n,t),f=dv(n,t),p=V("div",{class:"report-editor discovery-hidden-in-dzen",hidden:!0},[c.el,f.el]),m=V("div","report-content"),y=[...u.el,p,m];return o={header:u,queryEditor:c,viewEditor:f,reportEditorEl:p,reportContentEl:m,layout:y}}let o=null;n.page.define("report",function(u,c,f){let{header:p,queryEditor:m,viewEditor:y,reportEditorEl:x,reportContentEl:S}=i();x.hidden=f.params.noedit,p.render(c,f);let k=m.perform(c,f);if(k.error){y.el.hidden=!0,S.hidden=!0;return}y.el.hidden=!1,S.hidden=!1,y.render(k.data,f,S)},{reuseEl:!0,init(u){i().layout.forEach(c=>u.appendChild(c))},encodeParams:rv,decodeParams:iv})}var Ex=`
## Working with views

A presentation in Discovery.js is setting up as a tree of views.
There are several ways to define a view, some may be more convenient in one case, others in another.
The main notation is an object, all other notations are converted to it.
The only required property is \`view\` which defines a view name, any other properties are optional:

\`\`\`discovery-view
{
    view: "view-name"
}
\`\`\`

The following properties are supported by any view:

- \`when\` \u2013 control view rendering (should it be rendered or not) before an input data is transformed (\`data\` is applied)
- \`data\` \u2013 transform input data for the view and its nested views
- \`whenData\` \u2013 control view rendering after an input data is transformed
- \`className\` \u2013 add class name(s) to the root element of view if any
- \`postRender\` - a function which should be invoked after view rendering but before placing to destination place in DOM
- \`tooltip\` \u2013 setup a tooltip to show on view hovering, can be applied for views with a container only

The order of evaluation during a view render:

\`\`\`js
                          input data | output data (the result of "data" evaluation if any)
                                     |
render start ---> [when] --> [data] -|-> [whenData] --> [postRender] --> [className] --> render finish
                                     |
\`\`\`

When \`data\` property is specified, it changes flow's data according the following rules:

- a string \u2013 treated as a query which result is used as the output data
- a function like \`fn(data, context)\` \u2013 the result of the function invocation is used as the output data
- any other value used as the output data

> Note: Only \`when\` and \`data\` properties get an input data, any other functions and queries receive
a result of \`data\` property evalution. When \`data\` is not specified all the queries and functions
receive the same input data.

Properties \`when\` and \`whenData\` can take:

- a string \u2013 treated as a query
- \`true\` \u2013 treated as a empty query which mean that the data itself is examinated with no any transformation
- \`undefined\` \u2013 same when not specified, just render (ignore the property)
- a function like \`fn(data, context)\`
- any other value used as is

Regardless of how the value is obtained, it is coerce to a boolean.
Plase note, that Jora rules are used which mean that empty arrays and object with no own keys are falsy (truthy in JavaScript).
The view is only rendered if the resulting value is truthy.

## Queries for properties

In some cases, it is necessary to compute the value of a property based on the data.
To do this, you can use a string value for a property that starts with \`=\`.
This will mean that everything after the \`=\` is a query which will take output data and produce a value for the property.
Other values are passed to the view render as is, without any changes.

In the following, limit number of items rendered at once only if there are more than 12 items:

\`\`\`discovery-view
{
    view: 'list',
    limit: '=size() <= 12 and 10'  // the same as '=size() <= 12 ? false : 10'
}
\`\`\`

> Note: In those rare cases when you need to pass to a property a string that starts with \`=\`,
you can use a query like \`="=some string"\`,<br>e.g. \`{ view: 'example', prop: '="=string="' }\`

## Shorthand notations

| Shorhand notation | Expands into ... |
| --- | --- |
| \`'name'\` | \`{ view: 'name' }\`
| \`'name:<query>'\` | \`{ view: 'name', data: '<query>' }\`
| \`'name{ foo: size() / 2, bar: "qux" }'\` | \`{ view: 'name', foo: '=size() / 2', bar: 'qux' }\`

## List of views

If you need to specify a list of views, then you must use an array.
An array with view definitions can be passed anywhere a view is accepted as a value.

\`\`\`discovery-view
[
    {
        view: 'list',
        item: [
            'text:name',
            { view: 'badge', data: 'something.size()' }
        ]
    },
    'table{ limit: 10 }'
]
\`\`\`

## Tooltip

A canonical form for a toolup setup is an object with fields (all are optional):

\`\`\`js
{
    className: 'string',
    position: 'trigger', // 'trigger' or 'pointer' (default)
    content: 'a view setup'
}
\`\`\`

Instead of such object, any view notation can be used, i.e. a string, an object with \`view\` property, an array or a function:

| Shorhand notation | Expands into ... |
| --- | --- |
| \`'name'\` | \`{ content: 'name' }\`
| \`{ view: 'name' }\` | \`{ content: { view: 'name' } }\`
| \`['view', { view: 'name' }]\` | \`{ content: ['view', { view: 'name' }] }\`

A content is rendering into a popup container. When \`className\` is used it behaves the same as for a view but applies to a popup container.
`;function hv(n){n.page.define("views-showcase",{view:"context",data:()=>[...n.view.values],modifiers:[{view:"block",className:"sidebar",content:{view:"content-filter",content:{view:"menu",name:"view",limit:!1,data:`
                            .[name ~= #.filter]
                            .sort(name asc)
                            .({ ..., disabled: no options.usage })
                        `,item:"text-match:{ text: name, match: #.filter }"}}}],content:{view:"block",className:"content",data:"$[=> name=(#.view.name or #.id)]",content:{view:"switch",content:[{when:"no $ and #.id",content:'alert-warning:"View \\"" + #.id + "\\" not found"'},{when:"no $",content:['h1:"Views showcase"','alert:"\u2190 Select a view to get details"',{view:"markdown",source:Ex}]},{content:[{view:"context",postRender:function(t,i,o,u){n.setPageRef(o.name),n.cancelScheduledRender(),u.id=n.pageRef}},Na(n)]}]}}},{sidebar:!1})}function ys(n,t){let i=V("style",null,":host{display:none}"),o=new Set,u=Promise.resolve();return Array.isArray(t)&&(n.append(...t.map(c=>{switch(typeof c=="string"&&(c={type:"style",content:c}),c.type){case"style":case"inline":return V("style",{media:c.media},c.content);case"link":case"external":{let f,p,m=new Promise((x,S)=>{f=x,p=S});return o.add(m),V("link",{rel:"stylesheet",href:c.href,media:c.media,onerror(x){o.delete(m),p(x),o.size||i.remove()},onload(){o.delete(m),f(),o.size||i.remove()}})}default:throw new Error(`Unknown type "${c.type}" for a style descriptor`)}})),o.size&&(u=Promise.all(o),n.append(i))),u}var Zu=0,gv=[{view:"badge",when:'view.data != parent.(view or viewRoot).data or "data" in view.config',data:{text:"D"},tooltip:'text:"Data value was changed"'},{view:"badge",when:"view.context != parent.(view or viewRoot).context",data:{text:"C"},tooltip:'text:"Context value was changed"'}];function Mx(n){let t=rs(n),i=dr(n,t),o=0,u=0,{scrollTop:c,scrollLeft:f,clientWidth:p,clientHeight:m}=t,y=c+o,x=f+u,S=f+p,k=c+m,T=c+i.top,O=f+i.left,E=O+i.width,M=c,_=f;(T<y||T>k)&&(M=T-o),O<x?_=O-u:E>S&&(_=Math.max(O,f-(E-S))-u),t?.scrollTo(_,M)}function mv(){Zu=0}function vv(n,{selectTreeViewLeaf:t,detailsSidebarLeafExpanded:i}){return{view:"tree",when:"#.selectedView",data:"$[0]",className:"sidebar",limitLines:!1,itemConfig:{collapsible:"=not viewRoot",expanded:o=>i.has(o),onToggle:(o,u,c)=>o?i.add(c):i.delete(c)},item:{view:"switch",content:[{when:"viewRoot",content:{view:"block",className:"view-root",content:"text:viewRoot.name"}},{when:"$ = #.selectedView",content:[{view:"block",className:[o=>o.view?.skipped?"skipped":!1,"selected"],content:'text:view.config.view or "#root" | $ + "" = $ ? $ : "\u0192n"',postRender(o){requestAnimationFrame(()=>{n.querySelector(".sidebar").scrollTop=Zu,Mx(o)})}},...gv]},{content:[{view:"link",className:o=>o.view?.skipped?"skipped":!1,data:'{ text: view.config.view or "#root" | $ + "" = $ ? $ : "\u0192n", href: false, view, self: $ }',onClick(o,u){Zu=n.querySelector(".sidebar")?.scrollTop||0,t(u.self)}},...gv]}]}}}var yv={view:"block",className:["content","props-config"],data:"#.view | view or viewRoot",content:[{view:"block",className:"content-section skip",when:"skipped",content:'block{ content: "badge:{ text: skipped }" }'},{view:"block",className:"content-section render",when:'config | view + "" != view',content:'source:{ content: config.view + "", syntax: "js" }'},{view:"block",when:"props != undefined",className:"content-section props",content:{view:"struct",expanded:2,data:"props"}},{view:"block",className:"content-section config",content:[{view:"struct",expanded:1,data:"config"},{view:"tree",data:(n,t)=>t.host.view.getViewConfigTransitionTree(n.config).deps,whenData:!0,expanded:3,children:"deps",item:{view:"struct",expanded:1,data:"value"}}]}]};function Ax(n){n=n.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1").trimRight(),n=n.replace(/\n[ \t]+\n/g,`

`);let t=n.split(/\n+/),i=+(n.match(/^\s/)===null),o=1e3;for(var u=i;u<t.length;u++){let c=t[u].match(/^\s*/);if(c[0].length<o&&(o=c[0].length),o==0)break}return o>0&&(n=n.replace(new RegExp("(^|\\n) {"+o+"}","g"),"$1")),n}var bv={view:"list",className:"data-flow-transitions",limit:1,when:".[view]",data:`
        [null]    // to show empty list on first render
        + .[view] // filter viewRoot
        .(
            $parent;
            $parentName: parent.view.config.view;
            $queryData: view | inputDataIndex != undefined ? inputData[inputDataIndex] : inputData;

            view | [
                ...'data' in config ? { inputData: $queryData, transition: config.data, name: config.view, view: $, $parent } : [],
                ...inputDataIndex != undefined ? { inputData, transition: \`$[\${inputDataIndex}]\`, name: \`\${$parentName} \u2192 \${config.view}\`, view: $, $parent } : []
            ]
        )
    `,whenData:"size() > 1",itemConfig:{when:!0},item:[{view:"block",className:"root-data",when:"inputData = ..parent.viewRoot[].data",content:'badge:"Root data"'},{view:"struct",data:"inputData"},{view:"block",className:"data-flow-transition",content:[{view:"switch",content:[{when:"$isString: #.isString; transition | $isString() or $ = undefined",content:{view:"context",data(n){return{content:Ax(n.transition),refs:[]}},content:{view:"source",data:`{
                                    ...,
                                    syntax: "jora",
                                    lineNum: false
                                }`}}},{content:{view:"struct",data:"transition"}}]},{view:"block",className:"view-name",content:"text:name"}]}]},wv={view:"block",className:"content-section data",data:"#.view",content:[{view:"context",data:"..parent",content:bv},{view:"context",content:{...bv,limit:!1}},{view:"block",className:"root-data",when:"view or viewRoot | data = ([@] + @..parent).viewRoot[].data",content:'badge:"Root data"'},{view:"struct",expanded:1,data:"view or viewRoot | data"}]};function Ox(n,t){if(n===null)return!0;for(let i of["top","left","width","height"])if(n[i]!==t[i])return!0;return!1}var Xu=n=>{let t=!1,i=null,o=null,u=null,c=null,f,p=new Set,m=new Map,y=new Map,x=V("div","cancel-hint view-alert view-alert-warning"),S=V("div",{class:"discovery-view-inspector-overlay",onclick:()=>_(o&&!u?o:null)},[x]),k=Tr(()=>{if(!t||u!==null)return;let j=n.view.getViewTree([N.el]),F=new Set([...y.keys()]);(function H(te,W){for(let U of te){if(!U.node||!U.view&&!U.viewRoot){U.children.length&&H(U.children,W);continue}let L=dr(U.node,W),Z=y.get(U.node)||null;Z===null?(Z={el:W.appendChild(document.createElement("div")),box:null},Z.el.className=U.viewRoot?"overlay view-root":"overlay",y.set(U.node,Z),m.set(Z.el,U)):F.delete(U.node),Ox(Z.box,L)&&(Z.el.style.top=`${L.top}px`,Z.el.style.left=`${L.left}px`,Z.el.style.width=`${L.width}px`,Z.el.style.height=`${L.height}px`,Z.box=L),U.children.length&&(U.node.nodeType===1&&(Z.el.style.overflow=getComputedStyle(U.node).overflow!=="visible"?"hidden":"visible"),H(U.children,Z.el))}})(j,S);for(let H of F)y.get(H).el.remove(),y.delete(H);T()},{maxWait:0,wait:50}),T=()=>{let{x:j,y:F}=Wr.value;I([...n.dom.container.parentNode.elementsFromPoint(j|0,F|0)||[]].find(q=>m.has(q))||null)},O=j=>{(j.key==="Escape"||j.keyCode===27||j.which===27)&&n.inspectMode.set(!1)},E=()=>{t||(t=!0,document.addEventListener("scroll",k,Wn),document.addEventListener("keydown",O,!0),Wr.subscribe(k),f=setInterval(k,500),n.dom.container.append(S),k())},M=()=>{t&&(t=!1,clearInterval(f),document.removeEventListener("scroll",k,Wn),document.removeEventListener("keydown",O,!0),Wr.unsubscribe(k),R=!1,delete x.dataset.alt,S.remove(),C())},_=j=>{u=j||null,j?(N.show(),N.freeze(),delete x.dataset.alt):R?n.inspectMode.set(!1):(p.clear(),mv(),C(),k())},C=()=>{i&&i.classList.remove("hovered"),i=null,o=null,u=null,N.hide()},I=j=>{if(j===i)return;if(i!==null&&i.classList.remove("hovered"),i=j,j===null){c=setTimeout(C,100);return}j.classList.add("hovered");let F=m.get(j)||null;if(F===null){o=null;return}o!==null&&F.view===o.view||(o=F,clearTimeout(c),N.show())},N=new n.view.Popup({className:"discovery-inspect-details-popup",position:"pointer",hideIfEventOutside:!1,hideOnResize:!1,render(j){let F=u||o,q=[],H=F;for(;H!==null&&(H.view||H.viewRoot);)H!==F&&u!==null&&p.add(H),q.unshift(H),H=H.parent;n.view.render(j,{view:"context",modifiers:[vv(j,{selectTreeViewLeaf:_,detailsSidebarLeafExpanded:p})],content:{view:"context",data(te,W){return W.isString=U=>typeof U=="string",te},modifiers:{view:"block",className:"toolbar",content:[{view:"toggle-group",className:"stack-view-chain",name:"view",data:".({ value: $ })",value:"=$[-1].value",toggleConfig:{className:[te=>te.value.viewRoot?"view-root":!1,te=>te.value.view&&te.value.view.skipped?"skipped":!1],content:['text:value | viewRoot.name or view.config.view | $ + "" = $ ? $ : "\u0192n"']}},{view:"button",when:u!==null,content:'text:"Close inspector"',onClick(){n.inspectMode.set(!1)}}]},content:[yv,{view:"block",className:["content","data-context"],content:[wv,{view:"block",className:"content-section context",data:"$[-1] | view or viewRoot",content:{view:"struct",expanded:1,data:"context"}}]}]}},q,{selectedView:u,host:n})}});n.action.define("startInspect",E),n.action.define("stopInspect",M),n.inspectMode.subscribeSync(j=>j?E():M());let R=!1};var nc={};Ke(nc,{localStorageEntry:()=>tc,sessionStorageEntry:()=>Px});function Nx(n){let t="__storage_test__"+Math.random(),i;try{i=window[n]}catch{return null}try{i.setItem(t,t),i.removeItem(t)}catch(o){if(!(o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&i.length!==0))return null}return i}function xv(n){let t=new Map;return t.storage=Nx(n),t.getOrCreate=i=>t.get(i)||Dx(i,t),t.getOrCreate.available=t.storage!==null,t}var ec=new Map([["session",xv("sessionStorage")],["local",xv("localStorage")]]),Px=ec.get("session").getOrCreate,tc=ec.get("local").getOrCreate;addEventListener("storage",n=>{for(let[,t]of ec)t.storage===n.storageArea&&t.has(n.key)&&t.get(n.key).forceSync()});function Dx(n,t){let i=null,o=new tr,u=(f=t.storage.getItem(n))=>{i!==f&&o.emit("change",i=f)},c={get value(){return this.get()},get(){return i},set(f){t.storage&&(t.storage.setItem(n,f),u())},delete(){t.storage&&(t.storage.removeItem(n),u())},forceSync(){return t.storage&&u(),this.get()},on(f,p){return o.on("change",f),p&&f(i),()=>o.off("change",f)},off(f){o.off("change",f)}};return t.set(n,c),c.forceSync(),c}var Sv=new Set([!0,!1,"auto","disabled"]),Da=new Set,Ia=matchMedia("(prefers-color-scheme:dark)"),rc=tc("discoveryjs:darkmode"),kv=new Map([["true",!0],["false",!1],["auto","auto"]]),_a=null;function Ix(){for(let n of Da)n.mode==="auto"&&n.set("auto")}function Cv(n){let t=kv.has(n)?kv.get(n):null;if(_a!==t){_a=t;for(let i of Da)i.persistent&&i.mode!=="disabled"&&i.set(t!==null?t:"auto")}}Cv(rc.value);rc.on(Cv);Ia.addListener(Ix);function Tv(n,t){return(n==="off"||n==="disable")&&(n="disabled"),n!=="disabled"&&t&&_a!==null&&(n=_a),n}function Lv(n){return Sv.has(n)||(n="disabled"),n==="auto"?Ia.matches:n===!0}function Ev(n,t){return Lv(Tv(n,t))}var Ra=class{constructor(t,i){this.persistent=i?rc:null,this.handlers=[],this.set(Tv(t,i),!0),Da.add(this)}subscribe(t,i){let o={fn:t};return this.handlers.push(o),i&&o.fn(this.value,this.mode),()=>{let u=this.handlers.indexOf(o);o=null,u!==-1&&this.handlers.splice(u,1)}}destroy(){Da.delete(this)}set(t,i){let o=this.value,u=this.mode;Sv.has(t)||(console.warn('Bad value "'+t+'" for darkmode, fallback to "disabled"'),t="disabled"),this.mode=typeof t=="boolean"?"manual":t,this.value=Lv(t),this.mode!=="disabled"&&(this.persistent&&!i&&this.persistent.set(this.mode==="auto"?"auto":this.value),(this.value!==o||this.mode!==u)&&this.handlers.forEach(({fn:c})=>c(this.value,this.mode)))}toggle(t){switch(this.mode){case"auto":this.set(!Ia.matches);break;case"manual":this.set(t&&this.value!==Ia.matches?"auto":!this.value);break}}};var ic={};Ke(ic,{ContentRect:()=>bs});var _x=typeof ResizeObserver=="function",bs=class extends wn{constructor(){super(),this.el=null,_x&&(this.observer=new ResizeObserver(t=>{for(let i of t)this.set(i.contentRect)}))}observe(t){t=t||null,this.observer&&this.el!==t&&(this.el!==null&&this.observer.unobserve(this.el),t!==null&&this.observer.observe(t)),this.el=t}};function Mv(n){n.nav.append({name:"index-page",when:"#.widget | pageId != defaultPageId",data:'{ text: "Index", href: pageLink(#.widget.defaultPageId) }'})}function Av(n){n.nav.append({name:"report-page",when:"#.widget | pageId != reportPageId",data:'{ text: "Make report", href: pageLink(#.widget.reportPageId) }'})}function Ov(n){n.nav.append({name:"load-data",when:"#.actions.uploadFile and (#.datasets or (#.widget | pageId != defaultPageId))",content:'text:"Open file\u2026"',onClick:"=#.actions.uploadFile"})}function Nv(n){let t=()=>{};n.nav.menu.append({view:"block",className:["toggle-menu-item","dark-mode-switcher"],name:"dark-mode",when:'#.widget | darkmode.mode != "disabled"',postRender:(i,o,u,{widget:c,hide:f})=>{let p;t(),t=c.darkmode.subscribe((m,y)=>{let x=y==="auto"?"auto":m;x!==p&&(i.innerHTML="",p=x,c.view.render(i,{view:"toggle-group",beforeToggles:'text:"Color schema"',onChange:S=>{p=S,c.darkmode.set(S),f()},value:x,data:[{value:!1,text:"Light"},{value:!0,text:"Dark"},{value:"auto",text:"Auto"}]},null,{widget:c}))},!0)}})}function Pv(n){n.nav.append({name:"inspect",onClick:()=>n.inspectMode.set(!n.inspectMode.value),postRender(t){t.title="Enable view inspection"}})}function sc(n,t){let i=[],o=(u,c,f)=>{switch(c){case"after":c=i.findIndex(p=>p.name===f),c===-1?c=i.length:c++;break;case"before":c=i.findIndex(p=>p.name===f),c===-1&&(c=i.length);break;default:(c===void 0||isNaN(c)||!isFinite(c))&&(c=i.length)}i.splice(Math.max(0,Math.min(i.length,c)),0,n.view.composeConfig(t,u))};return Object.assign(i,{insert:o,prepend(u){o(u,0)},append(u){o(u)},before(u,c){o(c,"before",u)},after(u,c){o(c,"after",u)},replace(u,c){let f=i.findIndex(p=>p.name===u);f!==-1?i[f]=c:o(c)},remove(u){let c=i.findIndex(f=>f.name===u);if(c!==-1)return i.splice(c,1)[0]}})}var ja=class{constructor(t){let i=V("div","powered-by-discoveryjs",["powered by ",V("a",{class:"view-link",href:"https://github.com/discoveryjs/discovery",target:"_blank"},"Discovery.js"),` ${ca}`]);this.host=t,this.popup=null,this.data=null,this.context=null,this.primary=sc(t,"nav-button"),this.secondary=sc(t,"nav-button"),this.menu=sc(t,"menu-item"),this.config=[this.secondary,{view:"nav-button",name:"burger",data:()=>{let o=fi();return this.host.view.render(o,this.menu,this.host.data,{...this.context,hide:()=>this.popup&&this.popup.hide()}).then(()=>[...o.childNodes].filter(u=>u.nodeType===1||u.nodeType===3))},whenData:!0,onClick:(o,u)=>{this.popup||(this.popup=new this.host.view.Popup({className:"discovery-nav-popup"}),this.popup.el.addEventListener("click",({target:c})=>{c.closest("a[href]")&&setTimeout(()=>this.popup.hide(),50)},!0)),this.popup.toggle(o,c=>c.append(...u,i))}},this.primary],Object.assign(this,this.secondary),this.contentRect=new bs,this.contentRect.subscribe(({width:o,height:u})=>{let{container:c}=t.dom;c&&(c.style.setProperty("--discovery-nav-width",o+"px"),c.style.setProperty("--discovery-nav-height",u+"px"))})}render(t,i,o){this.contentRect.observe(t),t&&(this.data=i,this.context={...o,widget:this.host},this.host.view.setViewRoot(t,"nav",{config:this.config,data:this.data,context:this.context}),t.innerHTML="",this.host.view.render(t,this.config,this.data,this.context))}};var to=new Map,ac=null;function Rx(){ac=null;for(let[n,t]of to.entries())console.groupCollapsed(`${n} (${t.length})`),t.forEach(i=>console.warn(...i)),console.groupEnd();to.clear()}function jx(n,...t){ac===null&&to.size===0&&(ac=setTimeout(Rx,1)),to.has(n)?to.get(n).push(t):to.set(n,[t])}function _v(n,t,i){switch(typeof t){case"function":return t;case"string":return Object.assign(o=>o&&Object.hasOwnProperty.call(o,t)?o[t]:void 0,{getterFromString:`object[${JSON.stringify(t)}]`});default:throw new Error(`[Discovery] Bad type "${typeof key}" for ${i} in object marker "${n}" config (must be a string or a function)`)}}function Dv(n,t,i,o){return t&&hasOwnProperty.call(t,i)?_v(n,t[i],`"${i}" option`):o}function Iv(n,t,i){return(Array.isArray(t[i])?t[i]:[]).map(o=>_v(n,o,`"${i}" option`))}function zx(n){let{name:t,indexRefs:i,lookupRefs:o,page:u,getRef:c,getTitle:f}=n;u&&(c!==null?i.unshift(c):console.warn(`Option "ref" for "${t}" marker must be specified when "page" options is defined ("page" option ignored)`)),i.length>0&&o.unshift(T=>T);let p=new Set,m=new Map,y=new Map,x=new WeakMap;return{page:c!==null?u:null,mark:T=>{if(T===null||typeof T!="object"){console.warn(`Invalid value used for "${t}" marker (should be an object)`);return}p.add(T);for(let O of i){let E=O(T),M=E===null?"null":typeof E;if(M==="object"||M==="string"||M==="number"){if(!m.has(E)){m.set(E,T);continue}m.get(E)!==T&&jx(`The same reference value used for different objects for "${t}" marker`,`Reference value "${E}"`,{refGetter:O.getterFromString||O,ref:E,currentObject:m.get(E),newObject:T})}}},lookup:T=>{let O=T===null?"null":typeof T;if(O!=="object"&&O!=="string"&&O!=="number")return null;if(y.has(T))return y.get(T);if(x.has(T))return x.get(T);let E=null,M=null;if(p.has(T))M=T;else for(let _ of o){let C=_(T);if(m.has(C)){M=m.get(C);break}}if(M!==null){if(y.has(M))E=y.get(M);else{let _=c!==null?c(M):null;E=Object.freeze({type:t,object:M,ref:_,title:f(M),href:u!==null&&_!==null?`#${encodeURIComponent(u)}:${encodeURIComponent(_)}`:null}),y.set(M,E)}T!==M&&(typeof T!="object"?y.set(T,E):x.set(T,E))}return E}}}var ws=class extends jn{define(t,i){if(this.isDefined(t)){console.error(`[Discovery] Object marker "${t}" is already defined, new definition ignored`);return}i=i||{};let o=Iv(t,i,"refs"),u=Iv(t,i,"lookupRefs"),c=typeof i.page=="string"?i.page:null,f=Dv(t,i,"ref",null),p=Dv(t,i,"title",f||(()=>null));return super.define(t,zx({name:t,indexRefs:o,lookupRefs:u,page:c,getRef:f,getTitle:p}))}lookup(t,i){if(i)return this.get(i)?.lookup(t);for(let{lookup:o}of this.values){let u=o(t);if(u!==null)return u}return null}lookupAll(t){let i=[];for(let{lookup:o}of this.values){let u=o(t);u!==null&&i.push(u)}return i}};var Rv="1.0.0-beta.7";var K=function(n,t,i={}){return n.forEach(o=>i[o]=t),i},Ur=[2,5],zn=[1,13],ce=[1,41],fe=[1,18],Ie=[1,7],_e=[1,8],Re=[1,10],je=[1,11],ze=[1,12],ve=[1,19],ye=[1,20],be=[1,21],we=[1,22],xe=[1,23],ke=[1,24],Se=[1,25],Ce=[1,29],Te=[1,32],Le=[1,33],Ee=[1,34],Me=[1,35],Ae=[1,36],Oe=[1,37],Ne=[1,42],Pe=[1,43],De=[1,40],lc=[5,18,56,59],Ft=[1,47],nt=[1,55],rt=[1,54],wt=[1,48],xt=[1,49],kt=[1,50],St=[1,51],Lt=[1,52],Ot=[1,53],Je=[1,56],Qe=[1,57],Ze=[1,58],dt=[1,59],pt=[1,60],st=[1,61],at=[1,62],lt=[1,63],ut=[1,64],ht=[1,65],Nt=[1,66],no=[5,9,14,15,17,18,19,22,23,24,44,45,46,47,48,49,50,54,56,58,59,60,61,62,63,64,72,73,76,77,80],Vr=[5,10,11,18,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,56,59,66,74,75,77],uc=[1,67],cc=[1,68],fc=[1,69],dc=[1,70],pc=[1,71],hc=[1,72],jv=[1,73],Ye=[1,76],zv=[5,18,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,54,56,59,60,61,62,63,64,66,74,75,77,84],Fv=[2,46],Hv=[1,82],Bv=[1,83],Wv=[2,48],$v=[1,84],gc=[1,86],He=[5,10,11,18,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,54,56,59,60,61,62,63,64,66,74,75,77,84],qv=[5,10,11,18,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,54,56,58,59,60,61,62,63,64,66,74,75,77,84],ro=[1,93],Uv=[1,94],xs=[1,95],za=[1,111],Fa=[1,110],Vv=[1,116],Ha=[1,119],Ba=[1,120],Wa=[1,121],$a=[1,122],qa=[1,123],Gv=[9,14,15,17,19,22,23,24,44,45,46,47,48,49,50,54,58,60,61,62,63,64,72,73,74,75,76],Ua=[5,10,11,18,21,56,59,66,74,75,77],Yv=[5,10,11,18,21,29,30,41,56,59,66,74,75,77],Va=[5,10,11,18,21,23,24,25,26,27,28,29,30,34,35,36,37,38,39,40,41,56,59,66,74,75,77],io=[56,66],Kv=[2,115],Jv=[11,56],dn=[66,77],Qv=[2,102],Zv=[2,103],Ga=[5,10,11,18,21,25,26,27,28,29,30,41,56,59,66,74,75,77],mc=[5,10,11,18,21,25,26,27,28,29,30,34,35,40,41,56,59,66,74,75,77],Ya=[5,10,11,18,21,25,26,27,28,29,30,34,35,36,37,38,39,40,41,56,59,66,74,75,77],Xv=[1,199],ey=[1,201],ty=[59,66],ny=[1,211],ry=[2,109],Fx=function(){return{yy:{},options:{ranges:!0},rules:[/^(?:\/\/.*?(?:\n|\r\n?|\u2028|\u2029|$)|\/\*(?:.|\s)*?(?:\*\/|$))/,/^\s+/,/^\//,/^<(?!=)/,/^/,(t,i)=>{if(t[0]!==(i==="template"?"}":"`"))return null;for(let o=1;o<t.length;o++){if(t[o]==="`")return o+1;if(t[o]==="$"&&t[o+1]==="{")return o+2;t[o]==="\\"&&o++}return null},(t,i)=>{if(t[0]!==(i==="template"?"}":"`"))return null;for(let o=1;o<t.length;o++){if(t[o]==="`")return o+1;if(t[o]==="$"&&t[o+1]==="{")return o+2;t[o]==="\\"&&o++}return null},/^/,/^\(/,/^\)/,/^\[/,/^\]/,/^\{/,/^\}/,/^(?:(true|false|null|undefined|Infinity|NaN)\b)/,/^and\b/,/^or\b/,/^has\s+no\b/,/^has\b/,/^in\b/,/^not\s+in\b/,/^not?\b/,/^(?:(asc|desc)(NA?|AN?)?\b)/,/^(?:(\d+\.|\.)?\d+([eE][-+]?\d+)?\b)/,/^0[xX][0-9a-fA-F]+/,/^(?:"(?:\\[\\"]|[^"])*")/,/^(?:'(?:\\[\\']|[^'])*')/,/^(?:\/(?:\\.|[^/])+\/[gimsu]*)/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*)/,/^(?:\$(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*)/,/^@/,/^#/,/^\$\$/,/^\$/,/^=>/,/^<(?!=)/,/^=/,/^!=/,/^~=/,/^>=/,/^<=/,/^</,/^>/,/^\.\.\(/,/^\.\(/,/^\.\[/,/^\.\.\./,/^\.\./,/^\./,/^\?/,/^,/,/^:/,/^;/,/^\-/,/^\+/,/^\*/,/^\//,/^\%/,/^(?:\|)/,/^./,/^$/],conditions:{preventPrimitive:{rules:[0,1,2,3,4,5,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],inclusive:!0},template:{rules:[6,7],inclusive:!1},INITIAL:{rules:[0,1,5,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],inclusive:!0}},performAction(t,i,o,u){let c=u;switch(o){case 0:{t.commentRanges.push(i.yylloc.range);break}case 1:break;case 2:{return this.popState(),32;break}case 3:{return this.popState(),36;break}case 4:{this.done=!1,this.popState();break}case 5:{let f=i.yytext.endsWith("`")?"TEMPLATE":"TPL_START";return i.yytext=this.toStringLiteral(i.yytext,!0,1+ +(f!=="TEMPLATE")),f==="TEMPLATE"&&t.pps(),f;break}case 6:{let f=i.yytext.endsWith("`")?"TPL_END":"TPL_CONTINUE";return i.yytext=this.toStringLiteral(i.yytext,!0,1+ +(f!=="TPL_END")),this.popState(),f==="TPL_END"&&t.pps(),f;break}case 7:{this.parseError("Unexpected end of input");break}case 8:return 58;case 9:{return t.pps(),59;break}case 10:return 54;case 11:{return t.pps(),56;break}case 12:return 76;case 13:{if(this.bracketStack[this.bracketStack.length-1]!=="TPL_END")return t.pps(),77;this.unput("}"),this.begin("template");break}case 14:{return i.yytext=this.toLiteral(i.yytext),50;break}case 15:return 29;case 16:return 30;case 17:return 28;case 18:return 26;case 19:return 25;case 20:return 27;case 21:return 22;case 22:return 84;case 23:{return t.pps(),i.yytext=Number(i.yytext),48;break}case 24:{return t.pps(),i.yytext=parseInt(i.yytext,16),48;break}case 25:{return t.pps(),i.yytext=this.toStringLiteral(i.yytext),47;break}case 26:{return t.pps(),i.yytext=this.toStringLiteral(i.yytext),47;break}case 27:{return t.pps(),i.yytext=this.toRegExp(i.yytext),49;break}case 28:{return t.pps(),i.yytext=this.ident(i.yytext),14;break}case 29:{return t.pps(),i.yytext=this.ident(i.yytext.slice(1)),15;break}case 30:{return t.pps(),44;break}case 31:{return t.pps(),45;break}case 32:{return t.pps(),46;break}case 33:{return t.pps(),9;break}case 34:return 19;case 35:{return this.fnOpened++,17;break}case 36:return 34;case 37:return 35;case 38:return 40;case 39:return 39;case 40:return 37;case 41:return 36;case 42:return this.fnOpened?(this.fnOpened--,18):38;case 43:return 64;case 44:return 61;case 45:return 62;case 46:return 80;case 47:{return t.pps(),63;break}case 48:{return t.pps(),60;break}case 49:return 41;case 50:return 66;case 51:return 11;case 52:return 10;case 53:return 23;case 54:return 24;case 55:return 31;case 56:return 32;case 57:return 33;case 58:return 21;case 59:{this.parseError(`Bad input on line ${i.yylloc.first_line} column ${i.yylloc.first_column}
`+this.showPosition(),{text:i.yytext,token:"BAD_TOKEN"});break}case 60:return 5}},setInput(t,i){return this.yy=i||this.yy||{},this._input=t,this._more=!1,this._backtrack=!1,this.done=!1,this.currentCondition="INITIAL",this.conditionStack=["INITIAL"],this.offset=0,this.yytext=this.match="",this.yyleng=0,this.yylineno=0,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.yylloc.range=[0,0],this},parseError(t,i){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,i)},input(){let t=this._input[this.offset],i=/\n|\r\n?|\u2028|\u2029/g.test(t);return this.offset++,this.yyleng++,this.yytext=this.match=this.yytext+t,i?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,t},lineColumnForOffset(t=this.offset,i=this._input,o=1,u=0){let c=/\n|\r\n?|\u2028|\u2029/g,f=o,p=u,m=0,y;for(;(y=c.exec(i))!==null;)if(y.index<t)f++,p=0,m=y.index+y[0].length;else{p+=t-m,m=-1;break}return m!==-1&&(p+=t-m),{line:f,column:p}},setMatch(t,i){let o=this._input.slice(t,i),u=t!==this.offset?this.lineColumnForOffset(t):{line:this.yylloc.last_line,column:this.yylloc.last_column},c=t!==i?this.lineColumnForOffset(i-t,o,u.line,u.column):u;this.yytext=this.match=o,this.yyleng=i-t,this.offset=i,this.yylineno=c.line-1,this.yylloc={first_line:u.line,first_column:u.column,last_line:c.line,last_column:c.column},this.yylloc.range=[t,i]},less(t){let i=this.offset-this.match.length;this.setMatch(i,i+t)},unput(t){let i=this.match.length-t.length;if(!this.match.startsWith(t,i))throw new Error("Lexer#unput() should receive a part of matched text only");this.less(i)},more(){this._more=!0},reject(){throw new Error("reject() is allowed only when options.backtrack_lexer = true")},showPosition(t=this.offset-this.match.length){let i=this._input,o=Math.max(t-20,0),u=Math.min(t+20,i.length),c=(o===0?"":"...")+i.slice(o,t).replace(/\n|\r\n?|\u2028|\u2029/g,"\\n"),f=i.slice(t,u).replace(/\n|\r\n?|\u2028|\u2029/g,"\\n")+(u===i.length?"":"...");return c+f+`
${"-".repeat(c.length)}^`},test_match(t,i){let o;this._more=!1,this._backtrack=!1,this.setMatch(this.offset,this.offset+t[0].length),this.matches=t;let u=this.performAction.call(this,this.yy,this,i,this.conditionStack[this.conditionStack.length-1]);return!u&&this._backtrack?(Object.assign(this,o),!1):(this.eof()||(this.done=!1),typeof u=="number"&&this.yy.parser?this.yy.parser.terminals_[u]:u||!1)},eof(){return this.offset===this._input.length},next(){if(this.done)return 1;this.eof()&&(this.done=!0),this._more||(this.yytext="",this.match="");let t,i;for(let o of this.conditions[this.currentCondition].rules){let u=this.rules[o],c=this._input.slice(this.offset),f;if(typeof u=="function"){let p=u(c,this.currentCondition);switch(typeof p){case"string":f=[p];break;case"number":f=[c.slice(0,p)];break;default:f=p}}else f=c.match(u);if(f&&(!t||f[0].length>t[0].length)){t=f,i=o;break}}if(t)return this.test_match(t,i);if(this.eof())return 1;this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex(){let t;for(;!t;)t=this.next();return t},begin(t){this.currentCondition=t,this.conditionStack.push(t)},pushState(t){this.begin(t)},popState(){return this.conditionStack.pop(),this.currentCondition=this.conditionStack.length?this.conditionStack[this.conditionStack.length-1]:"INITIAL"},topState(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},stateStackSize(){return this.conditionStack.length}}}();function vc(){this.yy={}}vc.prototype={Parser:vc,lexer:Fx,symbols_:{error:2,root:3,block:4,EOF:5,definitions:6,e:7,def:8,$:9,";":10,":":11,$ident:12,ident:13,IDENT:14,$IDENT:15,query:16,FUNCTION_START:17,FUNCTION_END:18,FUNCTION:19,sortingCompareList:20,"|":21,NOT:22,"-":23,"+":24,IN:25,HAS:26,NOTIN:27,HASNO:28,AND:29,OR:30,"*":31,"/":32,"%":33,"=":34,"!=":35,"<":36,"<=":37,">":38,">=":39,"~=":40,"?":41,queryRoot:42,relativePath:43,"@":44,"#":45,$$:46,STRING:47,NUMBER:48,REGEXP:49,LITERAL:50,template:51,object:52,array:53,"[":54,sliceNotation:55,"]":56,"method()":57,"(":58,")":59,".":60,".(":61,".[":62,"..":63,"..(":64,arguments:65,",":66,templateString:67,templateStart:68,templateTail:69,templateEnd:70,templateContinue:71,TEMPLATE:72,TPL_START:73,TPL_CONTINUE:74,TPL_END:75,"{":76,"}":77,objectEntries:78,objectEntry:79,"...":80,arrayElements:81,arrayElement:82,sortingCompare:83,ORDER:84,sliceNotationComponent:85,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",9:"$",10:";",11:":",14:"IDENT",15:"$IDENT",17:"FUNCTION_START",18:"FUNCTION_END",19:"FUNCTION",21:"|",22:"NOT",23:"-",24:"+",25:"IN",26:"HAS",27:"NOTIN",28:"HASNO",29:"AND",30:"OR",31:"*",32:"/",33:"%",34:"=",35:"!=",36:"<",37:"<=",38:">",39:">=",40:"~=",41:"?",44:"@",45:"#",46:"$$",47:"STRING",48:"NUMBER",49:"REGEXP",50:"LITERAL",54:"[",56:"]",58:"(",59:")",60:".",61:".(",62:".[",63:"..",64:"..(",66:",",72:"TEMPLATE",73:"TPL_START",74:"TPL_CONTINUE",75:"TPL_END",76:"{",77:"}",80:"...",84:"ORDER"},productions_:[0,[3,2],[4,2],[4,1],[4,1],[4,0],[6,1],[6,2],[8,2],[8,4],[8,2],[8,4],[13,1],[12,1],[7,1],[7,3],[7,2],[7,1],[7,3],[7,4],[7,2],[7,2],[7,2],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,5],[16,1],[16,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,1],[42,3],[42,1],[42,1],[42,3],[42,4],[42,2],[42,2],[42,3],[42,3],[42,2],[42,2],[42,3],[43,3],[43,4],[43,4],[43,3],[43,3],[43,4],[43,4],[43,3],[43,3],[43,4],[57,3],[57,4],[57,3],[57,4],[65,1],[65,3],[51,1],[51,2],[69,1],[69,2],[69,2],[69,3],[67,1],[68,1],[71,1],[70,1],[52,2],[52,3],[52,4],[52,3],[52,4],[52,5],[78,1],[78,3],[79,1],[79,1],[79,1],[79,3],[79,3],[79,3],[79,3],[79,3],[79,5],[79,1],[79,2],[81,1],[81,3],[82,1],[82,1],[82,2],[53,2],[53,3],[53,4],[20,1],[20,3],[83,2],[55,1],[55,2],[55,2],[55,3],[85,1],[85,2]],table:[{3:1,4:2,5:Ur,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{1:[3]},{5:[1,44]},K(lc,[2,3],{16:6,20:9,12:14,42:15,43:16,83:17,51:26,52:27,53:28,13:30,57:31,67:38,68:39,7:45,8:46,9:zn,14:ce,15:fe,17:Ie,19:_e,22:Re,23:je,24:ze,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,54:Ce,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,72:Ne,73:Pe,76:De}),K(lc,[2,4],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(no,[2,6]),K(Vr,[2,14],{54:uc,60:cc,61:fc,62:dc,63:pc,64:hc,84:jv}),{4:74,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,18:Ur,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:75,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K([5,10,11,18,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,56,59,74,75,77],[2,17],{66:[1,78]}),{7:79,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:80,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:81,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(zv,Fv,{10:Hv,11:Bv}),K(zv,Wv,{10:$v,11:[1,85],58:gc}),K(He,[2,42]),K(He,[2,43]),K(Vr,[2,121]),K(qv,[2,13]),K(He,[2,44]),K(He,[2,45]),K(He,[2,47]),K(He,[2,49]),K(He,[2,50]),K(He,[2,51]),K(He,[2,52]),K(He,[2,53]),K(He,[2,54]),K(He,[2,55]),{7:91,9:Ye,11:ro,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,55:87,56:[1,88],57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,80:Uv,81:89,82:92,83:17,85:90},K(He,[2,57],{58:xs}),K(He,[2,58]),{6:97,7:96,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{12:100,13:98,14:ce,15:fe,57:99},{4:101,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,59:Ur,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{4:102,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,56:Ur,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{12:100,13:103,14:ce,15:fe,57:104},{4:105,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,59:Ur,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(He,[2,84]),{7:108,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,69:106,70:107,71:109,72:Ne,73:Pe,74:za,75:Fa,76:De,83:17},{6:114,8:5,9:Vv,12:117,13:118,14:ce,15:fe,47:Ha,48:Ba,50:Wa,54:$a,77:[1,112],78:113,79:115,80:qa},K(qv,[2,12]),K(He,[2,90]),K(Gv,[2,91]),{1:[2,1]},K(lc,[2,2],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(no,[2,7]),{6:125,7:124,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:126,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:127,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:128,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:129,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:130,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:131,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:132,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:133,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:134,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:135,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:136,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:137,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:138,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:139,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:140,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:141,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:142,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:143,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:144,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:146,9:Ye,11:ro,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,55:147,56:[1,145],57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17,85:90},{12:100,13:148,14:ce,15:fe,57:149},{4:150,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,59:Ur,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{4:151,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,56:Ur,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{12:100,13:152,14:ce,15:fe,57:153},{4:154,6:3,7:4,8:5,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,59:Ur,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(Vr,[2,123]),{18:[1,155]},K(Ua,[2,16],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(He,Fv),K(He,Wv,{58:gc}),{9:Ye,12:77,13:30,14:ce,15:fe,16:157,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:156},K(Yv,[2,20],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K(Va,[2,21],{31:Je,32:Qe,33:Ze}),K(Va,[2,22],{31:Je,32:Qe,33:Ze}),K(no,[2,8]),{7:158,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(no,[2,10]),{7:159,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:162,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,59:[1,160],60:Le,61:Ee,62:Me,63:Ae,64:Oe,65:161,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{56:[1,163]},K(He,[2,118]),{56:[1,164],66:[1,165]},{11:ro,56:[2,124],85:166},K(io,Kv,{85:167,11:ro,21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(io,[2,113]),K(Jv,[2,128],{16:6,20:9,42:15,43:16,83:17,51:26,52:27,53:28,13:30,57:31,67:38,68:39,12:77,7:168,9:Ye,14:ce,15:fe,17:Ie,19:_e,22:Re,23:je,24:ze,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,54:Ce,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,72:Ne,73:Pe,76:De}),K(io,[2,116],{16:6,20:9,42:15,43:16,83:17,51:26,52:27,53:28,13:30,57:31,67:38,68:39,12:77,7:169,9:Ye,14:ce,15:fe,17:Ie,19:_e,22:Re,23:je,24:ze,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,54:Ce,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,72:Ne,73:Pe,76:De}),{7:162,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,59:[1,170],60:Le,61:Ee,62:Me,63:Ae,64:Oe,65:171,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt,59:[1,172]},{7:173,8:46,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(He,[2,61],{58:xs}),K(He,[2,62]),{58:gc},{59:[1,174]},{56:[1,175]},K(He,[2,65],{58:xs}),K(He,[2,66]),{59:[1,176]},K(He,[2,85]),K(He,[2,86]),{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt,70:177,71:178,74:za,75:Fa},{7:108,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,69:179,70:107,71:109,72:Ne,73:Pe,74:za,75:Fa,76:De,83:17},K(He,[2,93]),K(Gv,[2,92]),K(He,[2,94]),{66:[1,181],77:[1,180]},{8:46,9:Vv,12:117,13:118,14:ce,15:fe,47:Ha,48:Ba,50:Wa,54:$a,77:[1,182],78:183,79:115,80:qa},K(dn,[2,100]),K(dn,Qv,{10:Hv,11:Bv}),K(dn,Zv,{10:$v,11:[1,184]}),K(dn,[2,104],{11:[1,185]}),{11:[1,186]},{11:[1,187]},{11:[1,188]},{7:189,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(dn,[2,111],{42:15,43:16,51:26,52:27,53:28,13:30,57:31,67:38,68:39,12:77,16:190,9:Ye,14:ce,15:fe,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,54:Ce,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,72:Ne,73:Pe,76:De}),K(Ua,[2,18],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),{7:191,8:46,9:zn,12:14,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(Ga,[2,23],{23:nt,24:rt,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K(Ga,[2,24],{23:nt,24:rt,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K(Ga,[2,25],{23:nt,24:rt,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K(Ga,[2,26],{23:nt,24:rt,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K(Yv,[2,27],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K([5,10,11,18,21,30,41,56,59,66,74,75,77],[2,28],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht}),K(Va,[2,29],{31:Je,32:Qe,33:Ze}),K(Va,[2,30],{31:Je,32:Qe,33:Ze}),K(Vr,[2,31]),K(Vr,[2,32]),K(Vr,[2,33]),K(mc,[2,34],{23:nt,24:rt,31:Je,32:Qe,33:Ze,36:st,37:at,38:lt,39:ut}),K(mc,[2,35],{23:nt,24:rt,31:Je,32:Qe,33:Ze,36:st,37:at,38:lt,39:ut}),K(Ya,[2,36],{23:nt,24:rt,31:Je,32:Qe,33:Ze}),K(Ya,[2,37],{23:nt,24:rt,31:Je,32:Qe,33:Ze}),K(Ya,[2,38],{23:nt,24:rt,31:Je,32:Qe,33:Ze}),K(Ya,[2,39],{23:nt,24:rt,31:Je,32:Qe,33:Ze}),K(mc,[2,40],{23:nt,24:rt,31:Je,32:Qe,33:Ze,36:st,37:at,38:lt,39:ut}),{11:[1,192],21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt},K(He,[2,68]),{11:ro,21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt,56:[1,193],85:167},{56:[1,194]},K(He,[2,71],{58:xs}),K(He,[2,72]),{59:[1,195]},{56:[1,196]},K(He,[2,75],{58:xs}),K(He,[2,76]),{59:[1,197]},K(Vr,[2,15]),K(Vr,[2,122]),{54:uc,60:cc,61:fc,62:dc,63:pc,64:hc,84:jv},{10:[1,198],21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt},{10:Xv,21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt},K(He,[2,80]),{59:[1,200],66:ey},K(ty,[2,82],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(He,[2,56]),K(He,[2,119]),{7:204,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,56:[1,202],57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,80:Uv,82:203,83:17},{56:[2,125]},{11:ro,56:[2,126],85:205},K(Jv,[2,129],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(io,[2,117],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(He,[2,78]),{59:[1,206],66:ey},K(He,[2,59]),{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt,59:[1,207]},K(He,[2,63]),K(He,[2,64]),K(He,[2,67]),K(He,[2,87]),{7:108,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,69:208,70:107,71:109,72:Ne,73:Pe,74:za,75:Fa,76:De,83:17},K(He,[2,88]),K(He,[2,95]),{9:ny,12:212,13:118,14:ce,15:fe,47:Ha,48:Ba,50:Wa,54:$a,77:[1,209],79:210,80:qa},K(He,[2,97]),{66:[1,214],77:[1,213]},{7:215,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:216,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:217,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:218,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{7:219,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt,56:[1,220]},K(dn,[2,112],{54:uc,60:cc,61:fc,62:dc,63:pc,64:hc}),K(Ua,[2,19],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),{7:221,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(He,[2,69]),K(He,[2,70]),K(He,[2,73]),K(He,[2,74]),K(He,[2,77]),K(no,[2,9]),K(no,[2,11]),K(He,[2,81]),{7:222,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(He,[2,120]),K(io,[2,114]),K(io,Kv,{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),{56:[2,127]},K(He,[2,79]),K(He,[2,60]),K(He,[2,89]),K(He,[2,96]),K(dn,[2,101]),K(dn,Qv),K(dn,Zv,{11:[1,223]}),K(He,[2,98]),{9:ny,12:212,13:118,14:ce,15:fe,47:Ha,48:Ba,50:Wa,54:$a,77:[1,224],79:210,80:qa},K(dn,ry,{10:Xv,21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(dn,[2,105],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(dn,[2,106],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(dn,[2,107],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(dn,[2,108],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),{11:[1,225]},K(Ua,[2,41],{23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(ty,[2,83],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),{7:226,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(He,[2,99]),{7:227,9:Ye,12:77,13:30,14:ce,15:fe,16:6,17:Ie,19:_e,20:9,22:Re,23:je,24:ze,42:15,43:16,44:ve,45:ye,46:be,47:we,48:xe,49:ke,50:Se,51:26,52:27,53:28,54:Ce,57:31,58:Te,60:Le,61:Ee,62:Me,63:Ae,64:Oe,67:38,68:39,72:Ne,73:Pe,76:De,83:17},K(dn,ry,{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt}),K(dn,[2,110],{21:Ft,23:nt,24:rt,25:wt,26:xt,27:kt,28:St,29:Lt,30:Ot,31:Je,32:Qe,33:Ze,34:dt,35:pt,36:st,37:at,38:lt,39:ut,40:ht,41:Nt})],defaultActions:{44:[2,1],166:[2,125],205:[2,127]},performAction(n,t,i,o,u,c,f){let p=c.length-1;switch(u){case 1:return o.buildResult(c[p-1]);case 2:this.$={type:"Block",definitions:c[p-1],body:c[p],range:this._$.range};break;case 3:this.$={type:"Block",definitions:c[p],body:{type:"Placeholder",range:[f[p].range[1],f[p].range[1]]},range:this._$.range};break;case 4:this.$={type:"Block",definitions:[],body:c[p],range:this._$.range};break;case 5:this.$={type:"Block",definitions:[],body:{type:"Placeholder",range:[f[p].range[1],f[p].range[1]]},range:this._$.range};break;case 6:case 82:case 84:case 100:case 113:case 121:this.$=[c[p]];break;case 7:c[p-1].push(c[p]);break;case 8:this.$={type:"Definition",declarator:{type:"Declarator",name:null,range:f[p-1].range},value:null,range:this._$.range};break;case 9:this.$={type:"Definition",declarator:{type:"Declarator",name:null,range:f[p-3].range},value:c[p-1],range:this._$.range};break;case 10:this.$={type:"Definition",declarator:{type:"Declarator",name:c[p-1].name,range:f[p-1].range},value:null,range:this._$.range};break;case 11:this.$={type:"Definition",declarator:{type:"Declarator",name:c[p-3].name,range:f[p-3].range},value:c[p-1],range:this._$.range};break;case 12:case 13:this.$={type:"Identifier",name:c[p],range:this._$.range};break;case 14:case 42:case 43:case 54:case 55:case 115:break;case 15:this.$={type:"Function",arguments:[],body:c[p-1],legacy:!0,range:this._$.range};break;case 16:this.$={type:"Function",arguments:[],body:c[p],legacy:!1,range:this._$.range};break;case 17:this.$={type:"SortingFunction",compares:c[p],range:this._$.range};break;case 18:this.$={type:"Pipeline",left:c[p-2],right:c[p],range:this._$.range};break;case 19:this.$={type:"Pipeline",left:c[p-3],right:{type:"Block",definitions:c[p-1],body:c[p]},range:this._$.range};break;case 20:case 21:case 22:this.$={type:"Unary",operator:c[p-1],argument:c[p],range:this._$.range};break;case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:this.$={type:"Binary",operator:c[p-1],left:c[p-2],right:c[p],range:this._$.range};break;case 41:this.$={type:"Conditional",test:c[p-4],consequent:c[p-2],alternate:c[p],range:this._$.range};break;case 44:this.$={type:"Data",range:this._$.range};break;case 45:this.$={type:"Context",range:this._$.range};break;case 46:this.$={type:"Current",range:this._$.range};break;case 47:this.$={type:"Arg1",range:this._$.range};break;case 48:this.$={type:"Reference",name:c[p],range:this._$.range};break;case 49:case 50:case 51:case 52:case 90:case 91:case 92:case 93:this.$={type:"Literal",value:c[p],range:this._$.range};break;case 53:this.$={type:"Template",values:c[p],range:this._$.range};break;case 56:this.$={type:"SliceNotation",value:null,arguments:c[p-1],range:this._$.range};break;case 57:case 61:this.$={type:"GetProperty",value:null,property:c[p],range:this._$.range};break;case 58:case 62:this.$={type:"MethodCall",value:null,method:c[p],range:this._$.range};break;case 59:this.$={type:"Parentheses",body:c[p-1],range:this._$.range};break;case 60:this.$={type:"Parentheses",body:{type:"Block",definitions:c[p-2],body:c[p-1]},range:this._$.range};break;case 63:this.$={type:"Map",value:null,query:c[p-1],range:this._$.range};break;case 64:this.$={type:"Filter",value:null,query:c[p-1],range:this._$.range};break;case 65:this.$={type:"MapRecursive",value:null,query:{type:"GetProperty",value:null,property:c[p]},range:this._$.range};break;case 66:this.$={type:"MapRecursive",value:null,query:{type:"MethodCall",value:null,method:c[p]},range:this._$.range};break;case 67:this.$={type:"MapRecursive",value:null,query:c[p-1],range:this._$.range};break;case 68:this.$={type:"Pick",value:c[p-2],getter:null,range:this._$.range};break;case 69:this.$={type:"Pick",value:c[p-3],getter:c[p-1],range:this._$.range};break;case 70:this.$={type:"SliceNotation",value:c[p-3],arguments:c[p-1],range:this._$.range};break;case 71:this.$={type:"GetProperty",value:c[p-2],property:c[p],range:this._$.range};break;case 72:this.$={type:"MethodCall",value:c[p-2],method:c[p],range:this._$.range};break;case 73:this.$={type:"Map",value:c[p-3],query:c[p-1],range:this._$.range};break;case 74:this.$={type:"Filter",value:c[p-3],query:c[p-1],range:this._$.range};break;case 75:this.$={type:"MapRecursive",value:c[p-2],query:{type:"GetProperty",value:null,property:c[p]},range:this._$.range};break;case 76:this.$={type:"MapRecursive",value:c[p-2],query:{type:"MethodCall",value:null,method:c[p]},range:this._$.range};break;case 77:this.$={type:"MapRecursive",value:c[p-3],query:c[p-1],range:this._$.range};break;case 78:this.$={type:"Method",reference:c[p-2],arguments:[],range:this._$.range};break;case 79:this.$={type:"Method",reference:c[p-3],arguments:c[p-1],range:this._$.range};break;case 80:this.$={type:"Method",reference:{type:"Reference",name:c[p-2]},arguments:[],range:this._$.range};break;case 81:this.$={type:"Method",reference:{type:"Reference",name:c[p-3]},arguments:c[p-1],range:this._$.range};break;case 83:case 101:case 114:case 122:c[p-2].push(c[p]);break;case 85:this.$=[c[p-1],...c[p]];break;case 86:case 124:this.$=[null,c[p]];break;case 87:case 126:this.$=[c[p-1],c[p]];break;case 88:this.$=[null,c[p-1],...c[p]];break;case 89:this.$=[c[p-2],c[p-1],...c[p]];break;case 94:case 97:this.$={type:"Object",properties:[],range:this._$.range};break;case 95:this.$={type:"Object",properties:c[p-1],range:this._$.range};break;case 96:this.$={type:"Object",properties:c[p-2],range:this._$.range};break;case 98:this.$={type:"Block",definitions:c[p-2],body:{type:"Object",properties:c[p-1]},range:this._$.range};break;case 99:this.$={type:"Block",definitions:c[p-3],body:{type:"Object",properties:c[p-2]},range:this._$.range};break;case 102:this.$={type:"ObjectEntry",key:{type:"Current"},value:null,range:this._$.range};break;case 103:this.$={type:"ObjectEntry",key:{type:"Reference",name:c[p]},value:null,range:this._$.range};break;case 104:this.$={type:"ObjectEntry",key:c[p],value:null,range:this._$.range};break;case 105:this.$={type:"ObjectEntry",key:c[p-2],value:c[p],range:this._$.range};break;case 106:case 107:case 108:this.$={type:"ObjectEntry",key:{type:"Literal",value:c[p-2]},value:c[p],range:this._$.range};break;case 109:this.$={type:"ObjectEntry",key:{type:"Identifier",name:"$"+c[p-2].name},value:c[p],range:this._$.range};break;case 110:this.$={type:"ObjectEntry",key:c[p-3],value:c[p],range:this._$.range};break;case 111:this.$={type:"Spread",query:null,array:!1,range:this._$.range};break;case 112:this.$={type:"Spread",query:c[p],array:!1,range:this._$.range};break;case 116:this.$={type:"Spread",query:null,array:!0,range:this._$.range};break;case 117:this.$={type:"Spread",query:c[p],array:!0,range:this._$.range};break;case 118:this.$={type:"Array",elements:[],range:this._$.range};break;case 119:this.$={type:"Array",elements:c[p-1],range:this._$.range};break;case 120:this.$={type:"Array",elements:c[p-2],range:this._$.range};break;case 123:this.$={type:"Compare",query:c[p-1],order:c[p],range:this._$.range};break;case 125:this.$=[null,c[p-1],c[p]];break;case 127:this.$=[c[p-2],c[p-1],c[p]];break;case 128:this.$=null;break;case 129:this.$=c[p];break}},trace(...n){this.DEBUG&&Jison.print(...n)},parseError(n,t){if(t.recoverable)this.trace(n);else{let i=new Error(n);throw i.hash=t,i}},parse(n,...t){let p=H=>{E.length-=2*H,M.length-=H,_.length-=H},m=()=>{let H=y.lex()||1;return typeof H!="number"&&(H=this.symbols_[H]||H),H},y=Object.create(this.lexer),x=y.options&&y.options.ranges,S={...this.yy,parser:this,lexer:y};y.setInput(n,S),typeof S.parseError=="function"&&(this.parseError=S.parseError),typeof y.yylloc>"u"&&(y.yylloc={});let k=this.table,T={},O=y.yylloc,E=[0],M=[null],_=[O],C=[],I="",N=0,R=0,j=0,F,q;for(;;){let H=E[E.length-1],te;if(this.defaultActions[H]?te=this.defaultActions[H]:((F===null||typeof F>"u")&&(F=m()),te=k[H]&&k[H][F]),!te||!te[0]){let L=function(Z){let X=E.length-1,he=0;for(;;){if(2 .toString()in k[Z])return he;if(Z===0||X<2)return!1;X-=2,Z=E[X],++he}},W,U="";if(!j){let Z=[];for(let X in k[H])X in this.terminals_&&X>2&&Z.push("'"+this.terminals_[X]+"'");U=y.showPosition?"Parse error on line "+(N+1)+`:
`+y.showPosition()+`
Expecting `+Z.join(", ")+", got '"+(this.terminals_[F]||F)+"'":"Parse error on line "+(N+1)+": Unexpected "+(F===1?"end of input":"'"+(this.terminals_[F]||F)+"'"),this.parseError(U,{text:y.match,token:this.terminals_[F]||F,line:y.yylineno,loc:O,expected:Z})}if(j===3){if(F===1||q===1)throw new Error(U||"Parsing halted while starting to recover from another error.");R=y.yyleng,I=y.yytext,N=y.yylineno,O=y.yylloc,F=m()}if(W===!1)throw new Error(U||"Parsing halted. No suitable error recovery rule available.");p(W),q=F==2?null:F,F=2,H=E[E.length-1],te=k[H]&&k[H][2],j=3}if(Array.isArray(te[0])&&te.length>1)throw new Error("Parse Error: multiple actions possible at state: "+H+", token: "+F);switch(te[0]){case 1:E.push(F),M.push(y.yytext),_.push(y.yylloc),E.push(te[1]),F=null,q?(F=q,q=null):(R=y.yyleng,I=y.yytext,N=y.yylineno,O=y.yylloc,j>0&&j--);break;case 2:{let W=this.productions_[te[1]][1],U=_[_.length-(W||1)],L=_[_.length-1];T.$=M[M.length-W],T._$={first_line:U.first_line,last_line:L.last_line,first_column:U.first_column,last_column:L.last_column},x&&(T._$.range=[U.range[0],L.range[1]]);let Z=this.performAction.call(T,I,R,N,S,te[1],M,_,...t);if(typeof Z<"u")return Z;W&&p(W),E.push(this.productions_[te[1]][0]),M.push(T.$),_.push(T._$),E.push(k[E[E.length-2]][E[E.length-1]]);break}case 3:return!0}}}};var Hx=function(t){function i(C,I){Object.entries(I).forEach(([N,R])=>C[N]=R(C[N]))}let o=new Map([["EOF",["<end of input>"]],["IDENT",["ident"]],["$IDENT",["$ident"]],["FUNCTION_START",["'<'"]],["FUNCTION_END",["'>'"]],["FUNCTION",["'=>'"]],["NOT",["'not'"]],["IN",["'in'"]],["HAS",["'has'"]],["NOTIN",["'not in'"]],["HASNO",["'has no'"]],["AND",["'and'"]],["OR",["'or'"]],["STRING",["string"]],["TPL_START",["template"]],["TEMPLATE",["template"]],["NUMBER",["number"]],["REGEXP",["regexp"]],["LITERAL",["'true'","'false'","'null'","'undefined'"]],["ORDER",["'asc'","'desc'","'ascN'","'descN'"]]]),u=C=>o.get(C)||`'${C}'`,c=function(C,I={},N){if(I.recoverable)this.trace(C);else{if(Array.isArray(I.inside)){let H=N.lexer.offset-N.lexer.match.length;N.lexer.setMatch(H+I.inside[0],H+I.inside[1])}let R=N.lexer.yylloc,j=[C.split(/\n/)[0],"",N.lexer.showPosition()],F=Array.isArray(I.expected)?[...new Set([].concat(...I.expected.map(H=>u(H.slice(1,-1)))))]:null;F&&j.push("","Expecting "+F.join(", ")+" got "+u(I.token));let q=new SyntaxError(j.join(`
`));throw q.details={rawMessage:C,text:I.text,token:I.token,expected:F,loc:{range:R.range,start:{line:R.first_line,column:R.first_column,offset:R.range[0]},end:{line:R.last_line,column:R.last_column,offset:R.range[1]}}},q}},f=new Set([`
`,"\r","\u2028","\u2029"]),p=new Map([["null",null],["false",!1],["true",!0],["Infinity",1/0],["NaN",NaN]]);Object.assign(t.lexer,{ident:C=>C.replace(/\\u[0-9a-fA-F]{4}/g,I=>String.fromCharCode(parseInt(I.slice(2),16))),toLiteral:C=>p.get(C),toStringLiteral(C,I=!1,N=1){let R=C.length-N,j="";for(let F=1;F<R;F++){if(!I&&f.has(C[F])&&this.parseError("Invalid line terminator",{inside:[F,F+1]}),C[F]!=="\\"){j+=C[F];continue}F===R-1&&this.parseError("Invalid backslash",{inside:[F,F+1]});let q=C[++F];switch(q){case"\r":F+=C[F+1]===`
`;break;case`
`:case"\u2028":case"\u2029":break;case"0":j+="\0";break;case"b":j+="\b";break;case"n":j+=`
`;break;case"r":j+="\r";break;case"f":j+="\f";break;case"t":j+="	";break;case"v":j+="\v";break;case"u":{let[H=""]=C.slice(F+1,F+5).match(/^[0-9a-f]*/i)||[];if(H.length===4){j+=String.fromCharCode(parseInt(H,16)),F+=4;break}this.parseError("Invalid Unicode escape sequence",{inside:[F-1,Math.min(F+1+H.length,R)]});break}case"x":{let[H=""]=C.slice(F+1,F+3).match(/^[0-9a-f]*/i)||[];if(H.length===2){j+=String.fromCharCode(parseInt(H,16)),F+=2;break}this.parseError("Invalid hexadecimal escape sequence",{inside:[F-1,Math.min(F+1+H.length,R)]});break}default:j+=q}}return j},toRegExp(C){let I=C.lastIndexOf("/")+1,N=C.substr(I);return N.split("").forEach((R,j,F)=>{let q=F.indexOf(R,j+1);q!==-1&&this.parseError("Duplicate flag in regexp",{inside:[I+q,I+q+1]})}),new RegExp(C.substr(1,C.lastIndexOf("/")-1),N)}}),i(t.lexer,{setInput:C=>function(I,N){let R=[];return N.commentRanges=R,N.buildResult=j=>({ast:j,commentRanges:R}),N.parseError=function(...j){return c.call(this,...j,N)},N.pps=()=>{this.eof()||this.begin("preventPrimitive")},this.fnOpened=0,this.fnOpenedStack=[],this.bracketStack=[],this.prevToken=null,this.prevYylloc={first_line:1,last_line:1,first_column:0,last_column:0,range:[0,0]},C.call(this,I,N)}});let m=new t.Parser;m.lexer={...t.lexer},m.yy={...t.yy};let y=["AND","OR","IN","NOTIN","HAS","HASNO"],x=[...y,"NOT","ORDER"],S=["+","-","*","/","%","|","=","!=","~=",">=","<=","<",">"],k=[null,":",";",",",".","..","(","[",".(","..(",".[","FUNCTION",...S,...y,"NOT"],T=new Set([",","?",":",";","EOF","]",")","}","TPL_CONTINUE","TPL_END",...S,...y,"ORDER"]),O=new Map(k.map(C=>[C,T]));O.set("{",new Set([","])),O.set("[",new Set([...T,","])),O.set("(",new Set([...T,","])),i(m.lexer,{lex:C=>function(){let N=this.offset,R=C.call(this);if(O.has(this.prevToken)&&O.get(this.prevToken).has(R)){let j={first_line:this.prevYylloc.last_line,last_line:this.yylloc.first_line,first_column:this.prevYylloc.last_column,last_column:this.yylloc.first_column,range:[this.prevYylloc.range[1],this.yylloc.range[0]]};if(this.unput(this.match),this.pushState("preventPrimitive"),this.done=!1,this.yytext="",this.yylloc=this.prevYylloc=j,N!==this.offset&&x.includes(R))switch(this._input[N]){case" ":case"	":j.last_column--,j.range[1]--;break;case`
`:{let F=this._input.lastIndexOf(`
`,N-1);j.last_line--,j.last_column=F===-1?j.last_column-1:N-F,j.range[1]--;break}}return this.prevToken="IDENT"}if(this.prevYylloc=this.yylloc,x.includes(R))switch(this._input[this.offset]){case" ":case"	":this.prevYylloc={...this.prevYylloc,last_column:this.prevYylloc.last_column+1,range:[this.prevYylloc.range[0],this.prevYylloc.range[1]+1]};break;case`
`:this.prevYylloc={...this.prevYylloc,last_line:this.prevYylloc.last_line+1,last_column:0,range:[this.prevYylloc.range[0],this.prevYylloc.range[1]+1]};break}return this.prevToken=R}});let E=new Map([["(",")"],[".(",")"],["..(",")"],["[","]"],[".[","]"],["{","}"],["TPL_START","TPL_END"]]),M=new Set([")","]","}","TPL_END"]),_=C=>function(){let N=C.call(this);if(M.has(N)){let R=this.bracketStack.pop();R!==N&&this.parseError(`Expected "${R}" got "${N}"`),this.fnOpened=this.fnOpenedStack.pop()||0}return E.has(N)&&(this.bracketStack.push(E.get(N)),this.fnOpenedStack.push(this.fnOpened),this.fnOpened=0),N};return i(t.lexer,{lex:_}),i(m.lexer,{lex:_}),{parse(C,I){return I?m.parse(C):t.parse(C)},*tokenize(C,I,N){let R=I?m:t,j=Object.create(R.lexer);for(j.setInput(C,{parser:R});!j.done;){let F={type:j.lex(),value:j.match,offset:j.yylloc.range[0]};N&&(F.loc={range:j.yylloc.range,start:{line:j.yylloc.first_line,column:j.yylloc.first_column},end:{line:j.yylloc.last_line,column:j.yylloc.last_column}}),yield F}}}}(new vc),Ka=Hx;var yc={};Ke(yc,{compile:()=>Bx,stringify:()=>$x,walk:()=>Wx});function Bx(n,t){t.put(t.scope.arg1?"arguments[1]":"undefined")}function Wx(){}function $x(n,t){t.put("$$")}var bc={};Ke(bc,{compile:()=>Ux,stringify:()=>Gx,suggest:()=>qx,walk:()=>Vx});function qx(n,t){n.elements.length===0&&t.queryRoot(n.range[0]+1,n.range[1]-1)}function Ux(n,t){t.put("["),t.list(n.elements,","),t.put("]")}function Vx(n,t){t.list(n.elements)}function Gx(n,t){t.put("["),t.list(n.elements,","),t.put("]")}var wc={};Ke(wc,{compile:()=>Kx,stringify:()=>Qx,suggest:()=>Yx,walk:()=>Jx});var iy={in:"in","not in":"notIn",has:"has","has no":"hasNo",and:"and",or:"or","+":"add","-":"sub","*":"mul","/":"div","%":"mod","=":"eq","!=":"ne","<":"lt","<=":"lte",">":"gt",">=":"gte","~=":"match"};function Ja(n,t,i){if(i.type==="Array"){if(i.elements.length===0){n.range([i.range[0]+1,i.range[1]-1],"value-subset",t,!1);return}let o=[];for(let{type:c,range:f,value:p}of i.elements)f&&(c==="Literal"||c==="Identifier")&&o.push(p);let u=o.length?n.literalList(o):!1;for(let{type:c,range:f,value:p}of i.elements)f&&(c==="Literal"||c==="Identifier"||c==="GetProperty"&&p===null)&&n.range(f,"value-subset",t,u)}}function Yx(n,t){switch(n.operator){case"in":t.range(n.left.range,"in-value",n.right,null),Ja(t,n.left,n.right);break;case"not in":Ja(t,n.left,n.right);break;case"has":t.range(n.right.range,"in-value",n.left,null),Ja(t,n.right,n.left);break;case"has no":Ja(t,n.right,n.left);break;case"=":case"!=":t.range(n.right.range,"value",n.left,null);break}}function Kx(n,t){if(!(n.operator in iy)){t.error('Unknown operator "'+n.operator+'"',n);return}switch(n.operator){case"and":t.put("!");case"or":{let i=t.allocateVar();t.put(`${t.buildinFn("bool")}(${i}=`),t.node(n.left),t.put(`)?${i}:`),t.scope.captureCurrent.disabled=!0,t.node(n.right),t.scope.captureCurrent.disabled=!1;break}case"has no":t.put("!");case"has":t.put(t.buildinFn("in")),t.put("("),t.node(n.right),t.put(","),t.node(n.left),t.put(")");break;default:t.put(t.buildinFn(iy[n.operator])),t.put("("),t.node(n.left),t.put(","),t.node(n.right),t.put(")")}}function Jx(n,t){t.node(n.left),t.node(n.right)}function Qx(n,t){t.node(n.left),/^[a-z]/i.test(n.operator)?(t.put(" "),t.put(n.operator),t.put(" ")):t.put(n.operator),t.node(n.right)}var xc={};Ke(xc,{compile:()=>Xx,stringify:()=>tk,suggest:()=>Zx,walk:()=>ek});function Zx(n,t){n.body===null&&t.queryRoot(n.range[1])}function Xx(n,t){n.definitions.length?t.createScope(()=>{t.put("(()=>{"),t.list(n.definitions),t.put("return "),t.nodeOrCurrent(n.body),t.put("})()")},(i,o)=>i+o+";"):n.body&&n.body.type==="Object"?(t.put("("),t.nodeOrCurrent(n.body),t.put(")")):t.nodeOrCurrent(n.body)}function ek(n,t){t.list(n.definitions),t.nodeOrNothing(n.body)}function tk(n,t){t.list(n.definitions),t.nodeOrNothing(n.body)}var kc={};Ke(kc,{compile:()=>nk,stringify:()=>ik,walk:()=>rk});var oy={"":"cmp",N:"cmpNatural",A:"cmpAnalytical",NA:"cmpNaturalAnalytical",AN:"cmpNaturalAnalytical"};function nk(n,t){n.order.startsWith("desc")&&t.put("-"),t.createScope(()=>{let i=oy[n.order.slice(3+n.order.startsWith("desc"))]||oy[""];t.put(t.buildinFn(i)),t.put("((_q=$=>("),t.node(n.query),t.put("))(a),_q(b))")},(i,o)=>i+o+",")}function rk(n,t){t.node(n.query)}function ik(n,t){t.node(n.query),t.put(" "),t.put(n.order)}var Sc={};Ke(Sc,{compile:()=>ok,stringify:()=>ak,walk:()=>sk});function ok(n,t){t.put(t.buildinFn("bool")),t.put("("),t.node(n.test),t.scope.captureCurrent.disabled=!0,t.put(")?"),t.node(n.consequent),t.put(":"),t.node(n.alternate),t.scope.captureCurrent.disabled=!1}function sk(n,t){t.node(n.test),t.node(n.consequent),t.node(n.alternate)}function ak(n,t){t.node(n.test),t.put("?"),t.node(n.consequent),t.put(":"),t.node(n.alternate)}var Cc={};Ke(Cc,{compile:()=>lk,stringify:()=>ck,walk:()=>uk});function lk(n,t){t.put("context")}function uk(){}function ck(n,t){t.put("#")}var Tc={};Ke(Tc,{compile:()=>dk,stringify:()=>hk,suggest:()=>fk,walk:()=>pk});function fk(n,t){n.range&&t.range(n.range,"var")}function dk(n,t){t.put("$")}function pk(){}function hk(n,t){t.put("$")}var Lc={};Ke(Lc,{compile:()=>gk,stringify:()=>vk,walk:()=>mk});function gk(n,t){t.put("data")}function mk(){}function vk(n,t){t.put("@")}var Ec={};Ke(Ec,{compile:()=>yk,stringify:()=>wk,walk:()=>bk});function yk(n,t){n.name&&t.put("$"+n.name)}function bk(){}function wk(n,t){t.put(n.name?"$"+n.name:"$")}var Mc={};Ke(Mc,{compile:()=>Sk,stringify:()=>Tk,suggest:()=>kk,walk:()=>Ck});function Qa(n,t){return{type:"GetProperty",value:n,property:t}}function Za(n){return{type:"Identifier",name:n}}var xk=["data","context","ctx","array","idx","index"];function kk(n,t){n.value===null&&t.range(n.declarator.range,"path")}function Sk(n,t){if(n.declarator.name===null){t.node(n.declarator),t.nodeOrCurrent(n.value),t.put(";");return}if(t.scope.own.includes(n.declarator.name)){t.error(`Identifier "$${n.declarator.name}" has already been declared`,n.declarator);return}if(xk.includes(n.declarator.name)){t.error(`Identifier "$${n.declarator.name}" is reserved for future use`,n.declarator);return}t.put("const "),t.node(n.declarator),t.put("="),t.node(n.value||Qa(null,Za(n.declarator.name))),t.put(";"),t.scope.push(n.declarator.name),t.scope.own.push(n.declarator.name)}function Ck(n,t){t.node(n.declarator),t.nodeOrNothing(n.value)}function Tk(n,t){t.node(n.declarator),n.value!==null&&(t.put(":"),t.node(n.value)),t.put(";")}var Ac={};Ke(Ac,{compile:()=>Lk,stringify:()=>Mk,walk:()=>Ek});function Lk(n,t){t.put(t.buildinFn("filter")),t.put("("),t.nodeOrCurrent(n.value),t.createScope(()=>{t.put(",$=>"),t.node(n.query)},(i,o)=>(t.put(")"),i+"("+o+",")),t.put(")")}function Ek(n,t){t.nodeOrNothing(n.value),t.node(n.query)}function Mk(n,t){t.nodeOrNothing(n.value),t.put(".["),t.node(n.query),t.put("]")}var Oc={};Ke(Oc,{compile:()=>Ak,stringify:()=>Nk,walk:()=>Ok});function Ak(n,t){t.createScope(()=>{t.scope.arg1=!0,t.put("function($){return "),t.node(n.body),t.put("}")},(i,o)=>i+o+",")}function Ok(n,t){t.node(n.body)}function Nk(n,t){n.legacy?(t.put("<"),t.node(n.body),t.put(">")):(t.put("=>"),t.node(n.body))}var Nc={};Ke(Nc,{compile:()=>Dk,stringify:()=>_k,suggest:()=>Pk,walk:()=>Ik});function Pk(n,t){t.range(n.property.range,"path",n.value||void 0,!n.value),n.value===null&&t.range(n.property.range,"var"),n.range&&n.value===null&&n.property.range[0]!==n.range[0]&&t.queryRoot(n.range[0])}function Dk(n,t){t.put(t.buildinFn("map")),t.put("("),t.nodeOrCurrent(n.value),t.put(","),n.property.type==="Identifier"?t.put(JSON.stringify(n.property.name)):t.node(n.property),t.put(")")}function Ik(n,t){t.nodeOrNothing(n.value),t.node(n.property)}function _k(n,t){t.nodeOrNothing(n.value)&&t.put("."),t.node(n.property)}var Pc={};Ke(Pc,{compile:()=>Rk,stringify:()=>zk,walk:()=>jk});function Rk(n,t){t.put(n.name)}function jk(){}function zk(n,t){t.put(n.name)}var Dc={};Ke(Dc,{compile:()=>Fk,stringify:()=>Bk,walk:()=>Hk});function Fk(n,t){t.put(typeof n.value=="string"?JSON.stringify(n.value):String(n.value))}function Hk(){}function Bk(n,t){t.put(typeof n.value=="string"?JSON.stringify(n.value):String(n.value))}var Ic={};Ke(Ic,{compile:()=>Wk,stringify:()=>qk,walk:()=>$k});function Wk(n,t){t.put(t.buildinFn("map")),t.put("("),t.nodeOrCurrent(n.value),t.createScope(()=>{t.put(",$=>"),t.node(n.query)},(i,o)=>(t.put(")"),i+"("+o+",")),t.put(")")}function $k(n,t){t.nodeOrNothing(n.value),t.node(n.query)}function qk(n,t){t.nodeOrNothing(n.value),t.put(".("),t.node(n.query),t.put(")")}var _c={};Ke(_c,{compile:()=>Uk,stringify:()=>Gk,walk:()=>Vk});function Uk(n,t){t.put(t.buildinFn("mapRecursive")),t.put("("),t.nodeOrCurrent(n.value),t.createScope(()=>{t.put(",$=>"),t.node(n.query)},(i,o)=>(t.put(")"),i+"("+o+",")),t.put(")")}function Vk(n,t){t.nodeOrNothing(n.value),t.node(n.query)}function Gk(n,t){t.nodeOrNothing(n.value),t.put(".."),t.isSimpleGetPropertyQuery(n.query)||t.isSimpleMethodCallQuery(n.query)?t.node(n.query):(t.put("("),t.node(n.query),t.put(")"))}var Rc={};Ke(Rc,{compile:()=>Kk,stringify:()=>Qk,suggest:()=>Yk,walk:()=>Jk});function Yk(n,t){n.arguments.length===0&&t.queryRoot(n.range[1]-1)}function Kk(n,t,i){t.tolerant&&t.put("(typeof "),n.reference.type==="Identifier"&&(t.usedMethods.has(n.reference.name)?t.usedMethods.get(n.reference.name).push(n.reference.range):t.usedMethods.set(n.reference.name,n.reference.range),t.put("m.")),t.node(n.reference),t.tolerant&&(t.put('==="function"?'),n.reference.type==="Identifier"&&t.put("m."),t.node(n.reference)),t.put("("),t.nodeOrCurrent(i),n.arguments.length&&(t.put(","),t.list(n.arguments,",")),t.put(")"),t.tolerant&&t.put(":undefined)")}function Jk(n,t){t.node(n.reference),t.list(n.arguments)}function Qk(n,t){t.node(n.reference),t.put("("),t.list(n.arguments,","),t.put(")")}var jc={};Ke(jc,{compile:()=>Zk,stringify:()=>e2,walk:()=>Xk});function Zk(n,t){t.node(n.method,n.value)}function Xk(n,t){t.nodeOrNothing(n.value),t.node(n.method)}function e2(n,t){t.nodeOrNothing(n.value)&&t.put("."),t.node(n.method)}var zc={};Ke(zc,{compile:()=>n2,stringify:()=>i2,suggest:()=>t2,walk:()=>r2});function t2(n,t){n.properties.length===0&&t.queryRoot(n.range[0]+1,n.range[1]-1)}function n2(n,t){t.put("{"),t.list(n.properties,","),t.put("}")}function r2(n,t){t.list(n.properties)}function i2(n,t){t.put("{"),t.list(n.properties,","),t.put("}")}var Fc={};Ke(Fc,{compile:()=>a2,stringify:()=>u2,suggest:()=>s2,walk:()=>l2});var o2=new Set(["Literal","Identifier","Reference","Current"]);function s2(n,t){if(n.value===null)switch(n.key.type){case"Identifier":t.range(n.range,"path"),t.range(n.range,"var");break;case"Current":case"Reference":t.range(n.range,"var");break}}function a2(n,t){let i=n.value;switch(n.key.type){case"Current":return;case"Literal":t.node(n.key);break;case"Identifier":t.node(n.key),i=i||Qa(null,Za(n.key.name));break;case"Reference":t.node(n.key.name),i=i||n.key;break;default:t.put("["),t.node(n.key),t.put("]")}t.put(":"),t.node(i)}function l2(n,t){t.node(n.key),t.nodeOrNothing(n.value)}function u2(n,t){if(o2.has(n.key.type)){if(t.node(n.key),n.value===null)return}else t.put("["),t.node(n.key),t.put("]");t.put(":"),t.node(n.value)}var Hc={};Ke(Hc,{compile:()=>c2,stringify:()=>d2,walk:()=>f2});function c2(n,t){t.put("("),t.node(n.body),t.put(")")}function f2(n,t){t.node(n.body)}function d2(n,t){t.put("("),t.node(n.body),t.put(")")}var Bc={};Ke(Bc,{compile:()=>h2,stringify:()=>m2,suggest:()=>p2,walk:()=>g2});function p2(n,t){if(n.getter===null){let i=n.range[1]-1;t.range([i,i],"key",n.value,!1),t.queryRoot(i)}else(n.getter.type==="GetProperty"||n.getter.type==="Reference"||n.getter.type==="Literal"&&typeof n.getter.value=="string")&&t.range(n.getter.range,"key",n.value,!1)}function h2(n,t){t.put(t.buildinFn("pick")),t.put("("),t.node(n.value),n.getter&&(t.put(","),t.node(n.getter)),t.put(")")}function g2(n,t){t.node(n.value),n.getter!==null&&t.node(n.getter)}function m2(n,t){t.node(n.value),t.put("["),n.getter!==null&&t.node(n.getter),t.put("]")}var Wc={};Ke(Wc,{compile:()=>v2,stringify:()=>b2,walk:()=>y2});function v2(n,t){t.createScope(()=>{t.put("($=>("),t.node(n.right),t.put("))")},(i,o)=>i+o+";"),t.put("("),t.node(n.left),t.put(")")}function y2(n,t){t.node(n.left),t.node(n.right)}function b2(n,t){t.node(n.left),t.put("|"),t.node(n.right)}var $c={};Ke($c,{compile:()=>x2,stringify:()=>S2,suggest:()=>w2,walk:()=>k2});function w2(n,t){t.queryRoot(n.range[1])}function x2(n,t){t.put("$")}function k2(){}function S2(){}var qc={};Ke(qc,{compile:()=>T2,stringify:()=>E2,suggest:()=>C2,walk:()=>L2});function C2(n,t){n.range&&t.range(n.range,"var")}function T2(n,t){if(!t.scope.includes(n.name.name)&&t.tolerant){t.put("(typeof $"),t.node(n.name),t.put('!=="undefined"?$'),t.node(n.name),t.put(":undefined)");return}t.put("$"),t.node(n.name)}function L2(n,t){t.node(n.name)}function E2(n,t){t.put("$"),t.node(n.name)}var Uc={};Ke(Uc,{compile:()=>M2,stringify:()=>O2,walk:()=>A2});function M2(n,t){t.put(t.buildinFn("slice")),t.put("("),t.nodeOrCurrent(n.value),n.arguments.slice(0,3).forEach(i=>{t.put(","),i?t.node(i):t.put("undefined")}),t.put(")")}function A2(n,t){t.nodeOrNothing(n.value);for(let i of n.arguments.slice(0,3))i&&t.node(i)}function O2(n,t){let[i,o,u]=n.arguments;t.nodeOrNothing(n.value),t.put("["),i&&t.node(i),t.put(":"),o&&t.node(o),u&&(t.put(":"),t.node(u)),t.put("]")}var Vc={};Ke(Vc,{compile:()=>N2,stringify:()=>D2,walk:()=>P2});function N2(n,t){t.put("(a, b)=>{let _q;return "),t.list(n.compares,"||"),t.put("||0}")}function P2(n,t){t.list(n.compares)}function D2(n,t){t.list(n.compares,",")}var Gc={};Ke(Gc,{compile:()=>_2,stringify:()=>j2,suggest:()=>I2,walk:()=>R2});function I2(n,t){n.query===null&&t.queryRoot(n.range[1])}function _2(n,t){if(n.array){t.put("..."),t.put(t.buildinFn("ensureArray")),t.put("("),t.nodeOrCurrent(n.query),t.put(")");return}t.put("..."),t.nodeOrCurrent(n.query)}function R2(n,t){t.nodeOrNothing(n.query)}function j2(n,t){t.put("..."),t.nodeOrNothing(n.query)}var Yc={};Ke(Yc,{compile:()=>F2,stringify:()=>B2,suggest:()=>z2,walk:()=>H2});function z2(n,t){for(let[i,o]of Object.entries(n.values))o===null&&t.queryRoot(n.values[Number(i)-1].range[1])}function F2(n,t){for(let[i,o]of Object.entries(n.values)){let u=Number(i);o!==null&&(u!==0&&t.put("+"),u%2===0?t.put('"'+sy(o.value,W2)+'"'):(t.put("("),t.node(o),t.put(")")))}}function H2(n,t){for(let i of n.values)i!==null&&t.node(i)}function B2(n,t){let i=n.values.length-1;for(let[o,u]of Object.entries(n.values)){let c=Number(o);c%2===0?(t.put(c===0?"`":"}"),t.put(sy(u.value,$2)),t.put(c===i?"`":"${")):u!==null&&t.node(u)}}var W2=new Map([["\b","\\b"],[`
`,"\\n"],["\r","\\r"],["\f","\\f"],["	","\\t"],["\v","\\v"],["\u2028","\\u2028"],["\u2029","\\u2029"],["\\","\\\\"],['"','\\"']]),$2=new Map([["\b","\\b"],["\f","\\f"],["	","\\t"],["\v","\\v"],["\\","\\\\"],["$","\\$"]]);function sy(n,t){let i="";for(let o=0;o<n.length;o++)i+=t.get(n[o])||n[o];return i}var Kc={};Ke(Kc,{compile:()=>q2,stringify:()=>V2,walk:()=>U2});function q2(n,t){switch(n.operator){case"no":case"not":t.put("!"),t.put(t.buildinFn("bool")),t.put("("),t.node(n.argument),t.put(")");break;case"+":case"-":t.put(n.operator),t.node(n.argument);break;default:t.error('Unknown operator "'+n.operator+'"',n)}}function U2(n,t){t.node(n.argument)}function V2(n,t){t.put(n.operator),n.operator!=="-"&&n.operator!=="+"&&t.put(" "),t.node(n.argument)}var G2={Arg1:yc,Array:bc,Binary:wc,Block:xc,Compare:kc,Conditional:Sc,Context:Cc,Current:Tc,Data:Lc,Declarator:Ec,Definition:Mc,Filter:Ac,Function:Oc,GetProperty:Nc,Identifier:Pc,Literal:Dc,Map:Ic,MapRecursive:_c,Method:Rc,MethodCall:jc,Object:zc,ObjectEntry:Fc,Parentheses:Hc,Pick:Bc,Pipeline:Wc,Placeholder:$c,Reference:qc,SliceNotation:Uc,SortingFunction:Vc,Spread:Gc,Template:Yc,Unary:Kc},ks=n=>new Map(Object.entries(G2).map(([t,i])=>[t,i[n]]).filter(([,t])=>typeof t=="function")),Y2={};ks("build").forEach((n,t)=>Y2[t]=n);var Jc=ks("compile"),Qc=ks("walk"),Zc=ks("stringify"),Xc=ks("suggest");function Ss(n,t){function i(f){if(Qc.has(f.type))u(f),Qc.get(f.type)(f,o),c(f);else throw new Error('Unknown node type "'+f.type+'"')}let o={node:i,nodeOrNothing(f){f!==null&&i(f)},list(f){f.forEach(i)}},u=()=>{},c=()=>{};typeof t=="function"&&(t={enter:t}),t&&(typeof t.enter=="function"&&(u=t.enter),typeof t.leave=="function"&&(c=t.leave)),i(n)}function ay(n,t){return t>=0&&t<n.length&&/[a-zA-Z_$0-9]/.test(n[t])}function ef(n,t){let i=n.charCodeAt(t);return i===9||i===10||i===13||i===32}function K2(n,t,i){for(;t<i;t++)if(!ef(n,t))return!1;return!0}function J2(n,t,i,o,u){let c=[];for(let f=0;f<o.length;f++){let[p,m]=o[f];if(p>=t)break;p<n||(c.push(n,p),n=m)}return(n!==i.length||!u)&&c.push(n,t),c}function Q2(n,t,i,o){let u=[];for(let c=0;c<n.length;c++){let[f,p,m,y]=n[c];if(K2(t,f,p)){for(;f>=0&&ef(t,f-1);)f--;for(;p<t.length&&ef(t,p);)p++;if(ay(t,f-1)){if(f===p)continue;f++}if(ay(t,p)){if(f===p)continue;p--}}let x=J2(f,p,t,i,o);for(let S=0;S<x.length;S+=2)u.push([x[S],x[S+1],m,y])}return u}function Z2(n){let t=null,i=[],o=Object.assign(new Map,{literalList:i}),u=(f,p)=>{o.has(f)?o.get(f).push(p):o.set(f,[p])},c={range(f,p,m=t,y=!0){u(m,[...f,p,y])},literalList(f){let p="l"+i.length;return i.push([p,f]),p},queryRoot(f,p=f){u(t,[f,p,"var",!0]),u(t,[f,p,"path",!0])}};return Ss(n,f=>{if(Xc.has(f.type)){let p=t;t=f,Xc.get(f.type)(f,c),t=p}}),o}function Xa(n,{ast:t,commentRanges:i}){let o=Z2(t),u=i.length&&i[i.length-1][1]===n.length&&!/[\r\n]$/.test(n);for(let[c,f]of o)o.set(c,Q2(f,n,i,u));return o}function X2(n){return n.type==="GetProperty"}function e3(n){return n.type==="MethodCall"}function el(n){function t(u){if(Zc.has(u.type))Zc.get(u.type)(u,o);else throw new Error('Unknown node type "'+u.type+'"')}let i=[],o={isSimpleGetPropertyQuery:X2,isSimpleMethodCallQuery:e3,put(u){i.push(u)},node:t,nodeOrNothing(u){if(u!==null)return t(u),!0},list(u,c){if(!c){u.forEach(t);return}u.forEach((f,p)=>{p>0&&o.put(c),t(f)})}};return t(n),i.join("")}var Gn=Object.hasOwnProperty,t3=Object.prototype.toString;function oo(n,t){return t!==void 0&&(Array.isArray(t)?t.forEach(i=>n.add(i)):n.add(t)),n}function ly(n,t){return n&&Gn.call(n,t)?n[t]:void 0}function Er(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function tl(n){return t3.call(n)==="[object RegExp]"}function uy(n){return n&&Gn.call(n,"length")}function tf(n,t,i){let o=Object.assign(Object.create(SyntaxError.prototype),i),u=new Error;return o.name=n,o.message=t,Object.defineProperty(o,"stack",{get:function(){return(u.stack||"").replace(/^(.+\n){1,3}/,n+": "+t+`
`)}}),o}function nl(n,t=!1,i=null){function o(M){let _="s"+m.length;return m.push(M?[_,M]:[_]),_}function u(M){let _=y.get(M);return _||y.set(M,_=o()),_}function c(M,_,C,I,N){let R=[M,_,JSON.stringify(C)];if(C==="var"){if(!E.scope.length)return;R.push(JSON.stringify(E.scope))}else I||(I=o()),R.push(I),N&&R.push(typeof N=="string"?N:u(N));return S.push(R),I}function f(M,_){let C=E.scope,I=k.length;if(E.scope=E.scope.slice(),E.scope.own=[],E.scope.firstCurrent=null,E.scope.captureCurrent=[],E.scope.arg1=C.arg1||!1,M(),E.scope.captureCurrent.length){let R="stat("+E.scope.captureCurrent.reduce((j,F)=>c(...F,j),void 0)+",$)";E.scope.firstCurrent?k[E.scope.firstCurrent]=R:k[I]=_(k[I],R)}E.scope=C}function p(M,_){let C=!1;if(i!==null){if(i.has(M))for(let[I,N,R,j]of i.get(M))R==="var"?c(I,N,R):j===!0?E.scope.captureCurrent.push([I,N,R]):(C||(C=u(M),k.push("stat("+C+",")),R&&c(I,N,R,C,j));M.type==="Current"&&E.scope.firstCurrent===null&&E.scope.captureCurrent.disabled!==!0&&(E.scope.firstCurrent=k.length)}if(Jc.has(M.type))Jc.get(M.type)(M,E,_);else throw new Error('Unknown node type "'+M.type+'"');C&&k.push(")")}let m=[],y=new WeakMap,x=[],S=[],k=["((data,context)=>{","const $=data;",{toString(){return x.length>0?"let "+x+`;
`:""}},{toString(){return m.length>0?[`const stat=(s,v)=>(s.add(v),v);
`,"const "+m.map(([M,_])=>M+"=new Set("+(_?JSON.stringify(_):"")+")")+`;
`].join(""):""}},{toString(){let M=i&&Array.isArray(i.literalList)&&i.literalList.map(([_,C])=>_+"="+JSON.stringify(C));return M&&M.length?"const "+M+`;
`:""}},"return "],T={},O=new Set,E={tolerant:t,usedMethods:new Map,buildinFn(M){return O.add(M),"f."+M},scope:[],createScope:f,error:(M,_)=>{let C=new SyntaxError(M);if(_&&_.range&&(C.details={loc:{range:_.range}}),!t)throw C},allocateVar(){let M="tmp"+x.length;return x.push(M),M},put:M=>k.push(M),node:p,nodeOrCurrent(M,_){p(M||{type:"Current"},_)},list(M,_,C){M.forEach((I,N)=>{N>0&&k.push(_),p(I,C)})}};if(f(()=>p(n),(M,_)=>(k.push(")"),"("+_+","+M)),!t&&E.usedMethods.size){let{usedMethods:M}=E;k.unshift(" this.assertMethods(m)||"),T.assertMethods=function(_){for(let[C,I]of M.entries())if(!Gn.call(_,C))return()=>{throw Object.assign(new Error(`Method "${C}" is not defined`),{details:{loc:{range:I}}})}}}i!==null&&k.push(`
,[`+S.map(M=>"["+M+"]")+"]");try{let M=new Function("f,m","return"+k.join("")+"})");return Object.assign(M.bind(T),{toString(){return M.toString().replace(/^(\S+\s+)anonymous([^)\s]+)\s*\)/,"$1query$2)")}})}catch(M){throw tf("SyntaxError","Jora query compilation error",{compiledSource:k.join(""),details:M})}}var an=(n,t)=>t<n.length?n.charCodeAt(t):0,rl=n=>n===43||n===45,Gr=n=>n>=48&&n<=57,nf=n=>n===9||n===10||n===12||n===13||n===32,rf=n=>n>32&&n<256&&(n<65||n>90)&&(n<97||n>122)&&(n<48||n>57)&&n!==43&&n!==45||n===8470;function n3(n,t,i){return rl(n)?Gr(t)?2:t===46&&Gr(i)?3:0:Gr(n)?1:0}function of(n,t){for(;Gr(an(n,t));)t++;return t}function r3(n,t,i){let o=an(n,t);if(rl(o)&&(o=an(n,t+=1)),Gr(o)&&(t=of(n,t+1),o=an(n,t)),o===46&&Gr(an(n,t+1))){if(i)return t;let u=t+2;if(u=of(n,u),an(n,u)===46)return t;t=u}if(o=an(n,t),o===69||o===101){let u=0;o=an(n,t+1),rl(o)&&(u=1,o=an(n,t+2)),Gr(o)&&(t=of(n,t+1+u+1))}return t}function cy(n,t,i,o){if(t>=n.length)return 0;let u=an(n,t);if(nf(u)){let m=t+1;for(;nf(an(n,m));)m++;return 1|m-t<<3}if(rf(u)||o&&rl(u)){let m=t+1,y=u;do u=y,y=an(n,m++);while(rf(y)||y===u);return 2|m-t-1<<3}let c=an(n,t+1),f=an(n,t+2);if(n3(u,c,f))return 3|r3(n,t,i)-t<<3;let p=t;do u=c,c=f,f=an(n,3+p++);while(p<n.length&&!nf(u)&&!rf(u)&&!Gr(u));return 4|p-t<<3}function fy(n,t,i){let o=0,u=0,c=!1,f=!1,p=0,m=0,y=!0;do{let x=cy(n,o,c,f),S=cy(t,u,c,f),k=x&7,T=x>>3,O=S&7,E=S>>3;if(k!==O&&y){if((k===1||k===2)&&(O===3||O===4)){p=1,m=k,o+=T;continue}if((O===1||O===2)&&(k===3||k===4)){p=-1,m=O,u+=E;continue}}if(y=!1,k!==O)return k<O?-1:1;if(c=!1,f=!1,k===0)return p;let M=T<E?T:E,_=T-E,C=0;for(;C<M;C++){let I=n[o+C],N=t[u+C];if(I!==N){_=I<N?-1:1;break}}if(k===1||k===2)_!==0&&(p===0||k>m)&&(m=k,p=_),c=n[o+T-1]===".";else if(k===3){if(f=!0,_!==0){let I=n.substr(o,T)-t.substr(u,E);if(I!==0)return i?-I:I;if(p===0||k>m){let N=an(n,o),R=an(t,u),j=N===45?-1:1;m=k,p=N!==R&&(N===45||R===43)?-1:N!==R&&(N===43||R===45)?1:(T!==E?T<E:_<0)?-j:j,i&&(p=-p)}}}else{if(_!==0){if(C<M){let I=n[o+C].toLowerCase(),N=t[u+C].toLowerCase();if(I!==N)return I<N?-1:1}return _}c=n[o+T-1]==="."}o+=T,u+=E}while(!0)}function dy(n,t){let i=typeof n,o=typeof t,u=0;return(i==="number"||i==="string")&&(o==="number"||o==="string")&&(u=Math.sign(fy(String(n),String(t),!1))),u}function py(n,t){let i=typeof n,o=typeof t,u=0;return(i==="number"||i==="string")&&(o==="number"||o==="string")&&(u=Math.sign(fy(String(n),String(t),!0))),u}var i3=1,o3=2,so=3,Cs=4,s3=5,a3=6,l3=7,u3=8;function Yr(n){switch(typeof n){case"boolean":return i3;case"number":return n!==n?o3:so;case"string":return Cs;case"object":return n===null?s3:a3;case"undefined":return u3;default:return l3}}var Mn=Object.freeze({ensureArray:c3,bool:mi,and:(n,t)=>mi(n)?t:n,or:(n,t)=>mi(n)?n:t,add:f3,sub:d3,mul:p3,div:h3,mod:g3,eq:m3,ne:v3,lt:y3,lte:b3,gt:w3,gte:x3,in:il,notIn:(n,t)=>!il(n,t),has:(n,t)=>il(t,n),hasNo:(n,t)=>!il(t,n),cmp:k3,cmpAnalytical:S3,cmpNatural:C3,cmpNaturalAnalytical:T3,match:L3,pick:E3,map:sf,mapRecursive:M3,some:af,filter:A3,slice:O3});function c3(n){return Array.isArray(n)?n:[n]}function mi(n){if(Array.isArray(n))return n.length>0;if(Er(n)){for(let t in n)if(Gn.call(n,t))return!0;return!1}return!!n}function f3(n,t){return Array.isArray(n)||Array.isArray(t)?[...new Set([].concat(n,t))]:n+t}function d3(n,t){if(Array.isArray(n)){let i=new Set(n);return Array.isArray(t)?t.forEach(o=>i.delete(o)):i.delete(t),[...i]}return n-t}function p3(n,t){return n*t}function h3(n,t){return n/t}function g3(n,t){return n%t}function m3(n,t){return Object.is(n,t)}function v3(n,t){return!Object.is(n,t)}function y3(n,t){return n<t}function b3(n,t){return n<=t}function w3(n,t){return n>t}function x3(n,t){return n>=t}function il(n,t){return Er(t)?Gn.call(t,n):t&&typeof t.indexOf=="function"?t.indexOf(n)!==-1:!1}function k3(n,t){let i=Yr(n),o=Yr(t);return i!==o?i<o?-1:1:n<t?-1:n>t?1:0}function S3(n,t){let i=Yr(n),o=Yr(t);return i!==o?i<o?-1:1:i===so?t-n:n<t?-1:n>t?1:0}function C3(n,t){let i=Yr(n),o=Yr(t);return(i===so||i===Cs)&&(o===so||o===Cs)?dy(n,t):i!==o?i<o?-1:1:n<t?-1:n>t?1:0}function T3(n,t){let i=Yr(n),o=Yr(t);return(i===so||i===Cs)&&(o===so||o===Cs)?py(n,t,!0):i!==o?i<o?-1:1:n<t?-1:n>t?1:0}function L3(n,t){return typeof t=="function"?af(n,t):tl(t)?af(n,t.test.bind(t)):t==null}function E3(n,t=()=>!0){if(n){if(typeof t=="function"){if(Array.isArray(n)||typeof n=="string"){for(let i=0;i<n.length;i++)if(t(n[i],i))return n[i]}for(let i in n)if(Gn.call(n,i)&&t(n[i],i))return n[i];return}return Array.isArray(n)||typeof n=="string"?isFinite(t)?n[t<0?n.length+Number(t):Number(t)||0]:void 0:Gn.call(n,t)?n[t]:void 0}}function sf(n,t){let i=typeof t=="function"?t:o=>ly(o,t);return Array.isArray(n)?[...n.reduce((o,u)=>oo(o,i(u)),new Set)]:n!==void 0?i(n):n}function M3(n,t){let i=new Set;return oo(i,sf(n,t)),i.forEach(o=>oo(i,sf(o,t))),[...i]}function af(n,t){return Array.isArray(n)?n.some(i=>mi(t(i))):mi(t(n))}function A3(n,t){return Array.isArray(n)?n.filter(i=>mi(t(i))):mi(t(n))?n:void 0}function O3(n,t=0,i=n&&n.length,o=1){if(!uy(n))return[];if(t=parseInt(t,10)||0,i=parseInt(i,10)||n.length,o=parseInt(o,10)||1,o!==1){let u=[];t=t<0?Math.max(0,n.length+t):Math.min(n.length,t),i=i<0?Math.max(0,n.length+i):Math.min(n.length,i);for(let c=o>0?t:i-1;c>=t&&c<i;c+=o)u.push(n[c]);return u}return typeof n=="string"?n.slice(t,i):Array.prototype.slice.call(n,t,i)}function N3(){}function P3(n){return n}function hy(n){return{matched:n.slice(),start:n.index,end:n.index+n[0].length,input:n.input,groups:n.groups||null}}var D3=gy(20)?1/0:gy(10)?10:0;function gy(n){return Array.from({length:n},(t,i)=>({idx:i})).sort((t,i)=>t.idx%2-i.idx%2).every((t,i)=>i<n/2?t.idx>>1===i:Math.ceil(n/2)+(t.idx>>1)===i)}function I3(n,t){return n.length<=D3?n.slice().sort(t):n.map((i,o)=>({value:i,idx:o})).sort((i,o)=>(i.value===void 0?o.value!==void 0:o.value===void 0?-1:t(i.value,o.value))||i.idx-o.idx).map(i=>i.value)}var Ts=Object.freeze({bool:Mn.bool,filter:Mn.filter,map:Mn.map,pick:Mn.pick,keys(n){return Object.keys(n||{})},values(n){let t=new Set;for(let i in n)Gn.call(n,i)&&oo(t,n[i]);return[...t]},entries(n){let t=[];for(let i in n)Gn.call(n,i)&&t.push({key:i,value:n[i]});return t},fromEntries(n){let t={};return Array.isArray(n)&&n.forEach(i=>{i&&(t[i.key]=i.value)}),t},size(n){return Er(n)?Object.keys(n).length:n&&n.length||0},sort(n,t){let i;return Array.isArray(n)?(typeof t=="function"?i=t.length===2?t:(o,u)=>{if(o=t(o),u=t(u),Array.isArray(o)&&Array.isArray(u)){if(o.length!==u.length)return o.length<u.length?-1:1;for(let c=0;c<o.length;c++){if(o[c]<u[c])return-1;if(o[c]>u[c])return 1}return 0}return o<u?-1:o>u}:i=Mn.cmp,I3(n,i)):n},reverse(n){return Array.isArray(n)?n.slice().reverse():n},slice(n,t,i){return Mn.slice(n,t,i)},group(n,t,i){typeof t!="function"&&(t=N3),typeof i!="function"&&(i=P3),Array.isArray(n)||(n=[n]);let o=new Map,u=[];return n.forEach(c=>{let f=t(c);Array.isArray(f)||(f=[f]),f.forEach(p=>{o.has(p)?o.get(p).add(i(c)):o.set(p,new Set([i(c)]))})}),o.forEach((c,f)=>u.push({key:f,value:[...c]})),u},split(n,t){return String(n).split(t)},join(n,t){return Array.isArray(n)?n.join(t):String(n)},match(n,t,i){let o=String(n),u=tl(t)?t.flags:"";if(i||u.includes("g")){let f=[],p=new RegExp(t,(u||"").replace(/g|$/,"g")),m;for(;m=p.exec(o);)f.push(hy(m));return f}let c=o.match(t);return c&&hy(c)},reduce(n,t,i=void 0){return Array.isArray(n)?i!==void 0?n.reduce((o,u)=>t(u,o),i):n.reduce((o,u)=>t(u,o)):t(n,i)}});var _3=(n,t)=>n-t,R3=()=>!0,ao=class{constructor(t,i,o){this.maxSize=t||1/0,this.compare=i||_3,this.accept=o||R3,this.values=[]}add(t){let i=this.values.length+1;if(i>this.maxSize)this.compare(this.values[0],t)>0&&this.accept(t)&&(this.values[0]=t,this.heapify(0));else if(this.accept(t)&&(this.values.push(t),i===this.maxSize))for(let o=i-1;o>=0;o--)this.heapify(o)}heapify(t){let i=this.values.length;if(t>=i>>1)return;let o=2*t+1,u=2*t+2,c=this.values[t],f=this.compare(this.values[o],c)>0?o:t;u<i&&this.compare(this.values[u],this.values[f])>0&&(f=u),f!==t&&(this.values[t]=this.values[f],this.values[f]=c,this.heapify(f))}[Symbol.iterator](){return this.values.slice().sort(this.compare)[Symbol.iterator]()}};var j3={path:"property",key:"value",value:"value","in-value":"value","value-subset":"value",var:"variable"};function ol(n,t){Object.keys(n).forEach(t.add,t)}function z3(n,t,i,o=new Set){let u=c=>{switch(typeof c){case"string":case"number":o.add(c);break}};switch(n){case"path":{let c=new Set;for(let f of t)if(Array.isArray(f))for(let p of f)Er(p)&&ol(p,c);else Er(f)&&ol(f,c);c.forEach(o.add,o);break}case"key":{let c=new Set;for(let f of t)f!==null&&typeof f=="object"&&!Array.isArray(f)&&ol(f,c);c.forEach(o.add,o);break}case"value":for(let c of t)u(c);break;case"in-value":{let c=new Set;for(let f of t)Array.isArray(f)?f.forEach(u):Er(f)&&ol(f,c);c.forEach(o.add,o);break}case"var":for(let c of t)o.add("$"+c);break;case"value-subset":{let c=new Set(i);for(let f of t)c.has(f)||u(f);break}}return o}function my(n,t,i,o=!1){let u=[];for(let[c,f,p,m,y=null]of i)if(t>=c&&t<=f&&(o||m.size||m.length)){let x=n.substring(c,f);/\S/.test(x)||(c=f=t,x=""),u.push({context:p,from:c,to:f,text:x,values:m,related:y})}return u}function vy(n,t){return typeof n=="function"?n:n===!0?t:!1}function yy(n){if(/^(["']).*\1$/.test(n))try{return n[0]==="'"&&(n=`"${n.slice(1,-1).replace(/\\.|"/g,t=>t==="\\'"?"'":t==='"'?'\\"':t)}"`),JSON.parse(n)}catch{}return n}function F3(n){return t=>(typeof t=="string"?t:String(t)).toLowerCase().indexOf(n)!==-1}var lf=(n,t)=>({stat(i,o){return my(n,i,t,o)},suggestion(i,o){let{limit:u=1/0,sort:c,filter:f}=o||{};c=vy(c,Mn.cmp),f=vy(f,F3);let p=c&&isFinite(u)?ao:Set,m=my(n,i,t),y=new Map,x=[];for(let S of m){let{context:k,text:T,from:O,to:E,values:M,related:_}=S,C=j3[k];if(!y.has(C)){let N;switch(p){case ao:N=new ao(u,c,f&&f(yy(T)));break;case Set:N=new Set;break}y.set(C,{type:C,from:O,to:E,text:T,suggestions:N})}let{suggestions:I}=y.get(C);z3(k,M,_,I)}if(p===Set)for(let S of y.values()){let{suggestions:k}=S;if(c&&(k=[...k].sort(c)),f||isFinite(u)){let T=[],O=f?f(yy(S.text)):()=>!0;for(let E of k)if(O(E)&&T.push(E)>=u)break;k=T}S.suggestions=k}for(let S of y.values())S.suggestions=Array.isArray(S.suggestions)?S.suggestions:[...S.suggestions],S.suggestions.length&&x.push(S);return x.length?x:null}});var H3=new Map,B3=new Map,W3=new Map,$3=new Map;function q3(n,t){console.log(`[${n}]`),typeof t=="string"?console.log(t):t!==void 0&&console.dir(t,{depth:null}),console.log()}function uf(n,t,i,o){o=typeof o=="function"?o:o?q3:!1,o&&(o("========================="),o("Compile query from source",n));let u=Ka.parse(n,i);o&&(o("AST",u.ast),o("Restored source",el(u.ast)));let c=t?Xa(n,u):null;if(o&&c){let p=S=>JSON.stringify(S).slice(1,-1),m=[].concat(...[...c.entries()].map(([S,k])=>k.map(T=>[S,...T]))),y=[],x=null;o("Stat/suggestion ranges",m.sort((S,k)=>S[1]-k[1]).map(([S,...k])=>{let[T,O,E,M]=k,_;if(T===y[0]&&O===y[1])_=" ".repeat(x.length);else{let C=p(n.slice(0,T)).length,I=p(n.substring(T,O)).length;y=k,x=" ".repeat(C)+(I?"~".repeat(I):"\\")+" "+T+":"+O,_=p(n)+`
`+x}return _+" ["+E+"] on "+S.type+(M===!0?" (current)":M&&M.type?" & "+M.type:"")}).join(`
`))}let f=nl(u.ast,i,c);return o&&o("Compiled code",f.toString()),f}function U3(n,t){t=t||{};let i=!!t.stat,o=!!t.tolerant,u=t.methods?{...Ts,...t.methods}:Ts,c=i?o?$3:B3:o?W3:H3,f;return n=String(n),c.has(n)&&!t.debug?f=c.get(n):(f=uf(n,i,o,t.debug),c.set(n,f)),f=f(Mn,u),i?(p,m)=>lf(n,f(p,m)):f}function V3(n){let t=new Map,i=new Map,o=new Map,u=new Map,c={...Ts};for(let[f,p]of Object.entries(n||{}))typeof p=="string"?Object.defineProperty(c,f,{configurable:!0,get(){let m=uf(p)(Mn,c),y=x=>m(x,null);return Object.defineProperty(c,f,{value:y}),y}}):c[f]=p;return function(p,m){m=m||{};let y=!!m.stat,x=!!m.tolerant,S=y?x?u:i:x?o:t,k;if(p=String(p),S.has(p)&&!m.debug)k=S.get(p);else{let T=uf(p,y,x,m.debug)(Mn,c);k=y?(O,E)=>lf(p,T(O,E)):T,S.set(p,k)}return k}}var Mr=Object.assign(U3,{version:Rv,buildin:Mn,methods:Ts,setup:V3,syntax:{tokenize:Ka.tokenize,parse:Ka.parse,suggest:Xa,walk:Ss,stringify:el,compile:nl}});function cf(n){let t=new ws,i=[],o=[],u=(S,k)=>t.lookup(S,k),c=S=>t.lookupAll(S),f=(S,k=!1)=>{typeof k=="boolean"&&(k={debug:k}),o.push({query:S,...k})},p=S=>{let k=[],T=typeof S;if(S&&(T==="object"||T==="string"))for(let O of i){let E=O(S);E&&k.push(E)}return k.length?k:null};function m(S,...k){let T=null;typeof k[k.length-1]=="function"&&(T=k.pop());let O=n.action.call(S,...k);return O&&T&&typeof O.then=="function"?O.then(T):T?T(O):O}let y={query:(...S)=>n.query(...S),pageLink:(S,k,T)=>n.encodePageHash(k,S,T),marker:u,markerAll:c,callAction:m,actionHandler:(S,...k)=>n.action.has(S)?()=>m(S,...k):void 0},x=Mr.setup(y);return{apply(){Object.assign(n,{objectMarkers:t,linkResolvers:i,resolveValueLinks:p,annotations:o,queryFnFromString:x})},methods:{rejectData(S,k){throw Object.assign(new Error(S),{renderContent:k})},lookupObjectMarker:u,lookupObjectMarkerAll:c,resolveValueLinks:p,defineObjectMarker(S,k){let{page:T,mark:O,lookup:E}=t.define(S,k)||{};if(!E)return()=>{};if(T!==null){if(!n.page.isDefined(k.page)){console.error(`[Discovery] Page reference "${k.page}" doesn't exist`);return}i.push(M=>{let _=E(M);if(_!==null)return{type:T,text:_.title,href:_.href,entity:_.object}}),f((M,_)=>{let C=E(M);if(C&&C.object!==_.host)return{place:"before",style:"badge",text:T,href:C.href}})}else f((M,_)=>{let C=E(M);if(C&&C.object!==_.host)return{place:"before",style:"badge",text:S}});return O},addValueAnnotation:f,addQueryHelpers(S){x=Mr.setup(y={...y,...S})},query(S,...k){return n.queryFn.call({queryFnFromString:x},S)(...k)}}}}var by=new WeakMap,wy=["variable","property","value","method"],G3=(n,t)=>wy.indexOf(n.type)-wy.indexOf(t.type),Y3=n=>(n=n.toLowerCase(),t=>t!==n&&(typeof t=="string"?t:String(t)).toLowerCase().indexOf(n)!==-1);function K3(n,t){return typeof n!="string"?String(n):(n=JSON.stringify(n),t[0]!=="'"?n:`'${n.slice(1,-1).replace(/\\.|'/g,i=>i==='\\"'?'"':i==="'"?"\\'":i)}'`)}function J3(n,t,i){if(t===i)return!0;let o=n.stat(t)||[],u=n.stat(i)||[];if(o.length!==u.length)return!1;for(let c=0;c<o.length;c++){let f=o[c],p=u[c];for(let m of Object.keys(f))if(f[m]!==p[m])return!1}return!0}function xy(n,t,i,o,u){try{let c=by.get(n);if(!c||c.query!==t||c.data!==o||c.context!==u){let p={tolerant:!0,stat:!0};by.set(n,c={query:t,data:o,context:u,offset:-1,suggestions:null,api:null}),c.api=n.queryFnFromString(t,p)(o,u)}if(c.api===null)return null;if(c.offset!==-1&&J3(c.api,c.offset,i))return c.suggestions;let f=c.api.suggestion(c.offset=i,{sort:!0,filter:Y3,limit:50});if(f){c.suggestions=[];for(let p of f.sort(G3))c.suggestions.push(...p.suggestions.map(m=>({type:p.type,from:p.from,to:p.to,text:p.text,value:p.type==="value"?K3(m,p.text):m})))}else c.suggestions=null;return c.suggestions}catch(c){console.groupCollapsed("[Discovery] Error on getting suggestions for query"),console.error(c),console.groupEnd();return}}var ky=new WeakMap,lo=new WeakMap,Q3=n=>n,Z3=n=>Object.fromEntries(n);function ff(n,t,i){i?n.dataset[t]=i:delete n.dataset[t]}function X3(n,t,i,o){let u=n.page.get(t);return u&&Object.hasOwnProperty.call(u.options,i)?u.options[i]:o}function Sy(n,t,i,o){let u=X3(n,t,i,o);return typeof u=="function"?u:o}var uo=class extends tr{constructor(t={}){super(),this.options=t||{};let{darkmode:i="disabled",darkmodePersistent:o=!1,defaultPageId:u,reportPageId:c,extensions:f,inspector:p=!1}=this.options;this.darkmode=new Ra(i,o),this.inspectMode=new wn(!1),this.initDom(),this.action=new Qo,this.action.on("define",()=>{this.context&&(this.scheduleRender("sidebar"),this.scheduleRender("page"))}).on("revoke",()=>{this.context&&(this.scheduleRender("sidebar"),this.scheduleRender("page"))}),this.view=new Zo(this),this.nav=new ja(this),this.preset=new Xo(this.view),this.page=new es(this).on("define",(m,y)=>{let{resolveLink:x}=y.options;if(typeof x<"u"&&console.warn('"resolveLink" in "page.define()" options is deprecated, use "page" option for "defineObjectMarker()" method in prepare function'),this.pageId===m&&this.pageHash!=="#"){let S=this.pageHash;this.pageHash="#",this.setPageHash(S),this.cancelScheduledRender()}}),lo.set(this,new Set),this.datasets=[],this.data=void 0,this.context=void 0,this.prepare=m=>m,cf(this).apply(),this.defaultPageId=u||"default",this.reportPageId=c||"report",this.pageId=this.defaultPageId,this.pageRef=null,this.pageParams={},this.pageHash=this.encodePageHash(this.pageId,this.pageRef,this.pageParams),this.apply(La),this.apply(Pa),this.options.defaultPage&&this.page.define(this.defaultPageId,this.options.defaultPage),f&&this.apply(f),p&&this.apply(Xu),this.nav.render(this.dom.nav,this.data,this.getRenderContext()),this.setContainer(this.options.container)}apply(t){Array.isArray(t)?t.forEach(i=>this.apply(i)):typeof t=="function"?t.call(window,this):t?this.apply(Object.values(t)):console.error("Bad type of extension:",t)}setPrepare(t){if(typeof t!="function")throw new Error("An argument should be a function");this.prepare=t}setData(t,i={},o){o=o||{};let u=Date.now(),c=cf(this),f=()=>{if(ky.get(this)!==p)throw new Error("Prevented by another setData()")},p=Promise.resolve().then(()=>(f(),this.prepare(t,c.methods)||t)).then(m=>{f(),this.datasets=[{...o.dataset,data:m}],this.data=m,this.context=i,c.apply(),this.emit("data"),console.log(`[Discovery] Data prepared in ${Date.now()-u}ms`)});return ky.set(this,p),(!("render"in o)||o.render)&&p.then(()=>{this.scheduleRender("sidebar"),this.scheduleRender("page")}),p}async setDataProgress(t,i,o){let{dataset:u,progressbar:c}=o||{};this.emit("startSetData",(...f)=>c?.subscribeSync(...f)),await c?.setState({stage:"prepare"}),await this.setData(t,i,{dataset:u,render:!1}),await c?.setState({stage:"initui"}),this.scheduleRender("sidebar"),this.scheduleRender("page"),await Promise.all([this.dom.wrapper.parentNode?this.dom.ready:!0,lo.get(this).timer]),await c?.finish()}unloadData(){this.hasDatasets()&&(this.datasets=[],this.data=void 0,this.context=void 0,this.scheduleRender("sidebar"),this.scheduleRender("page"),this.emit("unloadData"))}hasDatasets(){return this.datasets.length!==0}resolveValueLinks(){return null}queryFn(t){switch(typeof t){case"function":return t;case"string":return this.queryFnFromString(t)}}query(t,i,o){switch(typeof t){case"function":return t(i,o);case"string":return this.queryFn(t)(i,o);default:return t}}queryBool(...t){return Mr.buildin.bool(this.query(...t))}queryToConfig(t,i){let{ast:o}=Mr.syntax.parse(i),u={view:t};if(o.type!=="Block")throw new SyntaxError('[Discovery] Widget#queryToConfig(): query root must be a "Block"');if(o.body.type!=="Object")throw new SyntaxError('[Discovery] Widget#queryToConfig(): query root must return an "Object"');for(let c of o.body.properties){if(c.type!=="ObjectEntry")throw new SyntaxError('[Discovery] Widget#queryToConfig(): unsupported object entry type "'+c.type+'"');let f,p=c.value;switch(c.key.type){case"Literal":f=c.key.value;break;case"Identifier":f=c.key.name,p||=c.key;break;case"Reference":f=c.key.name.name,p||=c.key;break;default:throw new SyntaxError('[Discovery] Widget#queryToConfig(): unsupported object key type "'+c.key.type+'"')}if(f==="view"||f==="postRender")throw new SyntaxError('[Discovery] Widget#queryToConfig(): set a value for "'+f+'" property in shorthand notation is prohibited');f==="when"||f==="data"||f==="whenData"?u[f]=p.type==="Literal"&&typeof p.value!="string"?p.value:Mr.syntax.stringify(p):u[f]=p.type==="Literal"&&(typeof p.value!="string"||p.value[0]!=="=")?p.value:"="+Mr.syntax.stringify(p)}return u}querySuggestions(t,i,o,u){return xy(this,t,i,o,u)}pathToQuery(t){return t.map((i,o)=>i==="*"?o===0?"values()":".values()":typeof i=="number"||!/^[a-zA-Z_][a-zA-Z_$0-9]*$/.test(i)?o===0?`$[${JSON.stringify(i)}]`:`[${JSON.stringify(i)}]`:o===0?i:"."+i).join("")}getQueryEngineInfo(){return{name:"jora",version:Mr.version,link:"https://github.com/discoveryjs/jora"}}initDom(){let t=V("div","discovery init"),i=t.attachShadow({mode:"open"}),o=ys(i,this.options.styles),u=i.appendChild(V("div"));this.dom={},this.dom.ready=Promise.all([o]),this.dom.wrapper=t,this.dom.root=i,this.dom.container=u,u.classList.add("discovery-root","discovery"),u.append(this.dom.nav=V("div","discovery-nav discovery-hidden-in-dzen"),this.dom.sidebar=V("nav","discovery-sidebar discovery-hidden-in-dzen"),this.dom.content=V("main","discovery-content",[this.dom.pageContent=V("article")])),i.addEventListener("click",c=>{let f=c.target.closest("a");!f||f.getAttribute("target")||f.origin!==location.origin||f.pathname!==location.pathname||(c.preventDefault(),f.classList.contains("ignore-href")||this.setPageHash(f.hash))},!0),this.dom.detachDarkMode=this.darkmode.subscribe(c=>u.classList.toggle("discovery-root-darkmode",c),!0),this.dom.ready.then(()=>{getComputedStyle(this.dom.wrapper).opacity,this.dom.wrapper.classList.remove("init")})}setContainer(t){t instanceof Node?t.append(this.dom.wrapper):this.dom.wrapper.remove()}disposeDom(){typeof this.dom.detachDarkMode=="function"&&(this.dom.detachDarkMode(),this.dom.detachDarkMode=null),this.dom.container.remove(),this.dom=null}addGlobalEventListener(t,i,o){return document.addEventListener(t,i,o),()=>document.removeEventListener(t,i,o)}addHostElEventListener(t,i,o){let u=this.dom.container;return u.addEventListener(t,i,o),()=>u.removeEventListener(t,i,o)}scheduleRender(t){let i=lo.get(this);if(!i.has(t)&&(i.add(t),!i.timer))return i.timer=Promise.resolve().then(async()=>{for(let o of i)switch(o){case"sidebar":await this.renderSidebar();break;case"page":await this.renderPage();break}i.timer=null}),i.timer}cancelScheduledRender(t){let i=lo.get(this);i&&(t?i.delete(t):i.clear())}getRenderContext(){return{page:this.pageId,id:this.pageRef,params:this.pageParams,actions:this.action.actionMap,datasets:this.datasets,data:this.data,...this.context}}renderSidebar(){if(lo.get(this).delete("sidebar"),this.hasDatasets()&&this.view.isDefined("sidebar")){let t=Date.now(),i=this.data,o=this.getRenderContext();return this.view.setViewRoot(this.dom.sidebar,"sidebar",{data:i,context:o}),this.dom.sidebar.innerHTML="",this.view.render(this.dom.sidebar,"sidebar",i,o).then(()=>console.log(`[Discovery] Sidebar rendered in ${Date.now()-t}ms`))}}encodePageHash(t,i,o){let c=Sy(this,t,"encodeParams",Q3)(o||{});return c&&typeof c!="string"&&(Array.isArray(c)||(c=Object.entries(c)),c=c.map(f=>f.map(encodeURIComponent).join("=")).join("&")),`#${t!==this.defaultPageId?encodeURIComponent(t):""}${typeof i=="string"&&i||typeof i=="number"?":"+encodeURIComponent(i):""}${c?"&"+c:""}`}decodePageHash(t){let i=(t.indexOf("&")+1||t.length+1)-1,[o,u]=t.substring(t[0]==="#"?1:0,i).split(":").map(decodeURIComponent),c=Sy(this,o||this.defaultPageId,"decodeParams",Z3),f=t.substr(i+1).split("&").filter(Boolean).map(p=>{let m=p.indexOf("=");return m!==-1?[decodeURIComponent(p.slice(0,m)),decodeURIComponent(p.slice(m+1))]:[decodeURIComponent(p),!0]});return{pageId:o||this.defaultPageId,pageRef:u,pageParams:c(f)}}setPage(t,i,o,u=!1){return this.setPageHash(this.encodePageHash(t||this.defaultPageId,i,o),u)}setPageRef(t,i=!1){return this.setPage(this.pageId,t,this.pageParams,i)}setPageParams(t,i=!1){return this.setPage(this.pageId,this.pageRef,t,i)}setPageHash(t,i=!1){let{pageId:o,pageRef:u,pageParams:c}=this.decodePageHash(t);return(this.pageId!==o||this.pageRef!==u||!fs(this.pageParams,c))&&(this.pageId=o,this.pageRef=u,this.pageParams=c,this.scheduleRender("page"),t!==this.pageHash)?(this.pageHash=t,this.emit("pageHashChange",i),!0):!1}renderPage(){lo.get(this).delete("page");let t=this.data,i=this.getRenderContext(),{pageEl:o,renderState:u,config:c}=this.page.render(this.dom.pageContent,this.pageId,t,i);return this.view.setViewRoot(o,"Page: "+this.pageId,{config:c,data:t,context:i}),this.dom.pageContent=o,this.nav.render(this.dom.nav,t,i),ff(this.dom.container,"page",this.pageId),ff(this.dom.container,"dzen",!!this.pageParams.dzen),ff(this.dom.container,"compact",!!this.options.compact),u.then(()=>{if(this.pageParams["!anchor"]){let f=o.querySelector("#"+CSS.escape("!anchor:"+this.pageParams["!anchor"]));if(f){let p=o.querySelector(".view-page-header");f.style.scrollMargin=p?p.offsetHeight+"px":"",f.scrollIntoView(!0)}}}),u}};var df=Object.assign(Ty(),{setup:Ty}),Cy=n=>/^\./.test(n);function Ty(n){return n=n||!0,function(t){let i=n.accept?String(n.accept):"application/json,application/jsonxl,.json,.jsonxl",o=!!(n.dragdrop||n.dragdrop===void 0),u=i.split(",");o&&(t.dom.container.addEventListener("drop",c=>{t.loadDataFromEvent(c)},!0),t.dom.container.addEventListener("dragover",c=>{c.stopPropagation(),c.preventDefault()},!0)),t.preset.define("upload",[{view:"button-primary",onClick:"=#.actions.uploadFile",content:'text:`Open file ${#.actions.uploadFile.fileExtensions | $ ? "(" + join(", ") + ")" : ""}`'},{view:"context",when:"#.actions.uploadFile.dragdrop",content:['html:"<span style=\\"color: #888; padding: 0 1ex\\"> or </span>"','text:"drop a file on the page"']}]),t.action.define("unloadData",()=>{t.unloadData()}),t.action.define("uploadFile",Object.assign(()=>{V("input",{type:"file",accept:i,onchange:c=>t.loadDataFromEvent(c)}).click()},{fileExtensions:u.filter(c=>Cy(c)),mimeTypes:u.filter(c=>!Cy(c)),dragdrop:o}))}}function pf(){return[parseInt(performance.timeOrigin,10).toString(16),parseInt(1e4*performance.now(),10).toString(16),String(Math.random().toString(16).slice(2))].join("-")}var xf={};Ke(xf,{dataFromStream:()=>eb,dataSource:()=>C4,extractResourceMetadata:()=>wf,getReadableStreamFromSource:()=>z4,loadDataFromEvent:()=>cl,loadDataFromFile:()=>Es,loadDataFromPush:()=>dl,loadDataFromStream:()=>po,loadDataFromUrl:()=>fl,syncLoaderWithProgressbar:()=>bf});var Xy=Bn(Bu(),1);var hf=typeof new Blob().stream=="function"?n=>n.stream():e4();function e4(){try{return new ReadableStream({type:"bytes"}),t4}catch{try{return new ReadableStream({}),n4}catch{try{return new Response(new Blob).body.getReader(),r4}catch{}}}return i4}function Ly(n){return typeof n.arrayBuffer=="function"?n.arrayBuffer():new Promise((t,i)=>{let o=new FileReader;o.readAsArrayBuffer(n),o.onload=o.onerror=({type:u})=>{o.onload=o.onerror=null,u==="load"?t(o.result||o):i(new Error("Failed to read the blob/file"))}})}function t4(n){let t=0;return new ReadableStream({type:"bytes",autoAllocateChunkSize:512*1024,pull(i){let o=i.byobRequest.view,u=n.slice(t,t+o.byteLength);return Ly(u).then(c=>{let f=new Uint8Array(c),p=f.byteLength;t+=p,o.set(f),i.byobRequest.respond(p),t>=n.size&&i.close()})}})}function n4(n){let t=0;return new ReadableStream({pull(i){let o=n.slice(t,t+524288);return Ly(o).then(u=>{t+=u.byteLength,i.enqueue(new Uint8Array(u)),t==n.size&&i.close()})}})}function r4(n){return new Response(n).body}function i4(){throw new Error("Blob#stream() is not supported and no fallback can be applied, include https://github.com/MattiasBuelens/web-streams-polyfill")}var o4=new Uint8Array([0,0,74,83,79,78,88,76]),Ey=9,s4=268435455,a4=4294967295,Py=1<<0,sl=1<<1,co=1<<2,Ls=1<<3,fo=1<<4,al=1<<5,ll=1<<6,vi=1<<7,Dy=0,Iy=1,_y=2,Ry=3,jy=4,zy=5,Fy=6,l4=7,Hy=8,By=9,Wy=10,$y=11,qy=12,u4=31,HE=~u4,Uy=224,BE=~Uy,Vy=7936,WE=~Vy,Gy=0,mf=1,c4=2,f4=3,d4=4,p4=5,Yy=6,Ky=7,h4=8,My=16,Ay=32,$E=~fo,Oy=sl|al|ll,g4=new Uint8Array(256),Jy=new Uint8Array(8).map((n,t)=>(g4[1<<t]=t,1<<t)),Qy=new Uint8Array(256).map((n,t)=>{for(let i=0;i<8;i++)n+=t>>i&1;return n}),qE=Object.fromEntries(Object.entries({TYPE_UNDEF:Py,TYPE_TRUE:al,TYPE_FALSE:ll,TYPE_NULL:sl,TYPE_NUMBER:co,TYPE_STRING:Ls,TYPE_OBJECT:fo,TYPE_ARRAY:vi}).map(([n,t])=>[t,n])),UE=Object.fromEntries(Object.entries({UINT_8:Dy,UINT_16:Iy,UINT_24:_y,UINT_32:Ry,UINT_32_VAR:jy,INT_8:Hy,INT_16:By,INT_24:Wy,INT_32:$y,INT_32_VAR:qy,FLOAT_32:zy,FLOAT_64:Fy,DECIMAL:l4}).map(([n,t])=>[t,n])),gf=new Uint8Array(32),m4=class{constructor(n){this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.bytes=n,this.pos=0}readBytes(n){return this.bytes.subarray(this.pos,this.pos+=n)}readTypeIndex(n,t,i){let o=0,u=0;for(;t>0;)t&1&&(gf[o++]=u),u++,t>>=1;let c=new Uint8Array(n),f=32-Math.clz32(o-1),p=(1<<f)-1,m=this.readBytes(Math.ceil(f*n/8)),y=0,x=0,S=0;for(let k=0;k<n;k++)x<f&&(S|=m[y]<<x,x+=8,y++),c[k]=i?Jy[gf[S&p]]:gf[S&p],S>>=f,x-=f;return c}readVlq(){let n=this.view.getUint8(this.pos);if(!(n&1))n=n>>1,this.pos+=1;else if(!(n&2))n=this.view.getUint8(this.pos+1)<<6|n>>2,this.pos+=2;else if(!(n&4))n=this.view.getUint16(this.pos+1,!0)<<5|n>>3,this.pos+=3;else{let t=this.view.getUint32(this.pos,!0);n=t>>>3&s4,this.pos+=4,t>>>31&&(n+=this.readUintVar()*(1<<28))}return n}readUintVar(){let n=this.view.getUint8(this.pos++),t=n&127,i=128;for(;n&128;)n=this.view.getUint8(this.pos++),t+=(n&127)*i,i*=128;return t}readIntVar(){let n=this.readUintVar();return n&1?-(n-1)/2:n<=a4?n>>>1:n/2}readUint8(){let n=this.view.getUint8(this.pos);return this.pos++,n}readInt8(){let n=this.view.getInt8(this.pos);return this.pos++,n}readUint16(){let n=this.view.getUint16(this.pos,!0);return this.pos+=2,n}readInt16(){let n=this.view.getInt16(this.pos,!0);return this.pos+=2,n}readUint24(){let n=this.view.getUint16(this.pos,!0)|this.view.getUint8(this.pos+2)<<16;return this.pos+=3,n}readInt24(){let n=this.view.getUint16(this.pos,!0),t=this.view.getUint8(this.pos+2),i=t&128?-(16777215-(n|t<<16)+1):n|t<<16;return this.pos+=3,i}readUint32(){let n=this.view.getUint32(this.pos,!0);return this.pos+=4,n}readInt32(){let n=this.view.getInt32(this.pos,!0);return this.pos+=4,n}readFloat32(){let n=this.view.getFloat32(this.pos);return this.pos+=4,n}readFloat64(){let n=this.view.getFloat64(this.pos);return this.pos+=8,n}};function vf(n,t){switch(t){case Dy:return n.readUint8();case Iy:return n.readUint16();case _y:return n.readUint24();case Ry:return n.readUint32();case jy:return n.readUintVar();case Hy:return n.readInt8();case By:return n.readInt16();case Wy:return n.readInt24();case $y:return n.readInt32();case qy:return n.readIntVar();case zy:return n.readFloat32();case Fy:return n.readFloat64()}}function v4(n){let t=n.readUint8();switch(t&15){case Gy:case mf:case Yy:case Ky:t|=n.readUint8()<<8;break}return t}function gr(n,t=n.readVlq()){let i=v4(n);return yf(n,i,t)}function yf(n,t,i,o=new Array(i)){let u=t&15,c=t&48,f=i,p=0,m=0;switch(c){case My:{p=o[0]=n.readIntVar(),f--,m=1;break}case Ay:{p=n.readIntVar();break}}switch(u){case c4:{for(let y=0;y<f;y++)o[m+y]=n.readVlq();break}case f4:{for(let y=0;y<f;y++)o[m+y]=n.readIntVar();break}case d4:{let y=n.readBytes(Math.ceil(f/2));for(let x=0,S=0;x<f;x++)S=x&1?S>>4:y[x>>1],o[m+x]=S&8?n.readVlq()*8+(S&7):S&7;break}case p4:{let y=n.readBytes(Math.ceil(f/2));for(let x=0,S=0;x<f;x++){S=x&1?S>>4:y[x>>1];let k=S&4?-1:1;o[m+x]=S&8?k*(n.readVlq()*4+(S&3)):k*(S&3)}break}case Yy:{let y=t>>8,x=(1<<y)-1,S=n.readBytes(Math.ceil(f*y/8)),k=0,T=0,O=0;for(let E=0;E<f;E++){for(;T<y;)O|=S[k]<<T,T+=8,k++;o[m+E]=O&x,O>>=y,T-=y}break}case Ky:{let y=t>>8,x=(1<<y)-1,S=n.readBytes(Math.ceil(f*y/8)),k=0,T=0,O=0;for(let E=0;E<f;E++){for(;T<y;)O|=S[k]<<T,T+=8,k++;o[m+E]=O&1?-((O&x)>>1):(O&x)>>1,O>>=y,T-=y}break}case h4:{let y=o[0]=n.readIntVar(),x=n.readIntVar();for(let S=1;S<i;S++)y=o[S]=y+x;break}case Gy:case mf:{let y=u===mf,x=t>>8,S=y?t&Vy|x&Uy:x;if(Qy[x]>1){let k=n.readTypeIndex(f,S);for(let T=0;T<f;T++)o[m+T]=vf(n,k[T])}else{let k=31-Math.clz32(S);for(let T=0;T<f;T++)o[m+T]=vf(n,k)}break}default:throw new Error(`Unknown numeric array encoding method: ${u}`)}switch(c){case My:{o[0]=p;for(let y=1;y<i;y++)o[y]+=o[y-1];break}case Ay:{for(let y=0;y<i;y++)o[y]+=p;break}}return o}var y4=new TextDecoder("utf8",{ignoreBOM:!0});function b4(n){if(n.readBytes(8).some((o,u)=>o!==o4[u]))throw new Error("Bad magic number");let t=n.readUint16();if(t!==Ey)throw new Error(`Unsupported jsonxl version "${t}", expected "${Ey}"`);let i=n.readUint16();return{version:t,flags:i}}function w4(n){let t=y4.decode(n.readBytes(n.readVlq())),i=gr(n),o=gr(n),u=gr(n),c=gr(n),f=new Array(i),p=0;for(let m=0,y=0,x=0,S=0,k="";m<i.length;m++){let T=i[m],O=t.slice(y,y+=T>>2);T&2&&(O=k.slice(0,o[x++])+O),T&1&&(O=O+k.slice(-u[S++])),f[m]=O,k=O}return{readStrings(m,y){return c.slice(m,y).map(x=>f[x])},readString(){return f[c[p++]]}}}function x4(n){let t=gr(n),i=0;return function(){return t[i++]}}function k4(n){let t=gr(n),i=gr(n),o=0;return function(){return t[i[o++]]}}function S4(n,t){let i=n.readVlq(),o=n.readVlq();if(i===0)return()=>null;let u=o?t(-o):[],c=new Array(i);for(let f=0;f<i;f++)c[f]={dict:gr(n),refs:gr(n),index:0};return function(f){let p=c[f],m=p.refs[p.index++],y=p.dict[m];return y===0?null:{key:u[y>>8],type:y&255}}}function Ny(n,t){let i=0;for(let o=0;o<n.length;o++)n[o]===t&&i++;return i}function Zy(n){function t(k={}){let T=0,O;for(;O=x(T++);)k[O.key]=u(O.type);return k}function i(k=m()){if(k===0)return[];let T=y(),O=T>>16,E=T&65535,M=O&1,_=O>>5&1,C=O>>9&1,I=O>>1&255|(O&1)<<4,N=new Array(k),R=Qy[I]>1?c.readTypeIndex(k,I,!0):null;if(I&Oy)if(R===null)N.fill(o(I));else for(let j=0;j<k;j++)R[j]&Oy&&(N[j]=o(R[j]));if(I&Ls)for(let j=0;j<k;j++)(R===null||R[j]===Ls)&&(N[j]=p());if(I&co)if(I===co)yf(c,E,k,N);else{let j=Ny(R,co),F=yf(c,E,j);for(let q=0,H=0;q<k;q++)R[q]===co&&(N[q]=F[H++])}if(I&vi)if(C){let j=I===vi?k:Ny(R,vi),F=gr(c,j),q=i();for(let H=0,te=0,W=0;H<k;H++)(R===null||R[H]===vi)&&(N[H]=q.slice(W,W+=F[te++]))}else for(let j=0;j<k;j++)(R===null||R[j]===vi)&&(N[j]=i());if(I&fo){let j=I===fo?N:[];for(let F=0,q=0;F<k;F++)(R===null||R[F]===fo)&&(N[F]=j[q++]={});if(_){let F=c.readVlq(),q=new Array(F);for(let H=0;H<F;H++)q[H]=p();for(let H=0;H<F;H++){let te=q[H],W=i(j.length);for(let U=0;U<j.length;U++)W[U]!==void 0&&(j[U][te]=W[U])}}if(M)for(let F=0;F<j.length;F++)t(j[F])}return N}function o(k){switch(k){default:return;case sl:return null;case Ls:return p();case al:return!0;case ll:return!1}}function u(k){switch(Jy[k&7]){case Py:return;case sl:return null;case Ls:return p();case co:return vf(c,k>>3);case fo:return t();case al:return!0;case ll:return!1;case vi:return i()}}let c=new m4(n);b4(c);let{readStrings:f,readString:p}=w4(c),m=x4(c),y=k4(c),x=S4(c,f),S=u(c.readUint8());if(c.pos!==n.byteLength)throw new Error("End of input not reached");return S}var C4={stream:po,event:cl,file:Es,url:fl,push:dl};function T4(n){return n!==null&&typeof n=="object"}function L4(n){try{return new URL(n,location.origin).origin===location.origin}catch{return!1}}function E4(n){return n.ok}function M4(n){return n.headers.get("x-file-encoded-size")||n.headers.get("content-length")}function A4(n){return n.headers.get("x-file-size")||(L4(n.url)&&!n.headers.get("content-encoding")?n.headers.get("content-length"):void 0)}function O4(n){return n.headers.get("x-file-created-at")||n.headers.get("last-modified")}function N4(n){let t=n?Object.keys(n):[],i=["name","createdAt","elapsedTime","data"];return!(t.length!==4||t.some(o=>!i.includes(o)))}function P4(n,t,i,{encoding:o,size:u}){if(N4(n)){let{data:E,...M}=n;n=E,t={...t,createdAt:E.createdAt},i=M}let c=n,f=i||{},{type:p,name:m,encoding:y,size:x,encodedSize:S,createdAt:k,...T}=t;return{resource:{type:p||"unknown",name:m||"unknown",encoding:o,size:u,...S?{encodedSize:S}:null,createdAt:new Date(Date.parse(k)||Date.now()),...T},meta:f,data:c}}var D4=[0,0,74,83,79,78,88,76];function I4(n){return D4.every((t,i)=>t===n[i])}async function _4(n){let t=[],i=0;for await(let c of n)t.push(c),i+=c.byteLength;let o=new Uint8Array(i),u=0;for(let c of t)o.set(c,u),u+=c.length;return Zy(o)}function eb(n,t,i){let u=n.getReader(),c=Date.now(),f="json",p=0;return u.read().then(m=>{let y=async function*(){try{for(;;){let{done:x,value:S}=m||await u.read();if(m=void 0,x){await i({done:!0,elapsed:Date.now()-c,units:"bytes",completed:p,total:t});break}for(let k=0;k<S.length;k+=1048576){let T=k===0&&S.length-k<1048576?S:S.slice(k,k+1048576);p+=T.length,yield T,await i({done:!1,elapsed:Date.now()-c,units:"bytes",completed:p,total:t})}}}finally{u.releaseLock()}};return I4(m.value)?(f="jsonxl/snapshot9",_4(y())):(0,Xy.default)(y)}).then(m=>({data:m,encoding:f,size:p}))}async function R4(n,t){let i=async(o,u)=>(await t.asyncSet({stage:o}),await u());try{let o=new Date,{method:u,stream:c,resource:f,options:p,data:m}=await i("request",n),y=new Date,x=f?.size,{validateData:S}=p||{},{data:k,encoding:T,size:O}=m?{data:m}:await i("receive",()=>eb(c,Number(x)||0,R=>t.asyncSet({stage:"receive",progress:R}))),E=new Date;typeof S=="function"&&S(C);let M=new Date;await t.asyncSet({stage:"received"});let _=new Date,{data:C,resource:I,meta:N}=P4(k,f,null,{size:O,encoding:T});return{loadMethod:u,resource:I,meta:N,data:C,timing:{time:_-o,start:o,end:_,requestTime:y-o,requestStart:o,requestEnd:y,responseTime:E-y,responseStart:y,responseEnd:E,validateTime:M-E,validationStart:E,validationEnd:M}}}catch(o){throw console.error("[Discovery] Error loading data:",o),await t.asyncSet({stage:"error",error:o}),o}}function ul(n,t){let i=new wn;return{state:i,result:R4(n,i),...t}}function po(n,t){return ul(()=>({method:"stream",stream:n,resource:t?.resource,options:t}))}function Es(n,t){let i=wf(n);return ul(()=>({method:"file",stream:hf(n),resource:t?.resource||i,options:t}),{title:"Load data from file: "+(i.name||"unknown")})}function cl(n,t){let i=n.dataTransfer||n.target,o=i&&i.files&&i.files[0];if(n.stopPropagation(),n.preventDefault(),!o)throw new Error("Can't extract a file from an event object");return Es(o,t)}function fl(n,t){return t=t||{},ul(async()=>{let i=await fetch(n,t.fetch),o=wf(i,t);if(o)return{method:"fetch",stream:i.body,resource:t.resource||o,options:t};let u=i.headers.get("content-type")||"",c=await i.text();if(u.toLowerCase().startsWith("application/json"))try{let f=JSON.parse(c);c=f.error||f}catch{}throw c=new Error(c),c.stack=null,c},{title:`Load data from url: ${n}`})}function dl(n){let t,i=new ReadableStream({start(f){t=f},cancel(){t=null}}),o,u,c=new Promise(f=>{o=p=>f({method:"push",stream:i,resource:(u=p)||n.resource,options:n})||(o=()=>{})});return n=n||{},ul(()=>c,{start(f){o(f)},push(f){o(),t.enqueue(f)},finish(f){t.close(),t=null,isFinite(f)&&u&&(u.encodedSize=Number(f))}})}function bf({result:n,state:t},i){return new Promise((o,u)=>{let c=t.subscribeSync(({stage:f,progress:p,error:m})=>{if(m){c(),u(m);return}return f==="received"&&(c(),o(n)),i.setState({stage:f,progress:p})})})}function wf(n,t){if(n instanceof Response){let i=t?.isResponseOk||E4,o=t?.getContentSize||A4,u=t?.getContentEncodedSize||M4,c=t?.getContentSize||O4;if(i(n))return{type:"url",name:n.url,size:Number(o(n))||null,encodedSize:Number(u(n)),createdAt:c(n)}}if(n instanceof File)return{type:"file",name:n.name,size:n.size,createdAt:n.lastModified};if(n instanceof Blob)return{size:n.size};if(ArrayBuffer.isView(n))return{size:n.byteLength};if(typeof n=="string")return{size:n.length}}function j4(n){if(typeof n=="string"||DataView.isView(n))return function*(){yield new TextEncoder().encode(n)};if(!(Array.isArray(n)&&n.some(t=>typeof t!="string"))&&T4(n)){if(Symbol.asyncIterator in n)return n[Symbol.asyncIterator];if(Symbol.iterator in n)return n[Symbol.iterator]}}function z4(n){return n instanceof ReadableStream?n:n instanceof Response?n.body:n instanceof Blob?hf(n):new ReadableStream({start(){let t=j4(n);if(!t)throw new Error("Bad value type (can't convert to a generator)");this.iterator=t()},async pull(t){let{value:i,done:o}=await this.iterator.next();o?(this.iterator=null,t.close()):t.enqueue(i)},cancel(){this.iterator=null}})}var Ms=Object.assign(ib(),{setup:ib}),tb=()=>{},nb=["primary","secondary","menu"],F4=new Map([["insert",0],["prepend",0],["append",0],["before",1],["after",1],["replace",1],["remove"]]);function rb({mode:n,value:t}){return n==="auto"?"auto":t?"dark":"light"}function ib(n){return n=n||{},function(t){let i=null,o=tb,u=()=>{i?.finish(),i=null},c=n.hostId||pf(),f=window.parent,p=new Map,m=(k,T=null)=>{f.postMessage({from:"discoveryjs-app",id:c,type:k,payload:T},"*")},y=k=>{o=()=>{k!==null&&(o=tb,k())}},x=k=>{(typeof t.trackLoadDataProgress=="function"?t.trackLoadDataProgress(k):k.result.then(O=>t.setData(O.data,null,{dataset:O}))).catch(()=>{})},S=k=>{let{id:T,type:O,payload:E}=k.data||{};if(T===c)switch(O){case"defineAction":{let M=E;t.action.define(M,(..._)=>new Promise((C,I)=>{let N=pf();p.set(N,{resolve:C,reject:I}),setTimeout(()=>{p.delete(N),I(new Error("Timeout"))},3e4),m("action",{callId:N,name:M,args:_})}));break}case"actionResult":{let{callId:M,value:_,error:C}=E;if(!p.has(M)){console.error(`[Discovery.js] Unknown action call id "${M}"`);break}let{resolve:I,reject:N}=p.get(M);C?N(C):I(_);break}case"setPageHash":{let{replace:M,hash:_}=E||{};t.setPageHash(_||"",M||!1);break}case"setPage":{let{replace:M,id:_,ref:C,params:I}=E||{};t.setPage(_,C,I,M);break}case"setPageRef":{let{replace:M,ref:_}=E||{};t.setPageRef(_,M);break}case"setPageParams":{let{replace:M,params:_}=E||{};t.setPageParams(_,M);break}case"setDarkmode":{let M=E,_=["auto","light","dark"];if(!_.includes(M)){console.warn(`[Discovery.js] Wrong value for darkmode "${M}", supported values: ${_.map(C=>JSON.stringify(C)).join(", ")}`);break}t.darkmode.set(M==="auto"?"auto":M==="dark");break}case"setRouterPreventLocationUpdate":{t.routerPreventLocationUpdate=!!E;break}case"changeNavButtons":{let{section:M="primary",action:_="append",name:C,position:I,commands:N,config:R}=E||{};if(!nb.includes(M)){console.warn(`[Discovery.js] Wrong value for nav button place "${M}", supported values: ${nb.map(q=>JSON.stringify(q)).join(", ")}`);break}let j=N||{},F=JSON.parse(JSON.stringify(R),(q,H)=>j.includes(H)?()=>m("navMethod",H):H);switch(_){case"insert":t.nav[M].insert(F,I,C);break;case"prepend":case"append":t.nav[M][_](F);break;case"before":case"after":case"replace":t.nav[M][_](C,F);break;case"remove":t.nav[M].remove(C);break;default:console.warn(`[Discovery.js] Wrong value for nav button action "${_}", supported values: ${F4.map(q=>JSON.stringify(q)).join(", ")}`)}break}case"unloadData":{u(),t.unloadData();break}case"dataStream":{let{stream:M,resource:_}=E;u(),x(po(M,{resource:_}));break}case"startChunkedDataUpload":{let{acceptToken:M,resource:_}=E;u(),i=Object.assign(dl({resource:_}),{acceptToken:M}),x(i);break}case"cancelChunkedDataUpload":{let{acceptToken:M,error:_}=E;i?.acceptToken===M&&u(_)}case"dataChunk":{let{acceptToken:M,value:_,done:C}=E;if(i===null){console.warn("[Discovery.js] Loading data is not inited");break}if(i.acceptToken!==M){console.warn("[Discovery.js] Bad accept token");break}_&&i.push(_),C&&u();break}default:console.warn(`[Discovery.js] Got a post-message addressed to discovery app but with unknown "${O}" type`)}};f!==window&&(t.on("pageHashChange",k=>m("pageHashChanged",{replace:k,hash:t.pageHash||"#",id:t.pageId,ref:t.pageRef,params:t.pageParams})),t.on("startLoadData",k=>{o(),y(k(T=>m("loadingState",T)))}),t.on("startSetData",k=>{o(),y(k(T=>m("loadingState",T)))}),t.on("unloadData",()=>{o(),m("unloadData")}),t.on("data",()=>{m("data")}),t.darkmode.subscribe((k,T)=>m("darkmodeChanged",{mode:T,value:rb({mode:T,value:k})})),n.postponeMessages&&Promise.resolve().then(()=>{for(let k of n.postponeMessages)S({data:k})}),addEventListener("message",S,!1),addEventListener("unload",()=>m("destroy"),!1),m("ready",{page:{hash:t.pageHash||"#",id:t.pageId,ref:t.pageRef,params:t.pageParams},darkmode:{mode:t.darkmode.mode,value:rb(t.darkmode)}}))}}function kf(n){n.setPageHash(location.hash),n.cancelScheduledRender(),n.action.define("permalink",t=>new URL(t,location).href),window.addEventListener("hashchange",()=>n.setPageHash(location.hash),!1),n.on("pageHashChange",function(t){let i=n.pageHash||"#";n.routerPreventLocationUpdate||i==="#"&&!location.hash||(t?location.replace(i):location.hash=i)})}var Sf={request:{value:0,title:"Awaiting data"},receive:{value:.1,title:"Receiving data"},received:{value:.9,title:"Await app ready"},prepare:{value:.925,title:"Processing data (prepare)"},initui:{value:.975,title:"Rendering UI"},done:{value:1,title:"Done!"}};Object.values(Sf).forEach((n,t,i)=>{n.duration=(t!==i.length-1?i[t+1].value:0)-n.value});var ob=n=>n|0,sb=n=>typeof n=="function"?n:()=>{},H4=async()=>{if(await new Promise(n=>setTimeout(n,1)),!document.hidden)return Promise.race([new Promise(requestAnimationFrame),new Promise(n=>setTimeout(n,8))])};function B4(n,t){let{value:i,title:o,duration:u}=Sf[n],c=0,f=null;if(t){let{done:p,elapsed:m,units:y,completed:x,total:S}=t;S?(c=p?1:x/S,f=y==="bytes"?Math.round(c*100)+"%":`${x}/${S}`):(c=p?1:.1+Math.min(.9,m/2e4),f=y==="bytes"?(x/(1024*1024)).toFixed(1)+"MB":x)}return{stageTitle:o,progressValue:i+c*u,progressText:f,title:f?`${o} (${f})...`:n!=="done"?`${o}...`:o}}var yi=class extends wn{constructor({onTiming:t,onFinish:i,delay:o,domReady:u}){super({stage:null,progress:null,error:null}),this.finished=!1,this.awaitRepaint=null,this.lastStage="created",this.lastStageStart=null,this.timings=[],this.onTiming=sb(t),this.onFinish=sb(i),this.appearanceDelay=o===!0?200:Number(o)||0,this.domReady=u||Promise.resolve(),this.el=V("div","view-progress init",[V("div","title"),V("div","progress")])}recordTiming(t,i,o=performance.now()){let u={stage:t,title:Sf[t].title,duration:ob(o-i)};this.timings.push(u),this.onTiming(u)}async setState(t){let{stage:i,progress:o,error:u}=t;if(this.finished)return;if(u){this.set("stage"in t?{stage:i,progress:o,error:u}:{...this.value,error:u});return}this.set(t);let c=i!==this.lastStage,f=performance.now();this.lastStage==="created"&&(this.startTime=f,this.domReady.then(()=>{let y=Math.max(0,this.appearanceDelay-ob(performance.now()-f));y&&this.el.style.setProperty("--appearance-delay",`${y}ms`),getComputedStyle(this.el).opacity,this.el.classList.remove("init")})),c&&(this.lastStageStart!==null&&this.recordTiming(this.lastStage,this.lastStageStart,f),this.lastStage=i,this.lastStageStart=f,this.awaitRepaint=f);let{title:p,progressValue:m}=B4(i,o);this.el.querySelector(".title").textContent=p,this.el.style.setProperty("--progress",m),(c||f-this.awaitRepaint>65&&f-this.lastStageStart>200)&&(await H4(),this.awaitRepaint=performance.now())}finish(){this.finished||(this.finished=!0,this.lastStageStart!==null&&this.recordTiming(this.lastStage,this.lastStageStart),this.recordTiming("done",this.startTime),this.onFinish(this.timings),this.set({stage:"done"}))}dispose(){this.finish(),this.el.remove()}};var ho=(n,t)=>n!==void 0?n:t,go=class extends uo{constructor(t={}){let i=t.extensions?[t.extensions]:[];i.push(Nv),ho(t.router,!0)&&i.push(kf),t.mode!=="modelfree"&&(i.push(Mv),i.push(Av)),ho(t.upload,!1)&&(i.push(df.setup(t.upload)),i.push(Ov)),ho(t.embed,!1)&&i.push(Ms),ho(t.inspector,!0)&&i.push(Pv),super({container:document.body,...t,extensions:i,darkmode:ho(t.darkmode,"auto"),darkmodePersistent:ho(t.darkmodePersistent,!0)}),this.mode=this.options.mode}setLoadingState(t,{error:i,progressbar:o}={}){let u=this.dom.loadingOverlay;switch(t){case"init":{if(u.classList.remove("error","done"),o.el.parentNode)return;u.innerHTML="",u.append(o.el),u.classList.add("init"),requestAnimationFrame(()=>u.classList.remove("init"));break}case"success":{u.classList.add("done");break}case"error":{u.classList.add("error"),u.innerHTML="",this.view.render(u,[{view:"block",className:"action-buttons",content:[{view:"preset/upload",when:this.preset.isDefined("upload")}]},i.renderContent||{view:"alert-danger",content:[{view:"h3",content:['badge:"Error"',"text:errorText"]},'text:"(see details in the console)"']}],{errorText:Mt(i.message||String(i)),errorStack:i.stack?Mt(i.stack).replace(/^Error:\s*(\S+Error:)/,"$1"):""},{actions:this.action.actionMap}).then(()=>{console.error(i),o?.setState({error:i})});break}}}async setDataProgress(t,i,o){let u=o?.dataset,c=o?.progressbar||this.progressbar({title:"Set data"});try{this.setLoadingState("init",{progressbar:c}),await super.setDataProgress(t,i,{dataset:u,progressbar:c}),this.setLoadingState("success")}catch(f){this.setLoadingState("error",{error:f,progressbar:c})}}progressbar(t){return new yi({delay:200,domReady:this.dom.ready,onFinish(i){console.groupCollapsed(`[Discovery] ${t.title||"Load data"} (${i[i.length-1].duration}ms)`);for(let o of i)console.log(`${o.title}: ${o.duration}ms`);console.groupEnd()},...t})}trackLoadDataProgress(t){let i=this.progressbar({title:t.title});return this.setLoadingState("init",{progressbar:i}),this.emit("startLoadData",i.subscribe.bind(i)),bf(t,i).then(o=>this.setDataProgress(o.data,null,{dataset:o,progressbar:i}),o=>this.setLoadingState("error",{error:o,progressbar:i})),t.result}loadDataFromStream(t,i){return this.trackLoadDataProgress(po(t,typeof i=="number"?{size:i}:i))}loadDataFromEvent(t,i){return this.options.mode==="modelfree"&&this.defaultPageId!==this.reportPageId&&(this._defaultPageId=this.defaultPageId,this.defaultPageId=this.reportPageId,this.setPageHash(this.pageHash,!0),this.cancelScheduledRender()),this.trackLoadDataProgress(cl(t,i))}loadDataFromFile(t,i){return this.trackLoadDataProgress(Es(t,i))}loadDataFromUrl(t,i){return this.trackLoadDataProgress(fl(t,i))}unloadData(){this.hasDatasets()&&this.options.mode==="modelfree"&&this._defaultPageId!==this.defaultPageId&&(this.defaultPageId=this._defaultPageId,this.setPageHash(this.pageHash,!0),this.cancelScheduledRender()),super.unloadData()}initDom(){super.initDom(),this.dom.container.append(this.dom.loadingOverlay=V("div","loading-overlay done"))}renderPage(){return document.title=this.getRenderContext().name||document.title,super.renderPage()}};var Tf={};Ke(Tf,{applyContainerStyles:()=>q4,rollbackContainerStyles:()=>U4});var W4={"font-family":"Tahoma, Verdana, Arial, sans-serif","font-size":"16px","line-height":"1.6","-webkit-text-size-adjust":"none","text-size-adjust":"none","background-color":"var(--discovery-background-color, white)",color:"var(--discovery-color, black)","transition-property":"background-color, color","transition-duration":".25s","transition-timing-function":"ease-in"},$4={"--discovery-background-color":"#242424","--discovery-color":"#cccccc"},Cf=new WeakSet,bi=new WeakMap;function ab(n,t,i){t in i||(i[t]=[n.style.getPropertyValue(t),n.style.getPropertyPriority(t)])}function q4(n,t){t=t||{},bi.has(n)||bi.set(n,Object.create(null));let i=Ev(t.darkmode,t.darkmodePersistent),o=bi.get(n);for(let[u,c]of Object.entries(W4))(Cf.has(n)||!/^transition/.test(u))&&(ab(n,u,o),n.style.setProperty(u,c));for(let[u,c]of Object.entries($4))ab(n,u,o),i?n.style.setProperty(u,c):n.style.removeProperty(u);return Cf.add(n),i}function U4(n){if(bi.has(n)){let t=bi.get(n);for(let[i,o]of Object.entries(t))n.style.setProperty(i,...o);bi.delete(bi),Cf.delete(n)}}var V4={...Tf,base64:Ma,...ju,copyText:kn,...xf,debounce:Tr,...lu,...cu,injectStyles:ys,...Wu,...yu,pattern:Ju,persistent:nc,...Eu,progressbar:yi,safeFilterRx:as,...ic};function DM(n,t,i,o){let u=n.model,c=new go({mode:n.mode,styles:n.styles,darkmode:u.darkmode,darkmodePersistent:u.darkmodePersistent,upload:u.upload,inspector:u.inspector,router:u.router,extensions:[...Lp,...u.embed?[Ms.setup(i)]:[],Tp]});n.mode==="multi"&&c.nav.menu.append({name:"switch-model",onClick:'=$handler:"openModelIndex".actionHandler(href); $hide: #.hide; $handler and => $hide() or $handler()',data:{text:"Switch model",href:n.indexUrl}});let f={model:u};return o?c.setDataProgress(o.data,f,{progressbar:t,dataset:o}):(c.context=f,c.renderPage())}export{DM as default};
