var Vb=Object.create;var ll=Object.defineProperty;var Ub=Object.getOwnPropertyDescriptor;var $b=Object.getOwnPropertyNames;var Gb=Object.getPrototypeOf,Kb=Object.prototype.hasOwnProperty;var mt=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),Ae=(n,t)=>{for(var i in t)ll(n,i,{get:t[i],enumerable:!0})},Yb=(n,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of $b(t))!Kb.call(n,l)&&l!==i&&ll(n,l,{get:()=>t[l],enumerable:!(o=Ub(t,l))||o.enumerable});return n};var un=(n,t,i)=>(i=n!=null?Vb(Gb(n)):{},Yb(t||!n||!n.__esModule?ll(i,"default",{value:n,enumerable:!0}):i,n));var Sn=mt((qu,Wu)=>{(function(n,t){typeof qu=="object"&&typeof Wu<"u"?Wu.exports=t():typeof define=="function"&&define.amd?define(t):(n=n||self,n.CodeMirror=t())})(qu,function(){"use strict";var n=navigator.userAgent,t=navigator.platform,i=/gecko\/\d/i.test(n),o=/MSIE \d/.test(n),l=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(n),c=/Edge\/(\d+)/.exec(n),f=o||l||c,d=f&&(o?document.documentMode||6:+(c||l)[1]),g=!c&&/WebKit\//.test(n),y=g&&/Qt\/\d+\.\d+/.test(n),b=!c&&/Chrome\//.test(n),k=/Opera\//.test(n),C=/Apple Computer/.test(navigator.vendor),E=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(n),M=/PhantomJS/.test(n),O=C&&(/Mobile\/\w+/.test(n)||navigator.maxTouchPoints>2),L=/Android/.test(n),S=O||L||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(n),T=O||/Mac/.test(t),N=/\bCrOS\b/.test(n),A=/win/i.test(t),j=k&&n.match(/Version\/(\d*\.\d*)/);j&&(j=Number(j[1])),j&&j>=15&&(k=!1,g=!0);var I=T&&(y||k&&(j==null||j<12.11)),z=i||f&&d>=9;function W(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var H=function(e,r){var a=e.className,s=W(r).exec(a);if(s){var u=a.slice(s.index+s[0].length);e.className=a.slice(0,s.index)+(u?s[1]+u:"")}};function te(e){for(var r=e.childNodes.length;r>0;--r)e.removeChild(e.firstChild);return e}function _(e,r){return te(e).appendChild(r)}function $(e,r,a,s){var u=document.createElement(e);if(a&&(u.className=a),s&&(u.style.cssText=s),typeof r=="string")u.appendChild(document.createTextNode(r));else if(r)for(var p=0;p<r.length;++p)u.appendChild(r[p]);return u}function D(e,r,a,s){var u=$(e,r,a,s);return u.setAttribute("role","presentation"),u}var Q;document.createRange?Q=function(e,r,a,s){var u=document.createRange();return u.setEnd(s||e,a),u.setStart(e,r),u}:Q=function(e,r,a){var s=document.body.createTextRange();try{s.moveToElementText(e.parentNode)}catch{return s}return s.collapse(!0),s.moveEnd("character",a),s.moveStart("character",r),s};function X(e,r){if(r.nodeType==3&&(r=r.parentNode),e.contains)return e.contains(r);do if(r.nodeType==11&&(r=r.host),r==e)return!0;while(r=r.parentNode)}function de(){var e;try{e=document.activeElement}catch{e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function De(e,r){var a=e.className;W(r).test(a)||(e.className+=(a?" ":"")+r)}function Be(e,r){for(var a=e.split(" "),s=0;s<a.length;s++)a[s]&&!W(a[s]).test(r)&&(r+=" "+a[s]);return r}var Ke=function(e){e.select()};O?Ke=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:f&&(Ke=function(e){try{e.select()}catch{}});function Ot(e){var r=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,r)}}function Ue(e,r,a){r||(r={});for(var s in e)e.hasOwnProperty(s)&&(a!==!1||!r.hasOwnProperty(s))&&(r[s]=e[s]);return r}function Ye(e,r,a,s,u){r==null&&(r=e.search(/[^\s\u00a0]/),r==-1&&(r=e.length));for(var p=s||0,h=u||0;;){var m=e.indexOf("	",p);if(m<0||m>=r)return h+(r-p);h+=m-p,h+=a-h%a,p=m+1}}var Fe=function(){this.id=null,this.f=null,this.time=0,this.handler=Ot(this.onTimeout,this)};Fe.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},Fe.prototype.set=function(e,r){this.f=r;var a=+new Date+e;(!this.id||a<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=a)};function V(e,r){for(var a=0;a<e.length;++a)if(e[a]==r)return a;return-1}var ee=50,ie={toString:function(){return"CodeMirror.Pass"}},me={scroll:!1},ye={origin:"*mouse"},ae={origin:"+move"};function ke(e,r,a){for(var s=0,u=0;;){var p=e.indexOf("	",s);p==-1&&(p=e.length);var h=p-s;if(p==e.length||u+h>=r)return s+Math.min(h,r-u);if(u+=p-s,u+=a-u%a,s=p+1,u>=r)return s}}var Xe=[""];function _t(e){for(;Xe.length<=e;)Xe.push(Ee(Xe)+" ");return Xe[e]}function Ee(e){return e[e.length-1]}function Pe(e,r){for(var a=[],s=0;s<e.length;s++)a[s]=r(e[s],s);return a}function We(e,r,a){for(var s=0,u=a(r);s<e.length&&a(e[s])<=u;)s++;e.splice(s,0,r)}function qt(){}function Zt(e,r){var a;return Object.create?a=Object.create(e):(qt.prototype=e,a=new qt),r&&Ue(r,a),a}var Xn=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function He(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Xn.test(e))}function G(e,r){return r?r.source.indexOf("\\w")>-1&&He(e)?!0:r.test(e):He(e)}function se(e){for(var r in e)if(e.hasOwnProperty(r)&&e[r])return!1;return!0}var Y=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Oe(e){return e.charCodeAt(0)>=768&&Y.test(e)}function yt(e,r,a){for(;(a<0?r>0:r<e.length)&&Oe(e.charAt(r));)r+=a;return r}function gn(e,r,a){for(var s=r>a?-1:1;;){if(r==a)return r;var u=(r+a)/2,p=s<0?Math.ceil(u):Math.floor(u);if(p==r)return e(p)?r:a;e(p)?a=p:r=p+s}}function ga(e,r,a,s){if(!e)return s(r,a,"ltr",0);for(var u=!1,p=0;p<e.length;++p){var h=e[p];(h.from<a&&h.to>r||r==a&&h.to==r)&&(s(Math.max(h.from,r),Math.min(h.to,a),h.level==1?"rtl":"ltr",p),u=!0)}u||s(r,a,"ltr")}var Wt=null;function Qe(e,r,a){var s;Wt=null;for(var u=0;u<e.length;++u){var p=e[u];if(p.from<r&&p.to>r)return u;p.to==r&&(p.from!=p.to&&a=="before"?s=u:Wt=u),p.from==r&&(p.from!=p.to&&a!="before"?s=u:Wt=u)}return s??Wt}var er=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function a(w){return w<=247?e.charAt(w):1424<=w&&w<=1524?"R":1536<=w&&w<=1785?r.charAt(w-1536):1774<=w&&w<=2220?"r":8192<=w&&w<=8203?"w":w==8204?"b":"L"}var s=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,u=/[stwN]/,p=/[LRr]/,h=/[Lb1n]/,m=/[1n]/;function v(w,P,R){this.level=w,this.from=P,this.to=R}return function(w,P){var R=P=="ltr"?"L":"R";if(w.length==0||P=="ltr"&&!s.test(w))return!1;for(var q=w.length,F=[],K=0;K<q;++K)F.push(a(w.charCodeAt(K)));for(var Z=0,oe=R;Z<q;++Z){var le=F[Z];le=="m"?F[Z]=oe:oe=le}for(var ce=0,ue=R;ce<q;++ce){var pe=F[ce];pe=="1"&&ue=="r"?F[ce]="n":p.test(pe)&&(ue=pe,pe=="r"&&(F[ce]="R"))}for(var be=1,ve=F[0];be<q-1;++be){var Me=F[be];Me=="+"&&ve=="1"&&F[be+1]=="1"?F[be]="1":Me==","&&ve==F[be+1]&&(ve=="1"||ve=="n")&&(F[be]=ve),ve=Me}for(var _e=0;_e<q;++_e){var lt=F[_e];if(lt==",")F[_e]="N";else if(lt=="%"){var $e=void 0;for($e=_e+1;$e<q&&F[$e]=="%";++$e);for(var Rt=_e&&F[_e-1]=="!"||$e<q&&F[$e]=="1"?"1":"N",Et=_e;Et<$e;++Et)F[Et]=Rt;_e=$e-1}}for(var nt=0,Lt=R;nt<q;++nt){var ft=F[nt];Lt=="L"&&ft=="1"?F[nt]="L":p.test(ft)&&(Lt=ft)}for(var it=0;it<q;++it)if(u.test(F[it])){var rt=void 0;for(rt=it+1;rt<q&&u.test(F[rt]);++rt);for(var Ze=(it?F[it-1]:R)=="L",Mt=(rt<q?F[rt]:R)=="L",Zr=Ze==Mt?Ze?"L":"R":R,$n=it;$n<rt;++$n)F[$n]=Zr;it=rt-1}for(var gt=[],Cn,ut=0;ut<q;)if(h.test(F[ut])){var sl=ut;for(++ut;ut<q&&h.test(F[ut]);++ut);gt.push(new v(0,sl,ut))}else{var Pn=ut,fr=gt.length,dr=P=="rtl"?1:0;for(++ut;ut<q&&F[ut]!="L";++ut);for(var bt=Pn;bt<ut;)if(m.test(F[bt])){Pn<bt&&(gt.splice(fr,0,new v(1,Pn,bt)),fr+=dr);var Xr=bt;for(++bt;bt<ut&&m.test(F[bt]);++bt);gt.splice(fr,0,new v(2,Xr,bt)),fr+=dr,Pn=bt}else++bt;Pn<ut&&gt.splice(fr,0,new v(1,Pn,ut))}return P=="ltr"&&(gt[0].level==1&&(Cn=w.match(/^\s+/))&&(gt[0].from=Cn[0].length,gt.unshift(new v(0,0,Cn[0].length))),Ee(gt).level==1&&(Cn=w.match(/\s+$/))&&(Ee(gt).to-=Cn[0].length,gt.push(new v(0,q-Cn[0].length,q)))),P=="rtl"?gt.reverse():gt}}();function Pt(e,r){var a=e.order;return a==null&&(a=e.order=er(e.text,r)),a}var Tn=[],we=function(e,r,a){if(e.addEventListener)e.addEventListener(r,a,!1);else if(e.attachEvent)e.attachEvent("on"+r,a);else{var s=e._handlers||(e._handlers={});s[r]=(s[r]||Tn).concat(a)}};function Mr(e,r){return e._handlers&&e._handlers[r]||Tn}function Ct(e,r,a){if(e.removeEventListener)e.removeEventListener(r,a,!1);else if(e.detachEvent)e.detachEvent("on"+r,a);else{var s=e._handlers,u=s&&s[r];if(u){var p=V(u,a);p>-1&&(s[r]=u.slice(0,p).concat(u.slice(p+1)))}}}function Se(e,r){var a=Mr(e,r);if(a.length)for(var s=Array.prototype.slice.call(arguments,2),u=0;u<a.length;++u)a[u].apply(null,s)}function tt(e,r,a){return typeof r=="string"&&(r={type:r,preventDefault:function(){this.defaultPrevented=!0}}),Se(e,a||r.type,e,r),Vt(r)||r.codemirrorIgnore}function Dr(e){var r=e._handlers&&e._handlers.cursorActivity;if(r)for(var a=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),s=0;s<r.length;++s)V(a,r[s])==-1&&a.push(r[s])}function ct(e,r){return Mr(e,r).length>0}function mn(e){e.prototype.on=function(r,a){we(this,r,a)},e.prototype.off=function(r,a){Ct(this,r,a)}}function dt(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Or(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Vt(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function tr(e){dt(e),Or(e)}function Bn(e){return e.target||e.srcElement}function Fo(e){var r=e.which;return r==null&&(e.button&1?r=1:e.button&2?r=3:e.button&4&&(r=2)),T&&e.ctrlKey&&r==1&&(r=3),r}var xi=function(){if(f&&d<9)return!1;var e=$("div");return"draggable"in e||"dragDrop"in e}(),St;function Ho(e){if(St==null){var r=$("span","\u200B");_(e,$("span",[r,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(St=r.offsetWidth<=1&&r.offsetHeight>2&&!(f&&d<8))}var a=St?$("span","\u200B"):$("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px");return a.setAttribute("cm-text",""),a}var ki;function yn(e){if(ki!=null)return ki;var r=_(e,document.createTextNode("A\u062EA")),a=Q(r,0,1).getBoundingClientRect(),s=Q(r,1,2).getBoundingClientRect();return te(e),!a||a.left==a.right?!1:ki=s.right-a.right<3}var Ci=`

b`.split(/\n/).length!=3?function(e){for(var r=0,a=[],s=e.length;r<=s;){var u=e.indexOf(`
`,r);u==-1&&(u=e.length);var p=e.slice(r,e.charAt(u-1)=="\r"?u-1:u),h=p.indexOf("\r");h!=-1?(a.push(p.slice(0,h)),r+=h+1):(a.push(p),r=u+1)}return a}:function(e){return e.split(/\r\n?|\n/)},_o=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var r;try{r=e.ownerDocument.selection.createRange()}catch{}return!r||r.parentElement()!=e?!1:r.compareEndPoints("StartToEnd",r)!=0},qo=function(){var e=$("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Si=null;function jn(e){if(Si!=null)return Si;var r=_(e,$("span","x")),a=r.getBoundingClientRect(),s=Q(r,0,1).getBoundingClientRect();return Si=Math.abs(a.left-s.left)>1}var Xt={},Ut={};function Wo(e,r){arguments.length>2&&(r.dependencies=Array.prototype.slice.call(arguments,2)),Xt[e]=r}function An(e,r){Ut[e]=r}function Pr(e){if(typeof e=="string"&&Ut.hasOwnProperty(e))e=Ut[e];else if(e&&typeof e.name=="string"&&Ut.hasOwnProperty(e.name)){var r=Ut[e.name];typeof r=="string"&&(r={name:r}),e=Zt(r,e),e.name=r.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Pr("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Pr("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function Nr(e,r){r=Pr(r);var a=Xt[r.name];if(!a)return Nr(e,"text/plain");var s=a(e,r);if(nn.hasOwnProperty(r.name)){var u=nn[r.name];for(var p in u)u.hasOwnProperty(p)&&(s.hasOwnProperty(p)&&(s["_"+p]=s[p]),s[p]=u[p])}if(s.name=r.name,r.helperType&&(s.helperType=r.helperType),r.modeProps)for(var h in r.modeProps)s[h]=r.modeProps[h];return s}var nn={};function rn(e,r){var a=nn.hasOwnProperty(e)?nn[e]:nn[e]={};Ue(r,a)}function $t(e,r){if(r===!0)return r;if(e.copyState)return e.copyState(r);var a={};for(var s in r){var u=r[s];u instanceof Array&&(u=u.concat([])),a[s]=u}return a}function Ti(e,r){for(var a;e.innerMode&&(a=e.innerMode(r),!(!a||a.mode==e));)r=a.state,e=a.mode;return a||{mode:e,state:r}}function Ai(e,r,a){return e.startState?e.startState(r,a):!0}var Je=function(e,r,a){this.pos=this.start=0,this.string=e,this.tabSize=r||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=a};Je.prototype.eol=function(){return this.pos>=this.string.length},Je.prototype.sol=function(){return this.pos==this.lineStart},Je.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Je.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Je.prototype.eat=function(e){var r=this.string.charAt(this.pos),a;if(typeof e=="string"?a=r==e:a=r&&(e.test?e.test(r):e(r)),a)return++this.pos,r},Je.prototype.eatWhile=function(e){for(var r=this.pos;this.eat(e););return this.pos>r},Je.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Je.prototype.skipToEnd=function(){this.pos=this.string.length},Je.prototype.skipTo=function(e){var r=this.string.indexOf(e,this.pos);if(r>-1)return this.pos=r,!0},Je.prototype.backUp=function(e){this.pos-=e},Je.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ye(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ye(this.string,this.lineStart,this.tabSize):0)},Je.prototype.indentation=function(){return Ye(this.string,null,this.tabSize)-(this.lineStart?Ye(this.string,this.lineStart,this.tabSize):0)},Je.prototype.match=function(e,r,a){if(typeof e=="string"){var s=function(h){return a?h.toLowerCase():h},u=this.string.substr(this.pos,e.length);if(s(u)==s(e))return r!==!1&&(this.pos+=e.length),!0}else{var p=this.string.slice(this.pos).match(e);return p&&p.index>0?null:(p&&r!==!1&&(this.pos+=p[0].length),p)}},Je.prototype.current=function(){return this.string.slice(this.start,this.pos)},Je.prototype.hideFirstChars=function(e,r){this.lineStart+=e;try{return r()}finally{this.lineStart-=e}},Je.prototype.lookAhead=function(e){var r=this.lineOracle;return r&&r.lookAhead(e)},Je.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function he(e,r){if(r-=e.first,r<0||r>=e.size)throw new Error("There is no line "+(r+e.first)+" in the document.");for(var a=e;!a.lines;)for(var s=0;;++s){var u=a.children[s],p=u.chunkSize();if(r<p){a=u;break}r-=p}return a.lines[r]}function vn(e,r,a){var s=[],u=r.line;return e.iter(r.line,a.line+1,function(p){var h=p.text;u==a.line&&(h=h.slice(0,a.ch)),u==r.line&&(h=h.slice(r.ch)),s.push(h),++u}),s}function Ei(e,r,a){var s=[];return e.iter(r,a,function(u){s.push(u.text)}),s}function Nt(e,r){var a=r-e.height;if(a)for(var s=e;s;s=s.parent)s.height+=a}function Ie(e){if(e.parent==null)return null;for(var r=e.parent,a=V(r.lines,e),s=r.parent;s;r=s,s=s.parent)for(var u=0;s.children[u]!=r;++u)a+=s.children[u].chunkSize();return a+r.first}function bn(e,r){var a=e.first;e:do{for(var s=0;s<e.children.length;++s){var u=e.children[s],p=u.height;if(r<p){e=u;continue e}r-=p,a+=u.chunkSize()}return a}while(!e.lines);for(var h=0;h<e.lines.length;++h){var m=e.lines[h],v=m.height;if(r<v)break;r-=v}return a+h}function nr(e,r){return r>=e.first&&r<e.first+e.size}function Li(e,r){return String(e.lineNumberFormatter(r+e.firstLineNumber))}function ne(e,r,a){if(a===void 0&&(a=null),!(this instanceof ne))return new ne(e,r,a);this.line=e,this.ch=r,this.sticky=a}function x(e,r){return e.line-r.line||e.ch-r.ch}function B(e,r){return e.sticky==r.sticky&&x(e,r)==0}function J(e){return ne(e.line,e.ch)}function re(e,r){return x(e,r)<0?r:e}function Te(e,r){return x(e,r)<0?e:r}function Ne(e,r){return Math.max(e.first,Math.min(r,e.first+e.size-1))}function fe(e,r){if(r.line<e.first)return ne(e.first,0);var a=e.first+e.size-1;return r.line>a?ne(a,he(e,a).text.length):pt(r,he(e,r.line).text.length)}function pt(e,r){var a=e.ch;return a==null||a>r?ne(e.line,r):a<0?ne(e.line,0):e}function Gt(e,r){for(var a=[],s=0;s<r.length;s++)a[s]=fe(e,r[s]);return a}var Ir=function(e,r){this.state=e,this.lookAhead=r},wn=function(e,r,a,s){this.state=r,this.doc=e,this.line=a,this.maxLookAhead=s||0,this.baseTokens=null,this.baseTokenPos=1};wn.prototype.lookAhead=function(e){var r=this.doc.getLine(this.line+e);return r!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),r},wn.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var r=this.baseTokens[this.baseTokenPos+1];return{type:r&&r.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},wn.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},wn.fromSaved=function(e,r,a){return r instanceof Ir?new wn(e,$t(e.mode,r.state),a,r.lookAhead):new wn(e,$t(e.mode,r),a)},wn.prototype.save=function(e){var r=e!==!1?$t(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Ir(r,this.maxLookAhead):r};function Lc(e,r,a,s){var u=[e.state.modeGen],p={};Ic(e,r.text,e.doc.mode,a,function(w,P){return u.push(w,P)},p,s);for(var h=a.state,m=function(w){a.baseTokens=u;var P=e.state.overlays[w],R=1,q=0;a.state=!0,Ic(e,r.text,P.mode,a,function(F,K){for(var Z=R;q<F;){var oe=u[R];oe>F&&u.splice(R,1,F,u[R+1],oe),R+=2,q=Math.min(F,oe)}if(K)if(P.opaque)u.splice(Z,R-Z,F,"overlay "+K),R=Z+2;else for(;Z<R;Z+=2){var le=u[Z+1];u[Z+1]=(le?le+" ":"")+"overlay "+K}},p),a.state=h,a.baseTokens=null,a.baseTokenPos=1},v=0;v<e.state.overlays.length;++v)m(v);return{styles:u,classes:p.bgClass||p.textClass?p:null}}function Mc(e,r,a){if(!r.styles||r.styles[0]!=e.state.modeGen){var s=Mi(e,Ie(r)),u=r.text.length>e.options.maxHighlightLength&&$t(e.doc.mode,s.state),p=Lc(e,r,s);u&&(s.state=u),r.stateAfter=s.save(!u),r.styles=p.styles,p.classes?r.styleClasses=p.classes:r.styleClasses&&(r.styleClasses=null),a===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return r.styles}function Mi(e,r,a){var s=e.doc,u=e.display;if(!s.mode.startState)return new wn(s,!0,r);var p=$y(e,r,a),h=p>s.first&&he(s,p-1).stateAfter,m=h?wn.fromSaved(s,h,p):new wn(s,Ai(s.mode),p);return s.iter(p,r,function(v){ma(e,v.text,m);var w=m.line;v.stateAfter=w==r-1||w%5==0||w>=u.viewFrom&&w<u.viewTo?m.save():null,m.nextLine()}),a&&(s.modeFrontier=m.line),m}function ma(e,r,a,s){var u=e.doc.mode,p=new Je(r,e.options.tabSize,a);for(p.start=p.pos=s||0,r==""&&Dc(u,a.state);!p.eol();)ya(u,p,a.state),p.start=p.pos}function Dc(e,r){if(e.blankLine)return e.blankLine(r);if(e.innerMode){var a=Ti(e,r);if(a.mode.blankLine)return a.mode.blankLine(a.state)}}function ya(e,r,a,s){for(var u=0;u<10;u++){s&&(s[0]=Ti(e,a).mode);var p=e.token(r,a);if(r.pos>r.start)return p}throw new Error("Mode "+e.name+" failed to advance stream.")}var Oc=function(e,r,a){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=r||null,this.state=a};function Pc(e,r,a,s){var u=e.doc,p=u.mode,h;r=fe(u,r);var m=he(u,r.line),v=Mi(e,r.line,a),w=new Je(m.text,e.options.tabSize,v),P;for(s&&(P=[]);(s||w.pos<r.ch)&&!w.eol();)w.start=w.pos,h=ya(p,w,v.state),s&&P.push(new Oc(w,h,$t(u.mode,v.state)));return s?P:new Oc(w,h,v.state)}function Nc(e,r){if(e)for(;;){var a=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!a)break;e=e.slice(0,a.index)+e.slice(a.index+a[0].length);var s=a[1]?"bgClass":"textClass";r[s]==null?r[s]=a[2]:new RegExp("(?:^|\\s)"+a[2]+"(?:$|\\s)").test(r[s])||(r[s]+=" "+a[2])}return e}function Ic(e,r,a,s,u,p,h){var m=a.flattenSpans;m==null&&(m=e.options.flattenSpans);var v=0,w=null,P=new Je(r,e.options.tabSize,s),R,q=e.options.addModeClass&&[null];for(r==""&&Nc(Dc(a,s.state),p);!P.eol();){if(P.pos>e.options.maxHighlightLength?(m=!1,h&&ma(e,r,s,P.pos),P.pos=r.length,R=null):R=Nc(ya(a,P,s.state,q),p),q){var F=q[0].name;F&&(R="m-"+(R?F+" "+R:F))}if(!m||w!=R){for(;v<P.start;)v=Math.min(P.start,v+5e3),u(v,w);w=R}P.start=P.pos}for(;v<P.pos;){var K=Math.min(P.pos,v+5e3);u(K,w),v=K}}function $y(e,r,a){for(var s,u,p=e.doc,h=a?-1:r-(e.doc.mode.innerMode?1e3:100),m=r;m>h;--m){if(m<=p.first)return p.first;var v=he(p,m-1),w=v.stateAfter;if(w&&(!a||m+(w instanceof Ir?w.lookAhead:0)<=p.modeFrontier))return m;var P=Ye(v.text,null,e.options.tabSize);(u==null||s>P)&&(u=m-1,s=P)}return u}function Gy(e,r){if(e.modeFrontier=Math.min(e.modeFrontier,r),!(e.highlightFrontier<r-10)){for(var a=e.first,s=r-1;s>a;s--){var u=he(e,s).stateAfter;if(u&&(!(u instanceof Ir)||s+u.lookAhead<r)){a=s+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,a)}}var Rc=!1,En=!1;function Ky(){Rc=!0}function Yy(){En=!0}function Vo(e,r,a){this.marker=e,this.from=r,this.to=a}function Di(e,r){if(e)for(var a=0;a<e.length;++a){var s=e[a];if(s.marker==r)return s}}function Qy(e,r){for(var a,s=0;s<e.length;++s)e[s]!=r&&(a||(a=[])).push(e[s]);return a}function Jy(e,r,a){var s=a&&window.WeakSet&&(a.markedSpans||(a.markedSpans=new WeakSet));s&&s.has(e.markedSpans)?e.markedSpans.push(r):(e.markedSpans=e.markedSpans?e.markedSpans.concat([r]):[r],s&&s.add(e.markedSpans)),r.marker.attachLine(e)}function Zy(e,r,a){var s;if(e)for(var u=0;u<e.length;++u){var p=e[u],h=p.marker,m=p.from==null||(h.inclusiveLeft?p.from<=r:p.from<r);if(m||p.from==r&&h.type=="bookmark"&&(!a||!p.marker.insertLeft)){var v=p.to==null||(h.inclusiveRight?p.to>=r:p.to>r);(s||(s=[])).push(new Vo(h,p.from,v?null:p.to))}}return s}function Xy(e,r,a){var s;if(e)for(var u=0;u<e.length;++u){var p=e[u],h=p.marker,m=p.to==null||(h.inclusiveRight?p.to>=r:p.to>r);if(m||p.from==r&&h.type=="bookmark"&&(!a||p.marker.insertLeft)){var v=p.from==null||(h.inclusiveLeft?p.from<=r:p.from<r);(s||(s=[])).push(new Vo(h,v?null:p.from-r,p.to==null?null:p.to-r))}}return s}function va(e,r){if(r.full)return null;var a=nr(e,r.from.line)&&he(e,r.from.line).markedSpans,s=nr(e,r.to.line)&&he(e,r.to.line).markedSpans;if(!a&&!s)return null;var u=r.from.ch,p=r.to.ch,h=x(r.from,r.to)==0,m=Zy(a,u,h),v=Xy(s,p,h),w=r.text.length==1,P=Ee(r.text).length+(w?u:0);if(m)for(var R=0;R<m.length;++R){var q=m[R];if(q.to==null){var F=Di(v,q.marker);F?w&&(q.to=F.to==null?null:F.to+P):q.to=u}}if(v)for(var K=0;K<v.length;++K){var Z=v[K];if(Z.to!=null&&(Z.to+=P),Z.from==null){var oe=Di(m,Z.marker);oe||(Z.from=P,w&&(m||(m=[])).push(Z))}else Z.from+=P,w&&(m||(m=[])).push(Z)}m&&(m=Bc(m)),v&&v!=m&&(v=Bc(v));var le=[m];if(!w){var ce=r.text.length-2,ue;if(ce>0&&m)for(var pe=0;pe<m.length;++pe)m[pe].to==null&&(ue||(ue=[])).push(new Vo(m[pe].marker,null,null));for(var be=0;be<ce;++be)le.push(ue);le.push(v)}return le}function Bc(e){for(var r=0;r<e.length;++r){var a=e[r];a.from!=null&&a.from==a.to&&a.marker.clearWhenEmpty!==!1&&e.splice(r--,1)}return e.length?e:null}function ev(e,r,a){var s=null;if(e.iter(r.line,a.line+1,function(F){if(F.markedSpans)for(var K=0;K<F.markedSpans.length;++K){var Z=F.markedSpans[K].marker;Z.readOnly&&(!s||V(s,Z)==-1)&&(s||(s=[])).push(Z)}}),!s)return null;for(var u=[{from:r,to:a}],p=0;p<s.length;++p)for(var h=s[p],m=h.find(0),v=0;v<u.length;++v){var w=u[v];if(!(x(w.to,m.from)<0||x(w.from,m.to)>0)){var P=[v,1],R=x(w.from,m.from),q=x(w.to,m.to);(R<0||!h.inclusiveLeft&&!R)&&P.push({from:w.from,to:m.from}),(q>0||!h.inclusiveRight&&!q)&&P.push({from:m.to,to:w.to}),u.splice.apply(u,P),v+=P.length-3}}return u}function jc(e){var r=e.markedSpans;if(r){for(var a=0;a<r.length;++a)r[a].marker.detachLine(e);e.markedSpans=null}}function zc(e,r){if(r){for(var a=0;a<r.length;++a)r[a].marker.attachLine(e);e.markedSpans=r}}function Uo(e){return e.inclusiveLeft?-1:0}function $o(e){return e.inclusiveRight?1:0}function ba(e,r){var a=e.lines.length-r.lines.length;if(a!=0)return a;var s=e.find(),u=r.find(),p=x(s.from,u.from)||Uo(e)-Uo(r);if(p)return-p;var h=x(s.to,u.to)||$o(e)-$o(r);return h||r.id-e.id}function Fc(e,r){var a=En&&e.markedSpans,s;if(a)for(var u=void 0,p=0;p<a.length;++p)u=a[p],u.marker.collapsed&&(r?u.from:u.to)==null&&(!s||ba(s,u.marker)<0)&&(s=u.marker);return s}function Hc(e){return Fc(e,!0)}function Go(e){return Fc(e,!1)}function tv(e,r){var a=En&&e.markedSpans,s;if(a)for(var u=0;u<a.length;++u){var p=a[u];p.marker.collapsed&&(p.from==null||p.from<r)&&(p.to==null||p.to>r)&&(!s||ba(s,p.marker)<0)&&(s=p.marker)}return s}function _c(e,r,a,s,u){var p=he(e,r),h=En&&p.markedSpans;if(h)for(var m=0;m<h.length;++m){var v=h[m];if(v.marker.collapsed){var w=v.marker.find(0),P=x(w.from,a)||Uo(v.marker)-Uo(u),R=x(w.to,s)||$o(v.marker)-$o(u);if(!(P>=0&&R<=0||P<=0&&R>=0)&&(P<=0&&(v.marker.inclusiveRight&&u.inclusiveLeft?x(w.to,a)>=0:x(w.to,a)>0)||P>=0&&(v.marker.inclusiveRight&&u.inclusiveLeft?x(w.from,s)<=0:x(w.from,s)<0)))return!0}}}function on(e){for(var r;r=Hc(e);)e=r.find(-1,!0).line;return e}function nv(e){for(var r;r=Go(e);)e=r.find(1,!0).line;return e}function rv(e){for(var r,a;r=Go(e);)e=r.find(1,!0).line,(a||(a=[])).push(e);return a}function wa(e,r){var a=he(e,r),s=on(a);return a==s?r:Ie(s)}function qc(e,r){if(r>e.lastLine())return r;var a=he(e,r),s;if(!zn(e,a))return r;for(;s=Go(a);)a=s.find(1,!0).line;return Ie(a)+1}function zn(e,r){var a=En&&r.markedSpans;if(a){for(var s=void 0,u=0;u<a.length;++u)if(s=a[u],!!s.marker.collapsed){if(s.from==null)return!0;if(!s.marker.widgetNode&&s.from==0&&s.marker.inclusiveLeft&&xa(e,r,s))return!0}}}function xa(e,r,a){if(a.to==null){var s=a.marker.find(1,!0);return xa(e,s.line,Di(s.line.markedSpans,a.marker))}if(a.marker.inclusiveRight&&a.to==r.text.length)return!0;for(var u=void 0,p=0;p<r.markedSpans.length;++p)if(u=r.markedSpans[p],u.marker.collapsed&&!u.marker.widgetNode&&u.from==a.to&&(u.to==null||u.to!=a.from)&&(u.marker.inclusiveLeft||a.marker.inclusiveRight)&&xa(e,r,u))return!0}function Ln(e){e=on(e);for(var r=0,a=e.parent,s=0;s<a.lines.length;++s){var u=a.lines[s];if(u==e)break;r+=u.height}for(var p=a.parent;p;a=p,p=a.parent)for(var h=0;h<p.children.length;++h){var m=p.children[h];if(m==a)break;r+=m.height}return r}function Ko(e){if(e.height==0)return 0;for(var r=e.text.length,a,s=e;a=Hc(s);){var u=a.find(0,!0);s=u.from.line,r+=u.from.ch-u.to.ch}for(s=e;a=Go(s);){var p=a.find(0,!0);r-=s.text.length-p.from.ch,s=p.to.line,r+=s.text.length-p.to.ch}return r}function ka(e){var r=e.display,a=e.doc;r.maxLine=he(a,a.first),r.maxLineLength=Ko(r.maxLine),r.maxLineChanged=!0,a.iter(function(s){var u=Ko(s);u>r.maxLineLength&&(r.maxLineLength=u,r.maxLine=s)})}var Rr=function(e,r,a){this.text=e,zc(this,r),this.height=a?a(this):1};Rr.prototype.lineNo=function(){return Ie(this)},mn(Rr);function iv(e,r,a,s){e.text=r,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),jc(e),zc(e,a);var u=s?s(e):1;u!=e.height&&Nt(e,u)}function ov(e){e.parent=null,jc(e)}var sv={},av={};function Wc(e,r){if(!e||/^\s*$/.test(e))return null;var a=r.addModeClass?av:sv;return a[e]||(a[e]=e.replace(/\S+/g,"cm-$&"))}function Vc(e,r){var a=D("span",null,null,g?"padding-right: .1px":null),s={pre:D("pre",[a],"CodeMirror-line"),content:a,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};r.measure={};for(var u=0;u<=(r.rest?r.rest.length:0);u++){var p=u?r.rest[u-1]:r.line,h=void 0;s.pos=0,s.addToken=uv,yn(e.display.measure)&&(h=Pt(p,e.doc.direction))&&(s.addToken=fv(s.addToken,h)),s.map=[];var m=r!=e.display.externalMeasured&&Ie(p);dv(p,s,Mc(e,p,m)),p.styleClasses&&(p.styleClasses.bgClass&&(s.bgClass=Be(p.styleClasses.bgClass,s.bgClass||"")),p.styleClasses.textClass&&(s.textClass=Be(p.styleClasses.textClass,s.textClass||""))),s.map.length==0&&s.map.push(0,0,s.content.appendChild(Ho(e.display.measure))),u==0?(r.measure.map=s.map,r.measure.cache={}):((r.measure.maps||(r.measure.maps=[])).push(s.map),(r.measure.caches||(r.measure.caches=[])).push({}))}if(g){var v=s.content.lastChild;(/\bcm-tab\b/.test(v.className)||v.querySelector&&v.querySelector(".cm-tab"))&&(s.content.className="cm-tab-wrap-hack")}return Se(e,"renderLine",e,r.line,s.pre),s.pre.className&&(s.textClass=Be(s.pre.className,s.textClass||"")),s}function lv(e){var r=$("span","\u2022","cm-invalidchar");return r.title="\\u"+e.charCodeAt(0).toString(16),r.setAttribute("aria-label",r.title),r}function uv(e,r,a,s,u,p,h){if(r){var m=e.splitSpaces?cv(r,e.trailingSpace):r,v=e.cm.state.specialChars,w=!1,P;if(!v.test(r))e.col+=r.length,P=document.createTextNode(m),e.map.push(e.pos,e.pos+r.length,P),f&&d<9&&(w=!0),e.pos+=r.length;else{P=document.createDocumentFragment();for(var R=0;;){v.lastIndex=R;var q=v.exec(r),F=q?q.index-R:r.length-R;if(F){var K=document.createTextNode(m.slice(R,R+F));f&&d<9?P.appendChild($("span",[K])):P.appendChild(K),e.map.push(e.pos,e.pos+F,K),e.col+=F,e.pos+=F}if(!q)break;R+=F+1;var Z=void 0;if(q[0]=="	"){var oe=e.cm.options.tabSize,le=oe-e.col%oe;Z=P.appendChild($("span",_t(le),"cm-tab")),Z.setAttribute("role","presentation"),Z.setAttribute("cm-text","	"),e.col+=le}else q[0]=="\r"||q[0]==`
`?(Z=P.appendChild($("span",q[0]=="\r"?"\u240D":"\u2424","cm-invalidchar")),Z.setAttribute("cm-text",q[0]),e.col+=1):(Z=e.cm.options.specialCharPlaceholder(q[0]),Z.setAttribute("cm-text",q[0]),f&&d<9?P.appendChild($("span",[Z])):P.appendChild(Z),e.col+=1);e.map.push(e.pos,e.pos+1,Z),e.pos++}}if(e.trailingSpace=m.charCodeAt(r.length-1)==32,a||s||u||w||p||h){var ce=a||"";s&&(ce+=s),u&&(ce+=u);var ue=$("span",[P],ce,p);if(h)for(var pe in h)h.hasOwnProperty(pe)&&pe!="style"&&pe!="class"&&ue.setAttribute(pe,h[pe]);return e.content.appendChild(ue)}e.content.appendChild(P)}}function cv(e,r){if(e.length>1&&!/  /.test(e))return e;for(var a=r,s="",u=0;u<e.length;u++){var p=e.charAt(u);p==" "&&a&&(u==e.length-1||e.charCodeAt(u+1)==32)&&(p="\xA0"),s+=p,a=p==" "}return s}function fv(e,r){return function(a,s,u,p,h,m,v){u=u?u+" cm-force-border":"cm-force-border";for(var w=a.pos,P=w+s.length;;){for(var R=void 0,q=0;q<r.length&&(R=r[q],!(R.to>w&&R.from<=w));q++);if(R.to>=P)return e(a,s,u,p,h,m,v);e(a,s.slice(0,R.to-w),u,p,null,m,v),p=null,s=s.slice(R.to-w),w=R.to}}}function Uc(e,r,a,s){var u=!s&&a.widgetNode;u&&e.map.push(e.pos,e.pos+r,u),!s&&e.cm.display.input.needsContentAttribute&&(u||(u=e.content.appendChild(document.createElement("span"))),u.setAttribute("cm-marker",a.id)),u&&(e.cm.display.input.setUneditable(u),e.content.appendChild(u)),e.pos+=r,e.trailingSpace=!1}function dv(e,r,a){var s=e.markedSpans,u=e.text,p=0;if(!s){for(var h=1;h<a.length;h+=2)r.addToken(r,u.slice(p,p=a[h]),Wc(a[h+1],r.cm.options));return}for(var m=u.length,v=0,w=1,P="",R,q,F=0,K,Z,oe,le,ce;;){if(F==v){K=Z=oe=q="",ce=null,le=null,F=1/0;for(var ue=[],pe=void 0,be=0;be<s.length;++be){var ve=s[be],Me=ve.marker;if(Me.type=="bookmark"&&ve.from==v&&Me.widgetNode)ue.push(Me);else if(ve.from<=v&&(ve.to==null||ve.to>v||Me.collapsed&&ve.to==v&&ve.from==v)){if(ve.to!=null&&ve.to!=v&&F>ve.to&&(F=ve.to,Z=""),Me.className&&(K+=" "+Me.className),Me.css&&(q=(q?q+";":"")+Me.css),Me.startStyle&&ve.from==v&&(oe+=" "+Me.startStyle),Me.endStyle&&ve.to==F&&(pe||(pe=[])).push(Me.endStyle,ve.to),Me.title&&((ce||(ce={})).title=Me.title),Me.attributes)for(var _e in Me.attributes)(ce||(ce={}))[_e]=Me.attributes[_e];Me.collapsed&&(!le||ba(le.marker,Me)<0)&&(le=ve)}else ve.from>v&&F>ve.from&&(F=ve.from)}if(pe)for(var lt=0;lt<pe.length;lt+=2)pe[lt+1]==F&&(Z+=" "+pe[lt]);if(!le||le.from==v)for(var $e=0;$e<ue.length;++$e)Uc(r,0,ue[$e]);if(le&&(le.from||0)==v){if(Uc(r,(le.to==null?m+1:le.to)-v,le.marker,le.from==null),le.to==null)return;le.to==v&&(le=!1)}}if(v>=m)break;for(var Rt=Math.min(m,F);;){if(P){var Et=v+P.length;if(!le){var nt=Et>Rt?P.slice(0,Rt-v):P;r.addToken(r,nt,R?R+K:K,oe,v+nt.length==F?Z:"",q,ce)}if(Et>=Rt){P=P.slice(Rt-v),v=Rt;break}v=Et,oe=""}P=u.slice(p,p=a[w++]),R=Wc(a[w++],r.cm.options)}}}function $c(e,r,a){this.line=r,this.rest=rv(r),this.size=this.rest?Ie(Ee(this.rest))-a+1:1,this.node=this.text=null,this.hidden=zn(e,r)}function Yo(e,r,a){for(var s=[],u,p=r;p<a;p=u){var h=new $c(e.doc,he(e.doc,p),p);u=p+h.size,s.push(h)}return s}var Br=null;function pv(e){Br?Br.ops.push(e):e.ownsGroup=Br={ops:[e],delayedCallbacks:[]}}function hv(e){var r=e.delayedCallbacks,a=0;do{for(;a<r.length;a++)r[a].call(null);for(var s=0;s<e.ops.length;s++){var u=e.ops[s];if(u.cursorActivityHandlers)for(;u.cursorActivityCalled<u.cursorActivityHandlers.length;)u.cursorActivityHandlers[u.cursorActivityCalled++].call(null,u.cm)}}while(a<r.length)}function gv(e,r){var a=e.ownsGroup;if(a)try{hv(a)}finally{Br=null,r(a)}}var Oi=null;function ot(e,r){var a=Mr(e,r);if(a.length){var s=Array.prototype.slice.call(arguments,2),u;Br?u=Br.delayedCallbacks:Oi?u=Oi:(u=Oi=[],setTimeout(mv,0));for(var p=function(m){u.push(function(){return a[m].apply(null,s)})},h=0;h<a.length;++h)p(h)}}function mv(){var e=Oi;Oi=null;for(var r=0;r<e.length;++r)e[r]()}function Gc(e,r,a,s){for(var u=0;u<r.changes.length;u++){var p=r.changes[u];p=="text"?vv(e,r):p=="gutter"?Yc(e,r,a,s):p=="class"?Ca(e,r):p=="widget"&&bv(e,r,s)}r.changes=null}function Pi(e){return e.node==e.text&&(e.node=$("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),f&&d<8&&(e.node.style.zIndex=2)),e.node}function yv(e,r){var a=r.bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass;if(a&&(a+=" CodeMirror-linebackground"),r.background)a?r.background.className=a:(r.background.parentNode.removeChild(r.background),r.background=null);else if(a){var s=Pi(r);r.background=s.insertBefore($("div",null,a),s.firstChild),e.display.input.setUneditable(r.background)}}function Kc(e,r){var a=e.display.externalMeasured;return a&&a.line==r.line?(e.display.externalMeasured=null,r.measure=a.measure,a.built):Vc(e,r)}function vv(e,r){var a=r.text.className,s=Kc(e,r);r.text==r.node&&(r.node=s.pre),r.text.parentNode.replaceChild(s.pre,r.text),r.text=s.pre,s.bgClass!=r.bgClass||s.textClass!=r.textClass?(r.bgClass=s.bgClass,r.textClass=s.textClass,Ca(e,r)):a&&(r.text.className=a)}function Ca(e,r){yv(e,r),r.line.wrapClass?Pi(r).className=r.line.wrapClass:r.node!=r.text&&(r.node.className="");var a=r.textClass?r.textClass+" "+(r.line.textClass||""):r.line.textClass;r.text.className=a||""}function Yc(e,r,a,s){if(r.gutter&&(r.node.removeChild(r.gutter),r.gutter=null),r.gutterBackground&&(r.node.removeChild(r.gutterBackground),r.gutterBackground=null),r.line.gutterClass){var u=Pi(r);r.gutterBackground=$("div",null,"CodeMirror-gutter-background "+r.line.gutterClass,"left: "+(e.options.fixedGutter?s.fixedPos:-s.gutterTotalWidth)+"px; width: "+s.gutterTotalWidth+"px"),e.display.input.setUneditable(r.gutterBackground),u.insertBefore(r.gutterBackground,r.text)}var p=r.line.gutterMarkers;if(e.options.lineNumbers||p){var h=Pi(r),m=r.gutter=$("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?s.fixedPos:-s.gutterTotalWidth)+"px");if(m.setAttribute("aria-hidden","true"),e.display.input.setUneditable(m),h.insertBefore(m,r.text),r.line.gutterClass&&(m.className+=" "+r.line.gutterClass),e.options.lineNumbers&&(!p||!p["CodeMirror-linenumbers"])&&(r.lineNumber=m.appendChild($("div",Li(e.options,a),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+s.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),p)for(var v=0;v<e.display.gutterSpecs.length;++v){var w=e.display.gutterSpecs[v].className,P=p.hasOwnProperty(w)&&p[w];P&&m.appendChild($("div",[P],"CodeMirror-gutter-elt","left: "+s.gutterLeft[w]+"px; width: "+s.gutterWidth[w]+"px"))}}}function bv(e,r,a){r.alignable&&(r.alignable=null);for(var s=W("CodeMirror-linewidget"),u=r.node.firstChild,p=void 0;u;u=p)p=u.nextSibling,s.test(u.className)&&r.node.removeChild(u);Qc(e,r,a)}function wv(e,r,a,s){var u=Kc(e,r);return r.text=r.node=u.pre,u.bgClass&&(r.bgClass=u.bgClass),u.textClass&&(r.textClass=u.textClass),Ca(e,r),Yc(e,r,a,s),Qc(e,r,s),r.node}function Qc(e,r,a){if(Jc(e,r.line,r,a,!0),r.rest)for(var s=0;s<r.rest.length;s++)Jc(e,r.rest[s],r,a,!1)}function Jc(e,r,a,s,u){if(r.widgets)for(var p=Pi(a),h=0,m=r.widgets;h<m.length;++h){var v=m[h],w=$("div",[v.node],"CodeMirror-linewidget"+(v.className?" "+v.className:""));v.handleMouseEvents||w.setAttribute("cm-ignore-events","true"),xv(v,w,a,s),e.display.input.setUneditable(w),u&&v.above?p.insertBefore(w,a.gutter||a.text):p.appendChild(w),ot(v,"redraw")}}function xv(e,r,a,s){if(e.noHScroll){(a.alignable||(a.alignable=[])).push(r);var u=s.wrapperWidth;r.style.left=s.fixedPos+"px",e.coverGutter||(u-=s.gutterTotalWidth,r.style.paddingLeft=s.gutterTotalWidth+"px"),r.style.width=u+"px"}e.coverGutter&&(r.style.zIndex=5,r.style.position="relative",e.noHScroll||(r.style.marginLeft=-s.gutterTotalWidth+"px"))}function Ni(e){if(e.height!=null)return e.height;var r=e.doc.cm;if(!r)return 0;if(!X(document.body,e.node)){var a="position: relative;";e.coverGutter&&(a+="margin-left: -"+r.display.gutters.offsetWidth+"px;"),e.noHScroll&&(a+="width: "+r.display.wrapper.clientWidth+"px;"),_(r.display.measure,$("div",[e.node],null,a))}return e.height=e.node.parentNode.offsetHeight}function Mn(e,r){for(var a=Bn(r);a!=e.wrapper;a=a.parentNode)if(!a||a.nodeType==1&&a.getAttribute("cm-ignore-events")=="true"||a.parentNode==e.sizer&&a!=e.mover)return!0}function Qo(e){return e.lineSpace.offsetTop}function Sa(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Zc(e){if(e.cachedPaddingH)return e.cachedPaddingH;var r=_(e.measure,$("pre","x","CodeMirror-line-like")),a=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,s={left:parseInt(a.paddingLeft),right:parseInt(a.paddingRight)};return!isNaN(s.left)&&!isNaN(s.right)&&(e.cachedPaddingH=s),s}function xn(e){return ee-e.display.nativeBarWidth}function rr(e){return e.display.scroller.clientWidth-xn(e)-e.display.barWidth}function Ta(e){return e.display.scroller.clientHeight-xn(e)-e.display.barHeight}function kv(e,r,a){var s=e.options.lineWrapping,u=s&&rr(e);if(!r.measure.heights||s&&r.measure.width!=u){var p=r.measure.heights=[];if(s){r.measure.width=u;for(var h=r.text.firstChild.getClientRects(),m=0;m<h.length-1;m++){var v=h[m],w=h[m+1];Math.abs(v.bottom-w.bottom)>2&&p.push((v.bottom+w.top)/2-a.top)}}p.push(a.bottom-a.top)}}function Xc(e,r,a){if(e.line==r)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var s=0;s<e.rest.length;s++)if(e.rest[s]==r)return{map:e.measure.maps[s],cache:e.measure.caches[s]};for(var u=0;u<e.rest.length;u++)if(Ie(e.rest[u])>a)return{map:e.measure.maps[u],cache:e.measure.caches[u],before:!0}}}function Cv(e,r){r=on(r);var a=Ie(r),s=e.display.externalMeasured=new $c(e.doc,r,a);s.lineN=a;var u=s.built=Vc(e,s);return s.text=u.pre,_(e.display.lineMeasure,u.pre),s}function ef(e,r,a,s){return kn(e,jr(e,r),a,s)}function Aa(e,r){if(r>=e.display.viewFrom&&r<e.display.viewTo)return e.display.view[sr(e,r)];var a=e.display.externalMeasured;if(a&&r>=a.lineN&&r<a.lineN+a.size)return a}function jr(e,r){var a=Ie(r),s=Aa(e,a);s&&!s.text?s=null:s&&s.changes&&(Gc(e,s,a,Oa(e)),e.curOp.forceUpdate=!0),s||(s=Cv(e,r));var u=Xc(s,r,a);return{line:r,view:s,rect:null,map:u.map,cache:u.cache,before:u.before,hasHeights:!1}}function kn(e,r,a,s,u){r.before&&(a=-1);var p=a+(s||""),h;return r.cache.hasOwnProperty(p)?h=r.cache[p]:(r.rect||(r.rect=r.view.text.getBoundingClientRect()),r.hasHeights||(kv(e,r.view,r.rect),r.hasHeights=!0),h=Tv(e,r,a,s),h.bogus||(r.cache[p]=h)),{left:h.left,right:h.right,top:u?h.rtop:h.top,bottom:u?h.rbottom:h.bottom}}var tf={left:0,right:0,top:0,bottom:0};function nf(e,r,a){for(var s,u,p,h,m,v,w=0;w<e.length;w+=3)if(m=e[w],v=e[w+1],r<m?(u=0,p=1,h="left"):r<v?(u=r-m,p=u+1):(w==e.length-3||r==v&&e[w+3]>r)&&(p=v-m,u=p-1,r>=v&&(h="right")),u!=null){if(s=e[w+2],m==v&&a==(s.insertLeft?"left":"right")&&(h=a),a=="left"&&u==0)for(;w&&e[w-2]==e[w-3]&&e[w-1].insertLeft;)s=e[(w-=3)+2],h="left";if(a=="right"&&u==v-m)for(;w<e.length-3&&e[w+3]==e[w+4]&&!e[w+5].insertLeft;)s=e[(w+=3)+2],h="right";break}return{node:s,start:u,end:p,collapse:h,coverStart:m,coverEnd:v}}function Sv(e,r){var a=tf;if(r=="left")for(var s=0;s<e.length&&(a=e[s]).left==a.right;s++);else for(var u=e.length-1;u>=0&&(a=e[u]).left==a.right;u--);return a}function Tv(e,r,a,s){var u=nf(r.map,a,s),p=u.node,h=u.start,m=u.end,v=u.collapse,w;if(p.nodeType==3){for(var P=0;P<4;P++){for(;h&&Oe(r.line.text.charAt(u.coverStart+h));)--h;for(;u.coverStart+m<u.coverEnd&&Oe(r.line.text.charAt(u.coverStart+m));)++m;if(f&&d<9&&h==0&&m==u.coverEnd-u.coverStart?w=p.parentNode.getBoundingClientRect():w=Sv(Q(p,h,m).getClientRects(),s),w.left||w.right||h==0)break;m=h,h=h-1,v="right"}f&&d<11&&(w=Av(e.display.measure,w))}else{h>0&&(v=s="right");var R;e.options.lineWrapping&&(R=p.getClientRects()).length>1?w=R[s=="right"?R.length-1:0]:w=p.getBoundingClientRect()}if(f&&d<9&&!h&&(!w||!w.left&&!w.right)){var q=p.parentNode.getClientRects()[0];q?w={left:q.left,right:q.left+Fr(e.display),top:q.top,bottom:q.bottom}:w=tf}for(var F=w.top-r.rect.top,K=w.bottom-r.rect.top,Z=(F+K)/2,oe=r.view.measure.heights,le=0;le<oe.length-1&&!(Z<oe[le]);le++);var ce=le?oe[le-1]:0,ue=oe[le],pe={left:(v=="right"?w.right:w.left)-r.rect.left,right:(v=="left"?w.left:w.right)-r.rect.left,top:ce,bottom:ue};return!w.left&&!w.right&&(pe.bogus=!0),e.options.singleCursorHeightPerLine||(pe.rtop=F,pe.rbottom=K),pe}function Av(e,r){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!jn(e))return r;var a=screen.logicalXDPI/screen.deviceXDPI,s=screen.logicalYDPI/screen.deviceYDPI;return{left:r.left*a,right:r.right*a,top:r.top*s,bottom:r.bottom*s}}function rf(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var r=0;r<e.rest.length;r++)e.measure.caches[r]={}}function of(e){e.display.externalMeasure=null,te(e.display.lineMeasure);for(var r=0;r<e.display.view.length;r++)rf(e.display.view[r])}function Ii(e){of(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function sf(){return b&&L?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function af(){return b&&L?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Ea(e){var r=on(e),a=r.widgets,s=0;if(a)for(var u=0;u<a.length;++u)a[u].above&&(s+=Ni(a[u]));return s}function Jo(e,r,a,s,u){if(!u){var p=Ea(r);a.top+=p,a.bottom+=p}if(s=="line")return a;s||(s="local");var h=Ln(r);if(s=="local"?h+=Qo(e.display):h-=e.display.viewOffset,s=="page"||s=="window"){var m=e.display.lineSpace.getBoundingClientRect();h+=m.top+(s=="window"?0:af());var v=m.left+(s=="window"?0:sf());a.left+=v,a.right+=v}return a.top+=h,a.bottom+=h,a}function lf(e,r,a){if(a=="div")return r;var s=r.left,u=r.top;if(a=="page")s-=sf(),u-=af();else if(a=="local"||!a){var p=e.display.sizer.getBoundingClientRect();s+=p.left,u+=p.top}var h=e.display.lineSpace.getBoundingClientRect();return{left:s-h.left,top:u-h.top}}function Zo(e,r,a,s,u){return s||(s=he(e.doc,r.line)),Jo(e,s,ef(e,s,r.ch,u),a)}function sn(e,r,a,s,u,p){s=s||he(e.doc,r.line),u||(u=jr(e,s));function h(K,Z){var oe=kn(e,u,K,Z?"right":"left",p);return Z?oe.left=oe.right:oe.right=oe.left,Jo(e,s,oe,a)}var m=Pt(s,e.doc.direction),v=r.ch,w=r.sticky;if(v>=s.text.length?(v=s.text.length,w="before"):v<=0&&(v=0,w="after"),!m)return h(w=="before"?v-1:v,w=="before");function P(K,Z,oe){var le=m[Z],ce=le.level==1;return h(oe?K-1:K,ce!=oe)}var R=Qe(m,v,w),q=Wt,F=P(v,R,w=="before");return q!=null&&(F.other=P(v,q,w!="before")),F}function uf(e,r){var a=0;r=fe(e.doc,r),e.options.lineWrapping||(a=Fr(e.display)*r.ch);var s=he(e.doc,r.line),u=Ln(s)+Qo(e.display);return{left:a,right:a,top:u,bottom:u+s.height}}function La(e,r,a,s,u){var p=ne(e,r,a);return p.xRel=u,s&&(p.outside=s),p}function Ma(e,r,a){var s=e.doc;if(a+=e.display.viewOffset,a<0)return La(s.first,0,null,-1,-1);var u=bn(s,a),p=s.first+s.size-1;if(u>p)return La(s.first+s.size-1,he(s,p).text.length,null,1,1);r<0&&(r=0);for(var h=he(s,u);;){var m=Ev(e,h,u,r,a),v=tv(h,m.ch+(m.xRel>0||m.outside>0?1:0));if(!v)return m;var w=v.find(1);if(w.line==u)return w;h=he(s,u=w.line)}}function cf(e,r,a,s){s-=Ea(r);var u=r.text.length,p=gn(function(h){return kn(e,a,h-1).bottom<=s},u,0);return u=gn(function(h){return kn(e,a,h).top>s},p,u),{begin:p,end:u}}function ff(e,r,a,s){a||(a=jr(e,r));var u=Jo(e,r,kn(e,a,s),"line").top;return cf(e,r,a,u)}function Da(e,r,a,s){return e.bottom<=a?!1:e.top>a?!0:(s?e.left:e.right)>r}function Ev(e,r,a,s,u){u-=Ln(r);var p=jr(e,r),h=Ea(r),m=0,v=r.text.length,w=!0,P=Pt(r,e.doc.direction);if(P){var R=(e.options.lineWrapping?Mv:Lv)(e,r,a,p,P,s,u);w=R.level!=1,m=w?R.from:R.to-1,v=w?R.to:R.from-1}var q=null,F=null,K=gn(function(be){var ve=kn(e,p,be);return ve.top+=h,ve.bottom+=h,Da(ve,s,u,!1)?(ve.top<=u&&ve.left<=s&&(q=be,F=ve),!0):!1},m,v),Z,oe,le=!1;if(F){var ce=s-F.left<F.right-s,ue=ce==w;K=q+(ue?0:1),oe=ue?"after":"before",Z=ce?F.left:F.right}else{!w&&(K==v||K==m)&&K++,oe=K==0?"after":K==r.text.length?"before":kn(e,p,K-(w?1:0)).bottom+h<=u==w?"after":"before";var pe=sn(e,ne(a,K,oe),"line",r,p);Z=pe.left,le=u<pe.top?-1:u>=pe.bottom?1:0}return K=yt(r.text,K,1),La(a,K,oe,le,s-Z)}function Lv(e,r,a,s,u,p,h){var m=gn(function(R){var q=u[R],F=q.level!=1;return Da(sn(e,ne(a,F?q.to:q.from,F?"before":"after"),"line",r,s),p,h,!0)},0,u.length-1),v=u[m];if(m>0){var w=v.level!=1,P=sn(e,ne(a,w?v.from:v.to,w?"after":"before"),"line",r,s);Da(P,p,h,!0)&&P.top>h&&(v=u[m-1])}return v}function Mv(e,r,a,s,u,p,h){var m=cf(e,r,s,h),v=m.begin,w=m.end;/\s/.test(r.text.charAt(w-1))&&w--;for(var P=null,R=null,q=0;q<u.length;q++){var F=u[q];if(!(F.from>=w||F.to<=v)){var K=F.level!=1,Z=kn(e,s,K?Math.min(w,F.to)-1:Math.max(v,F.from)).right,oe=Z<p?p-Z+1e9:Z-p;(!P||R>oe)&&(P=F,R=oe)}}return P||(P=u[u.length-1]),P.from<v&&(P={from:v,to:P.to,level:P.level}),P.to>w&&(P={from:P.from,to:w,level:P.level}),P}var ir;function zr(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(ir==null){ir=$("pre",null,"CodeMirror-line-like");for(var r=0;r<49;++r)ir.appendChild(document.createTextNode("x")),ir.appendChild($("br"));ir.appendChild(document.createTextNode("x"))}_(e.measure,ir);var a=ir.offsetHeight/50;return a>3&&(e.cachedTextHeight=a),te(e.measure),a||1}function Fr(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var r=$("span","xxxxxxxxxx"),a=$("pre",[r],"CodeMirror-line-like");_(e.measure,a);var s=r.getBoundingClientRect(),u=(s.right-s.left)/10;return u>2&&(e.cachedCharWidth=u),u||10}function Oa(e){for(var r=e.display,a={},s={},u=r.gutters.clientLeft,p=r.gutters.firstChild,h=0;p;p=p.nextSibling,++h){var m=e.display.gutterSpecs[h].className;a[m]=p.offsetLeft+p.clientLeft+u,s[m]=p.clientWidth}return{fixedPos:Pa(r),gutterTotalWidth:r.gutters.offsetWidth,gutterLeft:a,gutterWidth:s,wrapperWidth:r.wrapper.clientWidth}}function Pa(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function df(e){var r=zr(e.display),a=e.options.lineWrapping,s=a&&Math.max(5,e.display.scroller.clientWidth/Fr(e.display)-3);return function(u){if(zn(e.doc,u))return 0;var p=0;if(u.widgets)for(var h=0;h<u.widgets.length;h++)u.widgets[h].height&&(p+=u.widgets[h].height);return a?p+(Math.ceil(u.text.length/s)||1)*r:p+r}}function Na(e){var r=e.doc,a=df(e);r.iter(function(s){var u=a(s);u!=s.height&&Nt(s,u)})}function or(e,r,a,s){var u=e.display;if(!a&&Bn(r).getAttribute("cm-not-content")=="true")return null;var p,h,m=u.lineSpace.getBoundingClientRect();try{p=r.clientX-m.left,h=r.clientY-m.top}catch{return null}var v=Ma(e,p,h),w;if(s&&v.xRel>0&&(w=he(e.doc,v.line).text).length==v.ch){var P=Ye(w,w.length,e.options.tabSize)-w.length;v=ne(v.line,Math.max(0,Math.round((p-Zc(e.display).left)/Fr(e.display))-P))}return v}function sr(e,r){if(r>=e.display.viewTo||(r-=e.display.viewFrom,r<0))return null;for(var a=e.display.view,s=0;s<a.length;s++)if(r-=a[s].size,r<0)return s}function Tt(e,r,a,s){r==null&&(r=e.doc.first),a==null&&(a=e.doc.first+e.doc.size),s||(s=0);var u=e.display;if(s&&a<u.viewTo&&(u.updateLineNumbers==null||u.updateLineNumbers>r)&&(u.updateLineNumbers=r),e.curOp.viewChanged=!0,r>=u.viewTo)En&&wa(e.doc,r)<u.viewTo&&Hn(e);else if(a<=u.viewFrom)En&&qc(e.doc,a+s)>u.viewFrom?Hn(e):(u.viewFrom+=s,u.viewTo+=s);else if(r<=u.viewFrom&&a>=u.viewTo)Hn(e);else if(r<=u.viewFrom){var p=Xo(e,a,a+s,1);p?(u.view=u.view.slice(p.index),u.viewFrom=p.lineN,u.viewTo+=s):Hn(e)}else if(a>=u.viewTo){var h=Xo(e,r,r,-1);h?(u.view=u.view.slice(0,h.index),u.viewTo=h.lineN):Hn(e)}else{var m=Xo(e,r,r,-1),v=Xo(e,a,a+s,1);m&&v?(u.view=u.view.slice(0,m.index).concat(Yo(e,m.lineN,v.lineN)).concat(u.view.slice(v.index)),u.viewTo+=s):Hn(e)}var w=u.externalMeasured;w&&(a<w.lineN?w.lineN+=s:r<w.lineN+w.size&&(u.externalMeasured=null))}function Fn(e,r,a){e.curOp.viewChanged=!0;var s=e.display,u=e.display.externalMeasured;if(u&&r>=u.lineN&&r<u.lineN+u.size&&(s.externalMeasured=null),!(r<s.viewFrom||r>=s.viewTo)){var p=s.view[sr(e,r)];if(p.node!=null){var h=p.changes||(p.changes=[]);V(h,a)==-1&&h.push(a)}}}function Hn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Xo(e,r,a,s){var u=sr(e,r),p,h=e.display.view;if(!En||a==e.doc.first+e.doc.size)return{index:u,lineN:a};for(var m=e.display.viewFrom,v=0;v<u;v++)m+=h[v].size;if(m!=r){if(s>0){if(u==h.length-1)return null;p=m+h[u].size-r,u++}else p=m-r;r+=p,a+=p}for(;wa(e.doc,a)!=a;){if(u==(s<0?0:h.length-1))return null;a+=s*h[u-(s<0?1:0)].size,u+=s}return{index:u,lineN:a}}function Dv(e,r,a){var s=e.display,u=s.view;u.length==0||r>=s.viewTo||a<=s.viewFrom?(s.view=Yo(e,r,a),s.viewFrom=r):(s.viewFrom>r?s.view=Yo(e,r,s.viewFrom).concat(s.view):s.viewFrom<r&&(s.view=s.view.slice(sr(e,r))),s.viewFrom=r,s.viewTo<a?s.view=s.view.concat(Yo(e,s.viewTo,a)):s.viewTo>a&&(s.view=s.view.slice(0,sr(e,a)))),s.viewTo=a}function pf(e){for(var r=e.display.view,a=0,s=0;s<r.length;s++){var u=r[s];!u.hidden&&(!u.node||u.changes)&&++a}return a}function Ri(e){e.display.input.showSelection(e.display.input.prepareSelection())}function hf(e,r){r===void 0&&(r=!0);var a=e.doc,s={},u=s.cursors=document.createDocumentFragment(),p=s.selection=document.createDocumentFragment(),h=e.options.$customCursor;h&&(r=!0);for(var m=0;m<a.sel.ranges.length;m++)if(!(!r&&m==a.sel.primIndex)){var v=a.sel.ranges[m];if(!(v.from().line>=e.display.viewTo||v.to().line<e.display.viewFrom)){var w=v.empty();if(h){var P=h(e,v);P&&Ia(e,P,u)}else(w||e.options.showCursorWhenSelecting)&&Ia(e,v.head,u);w||Ov(e,v,p)}}return s}function Ia(e,r,a){var s=sn(e,r,"div",null,null,!e.options.singleCursorHeightPerLine),u=a.appendChild($("div","\xA0","CodeMirror-cursor"));if(u.style.left=s.left+"px",u.style.top=s.top+"px",u.style.height=Math.max(0,s.bottom-s.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var p=Zo(e,r,"div",null,null),h=p.right-p.left;u.style.width=(h>0?h:e.defaultCharWidth())+"px"}if(s.other){var m=a.appendChild($("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"));m.style.display="",m.style.left=s.other.left+"px",m.style.top=s.other.top+"px",m.style.height=(s.other.bottom-s.other.top)*.85+"px"}}function es(e,r){return e.top-r.top||e.left-r.left}function Ov(e,r,a){var s=e.display,u=e.doc,p=document.createDocumentFragment(),h=Zc(e.display),m=h.left,v=Math.max(s.sizerWidth,rr(e)-s.sizer.offsetLeft)-h.right,w=u.direction=="ltr";function P(ue,pe,be,ve){pe<0&&(pe=0),pe=Math.round(pe),ve=Math.round(ve),p.appendChild($("div",null,"CodeMirror-selected","position: absolute; left: "+ue+`px;
                             top: `+pe+"px; width: "+(be??v-ue)+`px;
                             height: `+(ve-pe)+"px"))}function R(ue,pe,be){var ve=he(u,ue),Me=ve.text.length,_e,lt;function $e(nt,Lt){return Zo(e,ne(ue,nt),"div",ve,Lt)}function Rt(nt,Lt,ft){var it=ff(e,ve,null,nt),rt=Lt=="ltr"==(ft=="after")?"left":"right",Ze=ft=="after"?it.begin:it.end-(/\s/.test(ve.text.charAt(it.end-1))?2:1);return $e(Ze,rt)[rt]}var Et=Pt(ve,u.direction);return ga(Et,pe||0,be??Me,function(nt,Lt,ft,it){var rt=ft=="ltr",Ze=$e(nt,rt?"left":"right"),Mt=$e(Lt-1,rt?"right":"left"),Zr=pe==null&&nt==0,$n=be==null&&Lt==Me,gt=it==0,Cn=!Et||it==Et.length-1;if(Mt.top-Ze.top<=3){var ut=(w?Zr:$n)&&gt,sl=(w?$n:Zr)&&Cn,Pn=ut?m:(rt?Ze:Mt).left,fr=sl?v:(rt?Mt:Ze).right;P(Pn,Ze.top,fr-Pn,Ze.bottom)}else{var dr,bt,Xr,al;rt?(dr=w&&Zr&&gt?m:Ze.left,bt=w?v:Rt(nt,ft,"before"),Xr=w?m:Rt(Lt,ft,"after"),al=w&&$n&&Cn?v:Mt.right):(dr=w?Rt(nt,ft,"before"):m,bt=!w&&Zr&&gt?v:Ze.right,Xr=!w&&$n&&Cn?m:Mt.left,al=w?Rt(Lt,ft,"after"):v),P(dr,Ze.top,bt-dr,Ze.bottom),Ze.bottom<Mt.top&&P(m,Ze.bottom,null,Mt.top),P(Xr,Mt.top,al-Xr,Mt.bottom)}(!_e||es(Ze,_e)<0)&&(_e=Ze),es(Mt,_e)<0&&(_e=Mt),(!lt||es(Ze,lt)<0)&&(lt=Ze),es(Mt,lt)<0&&(lt=Mt)}),{start:_e,end:lt}}var q=r.from(),F=r.to();if(q.line==F.line)R(q.line,q.ch,F.ch);else{var K=he(u,q.line),Z=he(u,F.line),oe=on(K)==on(Z),le=R(q.line,q.ch,oe?K.text.length+1:null).end,ce=R(F.line,oe?0:null,F.ch).start;oe&&(le.top<ce.top-2?(P(le.right,le.top,null,le.bottom),P(m,ce.top,ce.left,ce.bottom)):P(le.right,le.top,ce.left-le.right,le.bottom)),le.bottom<ce.top&&P(m,le.bottom,null,ce.top)}a.appendChild(p)}function Ra(e){if(e.state.focused){var r=e.display;clearInterval(r.blinker);var a=!0;r.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?r.blinker=setInterval(function(){e.hasFocus()||Hr(e),r.cursorDiv.style.visibility=(a=!a)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(r.cursorDiv.style.visibility="hidden")}}function gf(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||ja(e))}function Ba(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&Hr(e))},100)}function ja(e,r){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Se(e,"focus",e,r),e.state.focused=!0,De(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),g&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Ra(e))}function Hr(e,r){e.state.delayingBlurEvent||(e.state.focused&&(Se(e,"blur",e,r),e.state.focused=!1,H(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function ts(e){for(var r=e.display,a=r.lineDiv.offsetTop,s=Math.max(0,r.scroller.getBoundingClientRect().top),u=r.lineDiv.getBoundingClientRect().top,p=0,h=0;h<r.view.length;h++){var m=r.view[h],v=e.options.lineWrapping,w=void 0,P=0;if(!m.hidden){if(u+=m.line.height,f&&d<8){var R=m.node.offsetTop+m.node.offsetHeight;w=R-a,a=R}else{var q=m.node.getBoundingClientRect();w=q.bottom-q.top,!v&&m.text.firstChild&&(P=m.text.firstChild.getBoundingClientRect().right-q.left-1)}var F=m.line.height-w;if((F>.005||F<-.005)&&(u<s&&(p-=F),Nt(m.line,w),mf(m.line),m.rest))for(var K=0;K<m.rest.length;K++)mf(m.rest[K]);if(P>e.display.sizerWidth){var Z=Math.ceil(P/Fr(e.display));Z>e.display.maxLineLength&&(e.display.maxLineLength=Z,e.display.maxLine=m.line,e.display.maxLineChanged=!0)}}}Math.abs(p)>2&&(r.scroller.scrollTop+=p)}function mf(e){if(e.widgets)for(var r=0;r<e.widgets.length;++r){var a=e.widgets[r],s=a.node.parentNode;s&&(a.height=s.offsetHeight)}}function ns(e,r,a){var s=a&&a.top!=null?Math.max(0,a.top):e.scroller.scrollTop;s=Math.floor(s-Qo(e));var u=a&&a.bottom!=null?a.bottom:s+e.wrapper.clientHeight,p=bn(r,s),h=bn(r,u);if(a&&a.ensure){var m=a.ensure.from.line,v=a.ensure.to.line;m<p?(p=m,h=bn(r,Ln(he(r,m))+e.wrapper.clientHeight)):Math.min(v,r.lastLine())>=h&&(p=bn(r,Ln(he(r,v))-e.wrapper.clientHeight),h=v)}return{from:p,to:Math.max(h,p+1)}}function Pv(e,r){if(!tt(e,"scrollCursorIntoView")){var a=e.display,s=a.sizer.getBoundingClientRect(),u=null;if(r.top+s.top<0?u=!0:r.bottom+s.top>(window.innerHeight||document.documentElement.clientHeight)&&(u=!1),u!=null&&!M){var p=$("div","\u200B",null,`position: absolute;
                         top: `+(r.top-a.viewOffset-Qo(e.display))+`px;
                         height: `+(r.bottom-r.top+xn(e)+a.barHeight)+`px;
                         left: `+r.left+"px; width: "+Math.max(2,r.right-r.left)+"px;");e.display.lineSpace.appendChild(p),p.scrollIntoView(u),e.display.lineSpace.removeChild(p)}}}function Nv(e,r,a,s){s==null&&(s=0);var u;!e.options.lineWrapping&&r==a&&(a=r.sticky=="before"?ne(r.line,r.ch+1,"before"):r,r=r.ch?ne(r.line,r.sticky=="before"?r.ch-1:r.ch,"after"):r);for(var p=0;p<5;p++){var h=!1,m=sn(e,r),v=!a||a==r?m:sn(e,a);u={left:Math.min(m.left,v.left),top:Math.min(m.top,v.top)-s,right:Math.max(m.left,v.left),bottom:Math.max(m.bottom,v.bottom)+s};var w=za(e,u),P=e.doc.scrollTop,R=e.doc.scrollLeft;if(w.scrollTop!=null&&(ji(e,w.scrollTop),Math.abs(e.doc.scrollTop-P)>1&&(h=!0)),w.scrollLeft!=null&&(ar(e,w.scrollLeft),Math.abs(e.doc.scrollLeft-R)>1&&(h=!0)),!h)break}return u}function Iv(e,r){var a=za(e,r);a.scrollTop!=null&&ji(e,a.scrollTop),a.scrollLeft!=null&&ar(e,a.scrollLeft)}function za(e,r){var a=e.display,s=zr(e.display);r.top<0&&(r.top=0);var u=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:a.scroller.scrollTop,p=Ta(e),h={};r.bottom-r.top>p&&(r.bottom=r.top+p);var m=e.doc.height+Sa(a),v=r.top<s,w=r.bottom>m-s;if(r.top<u)h.scrollTop=v?0:r.top;else if(r.bottom>u+p){var P=Math.min(r.top,(w?m:r.bottom)-p);P!=u&&(h.scrollTop=P)}var R=e.options.fixedGutter?0:a.gutters.offsetWidth,q=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:a.scroller.scrollLeft-R,F=rr(e)-a.gutters.offsetWidth,K=r.right-r.left>F;return K&&(r.right=r.left+F),r.left<10?h.scrollLeft=0:r.left<q?h.scrollLeft=Math.max(0,r.left+R-(K?0:10)):r.right>F+q-3&&(h.scrollLeft=r.right+(K?0:10)-F),h}function Fa(e,r){r!=null&&(rs(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+r)}function _r(e){rs(e);var r=e.getCursor();e.curOp.scrollToPos={from:r,to:r,margin:e.options.cursorScrollMargin}}function Bi(e,r,a){(r!=null||a!=null)&&rs(e),r!=null&&(e.curOp.scrollLeft=r),a!=null&&(e.curOp.scrollTop=a)}function Rv(e,r){rs(e),e.curOp.scrollToPos=r}function rs(e){var r=e.curOp.scrollToPos;if(r){e.curOp.scrollToPos=null;var a=uf(e,r.from),s=uf(e,r.to);yf(e,a,s,r.margin)}}function yf(e,r,a,s){var u=za(e,{left:Math.min(r.left,a.left),top:Math.min(r.top,a.top)-s,right:Math.max(r.right,a.right),bottom:Math.max(r.bottom,a.bottom)+s});Bi(e,u.scrollLeft,u.scrollTop)}function ji(e,r){Math.abs(e.doc.scrollTop-r)<2||(i||_a(e,{top:r}),vf(e,r,!0),i&&_a(e),Hi(e,100))}function vf(e,r,a){r=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,r)),!(e.display.scroller.scrollTop==r&&!a)&&(e.doc.scrollTop=r,e.display.scrollbars.setScrollTop(r),e.display.scroller.scrollTop!=r&&(e.display.scroller.scrollTop=r))}function ar(e,r,a,s){r=Math.max(0,Math.min(r,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((a?r==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-r)<2)&&!s)&&(e.doc.scrollLeft=r,Cf(e),e.display.scroller.scrollLeft!=r&&(e.display.scroller.scrollLeft=r),e.display.scrollbars.setScrollLeft(r))}function zi(e){var r=e.display,a=r.gutters.offsetWidth,s=Math.round(e.doc.height+Sa(e.display));return{clientHeight:r.scroller.clientHeight,viewHeight:r.wrapper.clientHeight,scrollWidth:r.scroller.scrollWidth,clientWidth:r.scroller.clientWidth,viewWidth:r.wrapper.clientWidth,barLeft:e.options.fixedGutter?a:0,docHeight:s,scrollHeight:s+xn(e)+r.barHeight,nativeBarWidth:r.nativeBarWidth,gutterWidth:a}}var lr=function(e,r,a){this.cm=a;var s=this.vert=$("div",[$("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),u=this.horiz=$("div",[$("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");s.tabIndex=u.tabIndex=-1,e(s),e(u),we(s,"scroll",function(){s.clientHeight&&r(s.scrollTop,"vertical")}),we(u,"scroll",function(){u.clientWidth&&r(u.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,f&&d<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};lr.prototype.update=function(e){var r=e.scrollWidth>e.clientWidth+1,a=e.scrollHeight>e.clientHeight+1,s=e.nativeBarWidth;if(a){this.vert.style.display="block",this.vert.style.bottom=r?s+"px":"0";var u=e.viewHeight-(r?s:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+u)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(r){this.horiz.style.display="block",this.horiz.style.right=a?s+"px":"0",this.horiz.style.left=e.barLeft+"px";var p=e.viewWidth-e.barLeft-(a?s:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+p)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(s==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:a?s:0,bottom:r?s:0}},lr.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},lr.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},lr.prototype.zeroWidthHack=function(){var e=T&&!E?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Fe,this.disableVert=new Fe},lr.prototype.enableZeroWidthBar=function(e,r,a){e.style.pointerEvents="auto";function s(){var u=e.getBoundingClientRect(),p=a=="vert"?document.elementFromPoint(u.right-1,(u.top+u.bottom)/2):document.elementFromPoint((u.right+u.left)/2,u.bottom-1);p!=e?e.style.pointerEvents="none":r.set(1e3,s)}r.set(1e3,s)},lr.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var Fi=function(){};Fi.prototype.update=function(){return{bottom:0,right:0}},Fi.prototype.setScrollLeft=function(){},Fi.prototype.setScrollTop=function(){},Fi.prototype.clear=function(){};function qr(e,r){r||(r=zi(e));var a=e.display.barWidth,s=e.display.barHeight;bf(e,r);for(var u=0;u<4&&a!=e.display.barWidth||s!=e.display.barHeight;u++)a!=e.display.barWidth&&e.options.lineWrapping&&ts(e),bf(e,zi(e)),a=e.display.barWidth,s=e.display.barHeight}function bf(e,r){var a=e.display,s=a.scrollbars.update(r);a.sizer.style.paddingRight=(a.barWidth=s.right)+"px",a.sizer.style.paddingBottom=(a.barHeight=s.bottom)+"px",a.heightForcer.style.borderBottom=s.bottom+"px solid transparent",s.right&&s.bottom?(a.scrollbarFiller.style.display="block",a.scrollbarFiller.style.height=s.bottom+"px",a.scrollbarFiller.style.width=s.right+"px"):a.scrollbarFiller.style.display="",s.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(a.gutterFiller.style.display="block",a.gutterFiller.style.height=s.bottom+"px",a.gutterFiller.style.width=r.gutterWidth+"px"):a.gutterFiller.style.display=""}var wf={native:lr,null:Fi};function xf(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&H(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new wf[e.options.scrollbarStyle](function(r){e.display.wrapper.insertBefore(r,e.display.scrollbarFiller),we(r,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),r.setAttribute("cm-not-content","true")},function(r,a){a=="horizontal"?ar(e,r):ji(e,r)},e),e.display.scrollbars.addClass&&De(e.display.wrapper,e.display.scrollbars.addClass)}var Bv=0;function ur(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Bv,markArrays:null},pv(e.curOp)}function cr(e){var r=e.curOp;r&&gv(r,function(a){for(var s=0;s<a.ops.length;s++)a.ops[s].cm.curOp=null;jv(a)})}function jv(e){for(var r=e.ops,a=0;a<r.length;a++)zv(r[a]);for(var s=0;s<r.length;s++)Fv(r[s]);for(var u=0;u<r.length;u++)Hv(r[u]);for(var p=0;p<r.length;p++)_v(r[p]);for(var h=0;h<r.length;h++)qv(r[h])}function zv(e){var r=e.cm,a=r.display;Vv(r),e.updateMaxLine&&ka(r),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<a.viewFrom||e.scrollToPos.to.line>=a.viewTo)||a.maxLineChanged&&r.options.lineWrapping,e.update=e.mustUpdate&&new is(r,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Fv(e){e.updatedDisplay=e.mustUpdate&&Ha(e.cm,e.update)}function Hv(e){var r=e.cm,a=r.display;e.updatedDisplay&&ts(r),e.barMeasure=zi(r),a.maxLineChanged&&!r.options.lineWrapping&&(e.adjustWidthTo=ef(r,a.maxLine,a.maxLine.text.length).left+3,r.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(a.scroller.clientWidth,a.sizer.offsetLeft+e.adjustWidthTo+xn(r)+r.display.barWidth),e.maxScrollLeft=Math.max(0,a.sizer.offsetLeft+e.adjustWidthTo-rr(r))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=a.input.prepareSelection())}function _v(e){var r=e.cm;e.adjustWidthTo!=null&&(r.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<r.doc.scrollLeft&&ar(r,Math.min(r.display.scroller.scrollLeft,e.maxScrollLeft),!0),r.display.maxLineChanged=!1);var a=e.focus&&e.focus==de();e.preparedSelection&&r.display.input.showSelection(e.preparedSelection,a),(e.updatedDisplay||e.startHeight!=r.doc.height)&&qr(r,e.barMeasure),e.updatedDisplay&&Wa(r,e.barMeasure),e.selectionChanged&&Ra(r),r.state.focused&&e.updateInput&&r.display.input.reset(e.typing),a&&gf(e.cm)}function qv(e){var r=e.cm,a=r.display,s=r.doc;if(e.updatedDisplay&&kf(r,e.update),a.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(a.wheelStartX=a.wheelStartY=null),e.scrollTop!=null&&vf(r,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&ar(r,e.scrollLeft,!0,!0),e.scrollToPos){var u=Nv(r,fe(s,e.scrollToPos.from),fe(s,e.scrollToPos.to),e.scrollToPos.margin);Pv(r,u)}var p=e.maybeHiddenMarkers,h=e.maybeUnhiddenMarkers;if(p)for(var m=0;m<p.length;++m)p[m].lines.length||Se(p[m],"hide");if(h)for(var v=0;v<h.length;++v)h[v].lines.length&&Se(h[v],"unhide");a.wrapper.offsetHeight&&(s.scrollTop=r.display.scroller.scrollTop),e.changeObjs&&Se(r,"changes",r,e.changeObjs),e.update&&e.update.finish()}function It(e,r){if(e.curOp)return r();ur(e);try{return r()}finally{cr(e)}}function st(e,r){return function(){if(e.curOp)return r.apply(e,arguments);ur(e);try{return r.apply(e,arguments)}finally{cr(e)}}}function vt(e){return function(){if(this.curOp)return e.apply(this,arguments);ur(this);try{return e.apply(this,arguments)}finally{cr(this)}}}function at(e){return function(){var r=this.cm;if(!r||r.curOp)return e.apply(this,arguments);ur(r);try{return e.apply(this,arguments)}finally{cr(r)}}}function Hi(e,r){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(r,Ot(Wv,e))}function Wv(e){var r=e.doc;if(!(r.highlightFrontier>=e.display.viewTo)){var a=+new Date+e.options.workTime,s=Mi(e,r.highlightFrontier),u=[];r.iter(s.line,Math.min(r.first+r.size,e.display.viewTo+500),function(p){if(s.line>=e.display.viewFrom){var h=p.styles,m=p.text.length>e.options.maxHighlightLength?$t(r.mode,s.state):null,v=Lc(e,p,s,!0);m&&(s.state=m),p.styles=v.styles;var w=p.styleClasses,P=v.classes;P?p.styleClasses=P:w&&(p.styleClasses=null);for(var R=!h||h.length!=p.styles.length||w!=P&&(!w||!P||w.bgClass!=P.bgClass||w.textClass!=P.textClass),q=0;!R&&q<h.length;++q)R=h[q]!=p.styles[q];R&&u.push(s.line),p.stateAfter=s.save(),s.nextLine()}else p.text.length<=e.options.maxHighlightLength&&ma(e,p.text,s),p.stateAfter=s.line%5==0?s.save():null,s.nextLine();if(+new Date>a)return Hi(e,e.options.workDelay),!0}),r.highlightFrontier=s.line,r.modeFrontier=Math.max(r.modeFrontier,s.line),u.length&&It(e,function(){for(var p=0;p<u.length;p++)Fn(e,u[p],"text")})}}var is=function(e,r,a){var s=e.display;this.viewport=r,this.visible=ns(s,e.doc,r),this.editorIsHidden=!s.wrapper.offsetWidth,this.wrapperHeight=s.wrapper.clientHeight,this.wrapperWidth=s.wrapper.clientWidth,this.oldDisplayWidth=rr(e),this.force=a,this.dims=Oa(e),this.events=[]};is.prototype.signal=function(e,r){ct(e,r)&&this.events.push(arguments)},is.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Se.apply(null,this.events[e])};function Vv(e){var r=e.display;!r.scrollbarsClipped&&r.scroller.offsetWidth&&(r.nativeBarWidth=r.scroller.offsetWidth-r.scroller.clientWidth,r.heightForcer.style.height=xn(e)+"px",r.sizer.style.marginBottom=-r.nativeBarWidth+"px",r.sizer.style.borderRightWidth=xn(e)+"px",r.scrollbarsClipped=!0)}function Uv(e){if(e.hasFocus())return null;var r=de();if(!r||!X(e.display.lineDiv,r))return null;var a={activeElt:r};if(window.getSelection){var s=window.getSelection();s.anchorNode&&s.extend&&X(e.display.lineDiv,s.anchorNode)&&(a.anchorNode=s.anchorNode,a.anchorOffset=s.anchorOffset,a.focusNode=s.focusNode,a.focusOffset=s.focusOffset)}return a}function $v(e){if(!(!e||!e.activeElt||e.activeElt==de())&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&X(document.body,e.anchorNode)&&X(document.body,e.focusNode))){var r=window.getSelection(),a=document.createRange();a.setEnd(e.anchorNode,e.anchorOffset),a.collapse(!1),r.removeAllRanges(),r.addRange(a),r.extend(e.focusNode,e.focusOffset)}}function Ha(e,r){var a=e.display,s=e.doc;if(r.editorIsHidden)return Hn(e),!1;if(!r.force&&r.visible.from>=a.viewFrom&&r.visible.to<=a.viewTo&&(a.updateLineNumbers==null||a.updateLineNumbers>=a.viewTo)&&a.renderedView==a.view&&pf(e)==0)return!1;Sf(e)&&(Hn(e),r.dims=Oa(e));var u=s.first+s.size,p=Math.max(r.visible.from-e.options.viewportMargin,s.first),h=Math.min(u,r.visible.to+e.options.viewportMargin);a.viewFrom<p&&p-a.viewFrom<20&&(p=Math.max(s.first,a.viewFrom)),a.viewTo>h&&a.viewTo-h<20&&(h=Math.min(u,a.viewTo)),En&&(p=wa(e.doc,p),h=qc(e.doc,h));var m=p!=a.viewFrom||h!=a.viewTo||a.lastWrapHeight!=r.wrapperHeight||a.lastWrapWidth!=r.wrapperWidth;Dv(e,p,h),a.viewOffset=Ln(he(e.doc,a.viewFrom)),e.display.mover.style.top=a.viewOffset+"px";var v=pf(e);if(!m&&v==0&&!r.force&&a.renderedView==a.view&&(a.updateLineNumbers==null||a.updateLineNumbers>=a.viewTo))return!1;var w=Uv(e);return v>4&&(a.lineDiv.style.display="none"),Gv(e,a.updateLineNumbers,r.dims),v>4&&(a.lineDiv.style.display=""),a.renderedView=a.view,$v(w),te(a.cursorDiv),te(a.selectionDiv),a.gutters.style.height=a.sizer.style.minHeight=0,m&&(a.lastWrapHeight=r.wrapperHeight,a.lastWrapWidth=r.wrapperWidth,Hi(e,400)),a.updateLineNumbers=null,!0}function kf(e,r){for(var a=r.viewport,s=!0;;s=!1){if(!s||!e.options.lineWrapping||r.oldDisplayWidth==rr(e)){if(a&&a.top!=null&&(a={top:Math.min(e.doc.height+Sa(e.display)-Ta(e),a.top)}),r.visible=ns(e.display,e.doc,a),r.visible.from>=e.display.viewFrom&&r.visible.to<=e.display.viewTo)break}else s&&(r.visible=ns(e.display,e.doc,a));if(!Ha(e,r))break;ts(e);var u=zi(e);Ri(e),qr(e,u),Wa(e,u),r.force=!1}r.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(r.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function _a(e,r){var a=new is(e,r);if(Ha(e,a)){ts(e),kf(e,a);var s=zi(e);Ri(e),qr(e,s),Wa(e,s),a.finish()}}function Gv(e,r,a){var s=e.display,u=e.options.lineNumbers,p=s.lineDiv,h=p.firstChild;function m(K){var Z=K.nextSibling;return g&&T&&e.display.currentWheelTarget==K?K.style.display="none":K.parentNode.removeChild(K),Z}for(var v=s.view,w=s.viewFrom,P=0;P<v.length;P++){var R=v[P];if(!R.hidden)if(!R.node||R.node.parentNode!=p){var q=wv(e,R,w,a);p.insertBefore(q,h)}else{for(;h!=R.node;)h=m(h);var F=u&&r!=null&&r<=w&&R.lineNumber;R.changes&&(V(R.changes,"gutter")>-1&&(F=!1),Gc(e,R,w,a)),F&&(te(R.lineNumber),R.lineNumber.appendChild(document.createTextNode(Li(e.options,w)))),h=R.node.nextSibling}w+=R.size}for(;h;)h=m(h)}function qa(e){var r=e.gutters.offsetWidth;e.sizer.style.marginLeft=r+"px",ot(e,"gutterChanged",e)}function Wa(e,r){e.display.sizer.style.minHeight=r.docHeight+"px",e.display.heightForcer.style.top=r.docHeight+"px",e.display.gutters.style.height=r.docHeight+e.display.barHeight+xn(e)+"px"}function Cf(e){var r=e.display,a=r.view;if(!(!r.alignWidgets&&(!r.gutters.firstChild||!e.options.fixedGutter))){for(var s=Pa(r)-r.scroller.scrollLeft+e.doc.scrollLeft,u=r.gutters.offsetWidth,p=s+"px",h=0;h<a.length;h++)if(!a[h].hidden){e.options.fixedGutter&&(a[h].gutter&&(a[h].gutter.style.left=p),a[h].gutterBackground&&(a[h].gutterBackground.style.left=p));var m=a[h].alignable;if(m)for(var v=0;v<m.length;v++)m[v].style.left=p}e.options.fixedGutter&&(r.gutters.style.left=s+u+"px")}}function Sf(e){if(!e.options.lineNumbers)return!1;var r=e.doc,a=Li(e.options,r.first+r.size-1),s=e.display;if(a.length!=s.lineNumChars){var u=s.measure.appendChild($("div",[$("div",a)],"CodeMirror-linenumber CodeMirror-gutter-elt")),p=u.firstChild.offsetWidth,h=u.offsetWidth-p;return s.lineGutter.style.width="",s.lineNumInnerWidth=Math.max(p,s.lineGutter.offsetWidth-h)+1,s.lineNumWidth=s.lineNumInnerWidth+h,s.lineNumChars=s.lineNumInnerWidth?a.length:-1,s.lineGutter.style.width=s.lineNumWidth+"px",qa(e.display),!0}return!1}function Va(e,r){for(var a=[],s=!1,u=0;u<e.length;u++){var p=e[u],h=null;if(typeof p!="string"&&(h=p.style,p=p.className),p=="CodeMirror-linenumbers")if(r)s=!0;else continue;a.push({className:p,style:h})}return r&&!s&&a.push({className:"CodeMirror-linenumbers",style:null}),a}function Tf(e){var r=e.gutters,a=e.gutterSpecs;te(r),e.lineGutter=null;for(var s=0;s<a.length;++s){var u=a[s],p=u.className,h=u.style,m=r.appendChild($("div",null,"CodeMirror-gutter "+p));h&&(m.style.cssText=h),p=="CodeMirror-linenumbers"&&(e.lineGutter=m,m.style.width=(e.lineNumWidth||1)+"px")}r.style.display=a.length?"":"none",qa(e)}function _i(e){Tf(e.display),Tt(e),Cf(e)}function Kv(e,r,a,s){var u=this;this.input=a,u.scrollbarFiller=$("div",null,"CodeMirror-scrollbar-filler"),u.scrollbarFiller.setAttribute("cm-not-content","true"),u.gutterFiller=$("div",null,"CodeMirror-gutter-filler"),u.gutterFiller.setAttribute("cm-not-content","true"),u.lineDiv=D("div",null,"CodeMirror-code"),u.selectionDiv=$("div",null,null,"position: relative; z-index: 1"),u.cursorDiv=$("div",null,"CodeMirror-cursors"),u.measure=$("div",null,"CodeMirror-measure"),u.lineMeasure=$("div",null,"CodeMirror-measure"),u.lineSpace=D("div",[u.measure,u.lineMeasure,u.selectionDiv,u.cursorDiv,u.lineDiv],null,"position: relative; outline: none");var p=D("div",[u.lineSpace],"CodeMirror-lines");u.mover=$("div",[p],null,"position: relative"),u.sizer=$("div",[u.mover],"CodeMirror-sizer"),u.sizerWidth=null,u.heightForcer=$("div",null,null,"position: absolute; height: "+ee+"px; width: 1px;"),u.gutters=$("div",null,"CodeMirror-gutters"),u.lineGutter=null,u.scroller=$("div",[u.sizer,u.heightForcer,u.gutters],"CodeMirror-scroll"),u.scroller.setAttribute("tabIndex","-1"),u.wrapper=$("div",[u.scrollbarFiller,u.gutterFiller,u.scroller],"CodeMirror"),u.wrapper.setAttribute("translate","no"),f&&d<8&&(u.gutters.style.zIndex=-1,u.scroller.style.paddingRight=0),!g&&!(i&&S)&&(u.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(u.wrapper):e(u.wrapper)),u.viewFrom=u.viewTo=r.first,u.reportedViewFrom=u.reportedViewTo=r.first,u.view=[],u.renderedView=null,u.externalMeasured=null,u.viewOffset=0,u.lastWrapHeight=u.lastWrapWidth=0,u.updateLineNumbers=null,u.nativeBarWidth=u.barHeight=u.barWidth=0,u.scrollbarsClipped=!1,u.lineNumWidth=u.lineNumInnerWidth=u.lineNumChars=null,u.alignWidgets=!1,u.cachedCharWidth=u.cachedTextHeight=u.cachedPaddingH=null,u.maxLine=null,u.maxLineLength=0,u.maxLineChanged=!1,u.wheelDX=u.wheelDY=u.wheelStartX=u.wheelStartY=null,u.shift=!1,u.selForContextMenu=null,u.activeTouch=null,u.gutterSpecs=Va(s.gutters,s.lineNumbers),Tf(u),a.init(u)}var os=0,Dn=null;f?Dn=-.53:i?Dn=15:b?Dn=-.7:C&&(Dn=-1/3);function Af(e){var r=e.wheelDeltaX,a=e.wheelDeltaY;return r==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(r=e.detail),a==null&&e.detail&&e.axis==e.VERTICAL_AXIS?a=e.detail:a==null&&(a=e.wheelDelta),{x:r,y:a}}function Yv(e){var r=Af(e);return r.x*=Dn,r.y*=Dn,r}function Ef(e,r){var a=Af(r),s=a.x,u=a.y,p=Dn;r.deltaMode===0&&(s=r.deltaX,u=r.deltaY,p=1);var h=e.display,m=h.scroller,v=m.scrollWidth>m.clientWidth,w=m.scrollHeight>m.clientHeight;if(s&&v||u&&w){if(u&&T&&g){e:for(var P=r.target,R=h.view;P!=m;P=P.parentNode)for(var q=0;q<R.length;q++)if(R[q].node==P){e.display.currentWheelTarget=P;break e}}if(s&&!i&&!k&&p!=null){u&&w&&ji(e,Math.max(0,m.scrollTop+u*p)),ar(e,Math.max(0,m.scrollLeft+s*p)),(!u||u&&w)&&dt(r),h.wheelStartX=null;return}if(u&&p!=null){var F=u*p,K=e.doc.scrollTop,Z=K+h.wrapper.clientHeight;F<0?K=Math.max(0,K+F-50):Z=Math.min(e.doc.height,Z+F+50),_a(e,{top:K,bottom:Z})}os<20&&r.deltaMode!==0&&(h.wheelStartX==null?(h.wheelStartX=m.scrollLeft,h.wheelStartY=m.scrollTop,h.wheelDX=s,h.wheelDY=u,setTimeout(function(){if(h.wheelStartX!=null){var oe=m.scrollLeft-h.wheelStartX,le=m.scrollTop-h.wheelStartY,ce=le&&h.wheelDY&&le/h.wheelDY||oe&&h.wheelDX&&oe/h.wheelDX;h.wheelStartX=h.wheelStartY=null,ce&&(Dn=(Dn*os+ce)/(os+1),++os)}},200)):(h.wheelDX+=s,h.wheelDY+=u))}}var Kt=function(e,r){this.ranges=e,this.primIndex=r};Kt.prototype.primary=function(){return this.ranges[this.primIndex]},Kt.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var r=0;r<this.ranges.length;r++){var a=this.ranges[r],s=e.ranges[r];if(!B(a.anchor,s.anchor)||!B(a.head,s.head))return!1}return!0},Kt.prototype.deepCopy=function(){for(var e=[],r=0;r<this.ranges.length;r++)e[r]=new Re(J(this.ranges[r].anchor),J(this.ranges[r].head));return new Kt(e,this.primIndex)},Kt.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Kt.prototype.contains=function(e,r){r||(r=e);for(var a=0;a<this.ranges.length;a++){var s=this.ranges[a];if(x(r,s.from())>=0&&x(e,s.to())<=0)return a}return-1};var Re=function(e,r){this.anchor=e,this.head=r};Re.prototype.from=function(){return Te(this.anchor,this.head)},Re.prototype.to=function(){return re(this.anchor,this.head)},Re.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function an(e,r,a){var s=e&&e.options.selectionsMayTouch,u=r[a];r.sort(function(q,F){return x(q.from(),F.from())}),a=V(r,u);for(var p=1;p<r.length;p++){var h=r[p],m=r[p-1],v=x(m.to(),h.from());if(s&&!h.empty()?v>0:v>=0){var w=Te(m.from(),h.from()),P=re(m.to(),h.to()),R=m.empty()?h.from()==h.head:m.from()==m.head;p<=a&&--a,r.splice(--p,2,new Re(R?P:w,R?w:P))}}return new Kt(r,a)}function _n(e,r){return new Kt([new Re(e,r||e)],0)}function qn(e){return e.text?ne(e.from.line+e.text.length-1,Ee(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function Lf(e,r){if(x(e,r.from)<0)return e;if(x(e,r.to)<=0)return qn(r);var a=e.line+r.text.length-(r.to.line-r.from.line)-1,s=e.ch;return e.line==r.to.line&&(s+=qn(r).ch-r.to.ch),ne(a,s)}function Ua(e,r){for(var a=[],s=0;s<e.sel.ranges.length;s++){var u=e.sel.ranges[s];a.push(new Re(Lf(u.anchor,r),Lf(u.head,r)))}return an(e.cm,a,e.sel.primIndex)}function Mf(e,r,a){return e.line==r.line?ne(a.line,e.ch-r.ch+a.ch):ne(a.line+(e.line-r.line),e.ch)}function Qv(e,r,a){for(var s=[],u=ne(e.first,0),p=u,h=0;h<r.length;h++){var m=r[h],v=Mf(m.from,u,p),w=Mf(qn(m),u,p);if(u=m.to,p=w,a=="around"){var P=e.sel.ranges[h],R=x(P.head,P.anchor)<0;s[h]=new Re(R?w:v,R?v:w)}else s[h]=new Re(v,v)}return new Kt(s,e.sel.primIndex)}function $a(e){e.doc.mode=Nr(e.options,e.doc.modeOption),qi(e)}function qi(e){e.doc.iter(function(r){r.stateAfter&&(r.stateAfter=null),r.styles&&(r.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Hi(e,100),e.state.modeGen++,e.curOp&&Tt(e)}function Df(e,r){return r.from.ch==0&&r.to.ch==0&&Ee(r.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ga(e,r,a,s){function u(ce){return a?a[ce]:null}function p(ce,ue,pe){iv(ce,ue,pe,s),ot(ce,"change",ce,r)}function h(ce,ue){for(var pe=[],be=ce;be<ue;++be)pe.push(new Rr(w[be],u(be),s));return pe}var m=r.from,v=r.to,w=r.text,P=he(e,m.line),R=he(e,v.line),q=Ee(w),F=u(w.length-1),K=v.line-m.line;if(r.full)e.insert(0,h(0,w.length)),e.remove(w.length,e.size-w.length);else if(Df(e,r)){var Z=h(0,w.length-1);p(R,R.text,F),K&&e.remove(m.line,K),Z.length&&e.insert(m.line,Z)}else if(P==R)if(w.length==1)p(P,P.text.slice(0,m.ch)+q+P.text.slice(v.ch),F);else{var oe=h(1,w.length-1);oe.push(new Rr(q+P.text.slice(v.ch),F,s)),p(P,P.text.slice(0,m.ch)+w[0],u(0)),e.insert(m.line+1,oe)}else if(w.length==1)p(P,P.text.slice(0,m.ch)+w[0]+R.text.slice(v.ch),u(0)),e.remove(m.line+1,K);else{p(P,P.text.slice(0,m.ch)+w[0],u(0)),p(R,q+R.text.slice(v.ch),F);var le=h(1,w.length-1);K>1&&e.remove(m.line+1,K-1),e.insert(m.line+1,le)}ot(e,"change",e,r)}function Wn(e,r,a){function s(u,p,h){if(u.linked)for(var m=0;m<u.linked.length;++m){var v=u.linked[m];if(v.doc!=p){var w=h&&v.sharedHist;a&&!w||(r(v.doc,w),s(v.doc,u,w))}}}s(e,null,!0)}function Of(e,r){if(r.cm)throw new Error("This document is already in use.");e.doc=r,r.cm=e,Na(e),$a(e),Pf(e),e.options.direction=r.direction,e.options.lineWrapping||ka(e),e.options.mode=r.modeOption,Tt(e)}function Pf(e){(e.doc.direction=="rtl"?De:H)(e.display.lineDiv,"CodeMirror-rtl")}function Jv(e){It(e,function(){Pf(e),Tt(e)})}function ss(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Ka(e,r){var a={from:J(r.from),to:qn(r),text:vn(e,r.from,r.to)};return Rf(e,a,r.from.line,r.to.line+1),Wn(e,function(s){return Rf(s,a,r.from.line,r.to.line+1)},!0),a}function Nf(e){for(;e.length;){var r=Ee(e);if(r.ranges)e.pop();else break}}function Zv(e,r){if(r)return Nf(e.done),Ee(e.done);if(e.done.length&&!Ee(e.done).ranges)return Ee(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),Ee(e.done)}function If(e,r,a,s){var u=e.history;u.undone.length=0;var p=+new Date,h,m;if((u.lastOp==s||u.lastOrigin==r.origin&&r.origin&&(r.origin.charAt(0)=="+"&&u.lastModTime>p-(e.cm?e.cm.options.historyEventDelay:500)||r.origin.charAt(0)=="*"))&&(h=Zv(u,u.lastOp==s)))m=Ee(h.changes),x(r.from,r.to)==0&&x(r.from,m.to)==0?m.to=qn(r):h.changes.push(Ka(e,r));else{var v=Ee(u.done);for((!v||!v.ranges)&&as(e.sel,u.done),h={changes:[Ka(e,r)],generation:u.generation},u.done.push(h);u.done.length>u.undoDepth;)u.done.shift(),u.done[0].ranges||u.done.shift()}u.done.push(a),u.generation=++u.maxGeneration,u.lastModTime=u.lastSelTime=p,u.lastOp=u.lastSelOp=s,u.lastOrigin=u.lastSelOrigin=r.origin,m||Se(e,"historyAdded")}function Xv(e,r,a,s){var u=r.charAt(0);return u=="*"||u=="+"&&a.ranges.length==s.ranges.length&&a.somethingSelected()==s.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function eb(e,r,a,s){var u=e.history,p=s&&s.origin;a==u.lastSelOp||p&&u.lastSelOrigin==p&&(u.lastModTime==u.lastSelTime&&u.lastOrigin==p||Xv(e,p,Ee(u.done),r))?u.done[u.done.length-1]=r:as(r,u.done),u.lastSelTime=+new Date,u.lastSelOrigin=p,u.lastSelOp=a,s&&s.clearRedo!==!1&&Nf(u.undone)}function as(e,r){var a=Ee(r);a&&a.ranges&&a.equals(e)||r.push(e)}function Rf(e,r,a,s){var u=r["spans_"+e.id],p=0;e.iter(Math.max(e.first,a),Math.min(e.first+e.size,s),function(h){h.markedSpans&&((u||(u=r["spans_"+e.id]={}))[p]=h.markedSpans),++p})}function tb(e){if(!e)return null;for(var r,a=0;a<e.length;++a)e[a].marker.explicitlyCleared?r||(r=e.slice(0,a)):r&&r.push(e[a]);return r?r.length?r:null:e}function nb(e,r){var a=r["spans_"+e.id];if(!a)return null;for(var s=[],u=0;u<r.text.length;++u)s.push(tb(a[u]));return s}function Bf(e,r){var a=nb(e,r),s=va(e,r);if(!a)return s;if(!s)return a;for(var u=0;u<a.length;++u){var p=a[u],h=s[u];if(p&&h)e:for(var m=0;m<h.length;++m){for(var v=h[m],w=0;w<p.length;++w)if(p[w].marker==v.marker)continue e;p.push(v)}else h&&(a[u]=h)}return a}function Wr(e,r,a){for(var s=[],u=0;u<e.length;++u){var p=e[u];if(p.ranges){s.push(a?Kt.prototype.deepCopy.call(p):p);continue}var h=p.changes,m=[];s.push({changes:m});for(var v=0;v<h.length;++v){var w=h[v],P=void 0;if(m.push({from:w.from,to:w.to,text:w.text}),r)for(var R in w)(P=R.match(/^spans_(\d+)$/))&&V(r,Number(P[1]))>-1&&(Ee(m)[R]=w[R],delete w[R])}}return s}function Ya(e,r,a,s){if(s){var u=e.anchor;if(a){var p=x(r,u)<0;p!=x(a,u)<0?(u=r,r=a):p!=x(r,a)<0&&(r=a)}return new Re(u,r)}else return new Re(a||r,r)}function ls(e,r,a,s,u){u==null&&(u=e.cm&&(e.cm.display.shift||e.extend)),ht(e,new Kt([Ya(e.sel.primary(),r,a,u)],0),s)}function jf(e,r,a){for(var s=[],u=e.cm&&(e.cm.display.shift||e.extend),p=0;p<e.sel.ranges.length;p++)s[p]=Ya(e.sel.ranges[p],r[p],null,u);var h=an(e.cm,s,e.sel.primIndex);ht(e,h,a)}function Qa(e,r,a,s){var u=e.sel.ranges.slice(0);u[r]=a,ht(e,an(e.cm,u,e.sel.primIndex),s)}function zf(e,r,a,s){ht(e,_n(r,a),s)}function rb(e,r,a){var s={ranges:r.ranges,update:function(u){this.ranges=[];for(var p=0;p<u.length;p++)this.ranges[p]=new Re(fe(e,u[p].anchor),fe(e,u[p].head))},origin:a&&a.origin};return Se(e,"beforeSelectionChange",e,s),e.cm&&Se(e.cm,"beforeSelectionChange",e.cm,s),s.ranges!=r.ranges?an(e.cm,s.ranges,s.ranges.length-1):r}function Ff(e,r,a){var s=e.history.done,u=Ee(s);u&&u.ranges?(s[s.length-1]=r,us(e,r,a)):ht(e,r,a)}function ht(e,r,a){us(e,r,a),eb(e,e.sel,e.cm?e.cm.curOp.id:NaN,a)}function us(e,r,a){(ct(e,"beforeSelectionChange")||e.cm&&ct(e.cm,"beforeSelectionChange"))&&(r=rb(e,r,a));var s=a&&a.bias||(x(r.primary().head,e.sel.primary().head)<0?-1:1);Hf(e,qf(e,r,s,!0)),!(a&&a.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&_r(e.cm)}function Hf(e,r){r.equals(e.sel)||(e.sel=r,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Dr(e.cm)),ot(e,"cursorActivity",e))}function _f(e){Hf(e,qf(e,e.sel,null,!1))}function qf(e,r,a,s){for(var u,p=0;p<r.ranges.length;p++){var h=r.ranges[p],m=r.ranges.length==e.sel.ranges.length&&e.sel.ranges[p],v=cs(e,h.anchor,m&&m.anchor,a,s),w=cs(e,h.head,m&&m.head,a,s);(u||v!=h.anchor||w!=h.head)&&(u||(u=r.ranges.slice(0,p)),u[p]=new Re(v,w))}return u?an(e.cm,u,r.primIndex):r}function Vr(e,r,a,s,u){var p=he(e,r.line);if(p.markedSpans)for(var h=0;h<p.markedSpans.length;++h){var m=p.markedSpans[h],v=m.marker,w="selectLeft"in v?!v.selectLeft:v.inclusiveLeft,P="selectRight"in v?!v.selectRight:v.inclusiveRight;if((m.from==null||(w?m.from<=r.ch:m.from<r.ch))&&(m.to==null||(P?m.to>=r.ch:m.to>r.ch))){if(u&&(Se(v,"beforeCursorEnter"),v.explicitlyCleared))if(p.markedSpans){--h;continue}else break;if(!v.atomic)continue;if(a){var R=v.find(s<0?1:-1),q=void 0;if((s<0?P:w)&&(R=Wf(e,R,-s,R&&R.line==r.line?p:null)),R&&R.line==r.line&&(q=x(R,a))&&(s<0?q<0:q>0))return Vr(e,R,r,s,u)}var F=v.find(s<0?-1:1);return(s<0?w:P)&&(F=Wf(e,F,s,F.line==r.line?p:null)),F?Vr(e,F,r,s,u):null}}return r}function cs(e,r,a,s,u){var p=s||1,h=Vr(e,r,a,p,u)||!u&&Vr(e,r,a,p,!0)||Vr(e,r,a,-p,u)||!u&&Vr(e,r,a,-p,!0);return h||(e.cantEdit=!0,ne(e.first,0))}function Wf(e,r,a,s){return a<0&&r.ch==0?r.line>e.first?fe(e,ne(r.line-1)):null:a>0&&r.ch==(s||he(e,r.line)).text.length?r.line<e.first+e.size-1?ne(r.line+1,0):null:new ne(r.line,r.ch+a)}function Vf(e){e.setSelection(ne(e.firstLine(),0),ne(e.lastLine()),me)}function Uf(e,r,a){var s={canceled:!1,from:r.from,to:r.to,text:r.text,origin:r.origin,cancel:function(){return s.canceled=!0}};return a&&(s.update=function(u,p,h,m){u&&(s.from=fe(e,u)),p&&(s.to=fe(e,p)),h&&(s.text=h),m!==void 0&&(s.origin=m)}),Se(e,"beforeChange",e,s),e.cm&&Se(e.cm,"beforeChange",e.cm,s),s.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:s.from,to:s.to,text:s.text,origin:s.origin}}function Ur(e,r,a){if(e.cm){if(!e.cm.curOp)return st(e.cm,Ur)(e,r,a);if(e.cm.state.suppressEdits)return}if(!((ct(e,"beforeChange")||e.cm&&ct(e.cm,"beforeChange"))&&(r=Uf(e,r,!0),!r))){var s=Rc&&!a&&ev(e,r.from,r.to);if(s)for(var u=s.length-1;u>=0;--u)$f(e,{from:s[u].from,to:s[u].to,text:u?[""]:r.text,origin:r.origin});else $f(e,r)}}function $f(e,r){if(!(r.text.length==1&&r.text[0]==""&&x(r.from,r.to)==0)){var a=Ua(e,r);If(e,r,a,e.cm?e.cm.curOp.id:NaN),Wi(e,r,a,va(e,r));var s=[];Wn(e,function(u,p){!p&&V(s,u.history)==-1&&(Qf(u.history,r),s.push(u.history)),Wi(u,r,null,va(u,r))})}}function fs(e,r,a){var s=e.cm&&e.cm.state.suppressEdits;if(!(s&&!a)){for(var u=e.history,p,h=e.sel,m=r=="undo"?u.done:u.undone,v=r=="undo"?u.undone:u.done,w=0;w<m.length&&(p=m[w],!(a?p.ranges&&!p.equals(e.sel):!p.ranges));w++);if(w!=m.length){for(u.lastOrigin=u.lastSelOrigin=null;;)if(p=m.pop(),p.ranges){if(as(p,v),a&&!p.equals(e.sel)){ht(e,p,{clearRedo:!1});return}h=p}else if(s){m.push(p);return}else break;var P=[];as(h,v),v.push({changes:P,generation:u.generation}),u.generation=p.generation||++u.maxGeneration;for(var R=ct(e,"beforeChange")||e.cm&&ct(e.cm,"beforeChange"),q=function(Z){var oe=p.changes[Z];if(oe.origin=r,R&&!Uf(e,oe,!1))return m.length=0,{};P.push(Ka(e,oe));var le=Z?Ua(e,oe):Ee(m);Wi(e,oe,le,Bf(e,oe)),!Z&&e.cm&&e.cm.scrollIntoView({from:oe.from,to:qn(oe)});var ce=[];Wn(e,function(ue,pe){!pe&&V(ce,ue.history)==-1&&(Qf(ue.history,oe),ce.push(ue.history)),Wi(ue,oe,null,Bf(ue,oe))})},F=p.changes.length-1;F>=0;--F){var K=q(F);if(K)return K.v}}}}function Gf(e,r){if(r!=0&&(e.first+=r,e.sel=new Kt(Pe(e.sel.ranges,function(u){return new Re(ne(u.anchor.line+r,u.anchor.ch),ne(u.head.line+r,u.head.ch))}),e.sel.primIndex),e.cm)){Tt(e.cm,e.first,e.first-r,r);for(var a=e.cm.display,s=a.viewFrom;s<a.viewTo;s++)Fn(e.cm,s,"gutter")}}function Wi(e,r,a,s){if(e.cm&&!e.cm.curOp)return st(e.cm,Wi)(e,r,a,s);if(r.to.line<e.first){Gf(e,r.text.length-1-(r.to.line-r.from.line));return}if(!(r.from.line>e.lastLine())){if(r.from.line<e.first){var u=r.text.length-1-(e.first-r.from.line);Gf(e,u),r={from:ne(e.first,0),to:ne(r.to.line+u,r.to.ch),text:[Ee(r.text)],origin:r.origin}}var p=e.lastLine();r.to.line>p&&(r={from:r.from,to:ne(p,he(e,p).text.length),text:[r.text[0]],origin:r.origin}),r.removed=vn(e,r.from,r.to),a||(a=Ua(e,r)),e.cm?ib(e.cm,r,s):Ga(e,r,s),us(e,a,me),e.cantEdit&&cs(e,ne(e.firstLine(),0))&&(e.cantEdit=!1)}}function ib(e,r,a){var s=e.doc,u=e.display,p=r.from,h=r.to,m=!1,v=p.line;e.options.lineWrapping||(v=Ie(on(he(s,p.line))),s.iter(v,h.line+1,function(F){if(F==u.maxLine)return m=!0,!0})),s.sel.contains(r.from,r.to)>-1&&Dr(e),Ga(s,r,a,df(e)),e.options.lineWrapping||(s.iter(v,p.line+r.text.length,function(F){var K=Ko(F);K>u.maxLineLength&&(u.maxLine=F,u.maxLineLength=K,u.maxLineChanged=!0,m=!1)}),m&&(e.curOp.updateMaxLine=!0)),Gy(s,p.line),Hi(e,400);var w=r.text.length-(h.line-p.line)-1;r.full?Tt(e):p.line==h.line&&r.text.length==1&&!Df(e.doc,r)?Fn(e,p.line,"text"):Tt(e,p.line,h.line+1,w);var P=ct(e,"changes"),R=ct(e,"change");if(R||P){var q={from:p,to:h,text:r.text,removed:r.removed,origin:r.origin};R&&ot(e,"change",e,q),P&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(q)}e.display.selForContextMenu=null}function $r(e,r,a,s,u){var p;s||(s=a),x(s,a)<0&&(p=[s,a],a=p[0],s=p[1]),typeof r=="string"&&(r=e.splitLines(r)),Ur(e,{from:a,to:s,text:r,origin:u})}function Kf(e,r,a,s){a<e.line?e.line+=s:r<e.line&&(e.line=r,e.ch=0)}function Yf(e,r,a,s){for(var u=0;u<e.length;++u){var p=e[u],h=!0;if(p.ranges){p.copied||(p=e[u]=p.deepCopy(),p.copied=!0);for(var m=0;m<p.ranges.length;m++)Kf(p.ranges[m].anchor,r,a,s),Kf(p.ranges[m].head,r,a,s);continue}for(var v=0;v<p.changes.length;++v){var w=p.changes[v];if(a<w.from.line)w.from=ne(w.from.line+s,w.from.ch),w.to=ne(w.to.line+s,w.to.ch);else if(r<=w.to.line){h=!1;break}}h||(e.splice(0,u+1),u=0)}}function Qf(e,r){var a=r.from.line,s=r.to.line,u=r.text.length-(s-a)-1;Yf(e.done,a,s,u),Yf(e.undone,a,s,u)}function Vi(e,r,a,s){var u=r,p=r;return typeof r=="number"?p=he(e,Ne(e,r)):u=Ie(r),u==null?null:(s(p,u)&&e.cm&&Fn(e.cm,u,a),p)}function Ui(e){this.lines=e,this.parent=null;for(var r=0,a=0;a<e.length;++a)e[a].parent=this,r+=e[a].height;this.height=r}Ui.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,r){for(var a=e,s=e+r;a<s;++a){var u=this.lines[a];this.height-=u.height,ov(u),ot(u,"delete")}this.lines.splice(e,r)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,r,a){this.height+=a,this.lines=this.lines.slice(0,e).concat(r).concat(this.lines.slice(e));for(var s=0;s<r.length;++s)r[s].parent=this},iterN:function(e,r,a){for(var s=e+r;e<s;++e)if(a(this.lines[e]))return!0}};function $i(e){this.children=e;for(var r=0,a=0,s=0;s<e.length;++s){var u=e[s];r+=u.chunkSize(),a+=u.height,u.parent=this}this.size=r,this.height=a,this.parent=null}$i.prototype={chunkSize:function(){return this.size},removeInner:function(e,r){this.size-=r;for(var a=0;a<this.children.length;++a){var s=this.children[a],u=s.chunkSize();if(e<u){var p=Math.min(r,u-e),h=s.height;if(s.removeInner(e,p),this.height-=h-s.height,u==p&&(this.children.splice(a--,1),s.parent=null),(r-=p)==0)break;e=0}else e-=u}if(this.size-r<25&&(this.children.length>1||!(this.children[0]instanceof Ui))){var m=[];this.collapse(m),this.children=[new Ui(m)],this.children[0].parent=this}},collapse:function(e){for(var r=0;r<this.children.length;++r)this.children[r].collapse(e)},insertInner:function(e,r,a){this.size+=r.length,this.height+=a;for(var s=0;s<this.children.length;++s){var u=this.children[s],p=u.chunkSize();if(e<=p){if(u.insertInner(e,r,a),u.lines&&u.lines.length>50){for(var h=u.lines.length%25+25,m=h;m<u.lines.length;){var v=new Ui(u.lines.slice(m,m+=25));u.height-=v.height,this.children.splice(++s,0,v),v.parent=this}u.lines=u.lines.slice(0,h),this.maybeSpill()}break}e-=p}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var r=e.children.splice(e.children.length-5,5),a=new $i(r);if(e.parent){e.size-=a.size,e.height-=a.height;var u=V(e.parent.children,e);e.parent.children.splice(u+1,0,a)}else{var s=new $i(e.children);s.parent=e,e.children=[s,a],e=s}a.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,r,a){for(var s=0;s<this.children.length;++s){var u=this.children[s],p=u.chunkSize();if(e<p){var h=Math.min(r,p-e);if(u.iterN(e,h,a))return!0;if((r-=h)==0)break;e=0}else e-=p}}};var Gi=function(e,r,a){if(a)for(var s in a)a.hasOwnProperty(s)&&(this[s]=a[s]);this.doc=e,this.node=r};Gi.prototype.clear=function(){var e=this.doc.cm,r=this.line.widgets,a=this.line,s=Ie(a);if(!(s==null||!r)){for(var u=0;u<r.length;++u)r[u]==this&&r.splice(u--,1);r.length||(a.widgets=null);var p=Ni(this);Nt(a,Math.max(0,a.height-p)),e&&(It(e,function(){Jf(e,a,-p),Fn(e,s,"widget")}),ot(e,"lineWidgetCleared",e,this,s))}},Gi.prototype.changed=function(){var e=this,r=this.height,a=this.doc.cm,s=this.line;this.height=null;var u=Ni(this)-r;u&&(zn(this.doc,s)||Nt(s,s.height+u),a&&It(a,function(){a.curOp.forceUpdate=!0,Jf(a,s,u),ot(a,"lineWidgetChanged",a,e,Ie(s))}))},mn(Gi);function Jf(e,r,a){Ln(r)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Fa(e,a)}function ob(e,r,a,s){var u=new Gi(e,a,s),p=e.cm;return p&&u.noHScroll&&(p.display.alignWidgets=!0),Vi(e,r,"widget",function(h){var m=h.widgets||(h.widgets=[]);if(u.insertAt==null?m.push(u):m.splice(Math.min(m.length,Math.max(0,u.insertAt)),0,u),u.line=h,p&&!zn(e,h)){var v=Ln(h)<e.scrollTop;Nt(h,h.height+Ni(u)),v&&Fa(p,u.height),p.curOp.forceUpdate=!0}return!0}),p&&ot(p,"lineWidgetAdded",p,u,typeof r=="number"?r:Ie(r)),u}var Zf=0,Vn=function(e,r){this.lines=[],this.type=r,this.doc=e,this.id=++Zf};Vn.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,r=e&&!e.curOp;if(r&&ur(e),ct(this,"clear")){var a=this.find();a&&ot(this,"clear",a.from,a.to)}for(var s=null,u=null,p=0;p<this.lines.length;++p){var h=this.lines[p],m=Di(h.markedSpans,this);e&&!this.collapsed?Fn(e,Ie(h),"text"):e&&(m.to!=null&&(u=Ie(h)),m.from!=null&&(s=Ie(h))),h.markedSpans=Qy(h.markedSpans,m),m.from==null&&this.collapsed&&!zn(this.doc,h)&&e&&Nt(h,zr(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var v=0;v<this.lines.length;++v){var w=on(this.lines[v]),P=Ko(w);P>e.display.maxLineLength&&(e.display.maxLine=w,e.display.maxLineLength=P,e.display.maxLineChanged=!0)}s!=null&&e&&this.collapsed&&Tt(e,s,u+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&_f(e.doc)),e&&ot(e,"markerCleared",e,this,s,u),r&&cr(e),this.parent&&this.parent.clear()}},Vn.prototype.find=function(e,r){e==null&&this.type=="bookmark"&&(e=1);for(var a,s,u=0;u<this.lines.length;++u){var p=this.lines[u],h=Di(p.markedSpans,this);if(h.from!=null&&(a=ne(r?p:Ie(p),h.from),e==-1))return a;if(h.to!=null&&(s=ne(r?p:Ie(p),h.to),e==1))return s}return a&&{from:a,to:s}},Vn.prototype.changed=function(){var e=this,r=this.find(-1,!0),a=this,s=this.doc.cm;!r||!s||It(s,function(){var u=r.line,p=Ie(r.line),h=Aa(s,p);if(h&&(rf(h),s.curOp.selectionChanged=s.curOp.forceUpdate=!0),s.curOp.updateMaxLine=!0,!zn(a.doc,u)&&a.height!=null){var m=a.height;a.height=null;var v=Ni(a)-m;v&&Nt(u,u.height+v)}ot(s,"markerChanged",s,e)})},Vn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(!r.maybeHiddenMarkers||V(r.maybeHiddenMarkers,this)==-1)&&(r.maybeUnhiddenMarkers||(r.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Vn.prototype.detachLine=function(e){if(this.lines.splice(V(this.lines,e),1),!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(r.maybeHiddenMarkers||(r.maybeHiddenMarkers=[])).push(this)}},mn(Vn);function Gr(e,r,a,s,u){if(s&&s.shared)return sb(e,r,a,s,u);if(e.cm&&!e.cm.curOp)return st(e.cm,Gr)(e,r,a,s,u);var p=new Vn(e,u),h=x(r,a);if(s&&Ue(s,p,!1),h>0||h==0&&p.clearWhenEmpty!==!1)return p;if(p.replacedWith&&(p.collapsed=!0,p.widgetNode=D("span",[p.replacedWith],"CodeMirror-widget"),s.handleMouseEvents||p.widgetNode.setAttribute("cm-ignore-events","true"),s.insertLeft&&(p.widgetNode.insertLeft=!0)),p.collapsed){if(_c(e,r.line,r,a,p)||r.line!=a.line&&_c(e,a.line,r,a,p))throw new Error("Inserting collapsed marker partially overlapping an existing one");Yy()}p.addToHistory&&If(e,{from:r,to:a,origin:"markText"},e.sel,NaN);var m=r.line,v=e.cm,w;if(e.iter(m,a.line+1,function(R){v&&p.collapsed&&!v.options.lineWrapping&&on(R)==v.display.maxLine&&(w=!0),p.collapsed&&m!=r.line&&Nt(R,0),Jy(R,new Vo(p,m==r.line?r.ch:null,m==a.line?a.ch:null),e.cm&&e.cm.curOp),++m}),p.collapsed&&e.iter(r.line,a.line+1,function(R){zn(e,R)&&Nt(R,0)}),p.clearOnEnter&&we(p,"beforeCursorEnter",function(){return p.clear()}),p.readOnly&&(Ky(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),p.collapsed&&(p.id=++Zf,p.atomic=!0),v){if(w&&(v.curOp.updateMaxLine=!0),p.collapsed)Tt(v,r.line,a.line+1);else if(p.className||p.startStyle||p.endStyle||p.css||p.attributes||p.title)for(var P=r.line;P<=a.line;P++)Fn(v,P,"text");p.atomic&&_f(v.doc),ot(v,"markerAdded",v,p)}return p}var Ki=function(e,r){this.markers=e,this.primary=r;for(var a=0;a<e.length;++a)e[a].parent=this};Ki.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ot(this,"clear")}},Ki.prototype.find=function(e,r){return this.primary.find(e,r)},mn(Ki);function sb(e,r,a,s,u){s=Ue(s),s.shared=!1;var p=[Gr(e,r,a,s,u)],h=p[0],m=s.widgetNode;return Wn(e,function(v){m&&(s.widgetNode=m.cloneNode(!0)),p.push(Gr(v,fe(v,r),fe(v,a),s,u));for(var w=0;w<v.linked.length;++w)if(v.linked[w].isParent)return;h=Ee(p)}),new Ki(p,h)}function Xf(e){return e.findMarks(ne(e.first,0),e.clipPos(ne(e.lastLine())),function(r){return r.parent})}function ab(e,r){for(var a=0;a<r.length;a++){var s=r[a],u=s.find(),p=e.clipPos(u.from),h=e.clipPos(u.to);if(x(p,h)){var m=Gr(e,p,h,s.primary,s.primary.type);s.markers.push(m),m.parent=s}}}function lb(e){for(var r=function(s){var u=e[s],p=[u.primary.doc];Wn(u.primary.doc,function(v){return p.push(v)});for(var h=0;h<u.markers.length;h++){var m=u.markers[h];V(p,m.doc)==-1&&(m.parent=null,u.markers.splice(h--,1))}},a=0;a<e.length;a++)r(a)}var ub=0,At=function(e,r,a,s,u){if(!(this instanceof At))return new At(e,r,a,s,u);a==null&&(a=0),$i.call(this,[new Ui([new Rr("",null)])]),this.first=a,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=a;var p=ne(a,0);this.sel=_n(p),this.history=new ss(null),this.id=++ub,this.modeOption=r,this.lineSep=s,this.direction=u=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),Ga(this,{from:p,to:p,text:e}),ht(this,_n(p),me)};At.prototype=Zt($i.prototype,{constructor:At,iter:function(e,r,a){a?this.iterN(e-this.first,r-e,a):this.iterN(this.first,this.first+this.size,e)},insert:function(e,r){for(var a=0,s=0;s<r.length;++s)a+=r[s].height;this.insertInner(e-this.first,r,a)},remove:function(e,r){this.removeInner(e-this.first,r)},getValue:function(e){var r=Ei(this,this.first,this.first+this.size);return e===!1?r:r.join(e||this.lineSeparator())},setValue:at(function(e){var r=ne(this.first,0),a=this.first+this.size-1;Ur(this,{from:r,to:ne(a,he(this,a).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Bi(this.cm,0,0),ht(this,_n(r),me)}),replaceRange:function(e,r,a,s){r=fe(this,r),a=a?fe(this,a):r,$r(this,e,r,a,s)},getRange:function(e,r,a){var s=vn(this,fe(this,e),fe(this,r));return a===!1?s:a===""?s.join(""):s.join(a||this.lineSeparator())},getLine:function(e){var r=this.getLineHandle(e);return r&&r.text},getLineHandle:function(e){if(nr(this,e))return he(this,e)},getLineNumber:function(e){return Ie(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=he(this,e)),on(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return fe(this,e)},getCursor:function(e){var r=this.sel.primary(),a;return e==null||e=="head"?a=r.head:e=="anchor"?a=r.anchor:e=="end"||e=="to"||e===!1?a=r.to():a=r.from(),a},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:at(function(e,r,a){zf(this,fe(this,typeof e=="number"?ne(e,r||0):e),null,a)}),setSelection:at(function(e,r,a){zf(this,fe(this,e),fe(this,r||e),a)}),extendSelection:at(function(e,r,a){ls(this,fe(this,e),r&&fe(this,r),a)}),extendSelections:at(function(e,r){jf(this,Gt(this,e),r)}),extendSelectionsBy:at(function(e,r){var a=Pe(this.sel.ranges,e);jf(this,Gt(this,a),r)}),setSelections:at(function(e,r,a){if(e.length){for(var s=[],u=0;u<e.length;u++)s[u]=new Re(fe(this,e[u].anchor),fe(this,e[u].head||e[u].anchor));r==null&&(r=Math.min(e.length-1,this.sel.primIndex)),ht(this,an(this.cm,s,r),a)}}),addSelection:at(function(e,r,a){var s=this.sel.ranges.slice(0);s.push(new Re(fe(this,e),fe(this,r||e))),ht(this,an(this.cm,s,s.length-1),a)}),getSelection:function(e){for(var r=this.sel.ranges,a,s=0;s<r.length;s++){var u=vn(this,r[s].from(),r[s].to());a=a?a.concat(u):u}return e===!1?a:a.join(e||this.lineSeparator())},getSelections:function(e){for(var r=[],a=this.sel.ranges,s=0;s<a.length;s++){var u=vn(this,a[s].from(),a[s].to());e!==!1&&(u=u.join(e||this.lineSeparator())),r[s]=u}return r},replaceSelection:function(e,r,a){for(var s=[],u=0;u<this.sel.ranges.length;u++)s[u]=e;this.replaceSelections(s,r,a||"+input")},replaceSelections:at(function(e,r,a){for(var s=[],u=this.sel,p=0;p<u.ranges.length;p++){var h=u.ranges[p];s[p]={from:h.from(),to:h.to(),text:this.splitLines(e[p]),origin:a}}for(var m=r&&r!="end"&&Qv(this,s,r),v=s.length-1;v>=0;v--)Ur(this,s[v]);m?Ff(this,m):this.cm&&_r(this.cm)}),undo:at(function(){fs(this,"undo")}),redo:at(function(){fs(this,"redo")}),undoSelection:at(function(){fs(this,"undo",!0)}),redoSelection:at(function(){fs(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,r=0,a=0,s=0;s<e.done.length;s++)e.done[s].ranges||++r;for(var u=0;u<e.undone.length;u++)e.undone[u].ranges||++a;return{undo:r,redo:a}},clearHistory:function(){var e=this;this.history=new ss(this.history),Wn(this,function(r){return r.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Wr(this.history.done),undone:Wr(this.history.undone)}},setHistory:function(e){var r=this.history=new ss(this.history);r.done=Wr(e.done.slice(0),null,!0),r.undone=Wr(e.undone.slice(0),null,!0)},setGutterMarker:at(function(e,r,a){return Vi(this,e,"gutter",function(s){var u=s.gutterMarkers||(s.gutterMarkers={});return u[r]=a,!a&&se(u)&&(s.gutterMarkers=null),!0})}),clearGutter:at(function(e){var r=this;this.iter(function(a){a.gutterMarkers&&a.gutterMarkers[e]&&Vi(r,a,"gutter",function(){return a.gutterMarkers[e]=null,se(a.gutterMarkers)&&(a.gutterMarkers=null),!0})})}),lineInfo:function(e){var r;if(typeof e=="number"){if(!nr(this,e)||(r=e,e=he(this,e),!e))return null}else if(r=Ie(e),r==null)return null;return{line:r,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:at(function(e,r,a){return Vi(this,e,r=="gutter"?"gutter":"class",function(s){var u=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass";if(!s[u])s[u]=a;else{if(W(a).test(s[u]))return!1;s[u]+=" "+a}return!0})}),removeLineClass:at(function(e,r,a){return Vi(this,e,r=="gutter"?"gutter":"class",function(s){var u=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass",p=s[u];if(p)if(a==null)s[u]=null;else{var h=p.match(W(a));if(!h)return!1;var m=h.index+h[0].length;s[u]=p.slice(0,h.index)+(!h.index||m==p.length?"":" ")+p.slice(m)||null}else return!1;return!0})}),addLineWidget:at(function(e,r,a){return ob(this,e,r,a)}),removeLineWidget:function(e){e.clear()},markText:function(e,r,a){return Gr(this,fe(this,e),fe(this,r),a,a&&a.type||"range")},setBookmark:function(e,r){var a={replacedWith:r&&(r.nodeType==null?r.widget:r),insertLeft:r&&r.insertLeft,clearWhenEmpty:!1,shared:r&&r.shared,handleMouseEvents:r&&r.handleMouseEvents};return e=fe(this,e),Gr(this,e,e,a,"bookmark")},findMarksAt:function(e){e=fe(this,e);var r=[],a=he(this,e.line).markedSpans;if(a)for(var s=0;s<a.length;++s){var u=a[s];(u.from==null||u.from<=e.ch)&&(u.to==null||u.to>=e.ch)&&r.push(u.marker.parent||u.marker)}return r},findMarks:function(e,r,a){e=fe(this,e),r=fe(this,r);var s=[],u=e.line;return this.iter(e.line,r.line+1,function(p){var h=p.markedSpans;if(h)for(var m=0;m<h.length;m++){var v=h[m];!(v.to!=null&&u==e.line&&e.ch>=v.to||v.from==null&&u!=e.line||v.from!=null&&u==r.line&&v.from>=r.ch)&&(!a||a(v.marker))&&s.push(v.marker.parent||v.marker)}++u}),s},getAllMarks:function(){var e=[];return this.iter(function(r){var a=r.markedSpans;if(a)for(var s=0;s<a.length;++s)a[s].from!=null&&e.push(a[s].marker)}),e},posFromIndex:function(e){var r,a=this.first,s=this.lineSeparator().length;return this.iter(function(u){var p=u.text.length+s;if(p>e)return r=e,!0;e-=p,++a}),fe(this,ne(a,r))},indexFromPos:function(e){e=fe(this,e);var r=e.ch;if(e.line<this.first||e.ch<0)return 0;var a=this.lineSeparator().length;return this.iter(this.first,e.line,function(s){r+=s.text.length+a}),r},copy:function(e){var r=new At(Ei(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return r.scrollTop=this.scrollTop,r.scrollLeft=this.scrollLeft,r.sel=this.sel,r.extend=!1,e&&(r.history.undoDepth=this.history.undoDepth,r.setHistory(this.getHistory())),r},linkedDoc:function(e){e||(e={});var r=this.first,a=this.first+this.size;e.from!=null&&e.from>r&&(r=e.from),e.to!=null&&e.to<a&&(a=e.to);var s=new At(Ei(this,r,a),e.mode||this.modeOption,r,this.lineSep,this.direction);return e.sharedHist&&(s.history=this.history),(this.linked||(this.linked=[])).push({doc:s,sharedHist:e.sharedHist}),s.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],ab(s,Xf(this)),s},unlinkDoc:function(e){if(e instanceof Ve&&(e=e.doc),this.linked)for(var r=0;r<this.linked.length;++r){var a=this.linked[r];if(a.doc==e){this.linked.splice(r,1),e.unlinkDoc(this),lb(Xf(this));break}}if(e.history==this.history){var s=[e.id];Wn(e,function(u){return s.push(u.id)},!0),e.history=new ss(null),e.history.done=Wr(this.history.done,s),e.history.undone=Wr(this.history.undone,s)}},iterLinkedDocs:function(e){Wn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Ci(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:at(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(r){return r.order=null}),this.cm&&Jv(this.cm))})}),At.prototype.eachLine=At.prototype.iter;var ed=0;function cb(e){var r=this;if(td(r),!(tt(r,e)||Mn(r.display,e))){dt(e),f&&(ed=+new Date);var a=or(r,e,!0),s=e.dataTransfer.files;if(!(!a||r.isReadOnly()))if(s&&s.length&&window.FileReader&&window.File)for(var u=s.length,p=Array(u),h=0,m=function(){++h==u&&st(r,function(){a=fe(r.doc,a);var F={from:a,to:a,text:r.doc.splitLines(p.filter(function(K){return K!=null}).join(r.doc.lineSeparator())),origin:"paste"};Ur(r.doc,F),Ff(r.doc,_n(fe(r.doc,a),fe(r.doc,qn(F))))})()},v=function(F,K){if(r.options.allowDropFileTypes&&V(r.options.allowDropFileTypes,F.type)==-1){m();return}var Z=new FileReader;Z.onerror=function(){return m()},Z.onload=function(){var oe=Z.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(oe)){m();return}p[K]=oe,m()},Z.readAsText(F)},w=0;w<s.length;w++)v(s[w],w);else{if(r.state.draggingText&&r.doc.sel.contains(a)>-1){r.state.draggingText(e),setTimeout(function(){return r.display.input.focus()},20);return}try{var P=e.dataTransfer.getData("Text");if(P){var R;if(r.state.draggingText&&!r.state.draggingText.copy&&(R=r.listSelections()),us(r.doc,_n(a,a)),R)for(var q=0;q<R.length;++q)$r(r.doc,"",R[q].anchor,R[q].head,"drag");r.replaceSelection(P,"around","paste"),r.display.input.focus()}}catch{}}}}function fb(e,r){if(f&&(!e.state.draggingText||+new Date-ed<100)){tr(r);return}if(!(tt(e,r)||Mn(e.display,r))&&(r.dataTransfer.setData("Text",e.getSelection()),r.dataTransfer.effectAllowed="copyMove",r.dataTransfer.setDragImage&&!C)){var a=$("img",null,null,"position: fixed; left: 0; top: 0;");a.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",k&&(a.width=a.height=1,e.display.wrapper.appendChild(a),a._top=a.offsetTop),r.dataTransfer.setDragImage(a,0,0),k&&a.parentNode.removeChild(a)}}function db(e,r){var a=or(e,r);if(a){var s=document.createDocumentFragment();Ia(e,a,s),e.display.dragCursor||(e.display.dragCursor=$("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),_(e.display.dragCursor,s)}}function td(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function nd(e){if(document.getElementsByClassName){for(var r=document.getElementsByClassName("CodeMirror"),a=[],s=0;s<r.length;s++){var u=r[s].CodeMirror;u&&a.push(u)}a.length&&a[0].operation(function(){for(var p=0;p<a.length;p++)e(a[p])})}}var rd=!1;function pb(){rd||(hb(),rd=!0)}function hb(){var e;we(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,nd(gb)},100))}),we(window,"blur",function(){return nd(Hr)})}function gb(e){var r=e.display;r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.scrollbarsClipped=!1,e.setSize()}for(var Un={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Yi=0;Yi<10;Yi++)Un[Yi+48]=Un[Yi+96]=String(Yi);for(var ds=65;ds<=90;ds++)Un[ds]=String.fromCharCode(ds);for(var Qi=1;Qi<=12;Qi++)Un[Qi+111]=Un[Qi+63235]="F"+Qi;var On={};On.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},On.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},On.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},On.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},On.default=T?On.macDefault:On.pcDefault;function mb(e){var r=e.split(/-(?!$)/);e=r[r.length-1];for(var a,s,u,p,h=0;h<r.length-1;h++){var m=r[h];if(/^(cmd|meta|m)$/i.test(m))p=!0;else if(/^a(lt)?$/i.test(m))a=!0;else if(/^(c|ctrl|control)$/i.test(m))s=!0;else if(/^s(hift)?$/i.test(m))u=!0;else throw new Error("Unrecognized modifier name: "+m)}return a&&(e="Alt-"+e),s&&(e="Ctrl-"+e),p&&(e="Cmd-"+e),u&&(e="Shift-"+e),e}function yb(e){var r={};for(var a in e)if(e.hasOwnProperty(a)){var s=e[a];if(/^(name|fallthrough|(de|at)tach)$/.test(a))continue;if(s=="..."){delete e[a];continue}for(var u=Pe(a.split(" "),mb),p=0;p<u.length;p++){var h=void 0,m=void 0;p==u.length-1?(m=u.join(" "),h=s):(m=u.slice(0,p+1).join(" "),h="...");var v=r[m];if(!v)r[m]=h;else if(v!=h)throw new Error("Inconsistent bindings for "+m)}delete e[a]}for(var w in r)e[w]=r[w];return e}function Kr(e,r,a,s){r=ps(r);var u=r.call?r.call(e,s):r[e];if(u===!1)return"nothing";if(u==="...")return"multi";if(u!=null&&a(u))return"handled";if(r.fallthrough){if(Object.prototype.toString.call(r.fallthrough)!="[object Array]")return Kr(e,r.fallthrough,a,s);for(var p=0;p<r.fallthrough.length;p++){var h=Kr(e,r.fallthrough[p],a,s);if(h)return h}}}function id(e){var r=typeof e=="string"?e:Un[e.keyCode];return r=="Ctrl"||r=="Alt"||r=="Shift"||r=="Mod"}function od(e,r,a){var s=e;return r.altKey&&s!="Alt"&&(e="Alt-"+e),(I?r.metaKey:r.ctrlKey)&&s!="Ctrl"&&(e="Ctrl-"+e),(I?r.ctrlKey:r.metaKey)&&s!="Mod"&&(e="Cmd-"+e),!a&&r.shiftKey&&s!="Shift"&&(e="Shift-"+e),e}function sd(e,r){if(k&&e.keyCode==34&&e.char)return!1;var a=Un[e.keyCode];return a==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(a=e.code),od(a,e,r))}function ps(e){return typeof e=="string"?On[e]:e}function Yr(e,r){for(var a=e.doc.sel.ranges,s=[],u=0;u<a.length;u++){for(var p=r(a[u]);s.length&&x(p.from,Ee(s).to)<=0;){var h=s.pop();if(x(h.from,p.from)<0){p.from=h.from;break}}s.push(p)}It(e,function(){for(var m=s.length-1;m>=0;m--)$r(e.doc,"",s[m].from,s[m].to,"+delete");_r(e)})}function Ja(e,r,a){var s=yt(e.text,r+a,a);return s<0||s>e.text.length?null:s}function Za(e,r,a){var s=Ja(e,r.ch,a);return s==null?null:new ne(r.line,s,a<0?"after":"before")}function Xa(e,r,a,s,u){if(e){r.doc.direction=="rtl"&&(u=-u);var p=Pt(a,r.doc.direction);if(p){var h=u<0?Ee(p):p[0],m=u<0==(h.level==1),v=m?"after":"before",w;if(h.level>0||r.doc.direction=="rtl"){var P=jr(r,a);w=u<0?a.text.length-1:0;var R=kn(r,P,w).top;w=gn(function(q){return kn(r,P,q).top==R},u<0==(h.level==1)?h.from:h.to-1,w),v=="before"&&(w=Ja(a,w,1))}else w=u<0?h.to:h.from;return new ne(s,w,v)}}return new ne(s,u<0?a.text.length:0,u<0?"before":"after")}function vb(e,r,a,s){var u=Pt(r,e.doc.direction);if(!u)return Za(r,a,s);a.ch>=r.text.length?(a.ch=r.text.length,a.sticky="before"):a.ch<=0&&(a.ch=0,a.sticky="after");var p=Qe(u,a.ch,a.sticky),h=u[p];if(e.doc.direction=="ltr"&&h.level%2==0&&(s>0?h.to>a.ch:h.from<a.ch))return Za(r,a,s);var m=function(le,ce){return Ja(r,le instanceof ne?le.ch:le,ce)},v,w=function(le){return e.options.lineWrapping?(v=v||jr(e,r),ff(e,r,v,le)):{begin:0,end:r.text.length}},P=w(a.sticky=="before"?m(a,-1):a.ch);if(e.doc.direction=="rtl"||h.level==1){var R=h.level==1==s<0,q=m(a,R?1:-1);if(q!=null&&(R?q<=h.to&&q<=P.end:q>=h.from&&q>=P.begin)){var F=R?"before":"after";return new ne(a.line,q,F)}}var K=function(le,ce,ue){for(var pe=function(_e,lt){return lt?new ne(a.line,m(_e,1),"before"):new ne(a.line,_e,"after")};le>=0&&le<u.length;le+=ce){var be=u[le],ve=ce>0==(be.level!=1),Me=ve?ue.begin:m(ue.end,-1);if(be.from<=Me&&Me<be.to||(Me=ve?be.from:m(be.to,-1),ue.begin<=Me&&Me<ue.end))return pe(Me,ve)}},Z=K(p+s,s,P);if(Z)return Z;var oe=s>0?P.end:m(P.begin,-1);return oe!=null&&!(s>0&&oe==r.text.length)&&(Z=K(s>0?0:u.length-1,s,w(oe)),Z)?Z:null}var Ji={selectAll:Vf,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),me)},killLine:function(e){return Yr(e,function(r){if(r.empty()){var a=he(e.doc,r.head.line).text.length;return r.head.ch==a&&r.head.line<e.lastLine()?{from:r.head,to:ne(r.head.line+1,0)}:{from:r.head,to:ne(r.head.line,a)}}else return{from:r.from(),to:r.to()}})},deleteLine:function(e){return Yr(e,function(r){return{from:ne(r.from().line,0),to:fe(e.doc,ne(r.to().line+1,0))}})},delLineLeft:function(e){return Yr(e,function(r){return{from:ne(r.from().line,0),to:r.from()}})},delWrappedLineLeft:function(e){return Yr(e,function(r){var a=e.charCoords(r.head,"div").top+5,s=e.coordsChar({left:0,top:a},"div");return{from:s,to:r.from()}})},delWrappedLineRight:function(e){return Yr(e,function(r){var a=e.charCoords(r.head,"div").top+5,s=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:a},"div");return{from:r.from(),to:s}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(ne(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(ne(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(r){return ad(e,r.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(r){return ld(e,r.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(r){return bb(e,r.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(r){var a=e.cursorCoords(r.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:a},"div")},ae)},goLineLeft:function(e){return e.extendSelectionsBy(function(r){var a=e.cursorCoords(r.head,"div").top+5;return e.coordsChar({left:0,top:a},"div")},ae)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(r){var a=e.cursorCoords(r.head,"div").top+5,s=e.coordsChar({left:0,top:a},"div");return s.ch<e.getLine(s.line).search(/\S/)?ld(e,r.head):s},ae)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var r=[],a=e.listSelections(),s=e.options.tabSize,u=0;u<a.length;u++){var p=a[u].from(),h=Ye(e.getLine(p.line),p.ch,s);r.push(_t(s-h%s))}e.replaceSelections(r)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return It(e,function(){for(var r=e.listSelections(),a=[],s=0;s<r.length;s++)if(r[s].empty()){var u=r[s].head,p=he(e.doc,u.line).text;if(p){if(u.ch==p.length&&(u=new ne(u.line,u.ch-1)),u.ch>0)u=new ne(u.line,u.ch+1),e.replaceRange(p.charAt(u.ch-1)+p.charAt(u.ch-2),ne(u.line,u.ch-2),u,"+transpose");else if(u.line>e.doc.first){var h=he(e.doc,u.line-1).text;h&&(u=new ne(u.line,1),e.replaceRange(p.charAt(0)+e.doc.lineSeparator()+h.charAt(h.length-1),ne(u.line-1,h.length-1),u,"+transpose"))}}a.push(new Re(u,u))}e.setSelections(a)})},newlineAndIndent:function(e){return It(e,function(){for(var r=e.listSelections(),a=r.length-1;a>=0;a--)e.replaceRange(e.doc.lineSeparator(),r[a].anchor,r[a].head,"+input");r=e.listSelections();for(var s=0;s<r.length;s++)e.indentLine(r[s].from().line,null,!0);_r(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function ad(e,r){var a=he(e.doc,r),s=on(a);return s!=a&&(r=Ie(s)),Xa(!0,e,s,r,1)}function bb(e,r){var a=he(e.doc,r),s=nv(a);return s!=a&&(r=Ie(s)),Xa(!0,e,a,r,-1)}function ld(e,r){var a=ad(e,r.line),s=he(e.doc,a.line),u=Pt(s,e.doc.direction);if(!u||u[0].level==0){var p=Math.max(a.ch,s.text.search(/\S/)),h=r.line==a.line&&r.ch<=p&&r.ch;return ne(a.line,h?0:p,a.sticky)}return a}function hs(e,r,a){if(typeof r=="string"&&(r=Ji[r],!r))return!1;e.display.input.ensurePolled();var s=e.display.shift,u=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),a&&(e.display.shift=!1),u=r(e)!=ie}finally{e.display.shift=s,e.state.suppressEdits=!1}return u}function wb(e,r,a){for(var s=0;s<e.state.keyMaps.length;s++){var u=Kr(r,e.state.keyMaps[s],a,e);if(u)return u}return e.options.extraKeys&&Kr(r,e.options.extraKeys,a,e)||Kr(r,e.options.keyMap,a,e)}var xb=new Fe;function Zi(e,r,a,s){var u=e.state.keySeq;if(u){if(id(r))return"handled";if(/\'$/.test(r)?e.state.keySeq=null:xb.set(50,function(){e.state.keySeq==u&&(e.state.keySeq=null,e.display.input.reset())}),ud(e,u+" "+r,a,s))return!0}return ud(e,r,a,s)}function ud(e,r,a,s){var u=wb(e,r,s);return u=="multi"&&(e.state.keySeq=r),u=="handled"&&ot(e,"keyHandled",e,r,a),(u=="handled"||u=="multi")&&(dt(a),Ra(e)),!!u}function cd(e,r){var a=sd(r,!0);return a?r.shiftKey&&!e.state.keySeq?Zi(e,"Shift-"+a,r,function(s){return hs(e,s,!0)})||Zi(e,a,r,function(s){if(typeof s=="string"?/^go[A-Z]/.test(s):s.motion)return hs(e,s)}):Zi(e,a,r,function(s){return hs(e,s)}):!1}function kb(e,r,a){return Zi(e,"'"+a+"'",r,function(s){return hs(e,s,!0)})}var el=null;function fd(e){var r=this;if(!(e.target&&e.target!=r.display.input.getField())&&(r.curOp.focus=de(),!tt(r,e))){f&&d<11&&e.keyCode==27&&(e.returnValue=!1);var a=e.keyCode;r.display.shift=a==16||e.shiftKey;var s=cd(r,e);k&&(el=s?a:null,!s&&a==88&&!qo&&(T?e.metaKey:e.ctrlKey)&&r.replaceSelection("",null,"cut")),i&&!T&&!s&&a==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),a==18&&!/\bCodeMirror-crosshair\b/.test(r.display.lineDiv.className)&&Cb(r)}}function Cb(e){var r=e.display.lineDiv;De(r,"CodeMirror-crosshair");function a(s){(s.keyCode==18||!s.altKey)&&(H(r,"CodeMirror-crosshair"),Ct(document,"keyup",a),Ct(document,"mouseover",a))}we(document,"keyup",a),we(document,"mouseover",a)}function dd(e){e.keyCode==16&&(this.doc.sel.shift=!1),tt(this,e)}function pd(e){var r=this;if(!(e.target&&e.target!=r.display.input.getField())&&!(Mn(r.display,e)||tt(r,e)||e.ctrlKey&&!e.altKey||T&&e.metaKey)){var a=e.keyCode,s=e.charCode;if(k&&a==el){el=null,dt(e);return}if(!(k&&(!e.which||e.which<10)&&cd(r,e))){var u=String.fromCharCode(s??a);u!="\b"&&(kb(r,e,u)||r.display.input.onKeyPress(e))}}}var Sb=400,tl=function(e,r,a){this.time=e,this.pos=r,this.button=a};tl.prototype.compare=function(e,r,a){return this.time+Sb>e&&x(r,this.pos)==0&&a==this.button};var Xi,eo;function Tb(e,r){var a=+new Date;return eo&&eo.compare(a,e,r)?(Xi=eo=null,"triple"):Xi&&Xi.compare(a,e,r)?(eo=new tl(a,e,r),Xi=null,"double"):(Xi=new tl(a,e,r),eo=null,"single")}function hd(e){var r=this,a=r.display;if(!(tt(r,e)||a.activeTouch&&a.input.supportsTouch())){if(a.input.ensurePolled(),a.shift=e.shiftKey,Mn(a,e)){g||(a.scroller.draggable=!1,setTimeout(function(){return a.scroller.draggable=!0},100));return}if(!nl(r,e)){var s=or(r,e),u=Fo(e),p=s?Tb(s,u):"single";window.focus(),u==1&&r.state.selectingText&&r.state.selectingText(e),!(s&&Ab(r,u,s,p,e))&&(u==1?s?Lb(r,s,p,e):Bn(e)==a.scroller&&dt(e):u==2?(s&&ls(r.doc,s),setTimeout(function(){return a.input.focus()},20)):u==3&&(z?r.display.input.onContextMenu(e):Ba(r)))}}}function Ab(e,r,a,s,u){var p="Click";return s=="double"?p="Double"+p:s=="triple"&&(p="Triple"+p),p=(r==1?"Left":r==2?"Middle":"Right")+p,Zi(e,od(p,u),u,function(h){if(typeof h=="string"&&(h=Ji[h]),!h)return!1;var m=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),m=h(e,a)!=ie}finally{e.state.suppressEdits=!1}return m})}function Eb(e,r,a){var s=e.getOption("configureMouse"),u=s?s(e,r,a):{};if(u.unit==null){var p=N?a.shiftKey&&a.metaKey:a.altKey;u.unit=p?"rectangle":r=="single"?"char":r=="double"?"word":"line"}return(u.extend==null||e.doc.extend)&&(u.extend=e.doc.extend||a.shiftKey),u.addNew==null&&(u.addNew=T?a.metaKey:a.ctrlKey),u.moveOnDrag==null&&(u.moveOnDrag=!(T?a.altKey:a.ctrlKey)),u}function Lb(e,r,a,s){f?setTimeout(Ot(gf,e),0):e.curOp.focus=de();var u=Eb(e,a,s),p=e.doc.sel,h;e.options.dragDrop&&xi&&!e.isReadOnly()&&a=="single"&&(h=p.contains(r))>-1&&(x((h=p.ranges[h]).from(),r)<0||r.xRel>0)&&(x(h.to(),r)>0||r.xRel<0)?Mb(e,s,r,u):Db(e,s,r,u)}function Mb(e,r,a,s){var u=e.display,p=!1,h=st(e,function(w){g&&(u.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:Ba(e)),Ct(u.wrapper.ownerDocument,"mouseup",h),Ct(u.wrapper.ownerDocument,"mousemove",m),Ct(u.scroller,"dragstart",v),Ct(u.scroller,"drop",h),p||(dt(w),s.addNew||ls(e.doc,a,null,null,s.extend),g&&!C||f&&d==9?setTimeout(function(){u.wrapper.ownerDocument.body.focus({preventScroll:!0}),u.input.focus()},20):u.input.focus())}),m=function(w){p=p||Math.abs(r.clientX-w.clientX)+Math.abs(r.clientY-w.clientY)>=10},v=function(){return p=!0};g&&(u.scroller.draggable=!0),e.state.draggingText=h,h.copy=!s.moveOnDrag,we(u.wrapper.ownerDocument,"mouseup",h),we(u.wrapper.ownerDocument,"mousemove",m),we(u.scroller,"dragstart",v),we(u.scroller,"drop",h),e.state.delayingBlurEvent=!0,setTimeout(function(){return u.input.focus()},20),u.scroller.dragDrop&&u.scroller.dragDrop()}function gd(e,r,a){if(a=="char")return new Re(r,r);if(a=="word")return e.findWordAt(r);if(a=="line")return new Re(ne(r.line,0),fe(e.doc,ne(r.line+1,0)));var s=a(e,r);return new Re(s.from,s.to)}function Db(e,r,a,s){f&&Ba(e);var u=e.display,p=e.doc;dt(r);var h,m,v=p.sel,w=v.ranges;if(s.addNew&&!s.extend?(m=p.sel.contains(a),m>-1?h=w[m]:h=new Re(a,a)):(h=p.sel.primary(),m=p.sel.primIndex),s.unit=="rectangle")s.addNew||(h=new Re(a,a)),a=or(e,r,!0,!0),m=-1;else{var P=gd(e,a,s.unit);s.extend?h=Ya(h,P.anchor,P.head,s.extend):h=P}s.addNew?m==-1?(m=w.length,ht(p,an(e,w.concat([h]),m),{scroll:!1,origin:"*mouse"})):w.length>1&&w[m].empty()&&s.unit=="char"&&!s.extend?(ht(p,an(e,w.slice(0,m).concat(w.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),v=p.sel):Qa(p,m,h,ye):(m=0,ht(p,new Kt([h],0),ye),v=p.sel);var R=a;function q(ue){if(x(R,ue)!=0)if(R=ue,s.unit=="rectangle"){for(var pe=[],be=e.options.tabSize,ve=Ye(he(p,a.line).text,a.ch,be),Me=Ye(he(p,ue.line).text,ue.ch,be),_e=Math.min(ve,Me),lt=Math.max(ve,Me),$e=Math.min(a.line,ue.line),Rt=Math.min(e.lastLine(),Math.max(a.line,ue.line));$e<=Rt;$e++){var Et=he(p,$e).text,nt=ke(Et,_e,be);_e==lt?pe.push(new Re(ne($e,nt),ne($e,nt))):Et.length>nt&&pe.push(new Re(ne($e,nt),ne($e,ke(Et,lt,be))))}pe.length||pe.push(new Re(a,a)),ht(p,an(e,v.ranges.slice(0,m).concat(pe),m),{origin:"*mouse",scroll:!1}),e.scrollIntoView(ue)}else{var Lt=h,ft=gd(e,ue,s.unit),it=Lt.anchor,rt;x(ft.anchor,it)>0?(rt=ft.head,it=Te(Lt.from(),ft.anchor)):(rt=ft.anchor,it=re(Lt.to(),ft.head));var Ze=v.ranges.slice(0);Ze[m]=Ob(e,new Re(fe(p,it),rt)),ht(p,an(e,Ze,m),ye)}}var F=u.wrapper.getBoundingClientRect(),K=0;function Z(ue){var pe=++K,be=or(e,ue,!0,s.unit=="rectangle");if(be)if(x(be,R)!=0){e.curOp.focus=de(),q(be);var ve=ns(u,p);(be.line>=ve.to||be.line<ve.from)&&setTimeout(st(e,function(){K==pe&&Z(ue)}),150)}else{var Me=ue.clientY<F.top?-20:ue.clientY>F.bottom?20:0;Me&&setTimeout(st(e,function(){K==pe&&(u.scroller.scrollTop+=Me,Z(ue))}),50)}}function oe(ue){e.state.selectingText=!1,K=1/0,ue&&(dt(ue),u.input.focus()),Ct(u.wrapper.ownerDocument,"mousemove",le),Ct(u.wrapper.ownerDocument,"mouseup",ce),p.history.lastSelOrigin=null}var le=st(e,function(ue){ue.buttons===0||!Fo(ue)?oe(ue):Z(ue)}),ce=st(e,oe);e.state.selectingText=ce,we(u.wrapper.ownerDocument,"mousemove",le),we(u.wrapper.ownerDocument,"mouseup",ce)}function Ob(e,r){var a=r.anchor,s=r.head,u=he(e.doc,a.line);if(x(a,s)==0&&a.sticky==s.sticky)return r;var p=Pt(u);if(!p)return r;var h=Qe(p,a.ch,a.sticky),m=p[h];if(m.from!=a.ch&&m.to!=a.ch)return r;var v=h+(m.from==a.ch==(m.level!=1)?0:1);if(v==0||v==p.length)return r;var w;if(s.line!=a.line)w=(s.line-a.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var P=Qe(p,s.ch,s.sticky),R=P-h||(s.ch-a.ch)*(m.level==1?-1:1);P==v-1||P==v?w=R<0:w=R>0}var q=p[v+(w?-1:0)],F=w==(q.level==1),K=F?q.from:q.to,Z=F?"after":"before";return a.ch==K&&a.sticky==Z?r:new Re(new ne(a.line,K,Z),s)}function md(e,r,a,s){var u,p;if(r.touches)u=r.touches[0].clientX,p=r.touches[0].clientY;else try{u=r.clientX,p=r.clientY}catch{return!1}if(u>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;s&&dt(r);var h=e.display,m=h.lineDiv.getBoundingClientRect();if(p>m.bottom||!ct(e,a))return Vt(r);p-=m.top-h.viewOffset;for(var v=0;v<e.display.gutterSpecs.length;++v){var w=h.gutters.childNodes[v];if(w&&w.getBoundingClientRect().right>=u){var P=bn(e.doc,p),R=e.display.gutterSpecs[v];return Se(e,a,e,P,R.className,r),Vt(r)}}}function nl(e,r){return md(e,r,"gutterClick",!0)}function yd(e,r){Mn(e.display,r)||Pb(e,r)||tt(e,r,"contextmenu")||z||e.display.input.onContextMenu(r)}function Pb(e,r){return ct(e,"gutterContextMenu")?md(e,r,"gutterContextMenu",!1):!1}function vd(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ii(e)}var Qr={toString:function(){return"CodeMirror.Init"}},bd={},gs={};function Nb(e){var r=e.optionHandlers;function a(s,u,p,h){e.defaults[s]=u,p&&(r[s]=h?function(m,v,w){w!=Qr&&p(m,v,w)}:p)}e.defineOption=a,e.Init=Qr,a("value","",function(s,u){return s.setValue(u)},!0),a("mode",null,function(s,u){s.doc.modeOption=u,$a(s)},!0),a("indentUnit",2,$a,!0),a("indentWithTabs",!1),a("smartIndent",!0),a("tabSize",4,function(s){qi(s),Ii(s),Tt(s)},!0),a("lineSeparator",null,function(s,u){if(s.doc.lineSep=u,!!u){var p=[],h=s.doc.first;s.doc.iter(function(v){for(var w=0;;){var P=v.text.indexOf(u,w);if(P==-1)break;w=P+u.length,p.push(ne(h,P))}h++});for(var m=p.length-1;m>=0;m--)$r(s.doc,u,p[m],ne(p[m].line,p[m].ch+u.length))}}),a("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(s,u,p){s.state.specialChars=new RegExp(u.source+(u.test("	")?"":"|	"),"g"),p!=Qr&&s.refresh()}),a("specialCharPlaceholder",lv,function(s){return s.refresh()},!0),a("electricChars",!0),a("inputStyle",S?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),a("spellcheck",!1,function(s,u){return s.getInputField().spellcheck=u},!0),a("autocorrect",!1,function(s,u){return s.getInputField().autocorrect=u},!0),a("autocapitalize",!1,function(s,u){return s.getInputField().autocapitalize=u},!0),a("rtlMoveVisually",!A),a("wholeLineUpdateBefore",!0),a("theme","default",function(s){vd(s),_i(s)},!0),a("keyMap","default",function(s,u,p){var h=ps(u),m=p!=Qr&&ps(p);m&&m.detach&&m.detach(s,h),h.attach&&h.attach(s,m||null)}),a("extraKeys",null),a("configureMouse",null),a("lineWrapping",!1,Rb,!0),a("gutters",[],function(s,u){s.display.gutterSpecs=Va(u,s.options.lineNumbers),_i(s)},!0),a("fixedGutter",!0,function(s,u){s.display.gutters.style.left=u?Pa(s.display)+"px":"0",s.refresh()},!0),a("coverGutterNextToScrollbar",!1,function(s){return qr(s)},!0),a("scrollbarStyle","native",function(s){xf(s),qr(s),s.display.scrollbars.setScrollTop(s.doc.scrollTop),s.display.scrollbars.setScrollLeft(s.doc.scrollLeft)},!0),a("lineNumbers",!1,function(s,u){s.display.gutterSpecs=Va(s.options.gutters,u),_i(s)},!0),a("firstLineNumber",1,_i,!0),a("lineNumberFormatter",function(s){return s},_i,!0),a("showCursorWhenSelecting",!1,Ri,!0),a("resetSelectionOnContextMenu",!0),a("lineWiseCopyCut",!0),a("pasteLinesPerSelection",!0),a("selectionsMayTouch",!1),a("readOnly",!1,function(s,u){u=="nocursor"&&(Hr(s),s.display.input.blur()),s.display.input.readOnlyChanged(u)}),a("screenReaderLabel",null,function(s,u){u=u===""?null:u,s.display.input.screenReaderLabelChanged(u)}),a("disableInput",!1,function(s,u){u||s.display.input.reset()},!0),a("dragDrop",!0,Ib),a("allowDropFileTypes",null),a("cursorBlinkRate",530),a("cursorScrollMargin",0),a("cursorHeight",1,Ri,!0),a("singleCursorHeightPerLine",!0,Ri,!0),a("workTime",100),a("workDelay",100),a("flattenSpans",!0,qi,!0),a("addModeClass",!1,qi,!0),a("pollInterval",100),a("undoDepth",200,function(s,u){return s.doc.history.undoDepth=u}),a("historyEventDelay",1250),a("viewportMargin",10,function(s){return s.refresh()},!0),a("maxHighlightLength",1e4,qi,!0),a("moveInputWithCursor",!0,function(s,u){u||s.display.input.resetPosition()}),a("tabindex",null,function(s,u){return s.display.input.getField().tabIndex=u||""}),a("autofocus",null),a("direction","ltr",function(s,u){return s.doc.setDirection(u)},!0),a("phrases",null)}function Ib(e,r,a){var s=a&&a!=Qr;if(!r!=!s){var u=e.display.dragFunctions,p=r?we:Ct;p(e.display.scroller,"dragstart",u.start),p(e.display.scroller,"dragenter",u.enter),p(e.display.scroller,"dragover",u.over),p(e.display.scroller,"dragleave",u.leave),p(e.display.scroller,"drop",u.drop)}}function Rb(e){e.options.lineWrapping?(De(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(H(e.display.wrapper,"CodeMirror-wrap"),ka(e)),Na(e),Tt(e),Ii(e),setTimeout(function(){return qr(e)},100)}function Ve(e,r){var a=this;if(!(this instanceof Ve))return new Ve(e,r);this.options=r=r?Ue(r):{},Ue(bd,r,!1);var s=r.value;typeof s=="string"?s=new At(s,r.mode,null,r.lineSeparator,r.direction):r.mode&&(s.modeOption=r.mode),this.doc=s;var u=new Ve.inputStyles[r.inputStyle](this),p=this.display=new Kv(e,s,u,r);p.wrapper.CodeMirror=this,vd(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),xf(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Fe,keySeq:null,specialChars:null},r.autofocus&&!S&&p.input.focus(),f&&d<11&&setTimeout(function(){return a.display.input.reset(!0)},20),Bb(this),pb(),ur(this),this.curOp.forceUpdate=!0,Of(this,s),r.autofocus&&!S||this.hasFocus()?setTimeout(function(){a.hasFocus()&&!a.state.focused&&ja(a)},20):Hr(this);for(var h in gs)gs.hasOwnProperty(h)&&gs[h](this,r[h],Qr);Sf(this),r.finishInit&&r.finishInit(this);for(var m=0;m<rl.length;++m)rl[m](this);cr(this),g&&r.lineWrapping&&getComputedStyle(p.lineDiv).textRendering=="optimizelegibility"&&(p.lineDiv.style.textRendering="auto")}Ve.defaults=bd,Ve.optionHandlers=gs;function Bb(e){var r=e.display;we(r.scroller,"mousedown",st(e,hd)),f&&d<11?we(r.scroller,"dblclick",st(e,function(v){if(!tt(e,v)){var w=or(e,v);if(!(!w||nl(e,v)||Mn(e.display,v))){dt(v);var P=e.findWordAt(w);ls(e.doc,P.anchor,P.head)}}})):we(r.scroller,"dblclick",function(v){return tt(e,v)||dt(v)}),we(r.scroller,"contextmenu",function(v){return yd(e,v)}),we(r.input.getField(),"contextmenu",function(v){r.scroller.contains(v.target)||yd(e,v)});var a,s={end:0};function u(){r.activeTouch&&(a=setTimeout(function(){return r.activeTouch=null},1e3),s=r.activeTouch,s.end=+new Date)}function p(v){if(v.touches.length!=1)return!1;var w=v.touches[0];return w.radiusX<=1&&w.radiusY<=1}function h(v,w){if(w.left==null)return!0;var P=w.left-v.left,R=w.top-v.top;return P*P+R*R>20*20}we(r.scroller,"touchstart",function(v){if(!tt(e,v)&&!p(v)&&!nl(e,v)){r.input.ensurePolled(),clearTimeout(a);var w=+new Date;r.activeTouch={start:w,moved:!1,prev:w-s.end<=300?s:null},v.touches.length==1&&(r.activeTouch.left=v.touches[0].pageX,r.activeTouch.top=v.touches[0].pageY)}}),we(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),we(r.scroller,"touchend",function(v){var w=r.activeTouch;if(w&&!Mn(r,v)&&w.left!=null&&!w.moved&&new Date-w.start<300){var P=e.coordsChar(r.activeTouch,"page"),R;!w.prev||h(w,w.prev)?R=new Re(P,P):!w.prev.prev||h(w,w.prev.prev)?R=e.findWordAt(P):R=new Re(ne(P.line,0),fe(e.doc,ne(P.line+1,0))),e.setSelection(R.anchor,R.head),e.focus(),dt(v)}u()}),we(r.scroller,"touchcancel",u),we(r.scroller,"scroll",function(){r.scroller.clientHeight&&(ji(e,r.scroller.scrollTop),ar(e,r.scroller.scrollLeft,!0),Se(e,"scroll",e))}),we(r.scroller,"mousewheel",function(v){return Ef(e,v)}),we(r.scroller,"DOMMouseScroll",function(v){return Ef(e,v)}),we(r.wrapper,"scroll",function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(v){tt(e,v)||tr(v)},over:function(v){tt(e,v)||(db(e,v),tr(v))},start:function(v){return fb(e,v)},drop:st(e,cb),leave:function(v){tt(e,v)||td(e)}};var m=r.input.getField();we(m,"keyup",function(v){return dd.call(e,v)}),we(m,"keydown",st(e,fd)),we(m,"keypress",st(e,pd)),we(m,"focus",function(v){return ja(e,v)}),we(m,"blur",function(v){return Hr(e,v)})}var rl=[];Ve.defineInitHook=function(e){return rl.push(e)};function to(e,r,a,s){var u=e.doc,p;a==null&&(a="add"),a=="smart"&&(u.mode.indent?p=Mi(e,r).state:a="prev");var h=e.options.tabSize,m=he(u,r),v=Ye(m.text,null,h);m.stateAfter&&(m.stateAfter=null);var w=m.text.match(/^\s*/)[0],P;if(!s&&!/\S/.test(m.text))P=0,a="not";else if(a=="smart"&&(P=u.mode.indent(p,m.text.slice(w.length),m.text),P==ie||P>150)){if(!s)return;a="prev"}a=="prev"?r>u.first?P=Ye(he(u,r-1).text,null,h):P=0:a=="add"?P=v+e.options.indentUnit:a=="subtract"?P=v-e.options.indentUnit:typeof a=="number"&&(P=v+a),P=Math.max(0,P);var R="",q=0;if(e.options.indentWithTabs)for(var F=Math.floor(P/h);F;--F)q+=h,R+="	";if(q<P&&(R+=_t(P-q)),R!=w)return $r(u,R,ne(r,0),ne(r,w.length),"+input"),m.stateAfter=null,!0;for(var K=0;K<u.sel.ranges.length;K++){var Z=u.sel.ranges[K];if(Z.head.line==r&&Z.head.ch<w.length){var oe=ne(r,w.length);Qa(u,K,new Re(oe,oe));break}}}var ln=null;function ms(e){ln=e}function il(e,r,a,s,u){var p=e.doc;e.display.shift=!1,s||(s=p.sel);var h=+new Date-200,m=u=="paste"||e.state.pasteIncoming>h,v=Ci(r),w=null;if(m&&s.ranges.length>1)if(ln&&ln.text.join(`
`)==r){if(s.ranges.length%ln.text.length==0){w=[];for(var P=0;P<ln.text.length;P++)w.push(p.splitLines(ln.text[P]))}}else v.length==s.ranges.length&&e.options.pasteLinesPerSelection&&(w=Pe(v,function(le){return[le]}));for(var R=e.curOp.updateInput,q=s.ranges.length-1;q>=0;q--){var F=s.ranges[q],K=F.from(),Z=F.to();F.empty()&&(a&&a>0?K=ne(K.line,K.ch-a):e.state.overwrite&&!m?Z=ne(Z.line,Math.min(he(p,Z.line).text.length,Z.ch+Ee(v).length)):m&&ln&&ln.lineWise&&ln.text.join(`
`)==v.join(`
`)&&(K=Z=ne(K.line,0)));var oe={from:K,to:Z,text:w?w[q%w.length]:v,origin:u||(m?"paste":e.state.cutIncoming>h?"cut":"+input")};Ur(e.doc,oe),ot(e,"inputRead",e,oe)}r&&!m&&xd(e,r),_r(e),e.curOp.updateInput<2&&(e.curOp.updateInput=R),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function wd(e,r){var a=e.clipboardData&&e.clipboardData.getData("Text");if(a)return e.preventDefault(),!r.isReadOnly()&&!r.options.disableInput&&It(r,function(){return il(r,a,0,null,"paste")}),!0}function xd(e,r){if(!(!e.options.electricChars||!e.options.smartIndent))for(var a=e.doc.sel,s=a.ranges.length-1;s>=0;s--){var u=a.ranges[s];if(!(u.head.ch>100||s&&a.ranges[s-1].head.line==u.head.line)){var p=e.getModeAt(u.head),h=!1;if(p.electricChars){for(var m=0;m<p.electricChars.length;m++)if(r.indexOf(p.electricChars.charAt(m))>-1){h=to(e,u.head.line,"smart");break}}else p.electricInput&&p.electricInput.test(he(e.doc,u.head.line).text.slice(0,u.head.ch))&&(h=to(e,u.head.line,"smart"));h&&ot(e,"electricInput",e,u.head.line)}}}function kd(e){for(var r=[],a=[],s=0;s<e.doc.sel.ranges.length;s++){var u=e.doc.sel.ranges[s].head.line,p={anchor:ne(u,0),head:ne(u+1,0)};a.push(p),r.push(e.getRange(p.anchor,p.head))}return{text:r,ranges:a}}function Cd(e,r,a,s){e.setAttribute("autocorrect",a?"":"off"),e.setAttribute("autocapitalize",s?"":"off"),e.setAttribute("spellcheck",!!r)}function Sd(){var e=$("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),r=$("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return g?e.style.width="1000px":e.setAttribute("wrap","off"),O&&(e.style.border="1px solid black"),Cd(e),r}function jb(e){var r=e.optionHandlers,a=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(s,u){var p=this.options,h=p[s];p[s]==u&&s!="mode"||(p[s]=u,r.hasOwnProperty(s)&&st(this,r[s])(this,u,h),Se(this,"optionChange",this,s))},getOption:function(s){return this.options[s]},getDoc:function(){return this.doc},addKeyMap:function(s,u){this.state.keyMaps[u?"push":"unshift"](ps(s))},removeKeyMap:function(s){for(var u=this.state.keyMaps,p=0;p<u.length;++p)if(u[p]==s||u[p].name==s)return u.splice(p,1),!0},addOverlay:vt(function(s,u){var p=s.token?s:e.getMode(this.options,s);if(p.startState)throw new Error("Overlays may not be stateful.");We(this.state.overlays,{mode:p,modeSpec:s,opaque:u&&u.opaque,priority:u&&u.priority||0},function(h){return h.priority}),this.state.modeGen++,Tt(this)}),removeOverlay:vt(function(s){for(var u=this.state.overlays,p=0;p<u.length;++p){var h=u[p].modeSpec;if(h==s||typeof s=="string"&&h.name==s){u.splice(p,1),this.state.modeGen++,Tt(this);return}}}),indentLine:vt(function(s,u,p){typeof u!="string"&&typeof u!="number"&&(u==null?u=this.options.smartIndent?"smart":"prev":u=u?"add":"subtract"),nr(this.doc,s)&&to(this,s,u,p)}),indentSelection:vt(function(s){for(var u=this.doc.sel.ranges,p=-1,h=0;h<u.length;h++){var m=u[h];if(m.empty())m.head.line>p&&(to(this,m.head.line,s,!0),p=m.head.line,h==this.doc.sel.primIndex&&_r(this));else{var v=m.from(),w=m.to(),P=Math.max(p,v.line);p=Math.min(this.lastLine(),w.line-(w.ch?0:1))+1;for(var R=P;R<p;++R)to(this,R,s);var q=this.doc.sel.ranges;v.ch==0&&u.length==q.length&&q[h].from().ch>0&&Qa(this.doc,h,new Re(v,q[h].to()),me)}}}),getTokenAt:function(s,u){return Pc(this,s,u)},getLineTokens:function(s,u){return Pc(this,ne(s),u,!0)},getTokenTypeAt:function(s){s=fe(this.doc,s);var u=Mc(this,he(this.doc,s.line)),p=0,h=(u.length-1)/2,m=s.ch,v;if(m==0)v=u[2];else for(;;){var w=p+h>>1;if((w?u[w*2-1]:0)>=m)h=w;else if(u[w*2+1]<m)p=w+1;else{v=u[w*2+2];break}}var P=v?v.indexOf("overlay "):-1;return P<0?v:P==0?null:v.slice(0,P-1)},getModeAt:function(s){var u=this.doc.mode;return u.innerMode?e.innerMode(u,this.getTokenAt(s).state).mode:u},getHelper:function(s,u){return this.getHelpers(s,u)[0]},getHelpers:function(s,u){var p=[];if(!a.hasOwnProperty(u))return p;var h=a[u],m=this.getModeAt(s);if(typeof m[u]=="string")h[m[u]]&&p.push(h[m[u]]);else if(m[u])for(var v=0;v<m[u].length;v++){var w=h[m[u][v]];w&&p.push(w)}else m.helperType&&h[m.helperType]?p.push(h[m.helperType]):h[m.name]&&p.push(h[m.name]);for(var P=0;P<h._global.length;P++){var R=h._global[P];R.pred(m,this)&&V(p,R.val)==-1&&p.push(R.val)}return p},getStateAfter:function(s,u){var p=this.doc;return s=Ne(p,s??p.first+p.size-1),Mi(this,s+1,u).state},cursorCoords:function(s,u){var p,h=this.doc.sel.primary();return s==null?p=h.head:typeof s=="object"?p=fe(this.doc,s):p=s?h.from():h.to(),sn(this,p,u||"page")},charCoords:function(s,u){return Zo(this,fe(this.doc,s),u||"page")},coordsChar:function(s,u){return s=lf(this,s,u||"page"),Ma(this,s.left,s.top)},lineAtHeight:function(s,u){return s=lf(this,{top:s,left:0},u||"page").top,bn(this.doc,s+this.display.viewOffset)},heightAtLine:function(s,u,p){var h=!1,m;if(typeof s=="number"){var v=this.doc.first+this.doc.size-1;s<this.doc.first?s=this.doc.first:s>v&&(s=v,h=!0),m=he(this.doc,s)}else m=s;return Jo(this,m,{top:0,left:0},u||"page",p||h).top+(h?this.doc.height-Ln(m):0)},defaultTextHeight:function(){return zr(this.display)},defaultCharWidth:function(){return Fr(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(s,u,p,h,m){var v=this.display;s=sn(this,fe(this.doc,s));var w=s.bottom,P=s.left;if(u.style.position="absolute",u.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(u),v.sizer.appendChild(u),h=="over")w=s.top;else if(h=="above"||h=="near"){var R=Math.max(v.wrapper.clientHeight,this.doc.height),q=Math.max(v.sizer.clientWidth,v.lineSpace.clientWidth);(h=="above"||s.bottom+u.offsetHeight>R)&&s.top>u.offsetHeight?w=s.top-u.offsetHeight:s.bottom+u.offsetHeight<=R&&(w=s.bottom),P+u.offsetWidth>q&&(P=q-u.offsetWidth)}u.style.top=w+"px",u.style.left=u.style.right="",m=="right"?(P=v.sizer.clientWidth-u.offsetWidth,u.style.right="0px"):(m=="left"?P=0:m=="middle"&&(P=(v.sizer.clientWidth-u.offsetWidth)/2),u.style.left=P+"px"),p&&Iv(this,{left:P,top:w,right:P+u.offsetWidth,bottom:w+u.offsetHeight})},triggerOnKeyDown:vt(fd),triggerOnKeyPress:vt(pd),triggerOnKeyUp:dd,triggerOnMouseDown:vt(hd),execCommand:function(s){if(Ji.hasOwnProperty(s))return Ji[s].call(null,this)},triggerElectric:vt(function(s){xd(this,s)}),findPosH:function(s,u,p,h){var m=1;u<0&&(m=-1,u=-u);for(var v=fe(this.doc,s),w=0;w<u&&(v=ol(this.doc,v,m,p,h),!v.hitSide);++w);return v},moveH:vt(function(s,u){var p=this;this.extendSelectionsBy(function(h){return p.display.shift||p.doc.extend||h.empty()?ol(p.doc,h.head,s,u,p.options.rtlMoveVisually):s<0?h.from():h.to()},ae)}),deleteH:vt(function(s,u){var p=this.doc.sel,h=this.doc;p.somethingSelected()?h.replaceSelection("",null,"+delete"):Yr(this,function(m){var v=ol(h,m.head,s,u,!1);return s<0?{from:v,to:m.head}:{from:m.head,to:v}})}),findPosV:function(s,u,p,h){var m=1,v=h;u<0&&(m=-1,u=-u);for(var w=fe(this.doc,s),P=0;P<u;++P){var R=sn(this,w,"div");if(v==null?v=R.left:R.left=v,w=Td(this,R,m,p),w.hitSide)break}return w},moveV:vt(function(s,u){var p=this,h=this.doc,m=[],v=!this.display.shift&&!h.extend&&h.sel.somethingSelected();if(h.extendSelectionsBy(function(P){if(v)return s<0?P.from():P.to();var R=sn(p,P.head,"div");P.goalColumn!=null&&(R.left=P.goalColumn),m.push(R.left);var q=Td(p,R,s,u);return u=="page"&&P==h.sel.primary()&&Fa(p,Zo(p,q,"div").top-R.top),q},ae),m.length)for(var w=0;w<h.sel.ranges.length;w++)h.sel.ranges[w].goalColumn=m[w]}),findWordAt:function(s){var u=this.doc,p=he(u,s.line).text,h=s.ch,m=s.ch;if(p){var v=this.getHelper(s,"wordChars");(s.sticky=="before"||m==p.length)&&h?--h:++m;for(var w=p.charAt(h),P=G(w,v)?function(R){return G(R,v)}:/\s/.test(w)?function(R){return/\s/.test(R)}:function(R){return!/\s/.test(R)&&!G(R)};h>0&&P(p.charAt(h-1));)--h;for(;m<p.length&&P(p.charAt(m));)++m}return new Re(ne(s.line,h),ne(s.line,m))},toggleOverwrite:function(s){s!=null&&s==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?De(this.display.cursorDiv,"CodeMirror-overwrite"):H(this.display.cursorDiv,"CodeMirror-overwrite"),Se(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==de()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:vt(function(s,u){Bi(this,s,u)}),getScrollInfo:function(){var s=this.display.scroller;return{left:s.scrollLeft,top:s.scrollTop,height:s.scrollHeight-xn(this)-this.display.barHeight,width:s.scrollWidth-xn(this)-this.display.barWidth,clientHeight:Ta(this),clientWidth:rr(this)}},scrollIntoView:vt(function(s,u){s==null?(s={from:this.doc.sel.primary().head,to:null},u==null&&(u=this.options.cursorScrollMargin)):typeof s=="number"?s={from:ne(s,0),to:null}:s.from==null&&(s={from:s,to:null}),s.to||(s.to=s.from),s.margin=u||0,s.from.line!=null?Rv(this,s):yf(this,s.from,s.to,s.margin)}),setSize:vt(function(s,u){var p=this,h=function(v){return typeof v=="number"||/^\d+$/.test(String(v))?v+"px":v};s!=null&&(this.display.wrapper.style.width=h(s)),u!=null&&(this.display.wrapper.style.height=h(u)),this.options.lineWrapping&&of(this);var m=this.display.viewFrom;this.doc.iter(m,this.display.viewTo,function(v){if(v.widgets){for(var w=0;w<v.widgets.length;w++)if(v.widgets[w].noHScroll){Fn(p,m,"widget");break}}++m}),this.curOp.forceUpdate=!0,Se(this,"refresh",this)}),operation:function(s){return It(this,s)},startOperation:function(){return ur(this)},endOperation:function(){return cr(this)},refresh:vt(function(){var s=this.display.cachedTextHeight;Tt(this),this.curOp.forceUpdate=!0,Ii(this),Bi(this,this.doc.scrollLeft,this.doc.scrollTop),qa(this.display),(s==null||Math.abs(s-zr(this.display))>.5||this.options.lineWrapping)&&Na(this),Se(this,"refresh",this)}),swapDoc:vt(function(s){var u=this.doc;return u.cm=null,this.state.selectingText&&this.state.selectingText(),Of(this,s),Ii(this),this.display.input.reset(),Bi(this,s.scrollLeft,s.scrollTop),this.curOp.forceScroll=!0,ot(this,"swapDoc",this,u),u}),phrase:function(s){var u=this.options.phrases;return u&&Object.prototype.hasOwnProperty.call(u,s)?u[s]:s},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},mn(e),e.registerHelper=function(s,u,p){a.hasOwnProperty(s)||(a[s]=e[s]={_global:[]}),a[s][u]=p},e.registerGlobalHelper=function(s,u,p,h){e.registerHelper(s,u,h),a[s]._global.push({pred:p,val:h})}}function ol(e,r,a,s,u){var p=r,h=a,m=he(e,r.line),v=u&&e.direction=="rtl"?-a:a;function w(){var ce=r.line+v;return ce<e.first||ce>=e.first+e.size?!1:(r=new ne(ce,r.ch,r.sticky),m=he(e,ce))}function P(ce){var ue;if(s=="codepoint"){var pe=m.text.charCodeAt(r.ch+(a>0?0:-1));if(isNaN(pe))ue=null;else{var be=a>0?pe>=55296&&pe<56320:pe>=56320&&pe<57343;ue=new ne(r.line,Math.max(0,Math.min(m.text.length,r.ch+a*(be?2:1))),-a)}}else u?ue=vb(e.cm,m,r,a):ue=Za(m,r,a);if(ue==null)if(!ce&&w())r=Xa(u,e.cm,m,r.line,v);else return!1;else r=ue;return!0}if(s=="char"||s=="codepoint")P();else if(s=="column")P(!0);else if(s=="word"||s=="group")for(var R=null,q=s=="group",F=e.cm&&e.cm.getHelper(r,"wordChars"),K=!0;!(a<0&&!P(!K));K=!1){var Z=m.text.charAt(r.ch)||`
`,oe=G(Z,F)?"w":q&&Z==`
`?"n":!q||/\s/.test(Z)?null:"p";if(q&&!K&&!oe&&(oe="s"),R&&R!=oe){a<0&&(a=1,P(),r.sticky="after");break}if(oe&&(R=oe),a>0&&!P(!K))break}var le=cs(e,r,p,h,!0);return B(p,le)&&(le.hitSide=!0),le}function Td(e,r,a,s){var u=e.doc,p=r.left,h;if(s=="page"){var m=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),v=Math.max(m-.5*zr(e.display),3);h=(a>0?r.bottom:r.top)+a*v}else s=="line"&&(h=a>0?r.bottom+3:r.top-3);for(var w;w=Ma(e,p,h),!!w.outside;){if(a<0?h<=0:h>=u.height){w.hitSide=!0;break}h+=a*5}return w}var je=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Fe,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};je.prototype.init=function(e){var r=this,a=this,s=a.cm,u=a.div=e.lineDiv;u.contentEditable=!0,Cd(u,s.options.spellcheck,s.options.autocorrect,s.options.autocapitalize);function p(m){for(var v=m.target;v;v=v.parentNode){if(v==u)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(v.className))break}return!1}we(u,"paste",function(m){!p(m)||tt(s,m)||wd(m,s)||d<=11&&setTimeout(st(s,function(){return r.updateFromDOM()}),20)}),we(u,"compositionstart",function(m){r.composing={data:m.data,done:!1}}),we(u,"compositionupdate",function(m){r.composing||(r.composing={data:m.data,done:!1})}),we(u,"compositionend",function(m){r.composing&&(m.data!=r.composing.data&&r.readFromDOMSoon(),r.composing.done=!0)}),we(u,"touchstart",function(){return a.forceCompositionEnd()}),we(u,"input",function(){r.composing||r.readFromDOMSoon()});function h(m){if(!(!p(m)||tt(s,m))){if(s.somethingSelected())ms({lineWise:!1,text:s.getSelections()}),m.type=="cut"&&s.replaceSelection("",null,"cut");else if(s.options.lineWiseCopyCut){var v=kd(s);ms({lineWise:!0,text:v.text}),m.type=="cut"&&s.operation(function(){s.setSelections(v.ranges,0,me),s.replaceSelection("",null,"cut")})}else return;if(m.clipboardData){m.clipboardData.clearData();var w=ln.text.join(`
`);if(m.clipboardData.setData("Text",w),m.clipboardData.getData("Text")==w){m.preventDefault();return}}var P=Sd(),R=P.firstChild;s.display.lineSpace.insertBefore(P,s.display.lineSpace.firstChild),R.value=ln.text.join(`
`);var q=de();Ke(R),setTimeout(function(){s.display.lineSpace.removeChild(P),q.focus(),q==u&&a.showPrimarySelection()},50)}}we(u,"copy",h),we(u,"cut",h)},je.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},je.prototype.prepareSelection=function(){var e=hf(this.cm,!1);return e.focus=de()==this.div,e},je.prototype.showSelection=function(e,r){!e||!this.cm.display.view.length||((e.focus||r)&&this.showPrimarySelection(),this.showMultipleSelections(e))},je.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},je.prototype.showPrimarySelection=function(){var e=this.getSelection(),r=this.cm,a=r.doc.sel.primary(),s=a.from(),u=a.to();if(r.display.viewTo==r.display.viewFrom||s.line>=r.display.viewTo||u.line<r.display.viewFrom){e.removeAllRanges();return}var p=ys(r,e.anchorNode,e.anchorOffset),h=ys(r,e.focusNode,e.focusOffset);if(!(p&&!p.bad&&h&&!h.bad&&x(Te(p,h),s)==0&&x(re(p,h),u)==0)){var m=r.display.view,v=s.line>=r.display.viewFrom&&Ad(r,s)||{node:m[0].measure.map[2],offset:0},w=u.line<r.display.viewTo&&Ad(r,u);if(!w){var P=m[m.length-1].measure,R=P.maps?P.maps[P.maps.length-1]:P.map;w={node:R[R.length-1],offset:R[R.length-2]-R[R.length-3]}}if(!v||!w){e.removeAllRanges();return}var q=e.rangeCount&&e.getRangeAt(0),F;try{F=Q(v.node,v.offset,w.offset,w.node)}catch{}F&&(!i&&r.state.focused?(e.collapse(v.node,v.offset),F.collapsed||(e.removeAllRanges(),e.addRange(F))):(e.removeAllRanges(),e.addRange(F)),q&&e.anchorNode==null?e.addRange(q):i&&this.startGracePeriod()),this.rememberSelection()}},je.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},je.prototype.showMultipleSelections=function(e){_(this.cm.display.cursorDiv,e.cursors),_(this.cm.display.selectionDiv,e.selection)},je.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},je.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var r=e.getRangeAt(0).commonAncestorContainer;return X(this.div,r)},je.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||de()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},je.prototype.blur=function(){this.div.blur()},je.prototype.getField=function(){return this.div},je.prototype.supportsTouch=function(){return!0},je.prototype.receivedFocus=function(){var e=this,r=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):It(this.cm,function(){return r.cm.curOp.selectionChanged=!0});function a(){r.cm.state.focused&&(r.pollSelection(),r.polling.set(r.cm.options.pollInterval,a))}this.polling.set(this.cm.options.pollInterval,a)},je.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},je.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),r=this.cm;if(L&&b&&this.cm.display.gutterSpecs.length&&zb(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var a=ys(r,e.anchorNode,e.anchorOffset),s=ys(r,e.focusNode,e.focusOffset);a&&s&&It(r,function(){ht(r.doc,_n(a,s),me),(a.bad||s.bad)&&(r.curOp.selectionChanged=!0)})}}},je.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,r=e.display,a=e.doc.sel.primary(),s=a.from(),u=a.to();if(s.ch==0&&s.line>e.firstLine()&&(s=ne(s.line-1,he(e.doc,s.line-1).length)),u.ch==he(e.doc,u.line).text.length&&u.line<e.lastLine()&&(u=ne(u.line+1,0)),s.line<r.viewFrom||u.line>r.viewTo-1)return!1;var p,h,m;s.line==r.viewFrom||(p=sr(e,s.line))==0?(h=Ie(r.view[0].line),m=r.view[0].node):(h=Ie(r.view[p].line),m=r.view[p-1].node.nextSibling);var v=sr(e,u.line),w,P;if(v==r.view.length-1?(w=r.viewTo-1,P=r.lineDiv.lastChild):(w=Ie(r.view[v+1].line)-1,P=r.view[v+1].node.previousSibling),!m)return!1;for(var R=e.doc.splitLines(Fb(e,m,P,h,w)),q=vn(e.doc,ne(h,0),ne(w,he(e.doc,w).text.length));R.length>1&&q.length>1;)if(Ee(R)==Ee(q))R.pop(),q.pop(),w--;else if(R[0]==q[0])R.shift(),q.shift(),h++;else break;for(var F=0,K=0,Z=R[0],oe=q[0],le=Math.min(Z.length,oe.length);F<le&&Z.charCodeAt(F)==oe.charCodeAt(F);)++F;for(var ce=Ee(R),ue=Ee(q),pe=Math.min(ce.length-(R.length==1?F:0),ue.length-(q.length==1?F:0));K<pe&&ce.charCodeAt(ce.length-K-1)==ue.charCodeAt(ue.length-K-1);)++K;if(R.length==1&&q.length==1&&h==s.line)for(;F&&F>s.ch&&ce.charCodeAt(ce.length-K-1)==ue.charCodeAt(ue.length-K-1);)F--,K++;R[R.length-1]=ce.slice(0,ce.length-K).replace(/^\u200b+/,""),R[0]=R[0].slice(F).replace(/\u200b+$/,"");var be=ne(h,F),ve=ne(w,q.length?Ee(q).length-K:0);if(R.length>1||R[0]||x(be,ve))return $r(e.doc,R,be,ve,"+input"),!0},je.prototype.ensurePolled=function(){this.forceCompositionEnd()},je.prototype.reset=function(){this.forceCompositionEnd()},je.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},je.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},je.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&It(this.cm,function(){return Tt(e.cm)})},je.prototype.setUneditable=function(e){e.contentEditable="false"},je.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||st(this.cm,il)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},je.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},je.prototype.onContextMenu=function(){},je.prototype.resetPosition=function(){},je.prototype.needsContentAttribute=!0;function Ad(e,r){var a=Aa(e,r.line);if(!a||a.hidden)return null;var s=he(e.doc,r.line),u=Xc(a,s,r.line),p=Pt(s,e.doc.direction),h="left";if(p){var m=Qe(p,r.ch);h=m%2?"right":"left"}var v=nf(u.map,r.ch,h);return v.offset=v.collapse=="right"?v.end:v.start,v}function zb(e){for(var r=e;r;r=r.parentNode)if(/CodeMirror-gutter-wrapper/.test(r.className))return!0;return!1}function Jr(e,r){return r&&(e.bad=!0),e}function Fb(e,r,a,s,u){var p="",h=!1,m=e.doc.lineSeparator(),v=!1;function w(F){return function(K){return K.id==F}}function P(){h&&(p+=m,v&&(p+=m),h=v=!1)}function R(F){F&&(P(),p+=F)}function q(F){if(F.nodeType==1){var K=F.getAttribute("cm-text");if(K){R(K);return}var Z=F.getAttribute("cm-marker"),oe;if(Z){var le=e.findMarks(ne(s,0),ne(u+1,0),w(+Z));le.length&&(oe=le[0].find(0))&&R(vn(e.doc,oe.from,oe.to).join(m));return}if(F.getAttribute("contenteditable")=="false")return;var ce=/^(pre|div|p|li|table|br)$/i.test(F.nodeName);if(!/^br$/i.test(F.nodeName)&&F.textContent.length==0)return;ce&&P();for(var ue=0;ue<F.childNodes.length;ue++)q(F.childNodes[ue]);/^(pre|p)$/i.test(F.nodeName)&&(v=!0),ce&&(h=!0)}else F.nodeType==3&&R(F.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;q(r),r!=a;)r=r.nextSibling,v=!1;return p}function ys(e,r,a){var s;if(r==e.display.lineDiv){if(s=e.display.lineDiv.childNodes[a],!s)return Jr(e.clipPos(ne(e.display.viewTo-1)),!0);r=null,a=0}else for(s=r;;s=s.parentNode){if(!s||s==e.display.lineDiv)return null;if(s.parentNode&&s.parentNode==e.display.lineDiv)break}for(var u=0;u<e.display.view.length;u++){var p=e.display.view[u];if(p.node==s)return Hb(p,r,a)}}function Hb(e,r,a){var s=e.text.firstChild,u=!1;if(!r||!X(s,r))return Jr(ne(Ie(e.line),0),!0);if(r==s&&(u=!0,r=s.childNodes[a],a=0,!r)){var p=e.rest?Ee(e.rest):e.line;return Jr(ne(Ie(p),p.text.length),u)}var h=r.nodeType==3?r:null,m=r;for(!h&&r.childNodes.length==1&&r.firstChild.nodeType==3&&(h=r.firstChild,a&&(a=h.nodeValue.length));m.parentNode!=s;)m=m.parentNode;var v=e.measure,w=v.maps;function P(oe,le,ce){for(var ue=-1;ue<(w?w.length:0);ue++)for(var pe=ue<0?v.map:w[ue],be=0;be<pe.length;be+=3){var ve=pe[be+2];if(ve==oe||ve==le){var Me=Ie(ue<0?e.line:e.rest[ue]),_e=pe[be]+ce;return(ce<0||ve!=oe)&&(_e=pe[be+(ce?1:0)]),ne(Me,_e)}}}var R=P(h,m,a);if(R)return Jr(R,u);for(var q=m.nextSibling,F=h?h.nodeValue.length-a:0;q;q=q.nextSibling){if(R=P(q,q.firstChild,0),R)return Jr(ne(R.line,R.ch-F),u);F+=q.textContent.length}for(var K=m.previousSibling,Z=a;K;K=K.previousSibling){if(R=P(K,K.firstChild,-1),R)return Jr(ne(R.line,R.ch+Z),u);Z+=K.textContent.length}}var et=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Fe,this.hasSelection=!1,this.composing=null};et.prototype.init=function(e){var r=this,a=this,s=this.cm;this.createField(e);var u=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),O&&(u.style.width="0px"),we(u,"input",function(){f&&d>=9&&r.hasSelection&&(r.hasSelection=null),a.poll()}),we(u,"paste",function(h){tt(s,h)||wd(h,s)||(s.state.pasteIncoming=+new Date,a.fastPoll())});function p(h){if(!tt(s,h)){if(s.somethingSelected())ms({lineWise:!1,text:s.getSelections()});else if(s.options.lineWiseCopyCut){var m=kd(s);ms({lineWise:!0,text:m.text}),h.type=="cut"?s.setSelections(m.ranges,null,me):(a.prevInput="",u.value=m.text.join(`
`),Ke(u))}else return;h.type=="cut"&&(s.state.cutIncoming=+new Date)}}we(u,"cut",p),we(u,"copy",p),we(e.scroller,"paste",function(h){if(!(Mn(e,h)||tt(s,h))){if(!u.dispatchEvent){s.state.pasteIncoming=+new Date,a.focus();return}var m=new Event("paste");m.clipboardData=h.clipboardData,u.dispatchEvent(m)}}),we(e.lineSpace,"selectstart",function(h){Mn(e,h)||dt(h)}),we(u,"compositionstart",function(){var h=s.getCursor("from");a.composing&&a.composing.range.clear(),a.composing={start:h,range:s.markText(h,s.getCursor("to"),{className:"CodeMirror-composing"})}}),we(u,"compositionend",function(){a.composing&&(a.poll(),a.composing.range.clear(),a.composing=null)})},et.prototype.createField=function(e){this.wrapper=Sd(),this.textarea=this.wrapper.firstChild},et.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},et.prototype.prepareSelection=function(){var e=this.cm,r=e.display,a=e.doc,s=hf(e);if(e.options.moveInputWithCursor){var u=sn(e,a.sel.primary().head,"div"),p=r.wrapper.getBoundingClientRect(),h=r.lineDiv.getBoundingClientRect();s.teTop=Math.max(0,Math.min(r.wrapper.clientHeight-10,u.top+h.top-p.top)),s.teLeft=Math.max(0,Math.min(r.wrapper.clientWidth-10,u.left+h.left-p.left))}return s},et.prototype.showSelection=function(e){var r=this.cm,a=r.display;_(a.cursorDiv,e.cursors),_(a.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},et.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing)){var r=this.cm;if(r.somethingSelected()){this.prevInput="";var a=r.getSelection();this.textarea.value=a,r.state.focused&&Ke(this.textarea),f&&d>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",f&&d>=9&&(this.hasSelection=null))}},et.prototype.getField=function(){return this.textarea},et.prototype.supportsTouch=function(){return!1},et.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!S||de()!=this.textarea))try{this.textarea.focus()}catch{}},et.prototype.blur=function(){this.textarea.blur()},et.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},et.prototype.receivedFocus=function(){this.slowPoll()},et.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},et.prototype.fastPoll=function(){var e=!1,r=this;r.pollingFast=!0;function a(){var s=r.poll();!s&&!e?(e=!0,r.polling.set(60,a)):(r.pollingFast=!1,r.slowPoll())}r.polling.set(20,a)},et.prototype.poll=function(){var e=this,r=this.cm,a=this.textarea,s=this.prevInput;if(this.contextMenuPending||!r.state.focused||_o(a)&&!s&&!this.composing||r.isReadOnly()||r.options.disableInput||r.state.keySeq)return!1;var u=a.value;if(u==s&&!r.somethingSelected())return!1;if(f&&d>=9&&this.hasSelection===u||T&&/[\uf700-\uf7ff]/.test(u))return r.display.input.reset(),!1;if(r.doc.sel==r.display.selForContextMenu){var p=u.charCodeAt(0);if(p==8203&&!s&&(s="\u200B"),p==8666)return this.reset(),this.cm.execCommand("undo")}for(var h=0,m=Math.min(s.length,u.length);h<m&&s.charCodeAt(h)==u.charCodeAt(h);)++h;return It(r,function(){il(r,u.slice(h),s.length-h,null,e.composing?"*compose":null),u.length>1e3||u.indexOf(`
`)>-1?a.value=e.prevInput="":e.prevInput=u,e.composing&&(e.composing.range.clear(),e.composing.range=r.markText(e.composing.start,r.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},et.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},et.prototype.onKeyPress=function(){f&&d>=9&&(this.hasSelection=null),this.fastPoll()},et.prototype.onContextMenu=function(e){var r=this,a=r.cm,s=a.display,u=r.textarea;r.contextMenuPending&&r.contextMenuPending();var p=or(a,e),h=s.scroller.scrollTop;if(!p||k)return;var m=a.options.resetSelectionOnContextMenu;m&&a.doc.sel.contains(p)==-1&&st(a,ht)(a.doc,_n(p),me);var v=u.style.cssText,w=r.wrapper.style.cssText,P=r.wrapper.offsetParent.getBoundingClientRect();r.wrapper.style.cssText="position: static",u.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-P.top-5)+"px; left: "+(e.clientX-P.left-5)+`px;
      z-index: 1000; background: `+(f?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var R;g&&(R=window.scrollY),s.input.focus(),g&&window.scrollTo(null,R),s.input.reset(),a.somethingSelected()||(u.value=r.prevInput=" "),r.contextMenuPending=F,s.selForContextMenu=a.doc.sel,clearTimeout(s.detectingSelectAll);function q(){if(u.selectionStart!=null){var Z=a.somethingSelected(),oe="\u200B"+(Z?u.value:"");u.value="\u21DA",u.value=oe,r.prevInput=Z?"":"\u200B",u.selectionStart=1,u.selectionEnd=oe.length,s.selForContextMenu=a.doc.sel}}function F(){if(r.contextMenuPending==F&&(r.contextMenuPending=!1,r.wrapper.style.cssText=w,u.style.cssText=v,f&&d<9&&s.scrollbars.setScrollTop(s.scroller.scrollTop=h),u.selectionStart!=null)){(!f||f&&d<9)&&q();var Z=0,oe=function(){s.selForContextMenu==a.doc.sel&&u.selectionStart==0&&u.selectionEnd>0&&r.prevInput=="\u200B"?st(a,Vf)(a):Z++<10?s.detectingSelectAll=setTimeout(oe,500):(s.selForContextMenu=null,s.input.reset())};s.detectingSelectAll=setTimeout(oe,200)}}if(f&&d>=9&&q(),z){tr(e);var K=function(){Ct(window,"mouseup",K),setTimeout(F,20)};we(window,"mouseup",K)}else setTimeout(F,50)},et.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},et.prototype.setUneditable=function(){},et.prototype.needsContentAttribute=!1;function _b(e,r){if(r=r?Ue(r):{},r.value=e.value,!r.tabindex&&e.tabIndex&&(r.tabindex=e.tabIndex),!r.placeholder&&e.placeholder&&(r.placeholder=e.placeholder),r.autofocus==null){var a=de();r.autofocus=a==e||e.getAttribute("autofocus")!=null&&a==document.body}function s(){e.value=m.getValue()}var u;if(e.form&&(we(e.form,"submit",s),!r.leaveSubmitMethodAlone)){var p=e.form;u=p.submit;try{var h=p.submit=function(){s(),p.submit=u,p.submit(),p.submit=h}}catch{}}r.finishInit=function(v){v.save=s,v.getTextArea=function(){return e},v.toTextArea=function(){v.toTextArea=isNaN,s(),e.parentNode.removeChild(v.getWrapperElement()),e.style.display="",e.form&&(Ct(e.form,"submit",s),!r.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=u))}},e.style.display="none";var m=Ve(function(v){return e.parentNode.insertBefore(v,e.nextSibling)},r);return m}function qb(e){e.off=Ct,e.on=we,e.wheelEventPixels=Yv,e.Doc=At,e.splitLines=Ci,e.countColumn=Ye,e.findColumn=ke,e.isWordChar=He,e.Pass=ie,e.signal=Se,e.Line=Rr,e.changeEnd=qn,e.scrollbarModel=wf,e.Pos=ne,e.cmpPos=x,e.modes=Xt,e.mimeModes=Ut,e.resolveMode=Pr,e.getMode=Nr,e.modeExtensions=nn,e.extendMode=rn,e.copyState=$t,e.startState=Ai,e.innerMode=Ti,e.commands=Ji,e.keyMap=On,e.keyName=sd,e.isModifierKey=id,e.lookupKey=Kr,e.normalizeKeyMap=yb,e.StringStream=Je,e.SharedTextMarker=Ki,e.TextMarker=Vn,e.LineWidget=Gi,e.e_preventDefault=dt,e.e_stopPropagation=Or,e.e_stop=tr,e.addClass=De,e.contains=X,e.rmClass=H,e.keyNames=Un}Nb(Ve),jb(Ve);var Wb="iter insert remove copy getEditor constructor".split(" ");for(var vs in At.prototype)At.prototype.hasOwnProperty(vs)&&V(Wb,vs)<0&&(Ve.prototype[vs]=function(e){return function(){return e.apply(this.doc,arguments)}}(At.prototype[vs]));return mn(At),Ve.inputStyles={textarea:et,contenteditable:je},Ve.defineMode=function(e){!Ve.defaults.mode&&e!="null"&&(Ve.defaults.mode=e),Wo.apply(this,arguments)},Ve.defineMIME=An,Ve.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ve.defineMIME("text/plain","null"),Ve.defineExtension=function(e,r){Ve.prototype[e]=r},Ve.defineDocExtension=function(e,r){At.prototype[e]=r},Ve.fromTextArea=_b,qb(Ve),Ve.version="5.65.2",Ve})});var $u=mt((Wh,Vh)=>{(function(n){typeof Wh=="object"&&typeof Vh=="object"?n(Sn()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("javascript",function(t,i){var o=t.indentUnit,l=i.statementIndent,c=i.jsonld,f=i.json||c,d=i.trackScope!==!1,g=i.typescript,y=i.wordCharacters||/[\w$\xa1-\uffff]/,b=function(){function x(pt){return{type:pt,style:"keyword"}}var B=x("keyword a"),J=x("keyword b"),re=x("keyword c"),Te=x("keyword d"),Ne=x("operator"),fe={type:"atom",style:"atom"};return{if:x("if"),while:B,with:B,else:J,do:J,try:J,finally:J,return:Te,break:Te,continue:Te,new:x("new"),delete:re,void:re,throw:re,debugger:x("debugger"),var:x("var"),const:x("var"),let:x("var"),function:x("function"),catch:x("catch"),for:x("for"),switch:x("switch"),case:x("case"),default:x("default"),in:Ne,typeof:Ne,instanceof:Ne,true:fe,false:fe,null:fe,undefined:fe,NaN:fe,Infinity:fe,this:x("this"),class:x("class"),super:x("atom"),yield:re,export:x("export"),import:x("import"),extends:re,await:re}}(),k=/[+\-*&%=<>!?|~^@]/,C=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function E(x){for(var B=!1,J,re=!1;(J=x.next())!=null;){if(!B){if(J=="/"&&!re)return;J=="["?re=!0:re&&J=="]"&&(re=!1)}B=!B&&J=="\\"}}var M,O;function L(x,B,J){return M=x,O=J,B}function S(x,B){var J=x.next();if(J=='"'||J=="'")return B.tokenize=T(J),B.tokenize(x,B);if(J=="."&&x.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return L("number","number");if(J=="."&&x.match(".."))return L("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(J))return L(J);if(J=="="&&x.eat(">"))return L("=>","operator");if(J=="0"&&x.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return L("number","number");if(/\d/.test(J))return x.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),L("number","number");if(J=="/")return x.eat("*")?(B.tokenize=N,N(x,B)):x.eat("/")?(x.skipToEnd(),L("comment","comment")):ne(x,B,1)?(E(x),x.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),L("regexp","string-2")):(x.eat("="),L("operator","operator",x.current()));if(J=="`")return B.tokenize=A,A(x,B);if(J=="#"&&x.peek()=="!")return x.skipToEnd(),L("meta","meta");if(J=="#"&&x.eatWhile(y))return L("variable","property");if(J=="<"&&x.match("!--")||J=="-"&&x.match("->")&&!/\S/.test(x.string.slice(0,x.start)))return x.skipToEnd(),L("comment","comment");if(k.test(J))return(J!=">"||!B.lexical||B.lexical.type!=">")&&(x.eat("=")?(J=="!"||J=="=")&&x.eat("="):/[<>*+\-|&?]/.test(J)&&(x.eat(J),J==">"&&x.eat(J))),J=="?"&&x.eat(".")?L("."):L("operator","operator",x.current());if(y.test(J)){x.eatWhile(y);var re=x.current();if(B.lastType!="."){if(b.propertyIsEnumerable(re)){var Te=b[re];return L(Te.type,Te.style,re)}if(re=="async"&&x.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return L("async","keyword",re)}return L("variable","variable",re)}}function T(x){return function(B,J){var re=!1,Te;if(c&&B.peek()=="@"&&B.match(C))return J.tokenize=S,L("jsonld-keyword","meta");for(;(Te=B.next())!=null&&!(Te==x&&!re);)re=!re&&Te=="\\";return re||(J.tokenize=S),L("string","string")}}function N(x,B){for(var J=!1,re;re=x.next();){if(re=="/"&&J){B.tokenize=S;break}J=re=="*"}return L("comment","comment")}function A(x,B){for(var J=!1,re;(re=x.next())!=null;){if(!J&&(re=="`"||re=="$"&&x.eat("{"))){B.tokenize=S;break}J=!J&&re=="\\"}return L("quasi","string-2",x.current())}var j="([{}])";function I(x,B){B.fatArrowAt&&(B.fatArrowAt=null);var J=x.string.indexOf("=>",x.start);if(!(J<0)){if(g){var re=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(x.string.slice(x.start,J));re&&(J=re.index)}for(var Te=0,Ne=!1,fe=J-1;fe>=0;--fe){var pt=x.string.charAt(fe),Gt=j.indexOf(pt);if(Gt>=0&&Gt<3){if(!Te){++fe;break}if(--Te==0){pt=="("&&(Ne=!0);break}}else if(Gt>=3&&Gt<6)++Te;else if(y.test(pt))Ne=!0;else if(/["'\/`]/.test(pt))for(;;--fe){if(fe==0)return;var Ir=x.string.charAt(fe-1);if(Ir==pt&&x.string.charAt(fe-2)!="\\"){fe--;break}}else if(Ne&&!Te){++fe;break}}Ne&&!Te&&(B.fatArrowAt=fe)}}var z={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function W(x,B,J,re,Te,Ne){this.indented=x,this.column=B,this.type=J,this.prev=Te,this.info=Ne,re!=null&&(this.align=re)}function H(x,B){if(!d)return!1;for(var J=x.localVars;J;J=J.next)if(J.name==B)return!0;for(var re=x.context;re;re=re.prev)for(var J=re.vars;J;J=J.next)if(J.name==B)return!0}function te(x,B,J,re,Te){var Ne=x.cc;for(_.state=x,_.stream=Te,_.marked=null,_.cc=Ne,_.style=B,x.lexical.hasOwnProperty("align")||(x.lexical.align=!0);;){var fe=Ne.length?Ne.pop():f?ae:me;if(fe(J,re)){for(;Ne.length&&Ne[Ne.length-1].lex;)Ne.pop()();return _.marked?_.marked:J=="variable"&&H(x,re)?"variable-2":B}}}var _={state:null,column:null,marked:null,cc:null};function $(){for(var x=arguments.length-1;x>=0;x--)_.cc.push(arguments[x])}function D(){return $.apply(null,arguments),!0}function Q(x,B){for(var J=B;J;J=J.next)if(J.name==x)return!0;return!1}function X(x){var B=_.state;if(_.marked="def",!!d){if(B.context){if(B.lexical.info=="var"&&B.context&&B.context.block){var J=de(x,B.context);if(J!=null){B.context=J;return}}else if(!Q(x,B.localVars)){B.localVars=new Ke(x,B.localVars);return}}i.globalVars&&!Q(x,B.globalVars)&&(B.globalVars=new Ke(x,B.globalVars))}}function de(x,B){if(B)if(B.block){var J=de(x,B.prev);return J?J==B.prev?B:new Be(J,B.vars,!0):null}else return Q(x,B.vars)?B:new Be(B.prev,new Ke(x,B.vars),!1);else return null}function De(x){return x=="public"||x=="private"||x=="protected"||x=="abstract"||x=="readonly"}function Be(x,B,J){this.prev=x,this.vars=B,this.block=J}function Ke(x,B){this.name=x,this.next=B}var Ot=new Ke("this",new Ke("arguments",null));function Ue(){_.state.context=new Be(_.state.context,_.state.localVars,!1),_.state.localVars=Ot}function Ye(){_.state.context=new Be(_.state.context,_.state.localVars,!0),_.state.localVars=null}Ue.lex=Ye.lex=!0;function Fe(){_.state.localVars=_.state.context.vars,_.state.context=_.state.context.prev}Fe.lex=!0;function V(x,B){var J=function(){var re=_.state,Te=re.indented;if(re.lexical.type=="stat")Te=re.lexical.indented;else for(var Ne=re.lexical;Ne&&Ne.type==")"&&Ne.align;Ne=Ne.prev)Te=Ne.indented;re.lexical=new W(Te,_.stream.column(),x,null,re.lexical,B)};return J.lex=!0,J}function ee(){var x=_.state;x.lexical.prev&&(x.lexical.type==")"&&(x.indented=x.lexical.indented),x.lexical=x.lexical.prev)}ee.lex=!0;function ie(x){function B(J){return J==x?D():x==";"||J=="}"||J==")"||J=="]"?$():D(B)}return B}function me(x,B){return x=="var"?D(V("vardef",B),xi,ie(";"),ee):x=="keyword a"?D(V("form"),Xe,me,ee):x=="keyword b"?D(V("form"),me,ee):x=="keyword d"?_.stream.match(/^\s*$/,!1)?D():D(V("stat"),Ee,ie(";"),ee):x=="debugger"?D(ie(";")):x=="{"?D(V("}"),Ye,Pt,ee,Fe):x==";"?D():x=="if"?(_.state.lexical.info=="else"&&_.state.cc[_.state.cc.length-1]==ee&&_.state.cc.pop()(),D(V("form"),Xe,me,ee,_o)):x=="function"?D(Xt):x=="for"?D(V("form"),Ye,qo,me,Fe,ee):x=="class"||g&&B=="interface"?(_.marked="keyword",D(V("form",x=="class"?x:B),Nr,ee)):x=="variable"?g&&B=="declare"?(_.marked="keyword",D(me)):g&&(B=="module"||B=="enum"||B=="type")&&_.stream.match(/^\s*\w/,!1)?(_.marked="keyword",B=="enum"?D(bn):B=="type"?D(Wo,ie("operator"),Se,ie(";")):D(V("form"),St,ie("{"),V("}"),Pt,ee,ee)):g&&B=="namespace"?(_.marked="keyword",D(V("form"),ae,me,ee)):g&&B=="abstract"?(_.marked="keyword",D(me)):D(V("stat"),Oe):x=="switch"?D(V("form"),Xe,ie("{"),V("}","switch"),Ye,Pt,ee,ee,Fe):x=="case"?D(ae,ie(":")):x=="default"?D(ie(":")):x=="catch"?D(V("form"),Ue,ye,me,ee,Fe):x=="export"?D(V("stat"),Ti,ee):x=="import"?D(V("stat"),Je,ee):x=="async"?D(me):B=="@"?D(ae,me):$(V("stat"),ae,ie(";"),ee)}function ye(x){if(x=="(")return D(An,ie(")"))}function ae(x,B){return _t(x,B,!1)}function ke(x,B){return _t(x,B,!0)}function Xe(x){return x!="("?$():D(V(")"),Ee,ie(")"),ee)}function _t(x,B,J){if(_.state.fatArrowAt==_.stream.start){var re=J?He:Xn;if(x=="(")return D(Ue,V(")"),Qe(An,")"),ee,ie("=>"),re,Fe);if(x=="variable")return $(Ue,St,ie("=>"),re,Fe)}var Te=J?We:Pe;return z.hasOwnProperty(x)?D(Te):x=="function"?D(Xt,Te):x=="class"||g&&B=="interface"?(_.marked="keyword",D(V("form"),Pr,ee)):x=="keyword c"||x=="async"?D(J?ke:ae):x=="("?D(V(")"),Ee,ie(")"),ee,Te):x=="operator"||x=="spread"?D(J?ke:ae):x=="["?D(V("]"),Ie,ee,Te):x=="{"?er(gn,"}",null,Te):x=="quasi"?$(qt,Te):x=="new"?D(G(J)):D()}function Ee(x){return x.match(/[;\}\)\],]/)?$():$(ae)}function Pe(x,B){return x==","?D(Ee):We(x,B,!1)}function We(x,B,J){var re=J==!1?Pe:We,Te=J==!1?ae:ke;if(x=="=>")return D(Ue,J?He:Xn,Fe);if(x=="operator")return/\+\+|--/.test(B)||g&&B=="!"?D(re):g&&B=="<"&&_.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?D(V(">"),Qe(Se,">"),ee,re):B=="?"?D(ae,ie(":"),Te):D(Te);if(x=="quasi")return $(qt,re);if(x!=";"){if(x=="(")return er(ke,")","call",re);if(x==".")return D(yt,re);if(x=="[")return D(V("]"),Ee,ie("]"),ee,re);if(g&&B=="as")return _.marked="keyword",D(Se,re);if(x=="regexp")return _.state.lastType=_.marked="operator",_.stream.backUp(_.stream.pos-_.stream.start-1),D(Te)}}function qt(x,B){return x!="quasi"?$():B.slice(B.length-2)!="${"?D(qt):D(Ee,Zt)}function Zt(x){if(x=="}")return _.marked="string-2",_.state.tokenize=A,D(qt)}function Xn(x){return I(_.stream,_.state),$(x=="{"?me:ae)}function He(x){return I(_.stream,_.state),$(x=="{"?me:ke)}function G(x){return function(B){return B=="."?D(x?Y:se):B=="variable"&&g?D(tr,x?We:Pe):$(x?ke:ae)}}function se(x,B){if(B=="target")return _.marked="keyword",D(Pe)}function Y(x,B){if(B=="target")return _.marked="keyword",D(We)}function Oe(x){return x==":"?D(ee,me):$(Pe,ie(";"),ee)}function yt(x){if(x=="variable")return _.marked="property",D()}function gn(x,B){if(x=="async")return _.marked="property",D(gn);if(x=="variable"||_.style=="keyword"){if(_.marked="property",B=="get"||B=="set")return D(ga);var J;return g&&_.state.fatArrowAt==_.stream.start&&(J=_.stream.match(/^\s*:\s*/,!1))&&(_.state.fatArrowAt=_.stream.pos+J[0].length),D(Wt)}else{if(x=="number"||x=="string")return _.marked=c?"property":_.style+" property",D(Wt);if(x=="jsonld-keyword")return D(Wt);if(g&&De(B))return _.marked="keyword",D(gn);if(x=="[")return D(ae,Tn,ie("]"),Wt);if(x=="spread")return D(ke,Wt);if(B=="*")return _.marked="keyword",D(gn);if(x==":")return $(Wt)}}function ga(x){return x!="variable"?$(Wt):(_.marked="property",D(Xt))}function Wt(x){if(x==":")return D(ke);if(x=="(")return $(Xt)}function Qe(x,B,J){function re(Te,Ne){if(J?J.indexOf(Te)>-1:Te==","){var fe=_.state.lexical;return fe.info=="call"&&(fe.pos=(fe.pos||0)+1),D(function(pt,Gt){return pt==B||Gt==B?$():$(x)},re)}return Te==B||Ne==B?D():J&&J.indexOf(";")>-1?$(x):D(ie(B))}return function(Te,Ne){return Te==B||Ne==B?D():$(x,re)}}function er(x,B,J){for(var re=3;re<arguments.length;re++)_.cc.push(arguments[re]);return D(V(B,J),Qe(x,B),ee)}function Pt(x){return x=="}"?D():$(me,Pt)}function Tn(x,B){if(g){if(x==":")return D(Se);if(B=="?")return D(Tn)}}function we(x,B){if(g&&(x==":"||B=="in"))return D(Se)}function Mr(x){if(g&&x==":")return _.stream.match(/^\s*\w+\s+is\b/,!1)?D(ae,Ct,Se):D(Se)}function Ct(x,B){if(B=="is")return _.marked="keyword",D()}function Se(x,B){if(B=="keyof"||B=="typeof"||B=="infer"||B=="readonly")return _.marked="keyword",D(B=="typeof"?ke:Se);if(x=="variable"||B=="void")return _.marked="type",D(Vt);if(B=="|"||B=="&")return D(Se);if(x=="string"||x=="number"||x=="atom")return D(Vt);if(x=="[")return D(V("]"),Qe(Se,"]",","),ee,Vt);if(x=="{")return D(V("}"),Dr,ee,Vt);if(x=="(")return D(Qe(Or,")"),tt,Vt);if(x=="<")return D(Qe(Se,">"),Se);if(x=="quasi")return $(mn,Vt)}function tt(x){if(x=="=>")return D(Se)}function Dr(x){return x.match(/[\}\)\]]/)?D():x==","||x==";"?D(Dr):$(ct,Dr)}function ct(x,B){if(x=="variable"||_.style=="keyword")return _.marked="property",D(ct);if(B=="?"||x=="number"||x=="string")return D(ct);if(x==":")return D(Se);if(x=="[")return D(ie("variable"),we,ie("]"),ct);if(x=="(")return $(Ut,ct);if(!x.match(/[;\}\)\],]/))return D()}function mn(x,B){return x!="quasi"?$():B.slice(B.length-2)!="${"?D(mn):D(Se,dt)}function dt(x){if(x=="}")return _.marked="string-2",_.state.tokenize=A,D(mn)}function Or(x,B){return x=="variable"&&_.stream.match(/^\s*[?:]/,!1)||B=="?"?D(Or):x==":"?D(Se):x=="spread"?D(Or):$(Se)}function Vt(x,B){if(B=="<")return D(V(">"),Qe(Se,">"),ee,Vt);if(B=="|"||x=="."||B=="&")return D(Se);if(x=="[")return D(Se,ie("]"),Vt);if(B=="extends"||B=="implements")return _.marked="keyword",D(Se);if(B=="?")return D(Se,ie(":"),Se)}function tr(x,B){if(B=="<")return D(V(">"),Qe(Se,">"),ee,Vt)}function Bn(){return $(Se,Fo)}function Fo(x,B){if(B=="=")return D(Se)}function xi(x,B){return B=="enum"?(_.marked="keyword",D(bn)):$(St,Tn,yn,Ci)}function St(x,B){if(g&&De(B))return _.marked="keyword",D(St);if(x=="variable")return X(B),D();if(x=="spread")return D(St);if(x=="[")return er(ki,"]");if(x=="{")return er(Ho,"}")}function Ho(x,B){return x=="variable"&&!_.stream.match(/^\s*:/,!1)?(X(B),D(yn)):(x=="variable"&&(_.marked="property"),x=="spread"?D(St):x=="}"?$():x=="["?D(ae,ie("]"),ie(":"),Ho):D(ie(":"),St,yn))}function ki(){return $(St,yn)}function yn(x,B){if(B=="=")return D(ke)}function Ci(x){if(x==",")return D(xi)}function _o(x,B){if(x=="keyword b"&&B=="else")return D(V("form","else"),me,ee)}function qo(x,B){if(B=="await")return D(qo);if(x=="(")return D(V(")"),Si,ee)}function Si(x){return x=="var"?D(xi,jn):x=="variable"?D(jn):$(jn)}function jn(x,B){return x==")"?D():x==";"?D(jn):B=="in"||B=="of"?(_.marked="keyword",D(ae,jn)):$(ae,jn)}function Xt(x,B){if(B=="*")return _.marked="keyword",D(Xt);if(x=="variable")return X(B),D(Xt);if(x=="(")return D(Ue,V(")"),Qe(An,")"),ee,Mr,me,Fe);if(g&&B=="<")return D(V(">"),Qe(Bn,">"),ee,Xt)}function Ut(x,B){if(B=="*")return _.marked="keyword",D(Ut);if(x=="variable")return X(B),D(Ut);if(x=="(")return D(Ue,V(")"),Qe(An,")"),ee,Mr,Fe);if(g&&B=="<")return D(V(">"),Qe(Bn,">"),ee,Ut)}function Wo(x,B){if(x=="keyword"||x=="variable")return _.marked="type",D(Wo);if(B=="<")return D(V(">"),Qe(Bn,">"),ee)}function An(x,B){return B=="@"&&D(ae,An),x=="spread"?D(An):g&&De(B)?(_.marked="keyword",D(An)):g&&x=="this"?D(Tn,yn):$(St,Tn,yn)}function Pr(x,B){return x=="variable"?Nr(x,B):nn(x,B)}function Nr(x,B){if(x=="variable")return X(B),D(nn)}function nn(x,B){if(B=="<")return D(V(">"),Qe(Bn,">"),ee,nn);if(B=="extends"||B=="implements"||g&&x==",")return B=="implements"&&(_.marked="keyword"),D(g?Se:ae,nn);if(x=="{")return D(V("}"),rn,ee)}function rn(x,B){if(x=="async"||x=="variable"&&(B=="static"||B=="get"||B=="set"||g&&De(B))&&_.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return _.marked="keyword",D(rn);if(x=="variable"||_.style=="keyword")return _.marked="property",D($t,rn);if(x=="number"||x=="string")return D($t,rn);if(x=="[")return D(ae,Tn,ie("]"),$t,rn);if(B=="*")return _.marked="keyword",D(rn);if(g&&x=="(")return $(Ut,rn);if(x==";"||x==",")return D(rn);if(x=="}")return D();if(B=="@")return D(ae,rn)}function $t(x,B){if(B=="!"||B=="?")return D($t);if(x==":")return D(Se,yn);if(B=="=")return D(ke);var J=_.state.lexical.prev,re=J&&J.info=="interface";return $(re?Ut:Xt)}function Ti(x,B){return B=="*"?(_.marked="keyword",D(Nt,ie(";"))):B=="default"?(_.marked="keyword",D(ae,ie(";"))):x=="{"?D(Qe(Ai,"}"),Nt,ie(";")):$(me)}function Ai(x,B){if(B=="as")return _.marked="keyword",D(ie("variable"));if(x=="variable")return $(ke,Ai)}function Je(x){return x=="string"?D():x=="("?$(ae):x=="."?$(Pe):$(he,vn,Nt)}function he(x,B){return x=="{"?er(he,"}"):(x=="variable"&&X(B),B=="*"&&(_.marked="keyword"),D(Ei))}function vn(x){if(x==",")return D(he,vn)}function Ei(x,B){if(B=="as")return _.marked="keyword",D(he)}function Nt(x,B){if(B=="from")return _.marked="keyword",D(ae)}function Ie(x){return x=="]"?D():$(Qe(ke,"]"))}function bn(){return $(V("form"),St,ie("{"),V("}"),Qe(nr,"}"),ee,ee)}function nr(){return $(St,yn)}function Li(x,B){return x.lastType=="operator"||x.lastType==","||k.test(B.charAt(0))||/[,.]/.test(B.charAt(0))}function ne(x,B,J){return B.tokenize==S&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(B.lastType)||B.lastType=="quasi"&&/\{\s*$/.test(x.string.slice(0,x.pos-(J||0)))}return{startState:function(x){var B={tokenize:S,lastType:"sof",cc:[],lexical:new W((x||0)-o,0,"block",!1),localVars:i.localVars,context:i.localVars&&new Be(null,null,!1),indented:x||0};return i.globalVars&&typeof i.globalVars=="object"&&(B.globalVars=i.globalVars),B},token:function(x,B){if(x.sol()&&(B.lexical.hasOwnProperty("align")||(B.lexical.align=!1),B.indented=x.indentation(),I(x,B)),B.tokenize!=N&&x.eatSpace())return null;var J=B.tokenize(x,B);return M=="comment"?J:(B.lastType=M=="operator"&&(O=="++"||O=="--")?"incdec":M,te(B,J,M,O,x))},indent:function(x,B){if(x.tokenize==N||x.tokenize==A)return n.Pass;if(x.tokenize!=S)return 0;var J=B&&B.charAt(0),re=x.lexical,Te;if(!/^\s*else\b/.test(B))for(var Ne=x.cc.length-1;Ne>=0;--Ne){var fe=x.cc[Ne];if(fe==ee)re=re.prev;else if(fe!=_o&&fe!=Fe)break}for(;(re.type=="stat"||re.type=="form")&&(J=="}"||(Te=x.cc[x.cc.length-1])&&(Te==Pe||Te==We)&&!/^[,\.=+\-*:?[\(]/.test(B));)re=re.prev;l&&re.type==")"&&re.prev.type=="stat"&&(re=re.prev);var pt=re.type,Gt=J==pt;return pt=="vardef"?re.indented+(x.lastType=="operator"||x.lastType==","?re.info.length+1:0):pt=="form"&&J=="{"?re.indented:pt=="form"?re.indented+o:pt=="stat"?re.indented+(Li(x,B)?l||o:0):re.info=="switch"&&!Gt&&i.doubleIndentSwitch!=!1?re.indented+(/^(?:case|default)\b/.test(B)?o:2*o):re.align?re.column+(Gt?0:1):re.indented+(Gt?0:o)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:f?null:"/*",blockCommentEnd:f?null:"*/",blockCommentContinue:f?null:" * ",lineComment:f?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:f?"json":"javascript",jsonldMode:c,jsonMode:f,expressionAllowed:ne,skipExpression:function(x){te(x,"atom","atom","true",new n.StringStream("",2,null))}}}),n.registerHelper("wordChars","javascript",/[\w$]/),n.defineMIME("text/javascript","javascript"),n.defineMIME("text/ecmascript","javascript"),n.defineMIME("application/javascript","javascript"),n.defineMIME("application/x-javascript","javascript"),n.defineMIME("application/ecmascript","javascript"),n.defineMIME("application/json",{name:"javascript",json:!0}),n.defineMIME("application/x-json",{name:"javascript",json:!0}),n.defineMIME("application/manifest+json",{name:"javascript",json:!0}),n.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),n.defineMIME("text/typescript",{name:"javascript",typescript:!0}),n.defineMIME("application/typescript",{name:"javascript",typescript:!0})})});var na=mt((LD,Hg)=>{function S1(n,t){switch(n.charCodeAt(t)){default:return 0;case 10:return 1;case 13:return t+1<n.length&&n.charCodeAt(t+1)===10?2:1}}Hg.exports={newLineLength:S1}});var qg=mt((MD,_g)=>{var{newLineLength:T1}=na();_g.exports=(n,t)=>{let i=1,o=0;for(let l=0;l<n.length;l++){let c=T1(n,l);c!==0&&(t(o,l+c,i++),o=l+c,l+=c-1)}t(o,n.length,i++)}});var Vg=mt((DD,Wg)=>{var{newLineLength:A1}=na();Wg.exports=(n,t)=>{let i=1,o=0;for(let l=0;l<n.length;l++){let c=A1(n,l);c!==0&&(t(o,l,i++),o=l+c,l+=c-1)}t(o,n.length,i++)}});var $g=mt((OD,Ug)=>{Ug.exports=function(n){if(n instanceof RegExp){let t=n.flags.indexOf("g")!==-1?n.flags:n.flags+"g",i=new RegExp(n,t);return function(o,l){let c;for(;c=i.exec(o);)l(c.index,c.index+c[0].length)}}return n=String(n),function(t,i){let o=-1;for(;o=t.indexOf(n,o+1),o!==-1;)i(o,o+n.length)}}});var Kg=mt((PD,Gg)=>{var{newLineLength:E1}=na();Gg.exports=(n,t)=>{let i=1;for(let o=0;o<n.length;o++){let l=E1(n,o);l!==0&&(t(o,o+l,i++),o+=l-1)}}});var Qg=mt((ND,Yg)=>{Yg.exports={lines:qg(),lineContents:Vg(),matches:$g(),newlines:Kg()}});var ra=mt((ID,Xg)=>{function Jg(n){return rc.call(null,n)}function rc(n){let t=this===window?{}:this||{},i={};return Object.assign(i,t,n,{fork:rc.bind(i),ranges:Object.assign({},t.ranges,n&&n.ranges)}),typeof i.createHook!="function"&&(i.createHook=o=>o()),i}function Zg(n){let t=Object.assign({},this);for(let i in n){let o=n[i];if(!(!o||typeof o!="object"))if(hasOwnProperty.call(t,i)){let l=t[i];t[i]=l&&typeof l.fork=="function"?l.fork(n[i]):l}else t[i]=Jg(n[i])}return t.fork=Zg.bind(t),t}Xg.exports={createPrinter:Jg,forkPrinter:rc,forkPrinterSet:Zg}});var ic=mt((RD,em)=>{em.exports=ra().createPrinter()});var nm=mt((BD,tm)=>{var{createPrinter:L1}=ra();tm.exports=L1({print:n=>n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")})});var im=mt((jD,rm)=>{var{forkPrinterSet:M1}=ra();rm.exports=M1.call({},{noop:ic(),html:nm(),tty:ic()})});var sm=mt((zD,om)=>{om.exports=function(t,i){let o=[];return i.forEach(({generate:l,marker:c})=>l(t,(f,d,g)=>o.push({type:c,start:f,end:d,data:g}))),o}});var lm=mt((FD,am)=>{var ia=()=>"",D1=function(){};function Sr(n,t){return typeof n=="function"?n:t||D1}am.exports=function(t,i,o){let l=Sr(o.print,N=>N),c=Object.assign(Object.defineProperties(Object.create(null),{offset:{get:()=>k},line:{get:()=>C},column:{get:()=>E},start:{get:()=>d.start},end:{get:()=>d.end},data:{get:()=>d.data}}),Sr(o.createContext)()),f=[],d={start:0,end:t.length},g=o.ranges||{},y=[],b=1/0,k=0,C=1,E=1,M="";M+=Sr(o.open,ia)(c),g=[].concat(Object.getOwnPropertyNames(g),Object.getOwnPropertySymbols(g)).reduce((N,A)=>{let j=g[A];return typeof j=="function"&&(g[A]=j=o.createHook(j)),j&&(y.push(A),N[A]={open:Sr(j.open,ia),close:Sr(j.close,ia),print:Sr(j.print,l)}),N},{}),i=i.slice().sort((N,A)=>N.start-A.start||A.end-N.end||y.indexOf(N.type)-y.indexOf(A.type));let O=N=>g[(d=f[N]).type].open(c)||"",L=N=>g[(d=f[N]).type].close(c)||"",S=N=>{if(k!==N){let A=t.substring(k,N),j=f.length?g[f[f.length-1].type].print:l;for(let I=k;I<N;I++){let z=t.charCodeAt(I);z===10||z===13&&(I>=t.length||t.charCodeAt(I+1)!==10)?(C++,E=1):E++}M+=j(A,c),k=N}},T=N=>{for(;b<=N;){S(b);for(let A=f.length-1;A>=0&&f[A].end===b;A--)M+=L(A),f.pop();b=1/0;for(let A=0;A<f.length;A++)f[A].end<b&&(b=f[A].end)}};for(let N=0;N<i.length;N++){let A=i[N],j=0;if(g.hasOwnProperty(A.type)!==!1&&!(A.start>A.end||!Number.isFinite(A.start)||!Number.isFinite(A.end))){for(T(A.start),S(A.start),j=0;j<f.length;j++)if(f[j].end<A.end){for(let I=f.length-1;I>=j;I--)M+=L(I);break}for(f.splice(j,0,A);j<f.length;j++)M+=O(j);A.end<b&&(b=A.end)}}T(t.length),S(t.length);for(let N=f.length-1;N>=0;N--)M+=L(N);return M+=Sr(o.close,ia)(c)||"",M}});var fm=mt((HD,cm)=>{var O1=Qg(),ac=im(),um=sm(),P1=lm();function N1(n,t){return{marker:n,generate:t}}function I1(n,t){let i={};for(let o in t)i[o]={ranges:{[n]:t[o]}};return i}function sc(n,t,i){let o=(l,c)=>{let f=t[c||i]||ac.noop,d=um(l,n);return P1(l,d,f)};return Object.assign(o,{print:o,generateRanges(l){return um(l,n)},use(l,c){let f=Symbol(l.name),d=l.ranges||l,g=Array.isArray(d)?(y,b)=>d.forEach(k=>b(...k)):d;return typeof g!="function"||(c||(c=l.printer),!c)?o:sc(n.concat(N1(f,g)),t.fork(I1(f,c)),i)},printer(l){return sc(n,t,l)}})}function oc(n,t,i){let o=sc([],i||ac,t);return Array.isArray(n)&&(o=n.reduce((l,c)=>Array.isArray(c)?l.use(...c):l.use(c),o)),o}cm.exports=Object.assign(oc,{gen:O1,printer:Object.assign((...n)=>oc().printer(...n),ac),use(...n){return oc().use(...n)}})});var hm=mt((dm,pm)=>{(function(n){typeof dm=="object"&&typeof pm=="object"?n(Sn()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("css",function(W,H){var te=H.inline;H.propertyKeywords||(H=n.resolveMode("text/css"));var _=W.indentUnit,$=H.tokenHooks,D=H.documentTypes||{},Q=H.mediaTypes||{},X=H.mediaFeatures||{},de=H.mediaValueKeywords||{},De=H.propertyKeywords||{},Be=H.nonStandardPropertyKeywords||{},Ke=H.fontProperties||{},Ot=H.counterDescriptors||{},Ue=H.colorKeywords||{},Ye=H.valueKeywords||{},Fe=H.allowNested,V=H.lineComment,ee=H.supportsAtComponent===!0,ie=W.highlightNonStandardPropertyKeywords!==!1,me,ye;function ae(G,se){return me=se,G}function ke(G,se){var Y=G.next();if($[Y]){var Oe=$[Y](G,se);if(Oe!==!1)return Oe}if(Y=="@")return G.eatWhile(/[\w\\\-]/),ae("def",G.current());if(Y=="="||(Y=="~"||Y=="|")&&G.eat("="))return ae(null,"compare");if(Y=='"'||Y=="'")return se.tokenize=Xe(Y),se.tokenize(G,se);if(Y=="#")return G.eatWhile(/[\w\\\-]/),ae("atom","hash");if(Y=="!")return G.match(/^\s*\w*/),ae("keyword","important");if(/\d/.test(Y)||Y=="."&&G.eat(/\d/))return G.eatWhile(/[\w.%]/),ae("number","unit");if(Y==="-"){if(/[\d.]/.test(G.peek()))return G.eatWhile(/[\w.%]/),ae("number","unit");if(G.match(/^-[\w\\\-]*/))return G.eatWhile(/[\w\\\-]/),G.match(/^\s*:/,!1)?ae("variable-2","variable-definition"):ae("variable-2","variable");if(G.match(/^\w+-/))return ae("meta","meta")}else return/[,+>*\/]/.test(Y)?ae(null,"select-op"):Y=="."&&G.match(/^-?[_a-z][_a-z0-9-]*/i)?ae("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(Y)?ae(null,Y):G.match(/^[\w-.]+(?=\()/)?(/^(url(-prefix)?|domain|regexp)$/i.test(G.current())&&(se.tokenize=_t),ae("variable callee","variable")):/[\w\\\-]/.test(Y)?(G.eatWhile(/[\w\\\-]/),ae("property","word")):ae(null,null)}function Xe(G){return function(se,Y){for(var Oe=!1,yt;(yt=se.next())!=null;){if(yt==G&&!Oe){G==")"&&se.backUp(1);break}Oe=!Oe&&yt=="\\"}return(yt==G||!Oe&&G!=")")&&(Y.tokenize=null),ae("string","string")}}function _t(G,se){return G.next(),G.match(/^\s*[\"\')]/,!1)?se.tokenize=null:se.tokenize=Xe(")"),ae(null,"(")}function Ee(G,se,Y){this.type=G,this.indent=se,this.prev=Y}function Pe(G,se,Y,Oe){return G.context=new Ee(Y,se.indentation()+(Oe===!1?0:_),G.context),Y}function We(G){return G.context.prev&&(G.context=G.context.prev),G.context.type}function qt(G,se,Y){return He[Y.context.type](G,se,Y)}function Zt(G,se,Y,Oe){for(var yt=Oe||1;yt>0;yt--)Y.context=Y.context.prev;return qt(G,se,Y)}function Xn(G){var se=G.current().toLowerCase();Ye.hasOwnProperty(se)?ye="atom":Ue.hasOwnProperty(se)?ye="keyword":ye="variable"}var He={};return He.top=function(G,se,Y){if(G=="{")return Pe(Y,se,"block");if(G=="}"&&Y.context.prev)return We(Y);if(ee&&/@component/i.test(G))return Pe(Y,se,"atComponentBlock");if(/^@(-moz-)?document$/i.test(G))return Pe(Y,se,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/i.test(G))return Pe(Y,se,"atBlock");if(/^@(font-face|counter-style)/i.test(G))return Y.stateArg=G,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(G))return"keyframes";if(G&&G.charAt(0)=="@")return Pe(Y,se,"at");if(G=="hash")ye="builtin";else if(G=="word")ye="tag";else{if(G=="variable-definition")return"maybeprop";if(G=="interpolation")return Pe(Y,se,"interpolation");if(G==":")return"pseudo";if(Fe&&G=="(")return Pe(Y,se,"parens")}return Y.context.type},He.block=function(G,se,Y){if(G=="word"){var Oe=se.current().toLowerCase();return De.hasOwnProperty(Oe)?(ye="property","maybeprop"):Be.hasOwnProperty(Oe)?(ye=ie?"string-2":"property","maybeprop"):Fe?(ye=se.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(ye+=" error","maybeprop")}else return G=="meta"?"block":!Fe&&(G=="hash"||G=="qualifier")?(ye="error","block"):He.top(G,se,Y)},He.maybeprop=function(G,se,Y){return G==":"?Pe(Y,se,"prop"):qt(G,se,Y)},He.prop=function(G,se,Y){if(G==";")return We(Y);if(G=="{"&&Fe)return Pe(Y,se,"propBlock");if(G=="}"||G=="{")return Zt(G,se,Y);if(G=="(")return Pe(Y,se,"parens");if(G=="hash"&&!/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(se.current()))ye+=" error";else if(G=="word")Xn(se);else if(G=="interpolation")return Pe(Y,se,"interpolation");return"prop"},He.propBlock=function(G,se,Y){return G=="}"?We(Y):G=="word"?(ye="property","maybeprop"):Y.context.type},He.parens=function(G,se,Y){return G=="{"||G=="}"?Zt(G,se,Y):G==")"?We(Y):G=="("?Pe(Y,se,"parens"):G=="interpolation"?Pe(Y,se,"interpolation"):(G=="word"&&Xn(se),"parens")},He.pseudo=function(G,se,Y){return G=="meta"?"pseudo":G=="word"?(ye="variable-3",Y.context.type):qt(G,se,Y)},He.documentTypes=function(G,se,Y){return G=="word"&&D.hasOwnProperty(se.current())?(ye="tag",Y.context.type):He.atBlock(G,se,Y)},He.atBlock=function(G,se,Y){if(G=="(")return Pe(Y,se,"atBlock_parens");if(G=="}"||G==";")return Zt(G,se,Y);if(G=="{")return We(Y)&&Pe(Y,se,Fe?"block":"top");if(G=="interpolation")return Pe(Y,se,"interpolation");if(G=="word"){var Oe=se.current().toLowerCase();Oe=="only"||Oe=="not"||Oe=="and"||Oe=="or"?ye="keyword":Q.hasOwnProperty(Oe)?ye="attribute":X.hasOwnProperty(Oe)?ye="property":de.hasOwnProperty(Oe)?ye="keyword":De.hasOwnProperty(Oe)?ye="property":Be.hasOwnProperty(Oe)?ye=ie?"string-2":"property":Ye.hasOwnProperty(Oe)?ye="atom":Ue.hasOwnProperty(Oe)?ye="keyword":ye="error"}return Y.context.type},He.atComponentBlock=function(G,se,Y){return G=="}"?Zt(G,se,Y):G=="{"?We(Y)&&Pe(Y,se,Fe?"block":"top",!1):(G=="word"&&(ye="error"),Y.context.type)},He.atBlock_parens=function(G,se,Y){return G==")"?We(Y):G=="{"||G=="}"?Zt(G,se,Y,2):He.atBlock(G,se,Y)},He.restricted_atBlock_before=function(G,se,Y){return G=="{"?Pe(Y,se,"restricted_atBlock"):G=="word"&&Y.stateArg=="@counter-style"?(ye="variable","restricted_atBlock_before"):qt(G,se,Y)},He.restricted_atBlock=function(G,se,Y){return G=="}"?(Y.stateArg=null,We(Y)):G=="word"?(Y.stateArg=="@font-face"&&!Ke.hasOwnProperty(se.current().toLowerCase())||Y.stateArg=="@counter-style"&&!Ot.hasOwnProperty(se.current().toLowerCase())?ye="error":ye="property","maybeprop"):"restricted_atBlock"},He.keyframes=function(G,se,Y){return G=="word"?(ye="variable","keyframes"):G=="{"?Pe(Y,se,"top"):qt(G,se,Y)},He.at=function(G,se,Y){return G==";"?We(Y):G=="{"||G=="}"?Zt(G,se,Y):(G=="word"?ye="tag":G=="hash"&&(ye="builtin"),"at")},He.interpolation=function(G,se,Y){return G=="}"?We(Y):G=="{"||G==";"?Zt(G,se,Y):(G=="word"?ye="variable":G!="variable"&&G!="("&&G!=")"&&(ye="error"),"interpolation")},{startState:function(G){return{tokenize:null,state:te?"block":"top",stateArg:null,context:new Ee(te?"block":"top",G||0,null)}},token:function(G,se){if(!se.tokenize&&G.eatSpace())return null;var Y=(se.tokenize||ke)(G,se);return Y&&typeof Y=="object"&&(me=Y[1],Y=Y[0]),ye=Y,me!="comment"&&(se.state=He[se.state](me,G,se)),ye},indent:function(G,se){var Y=G.context,Oe=se&&se.charAt(0),yt=Y.indent;return Y.type=="prop"&&(Oe=="}"||Oe==")")&&(Y=Y.prev),Y.prev&&(Oe=="}"&&(Y.type=="block"||Y.type=="top"||Y.type=="interpolation"||Y.type=="restricted_atBlock")?(Y=Y.prev,yt=Y.indent):(Oe==")"&&(Y.type=="parens"||Y.type=="atBlock_parens")||Oe=="{"&&(Y.type=="at"||Y.type=="atBlock"))&&(yt=Math.max(0,Y.indent-_))),yt},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:V,fold:"brace"}});function t(W){for(var H={},te=0;te<W.length;++te)H[W[te].toLowerCase()]=!0;return H}var i=["domain","regexp","url","url-prefix"],o=t(i),l=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],c=t(l),f=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover","prefers-color-scheme","dynamic-range","video-dynamic-range"],d=t(f),g=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive","dark","light","standard","high"],y=t(g),b=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","all","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","binding","bleed","block-size","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-content","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-height-step","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotate","rotation","rotation-point","row-gap","ruby-align","ruby-overhang","ruby-position","ruby-span","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-type","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-orientation","text-outline","text-overflow","text-rendering","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","touch-action","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","paint-order","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],k=t(b),C=["accent-color","aspect-ratio","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","content-visibility","margin-block","margin-block-end","margin-block-start","margin-inline","margin-inline-end","margin-inline-start","overflow-anchor","overscroll-behavior","padding-block","padding-block-end","padding-block-start","padding-inline","padding-inline-end","padding-inline-start","scroll-snap-stop","scrollbar-3d-light-color","scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-track-color","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","shape-inside","zoom"],E=t(C),M=["font-display","font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],O=t(M),L=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],S=t(L),T=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],N=t(T),A=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","blur","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","brightness","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","conic-gradient","contain","content","contents","content-box","context-menu","continuous","contrast","copy","counter","counters","cover","crop","cross","crosshair","cubic-bezier","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","drop-shadow","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","grayscale","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","hue-rotate","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","manipulation","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiple_mask_images","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeating-conic-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturate","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","sepia","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],j=t(A),I=i.concat(l).concat(f).concat(g).concat(b).concat(C).concat(T).concat(A);n.registerHelper("hintWords","css",I);function z(W,H){for(var te=!1,_;(_=W.next())!=null;){if(te&&_=="/"){H.tokenize=null;break}te=_=="*"}return["comment","comment"]}n.defineMIME("text/css",{documentTypes:o,mediaTypes:c,mediaFeatures:d,mediaValueKeywords:y,propertyKeywords:k,nonStandardPropertyKeywords:E,fontProperties:O,counterDescriptors:S,colorKeywords:N,valueKeywords:j,tokenHooks:{"/":function(W,H){return W.eat("*")?(H.tokenize=z,z(W,H)):!1}},name:"css"}),n.defineMIME("text/x-scss",{mediaTypes:c,mediaFeatures:d,mediaValueKeywords:y,propertyKeywords:k,nonStandardPropertyKeywords:E,colorKeywords:N,valueKeywords:j,fontProperties:O,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(W,H){return W.eat("/")?(W.skipToEnd(),["comment","comment"]):W.eat("*")?(H.tokenize=z,z(W,H)):["operator","operator"]},":":function(W){return W.match(/^\s*\{/,!1)?[null,null]:!1},$:function(W){return W.match(/^[\w-]+/),W.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(W){return W.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),n.defineMIME("text/x-less",{mediaTypes:c,mediaFeatures:d,mediaValueKeywords:y,propertyKeywords:k,nonStandardPropertyKeywords:E,colorKeywords:N,valueKeywords:j,fontProperties:O,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(W,H){return W.eat("/")?(W.skipToEnd(),["comment","comment"]):W.eat("*")?(H.tokenize=z,z(W,H)):["operator","operator"]},"@":function(W){return W.eat("{")?[null,"interpolation"]:W.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,!1)?!1:(W.eatWhile(/[\w\\\-]/),W.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),n.defineMIME("text/x-gss",{documentTypes:o,mediaTypes:c,mediaFeatures:d,propertyKeywords:k,nonStandardPropertyKeywords:E,fontProperties:O,counterDescriptors:S,colorKeywords:N,valueKeywords:j,supportsAtComponent:!0,tokenHooks:{"/":function(W,H){return W.eat("*")?(H.tokenize=z,z(W,H)):!1}},name:"css",helperType:"gss"})})});var ym=mt((gm,mm)=>{(function(n){typeof gm=="object"&&typeof mm=="object"?n(Sn()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},i={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};n.defineMode("xml",function(o,l){var c=o.indentUnit,f={},d=l.htmlMode?t:i;for(var g in d)f[g]=d[g];for(var g in l)f[g]=l[g];var y,b;function k(D,Q){function X(Be){return Q.tokenize=Be,Be(D,Q)}var de=D.next();if(de=="<")return D.eat("!")?D.eat("[")?D.match("CDATA[")?X(M("atom","]]>")):null:D.match("--")?X(M("comment","-->")):D.match("DOCTYPE",!0,!0)?(D.eatWhile(/[\w\._\-]/),X(O(1))):null:D.eat("?")?(D.eatWhile(/[\w\._\-]/),Q.tokenize=M("meta","?>"),"meta"):(y=D.eat("/")?"closeTag":"openTag",Q.tokenize=C,"tag bracket");if(de=="&"){var De;return D.eat("#")?D.eat("x")?De=D.eatWhile(/[a-fA-F\d]/)&&D.eat(";"):De=D.eatWhile(/[\d]/)&&D.eat(";"):De=D.eatWhile(/[\w\.\-:]/)&&D.eat(";"),De?"atom":"error"}else return D.eatWhile(/[^&<]/),null}k.isInText=!0;function C(D,Q){var X=D.next();if(X==">"||X=="/"&&D.eat(">"))return Q.tokenize=k,y=X==">"?"endTag":"selfcloseTag","tag bracket";if(X=="=")return y="equals",null;if(X=="<"){Q.tokenize=k,Q.state=A,Q.tagName=Q.tagStart=null;var de=Q.tokenize(D,Q);return de?de+" tag error":"tag error"}else return/[\'\"]/.test(X)?(Q.tokenize=E(X),Q.stringStartCol=D.column(),Q.tokenize(D,Q)):(D.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function E(D){var Q=function(X,de){for(;!X.eol();)if(X.next()==D){de.tokenize=C;break}return"string"};return Q.isInAttribute=!0,Q}function M(D,Q){return function(X,de){for(;!X.eol();){if(X.match(Q)){de.tokenize=k;break}X.next()}return D}}function O(D){return function(Q,X){for(var de;(de=Q.next())!=null;){if(de=="<")return X.tokenize=O(D+1),X.tokenize(Q,X);if(de==">")if(D==1){X.tokenize=k;break}else return X.tokenize=O(D-1),X.tokenize(Q,X)}return"meta"}}function L(D){return D&&D.toLowerCase()}function S(D,Q,X){this.prev=D.context,this.tagName=Q||"",this.indent=D.indented,this.startOfLine=X,(f.doNotIndent.hasOwnProperty(Q)||D.context&&D.context.noIndent)&&(this.noIndent=!0)}function T(D){D.context&&(D.context=D.context.prev)}function N(D,Q){for(var X;;){if(!D.context||(X=D.context.tagName,!f.contextGrabbers.hasOwnProperty(L(X))||!f.contextGrabbers[L(X)].hasOwnProperty(L(Q))))return;T(D)}}function A(D,Q,X){return D=="openTag"?(X.tagStart=Q.column(),j):D=="closeTag"?I:A}function j(D,Q,X){return D=="word"?(X.tagName=Q.current(),b="tag",H):f.allowMissingTagName&&D=="endTag"?(b="tag bracket",H(D,Q,X)):(b="error",j)}function I(D,Q,X){if(D=="word"){var de=Q.current();return X.context&&X.context.tagName!=de&&f.implicitlyClosed.hasOwnProperty(L(X.context.tagName))&&T(X),X.context&&X.context.tagName==de||f.matchClosing===!1?(b="tag",z):(b="tag error",W)}else return f.allowMissingTagName&&D=="endTag"?(b="tag bracket",z(D,Q,X)):(b="error",W)}function z(D,Q,X){return D!="endTag"?(b="error",z):(T(X),A)}function W(D,Q,X){return b="error",z(D,Q,X)}function H(D,Q,X){if(D=="word")return b="attribute",te;if(D=="endTag"||D=="selfcloseTag"){var de=X.tagName,De=X.tagStart;return X.tagName=X.tagStart=null,D=="selfcloseTag"||f.autoSelfClosers.hasOwnProperty(L(de))?N(X,de):(N(X,de),X.context=new S(X,de,De==X.indented)),A}return b="error",H}function te(D,Q,X){return D=="equals"?_:(f.allowMissing||(b="error"),H(D,Q,X))}function _(D,Q,X){return D=="string"?$:D=="word"&&f.allowUnquoted?(b="string",H):(b="error",H(D,Q,X))}function $(D,Q,X){return D=="string"?$:H(D,Q,X)}return{startState:function(D){var Q={tokenize:k,state:A,indented:D||0,tagName:null,tagStart:null,context:null};return D!=null&&(Q.baseIndent=D),Q},token:function(D,Q){if(!Q.tagName&&D.sol()&&(Q.indented=D.indentation()),D.eatSpace())return null;y=null;var X=Q.tokenize(D,Q);return(X||y)&&X!="comment"&&(b=null,Q.state=Q.state(y||X,D,Q),b&&(X=b=="error"?X+" error":b)),X},indent:function(D,Q,X){var de=D.context;if(D.tokenize.isInAttribute)return D.tagStart==D.indented?D.stringStartCol+1:D.indented+c;if(de&&de.noIndent)return n.Pass;if(D.tokenize!=C&&D.tokenize!=k)return X?X.match(/^(\s*)/)[0].length:0;if(D.tagName)return f.multilineTagIndentPastTag!==!1?D.tagStart+D.tagName.length+2:D.tagStart+c*(f.multilineTagIndentFactor||1);if(f.alignCDATA&&/<!\[CDATA\[/.test(Q))return 0;var De=Q&&/^<(\/)?([\w_:\.-]*)/.exec(Q);if(De&&De[1])for(;de;)if(de.tagName==De[2]){de=de.prev;break}else if(f.implicitlyClosed.hasOwnProperty(L(de.tagName)))de=de.prev;else break;else if(De)for(;de;){var Be=f.contextGrabbers[L(de.tagName)];if(Be&&Be.hasOwnProperty(L(De[2])))de=de.prev;else break}for(;de&&de.prev&&!de.startOfLine;)de=de.prev;return de?de.indent+c:D.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:f.htmlMode?"html":"xml",helperType:f.htmlMode?"html":"xml",skipAttribute:function(D){D.state==_&&(D.state=H)},xmlCurrentTag:function(D){return D.tagName?{name:D.tagName,close:D.type=="closeTag"}:null},xmlCurrentContext:function(D){for(var Q=[],X=D.context;X;X=X.prev)Q.push(X.tagName);return Q.reverse()}}}),n.defineMIME("text/xml","xml"),n.defineMIME("application/xml","xml"),n.mimeModes.hasOwnProperty("text/html")||n.defineMIME("text/html",{name:"xml",htmlMode:!0})})});function Ed(n){let t=[].filter(i=>{if(typeof i=="function")return!0;console.warn('[discovery-cli] "prepare" module should return a function, but got '+typeof i)});t.length&&n.setPrepare(async(i,...o)=>{for(let l of t)i=await l(i,...o)||i;return i})}var ul=null;var Ld=[];var Md=[];var cl="0.0.0-dev";var Dd="1.0.0-beta.13";var wt=Object.hasOwn||((n,t)=>Object.hasOwnProperty.call(n,t)),Qb=Object.prototype.toString;function ei(n,t){return t!==void 0&&(ze(t)?t.forEach(i=>n.add(i)):n.add(t)),n}function bs(n,t,i){n.has(t)?n.get(t).add(i):n.set(t,new Set([i]))}function Od(n,t){return n&&wt(n,t)?n[t]:void 0}function cn(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function Gn(n){return Qb.call(n)==="[object RegExp]"}function Nn(n){return n&&(ze(n)||wt(n,"length")&&isFinite(n.length))}function ze(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function pr(n,t=0){let i=parseInt(n,10);return isNaN(i)?t:i}function Yt(n){if(ze(n))return n.length>0;if(cn(n)){for(let t in n)if(wt(n,t))return!0;return!1}return!!n}var Jb=function(){return{yy:{},options:{ranges:!0},rules:[/^(?:\/\/.*?(?:\n|\r\n?|\u2028|\u2029|$)|\/\*(?:.|\s)*?(?:\*\/|$))/,/^\s+/,/^\//,/^<(?!=)/,/^/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*\(?)/,/^/,(t,i)=>{if(t[0]!==(i==="template"?"}":"`"))return null;for(let o=1;o<t.length;o++){if(t[o]==="`")return o+1;if(t[o]==="$"&&t[o+1]==="{")return o+2;t[o]==="\\"&&o++}return null},(t,i)=>{if(t[0]!==(i==="template"?"}":"`"))return null;for(let o=1;o<t.length;o++){if(t[o]==="`")return o+1;if(t[o]==="$"&&t[o+1]==="{")return o+2;t[o]==="\\"&&o++}return null},/^/,/^\(/,/^\)/,/^\[/,/^\]/,/^\{/,/^\}/,/^(?:(true|false|null|undefined|Infinity|NaN)\b)/,/^and\b/,/^or\b/,/^is\b/,/^has\s+no\b/,/^has\b/,/^in\b/,/^not\s+in\b/,/^not\b/,/^no\b/,/^(?:(asc|desc)(NA?|AN?)?\b)/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*\()/,/^(?:\$(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*\()/,/^(?:(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*)/,/^(?:\$(?:[a-zA-Z_]|\\u[0-9a-fA-F]{4})(?:[a-zA-Z_$0-9]|\\u[0-9a-fA-F]{4})*)/,/^(?:[_\d]*\.)?[_\d]+(?:[eE][-+]?[_\d]+)?\b/,/^(?:\d*\.)?\d+(?:[eE][-+]?\d+)?\b/,/^0[xX][_0-9a-fA-F]+/,/^0[xX][0-9a-fA-F]+/,/^(?:"(?:\\[\\"]|[^"])*")/,/^(?:'(?:\\[\\']|[^'])*')/,/^(?:\/(?:\\.|[^/])+\/[gimsu]*)/,/^@/,/^#/,/^\$\$/,/^\$/,/^=>/,/^=/,/^!=/,/^~=/,/^>=/,/^<=/,/^</,/^>/,/^\.\.\(/,/^\.\(/,/^\.\[/,/^\.\.\./,/^\.\./,/^\./,/^\?\?/,/^\?/,/^,/,/^:/,/^;/,/^\-/,/^\+/,/^\*/,/^\//,/^\%/,/^(?:\|)/,/^./,/^$/],conditions:{preventPrimitive:{rules:[0,1,2,3,4,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68],inclusive:!0},preventKeyword:{rules:[5,6],inclusive:!1},template:{rules:[8,9],inclusive:!1},INITIAL:{rules:[0,1,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68],inclusive:!0}},performAction(t,i,o,l){let c=l;switch(o){case 0:{t.commentRanges.push(i.yylloc.range);break}case 1:break;case 2:{return this.popState(),40;break}case 3:{return this.popState(),44;break}case 4:{this.done=!1,this.popState();break}case 5:{if(this.popState(),i.yytext.endsWith("(")){this.unput(i.yytext);return}return t.pps(),i.yytext=this.ident(i.yytext),14;break}case 6:{this.done=!1,this.popState();break}case 7:{let f=i.yytext.endsWith("`")?"TEMPLATE":"TPL_START";return i.yytext=this.toStringLiteral(i.yytext,!0,1+ +(f!=="TEMPLATE")),f==="TEMPLATE"&&t.pps(),f;break}case 8:{let f=i.yytext.endsWith("`")?"TPL_END":"TPL_CONTINUE";return i.yytext=this.toStringLiteral(i.yytext,!0,1+ +(f!=="TPL_END")),this.popState(),f==="TPL_END"&&t.pps(),f;break}case 9:{this.parseError("Unexpected end of input");break}case 10:return 21;case 11:{return t.pps(),22;break}case 12:return 61;case 13:{return t.pps(),63;break}case 14:return 84;case 15:{if(this.bracketStack[this.bracketStack.length-1]!=="TPL_END")return t.pps(),85;this.unput("}"),this.begin("template");break}case 16:{return i.yytext=this.toLiteral(i.yytext),57;break}case 17:return 36;case 18:return 37;case 19:return 30;case 20:return 35;case 21:return 33;case 22:return 32;case 23:return 34;case 24:return 25;case 25:return 26;case 26:return 95;case 27:{return i.yytext=this.ident(i.yytext.slice(0,-1)),70;break}case 28:{return i.yytext=this.ident(i.yytext.slice(1,-1)),72;break}case 29:{return t.pps(),i.yytext=this.ident(i.yytext),14;break}case 30:{return t.pps(),i.yytext=this.ident(i.yytext.slice(1)),15;break}case 31:{return t.pps(),i.yytext=this.toNumberLiteral(i.yytext,!0),55;break}case 32:{return t.pps(),i.yytext=this.toNumberLiteral(i.yytext),55;break}case 33:{return t.pps(),i.yytext=this.toNumberLiteral(i.yytext,!0,!0),55;break}case 34:{return t.pps(),i.yytext=this.toNumberLiteral(i.yytext,!1,!0),55;break}case 35:{return t.pps(),i.yytext=this.toStringLiteral(i.yytext),54;break}case 36:{return t.pps(),i.yytext=this.toStringLiteral(i.yytext),54;break}case 37:{return t.pps(),i.yytext=this.toRegExp(i.yytext),56;break}case 38:{return t.pps(),51;break}case 39:{return t.pps(),52;break}case 40:{return t.pps(),53;break}case 41:{return t.pps(),9;break}case 42:return 20;case 43:return 42;case 44:return 43;case 45:return 48;case 46:return 47;case 47:return 45;case 48:return 44;case 49:return 46;case 50:return 69;case 51:return 66;case 52:return 67;case 53:return 89;case 54:{return t.pps(),t.pks(),68;break}case 55:{return t.pps(),t.pks(),65;break}case 56:return 38;case 57:return 17;case 58:return 73;case 59:return 11;case 60:return 10;case 61:return 27;case 62:return 28;case 63:return 39;case 64:return 40;case 65:return 41;case 66:return 29;case 67:{this.parseError(`Bad input on line ${i.yylloc.first_line} column ${i.yylloc.first_column}
`+this.showPosition(),{text:i.yytext,token:"BAD_TOKEN"});break}case 68:return 5}},setInput(t,i){return this.yy=i||this.yy||{},this._input=t,this._more=!1,this._backtrack=!1,this.done=!1,this.currentCondition="INITIAL",this.conditionStack=["INITIAL"],this.offset=0,this.yytext=this.match="",this.yyleng=0,this.yylineno=0,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.yylloc.range=[0,0],this},parseError(t,i){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,i)},input(){let t=this._input[this.offset],i=/\n|\r\n?|\u2028|\u2029/g.test(t);return this.offset++,this.yyleng++,this.yytext=this.match=this.yytext+t,i?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,t},lineColumnForOffset(t=this.offset,i=this._input,o=1,l=0){let c=/\n|\r\n?|\u2028|\u2029/g,f=o,d=l,g=0,y;for(;(y=c.exec(i))!==null;)if(y.index<t)f++,d=0,g=y.index+y[0].length;else{d+=t-g,g=-1;break}return g!==-1&&(d+=t-g),{line:f,column:d}},setMatch(t,i){let o=this._input.slice(t,i),l=t!==this.offset?this.lineColumnForOffset(t):{line:this.yylloc.last_line,column:this.yylloc.last_column},c=t!==i?this.lineColumnForOffset(i-t,o,l.line,l.column):l;this.yytext=this.match=o,this.yyleng=i-t,this.offset=i,this.yylineno=c.line-1,this.yylloc={first_line:l.line,first_column:l.column,last_line:c.line,last_column:c.column},this.yylloc.range=[t,i]},less(t){let i=this.offset-this.match.length;this.setMatch(i,i+t)},unput(t){let i=this.match.length-t.length;if(!this.match.startsWith(t,i))throw new Error("Lexer#unput() should receive a part of matched text only");this.less(i)},more(){this._more=!0},reject(){throw new Error("reject() is allowed only when options.backtrack_lexer = true")},showPosition(t=this.offset-this.match.length){let i=this._input,o=Math.max(t-20,0),l=Math.min(t+20,i.length),c=(o===0?"":"...")+i.slice(o,t).replace(/\n|\r\n?|\u2028|\u2029/g,"\\n"),f=i.slice(t,l).replace(/\n|\r\n?|\u2028|\u2029/g,"\\n")+(l===i.length?"":"...");return c+f+`
${"-".repeat(c.length)}^`},test_match(t,i){let o;this._more=!1,this._backtrack=!1,this.setMatch(this.offset,this.offset+t[0].length),this.matches=t;let l=this.performAction.call(this,this.yy,this,i,this.conditionStack[this.conditionStack.length-1]);return!l&&this._backtrack?(Object.assign(this,o),!1):(this.eof()||(this.done=!1),typeof l=="number"&&this.yy.parser?this.yy.parser.terminals_[l]:l||!1)},eof(){return this.offset===this._input.length},next(){if(this.done)return 1;this.eof()&&(this.done=!0),this._more||(this.yytext="",this.match="");let t,i;for(let o of this.conditions[this.currentCondition].rules){let l=this.rules[o],c=this._input.slice(this.offset),f;if(typeof l=="function"){let d=l(c,this.currentCondition);switch(typeof d){case"string":f=[d];break;case"number":f=[c.slice(0,d)];break;default:f=d}}else f=c.match(l);if(f&&(!t||f[0].length>t[0].length)){t=f,i=o;break}}if(t)return this.test_match(t,i);if(this.eof())return 1;this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex(){let t;for(;!t;)t=this.next();return t},begin(t){this.currentCondition=t,this.conditionStack.push(t)},pushState(t){this.begin(t)},popState(){return this.conditionStack.pop(),this.currentCondition=this.conditionStack.length?this.conditionStack[this.conditionStack.length-1]:"INITIAL"},topState(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},stateStackSize(){return this.conditionStack.length}}}();function fl(){this.yy={}}fl.prototype={Parser:fl,lexer:Jb,symbols_:{error:2,root:3,block:4,EOF:5,definitions:6,e:7,def:8,$:9,";":10,":":11,$ident:12,ident:13,IDENT:14,$IDENT:15,condConsequent:16,"?":17,condAlternate:18,query:19,"=>":20,"(":21,")":22,functionArgs:23,compareFunction:24,NOT:25,NO:26,"-":27,"+":28,"|":29,IS:30,assertion:31,IN:32,HAS:33,NOTIN:34,HASNO:35,AND:36,OR:37,"??":38,"*":39,"/":40,"%":41,"=":42,"!=":43,"<":44,"<=":45,">":46,">=":47,"~=":48,queryRoot:49,relativePath:50,"@":51,"#":52,$$:53,STRING:54,NUMBER:55,REGEXP:56,LITERAL:57,template:58,object:59,array:60,"[":61,sliceNotation:62,"]":63,"method()":64,".":65,".(":66,".[":67,"..":68,"..(":69,"METHOD(":70,arguments:71,"$METHOD(":72,",":73,functionArg:74,templateString:75,templateStart:76,templateTail:77,templateEnd:78,templateContinue:79,TEMPLATE:80,TPL_START:81,TPL_CONTINUE:82,TPL_END:83,"{":84,"}":85,objectEntries:86,objectEntry:87,objectEntryKeyLiteral:88,"...":89,arrayElements:90,arrayElement:91,assertionTerm:92,assertionList:93,compareExpr:94,ORDER:95,sliceNotationComponent:96,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",9:"$",10:";",11:":",14:"IDENT",15:"$IDENT",17:"?",20:"=>",21:"(",22:")",25:"NOT",26:"NO",27:"-",28:"+",29:"|",30:"IS",32:"IN",33:"HAS",34:"NOTIN",35:"HASNO",36:"AND",37:"OR",38:"??",39:"*",40:"/",41:"%",42:"=",43:"!=",44:"<",45:"<=",46:">",47:">=",48:"~=",51:"@",52:"#",53:"$$",54:"STRING",55:"NUMBER",56:"REGEXP",57:"LITERAL",61:"[",63:"]",65:".",66:".(",67:".[",68:"..",69:"..(",70:"METHOD(",72:"$METHOD(",73:",",80:"TEMPLATE",81:"TPL_START",82:"TPL_CONTINUE",83:"TPL_END",84:"{",85:"}",89:"...",95:"ORDER"},productions_:[0,[3,2],[4,2],[4,1],[4,1],[4,0],[6,1],[6,2],[8,2],[8,4],[8,2],[8,4],[13,1],[12,1],[16,2],[16,1],[18,2],[18,1],[18,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,1],[7,2],[7,2],[7,2],[7,2],[7,3],[7,4],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[19,1],[19,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,1],[49,3],[49,2],[49,2],[49,1],[49,1],[49,3],[49,4],[49,2],[49,2],[49,3],[49,3],[49,2],[49,2],[49,3],[49,2],[49,3],[50,3],[50,4],[50,4],[50,3],[50,3],[50,4],[50,4],[50,3],[50,3],[50,4],[64,2],[64,3],[64,2],[64,3],[71,1],[71,3],[74,1],[23,1],[23,3],[58,1],[58,2],[77,1],[77,2],[77,2],[77,3],[75,1],[76,1],[79,1],[78,1],[59,2],[59,3],[59,4],[59,3],[59,4],[59,5],[86,1],[86,3],[88,1],[88,1],[88,1],[87,1],[87,1],[87,1],[87,1],[87,1],[87,3],[87,3],[87,3],[87,2],[87,2],[87,2],[87,5],[87,1],[87,2],[90,1],[90,3],[91,1],[91,1],[91,2],[60,2],[60,3],[60,4],[31,1],[31,2],[31,3],[31,4],[92,1],[92,1],[92,1],[92,1],[93,1],[93,3],[93,3],[24,1],[24,3],[94,2],[62,1],[62,2],[62,2],[62,3],[96,1],[96,2]],table:function(t){function i(C){let E=C.match(/[\x20-\x2f]/g),M=E?Math.max(...E.map(O=>O.charCodeAt()-32)):-1;for(let O=M;O>=0;O--){let L=(32+O).toString(16),S;C=C.replace(new RegExp("\\[\\x"+L+"(.+?)\\]"),(T,N)=>S=N).replace(new RegExp("\\x"+L,"g"),S)}return C=C.replace(/<([^>]+?)>/g,(O,L)=>{let S=c[L[0]],T=1;return S>>5===1&&(S=S&31|c[L[1]]<<5,T=2),L.slice(T).repeat(S)}),C}function o(C){let E=[];for(let M=0;M<C.length;M++){let O=c[C[M]];if(O&32){let L=c[C[++M]];E.push(O&31|L<<5)}else E.push(O)}return E}let c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789~|=".split("").reduce((C,E,M)=>(C[E]=M,C),Object.create(null)),[f,d,...g]=t.split("=").map(i),y=d.split(";").map(C=>{let E=[];for(let M=0;M<C.length;M++)for(let O=0,L=c[C[M]];O<3;O++)E.push(L>>O*2&3);return E}),b=g.map(o),k=o(f).map(C=>{let E=y[C],M=Object.create(null);for(let O=0;O<E.length;O++){let L=E[O];if(L!==0){let S=b[L-1].shift();M[O]=L===1?S:[L-1,S]}}return M});for(let C=0;C<b[3].length;C+=2)k[b[3][C]][b[3][C+1]]=[3];return k}(`ABCDEFGHIJKHHHHLL<NM>NOPMMQRSQRTMUVWXYYMZaEFTO<TH>PMbQRSQRcMMHdefgBhBiBHj[ BjBkBk]BFHFHlBMmBnBoBpBqBrBMMsBtBMMMMXMWMMuB[!lBMMuB]vBgBMMwBUMZMxByBzB0B1B2B3B4BH5<DB6>BvBXe7BXevBgBM<E8B>9B~ <DB|>BgCgC<EhC>gCMMiC<C!>cHdjCMfMkClClCMMmCnCnBoCpCMtBqCrCvBMMMvBMUMMsCMxBHtCHtCtCHuCvCTXHXvB<FM>cHhBhBMFFMpBpCnCqCMOOMMzBzB2BMsCwCtCtCxC7BcMrCrCHMHtCtC=A1[ V[!C["lmkCpqC]]]<FA>[#[$[%[&['UqqWJkq]K]C][([)FgCCAAE];]]A];Ag;AwU[*ClmkOpqC]<FA>[+[,U[-qqWJnqK]]C(A]wAA[.A[/kAMAqi]]<Fq>CAAAAD<JA>g;AwADwzwP8|D<GA>||DMz|PDAwDPw;AwA8AwAMA|z<F|>DAAAIjqCMAA8MAAw;AAE!<FA>#wA8AwgMA|z<F|>DAAAMz|DMAA8MAAw;AAVClmkapqC<FA>&S(AwA8AwAMA|z<F|>DAAAMz|DIAA8MAAw;AwAoAwAMA|z<F|>DAAAMz|DMAA8MAAw;AwA8AwAMA|z<F|>DAAAMz|DMAA8MAAw;AAEi"<FA>UqqWZmqKCFgCCgFEB;AAAChCACIAE<IA>C<KA>Q;AwAsAwBMA|z<F|>DAAAMz|DMAA8MAAw;AAAAk<QA>EAIC;AEV*<FA>#E <FA>+A <FA>#AE!<FA>%VlqCAAE;AARClC<MA>KCIEAICAAAYl;AwE~lmkOp6y<F|>X-OFg~OAA0;AwA|wzwP8|z<F|>D||DMz|PPAw|PAAw;AAEClmkKpqC<FA>'aC(AAADwzwD8|D<GA>||DMw|PDAw|D;M;AAEi"<FA>UqqWZmqKC)B;AwA8.<Fq>CAAAMz|DMAA8MAA<Cg;AAAAAA>AI<QA>I;<FA>kAIAqi<Fq>C<OA>g;AAU!<FA>$<HA>M<QA>M;AAA8AwgMA|z<F|>DAAAMw|DM<GA>w;AwA8A0AMA6jq|qqqCAAAMz|DMAA8MAAw;AwA8A0AMA|z||q||DAAAMz|DMAA8MAAw<C;AAAAAAAAAAAAAAAAAAAAAC>AAI;AAAg<RA>D<KA>B;AAAgAkAAAqi<Fq>CAAAADAAM<GA>gB;<VA>DAAM;AAEy"<FA>+AE!<FA>,O(AAAChCACA<KA>C<KA>Q;AAAChCACIAE<IA>C<KA>QB;<HA>I;AwA8AkAMA6i<Fq>CAAAMz|DMAA8MAAw;<FA>kAAAqi<Fq>C<JA>FoAAAg;<YA>IAAAI;AAQClC<MA>KCIEAICAAAYl;<YA>MAAAM;AAAo<UA>MAAAM;AAEq"<FA>&OFgCOAAE;AAEi"<FA>&OFgCOAAE;AAE!<FA>&OFgCOAAE;AAAg<UA>MAAAM;AAAClmECAgC<FA>&OFgCO;AAAw<UA>MAAAM;<FA>/<Fq>C<HA>M<GA>g;AwA8A0AMA6z||qqqCAAAMz|DMAA8MAAw;AwA8A0AMA6jqvqqqCAAAMz|DMAA8MAAw;AwA8A0AMA6jquqqqCAAAMz|DMAA8MAAw;AwA8A0AMA|z<F|>DAAAMz|DMAA8MAAw;AwA8A0AMA6z||qvqDAAAMz|DMAA8MAAw;AwA8A0AMA6z||q||DAAAMz|DMAA8MAAw;AAAgAkAAAqi<Fq><CCAAAA><FA>gB;<FA>C<SA>Q;<FA>kAAAqi<Fq>C<OA>g;AAAIAkAAAqi<Fq>C<OA>g;AAE!<FA>UqqWJmqKCFgCCgEE;<VA>D;AAAwAkAAAqi<Fq>CAAAAD<JA>g;<FA>kAAAqi<Fq>CAAAADAAM<GA>g;<HA>IAAAAK;<HA>MAAAAP;AAAClC<MA>KCIEAICAAAIl;<FA>kAAAqi<Fq>C<HA>MAAAMAAg;<FA>kAAAqi<Fq><CCAAAA><FA>g;<UA>IgqCMAAAM;AAAIAkAAAqi<Fq>C<HA>MAAAMAAg;AAAg=BC[ D[!E["[#F[$QhBgBG]][%[&['[(KRSbcd]iB]pBqB]T]]]]zB[)0B$%qC]y[*C[[,+[-0ChBgB]]G%]]5C4C#3C'6CpBqBT9*~*|*gD+pD-G(lD[.iBpBqB]nDqDToDzDtDuD2D4D5D6D 7D 8D9D~D gE|D"jE-G&hEiEkETpEF[/sEtEuE]oEqEvE1E+4E-G'3EpBqBT4E-G'6EpBqBTqC8E7!zD9EuD~E+|E+gF+hF+iF+jF+kF+lF+mF+nF+oF+pF+qF+rF+sF+tF+uF+vF+wF+xFzF-G(0F.ToD1F2F3F 4F 5F6F7F qC8F+qChG0B$%jG-G&iG<EqC>kG+lG+pGqCqGrG+sG+zDtGzDwGuDvGxG+qC1G)2G3GjE-G&4GiEkET0B/8GqEvE~G+gH+hH+jH,kHRSbcd.qCqCqCpH0B$%<UqC>qGqCvH+xH<EqC>4H-G&3HT5HqCqCzDwGuD6HqCqCjE-G&~HiEkETiItEuEgIvElI+qCmI+qCqCnI+qC5C4C"pI+qCqCqI+qCzDsIuDzDtIuD~G+iItEuEgIvE<FqC>xI+yI+qCqC=[ [!["P[#[$[%[&['tBIsBHJ]LMNO][(oB[)fUVWXYZae]]][*jBkBlBmBnBuBvBwBxB]]r]]B]y][+B[,![-[.sB|B~B][/1B2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC]]]rC]sCtCuCvCwCxCzC#B1CPtB7CsBHJ2CLMNO(*rB8C<EzC#B>hDiDjDkDzCrD%mD*rBsDyDxD1DwDvD0D3D<CtBuBvB!!>zC$mElErBrEtB1DyEzE0EwEuBvBnExEzC&)*rBzC'2ELMNO(*rBzC'5ELMNO(*rB-rC DxD1DwDvD0D<TzC#B>3DzCrD%yF*rBtBuBv<CB">BtBuBv+zC#B9F~F|FsBgG|B~B/rC!1CzC#B<C|B~B3B4B5B6BgChCiCjCkClCmCnCoCpC><CgChCiC><CzC#B>mGnGoGrDrD-rC<CzC#B>yDxD1DuG0DyDxD1DwDvD0DzC&)*rByGzG0G.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC,mElErCzC$mElErB6G5GrEtB1DyEzE0EwEuBvB7GxEhDiDzCjD9G#BzC|G#BzC#BiHzC#BzCtB1DsBlH(*rB.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpCmHnH-rCoHnH.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC!<E|B~BgChCiCjCkClCmCnCoCpC>|B~B3B4B5B6B9BgChCiCjCkClCmCnCoCpC|B~B3B4B5B6B7B9BgChCiCjCkClCmCnCoCpC|B~B3B4B5B6BgChCiCjCkClCmCnCoCp<CCgChCi><CC|B~BgChCiClCmCnCo><FC|B~BgChCi>ClCmCnCoCrD-qHrCrHsHtHuH-rCzC#BwHyHsBzH|B~B/rC-rC0H-rC1H-rCzC%2H*rBsDrD<C-rC>yDxD1DwDvD0D7H8H9H<C.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC>zC$mElErBhItB1DyEzE0EwEuBvB|HxEkIjI<CzC#B-rC>-rCzC#B-oIrCsCtCuCvCwCxC!zC#B.2B3B4B5B6B7B8B9BgChCiCjCkClCmCnCoCpC-rCzC#B-rCrI8H9H<CyDxD1DwDvD0D>zCuI#BhItB1DyEzE0EwEuBvBvIxE1H<D-rC>wI<C-rC><CzC#B><C-rC>=FDDDEEE<jBG><gBT><mBN><lBY><kB4B><kB6B><mB0B><mB1B><mB7E><mB2B><mB3B><mB5B><mB7B><mB8B><mB9B><mB~B><mB|B><mBgC><mBhC><lBS><mBlC><mBmC>FFF<mBlD><cP><5BM><mBrD><gBsD>BCCC<jBH><lBS><mB9E>FFF<PU><mB4B><mB6B>jDjDNNNiD<bN>iDN<WZ><Wa><jBb><jBc><jBI><jBK><mBtE>~EqEqEoEoEiFiFrErE<mBjC><mBwE><mB0E><mB1E><mB2E><mB3E><5BN><mBkC><cR><mBpC><mBqC><mBtC><mBuC><RwC><mBmD><mBnD><mBuD><gBtD><mBvD>1D1[ D6D6D7D7D]8D8D9D9D~D~DmEmE<D3D><D4D><D5D><RO><5B8C>gDgD<5B~C><Rd><mBf><agB><ahB><aiB><ajB><VkB><UlB><WmB><jBnB><jBoB><mBpB><mBqB><mBrB><dsB><dtB><hBuB><hBvB><hBwB><hBxB><dyB><mBzB><mByC><mB1C><mB2C><mB5C><mB6C><PV><mBnC><mB8E><mBiC><mBuE>|EgFjFjFsEsE<mBxE><D4E><RQ><mBrC><mBsC><mBvC><RxC><mBoD><mBpD><mBwD><mByD>iEiEjEjEkEkEnEnE<5B9C><5B|C><Re><mBzC><mB0C><mB3C><mB4C><mB7C><PW>kDkDiDiD<mBoC><jBJ><jBL><mBvE>pEpEqEqEhF<mByE><mBqD><mBxD>2D2 <mBzD>hEhE|D|DgEgEhDhD<PX><mBzE><D5E><D6E><mB0D>hEhElElE=BB`),defaultActions:{50:[2,1],201:[2,159],249:[2,161]},performAction(n,t,i,o,l,c,f){let d=c.length-1;switch(l){case 1:return o.buildResult(c[d-1]);case 2:this.$={type:"Block",definitions:c[d-1],body:c[d],range:this._$.range};break;case 3:this.$={type:"Block",definitions:c[d],body:{type:"Placeholder",range:[f[d].range[1],f[d].range[1]]},range:this._$.range};break;case 4:this.$={type:"Block",definitions:[],body:c[d],range:this._$.range};break;case 5:this.$={type:"Block",definitions:[],body:{type:"Placeholder",range:[f[d].range[1],f[d].range[1]]},range:this._$.range};break;case 6:case 96:case 99:case 101:case 117:case 136:case 152:case 155:this.$=[c[d]];break;case 7:c[d-1].push(c[d]);break;case 8:this.$={type:"Definition",declarator:{type:"Declarator",name:null,range:f[d-1].range},value:null,range:this._$.range};break;case 9:this.$={type:"Definition",declarator:{type:"Declarator",name:null,range:f[d-3].range},value:c[d-1],range:this._$.range};break;case 10:this.$={type:"Definition",declarator:{type:"Declarator",name:c[d-1].name,range:f[d-1].range},value:null,range:this._$.range};break;case 11:this.$={type:"Definition",declarator:{type:"Declarator",name:c[d-3].name,range:f[d-3].range},value:c[d-1],range:this._$.range};break;case 12:case 13:case 98:case 148:case 149:this.$={type:"Identifier",name:c[d],range:this._$.range};break;case 14:case 16:case 163:this.$=c[d];break;case 15:case 17:this.$={type:"Placeholder",range:[f[d].range[1],f[d].range[1]]};break;case 18:case 162:this.$=null;break;case 19:case 52:case 53:case 64:case 65:case 138:break;case 20:case 22:this.$={type:"Function",arguments:[],body:c[d],range:this._$.range};break;case 21:this.$={type:"Function",arguments:[{type:"Identifier",name:c[d-2]}],body:c[d],range:this._$.range};break;case 23:this.$={type:"Function",arguments:c[d-3],body:c[d],range:this._$.range};break;case 24:this.$={type:"CompareFunction",compares:c[d],range:this._$.range};break;case 25:case 26:case 27:case 28:case 67:this.$={type:"Prefix",operator:c[d-1],argument:c[d],range:this._$.range};break;case 29:this.$={type:"Pipeline",left:c[d-2],right:c[d],range:this._$.range};break;case 30:this.$={type:"Pipeline",left:c[d-3],right:{type:"Block",definitions:c[d-1],body:c[d]},range:this._$.range};break;case 31:this.$={type:"Postfix",operator:c[d],argument:c[d-2],range:this._$.range};break;case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:this.$={type:"Binary",operator:c[d-1],left:c[d-2],right:c[d],range:this._$.range};break;case 51:this.$={type:"Conditional",test:c[d-2],consequent:c[d-1],alternate:c[d],range:this._$.range};break;case 54:this.$={type:"Data",range:this._$.range};break;case 55:this.$={type:"Context",range:this._$.range};break;case 56:this.$={type:"Current",range:this._$.range};break;case 57:this.$={type:"Arg1",range:this._$.range};break;case 58:this.$={type:"Reference",name:c[d],range:this._$.range};break;case 59:case 60:case 61:case 62:case 107:case 108:case 109:case 110:case 119:case 120:case 121:this.$={type:"Literal",value:c[d],range:this._$.range};break;case 63:this.$={type:"Template",values:c[d],range:this._$.range};break;case 66:this.$={type:"SliceNotation",value:null,arguments:c[d-1],range:this._$.range};break;case 68:this.$={type:"Conditional",test:null,consequent:c[d-1],alternate:c[d],range:this._$.range};break;case 69:case 73:this.$={type:"GetProperty",value:null,property:c[d],range:this._$.range};break;case 70:case 74:this.$={type:"MethodCall",value:null,method:c[d],range:this._$.range};break;case 71:this.$={type:"Parentheses",body:c[d-1],range:this._$.range};break;case 72:this.$={type:"Parentheses",body:{type:"Block",definitions:c[d-2],body:c[d-1]},range:this._$.range};break;case 75:this.$={type:"Map",value:null,query:c[d-1],range:this._$.range};break;case 76:this.$={type:"Filter",value:null,query:c[d-1],range:this._$.range};break;case 77:this.$={type:"MapRecursive",value:null,query:{type:"GetProperty",value:null,property:c[d]},range:this._$.range};break;case 78:this.$={type:"MapRecursive",value:null,query:{type:"MethodCall",value:null,method:c[d]},range:this._$.range};break;case 79:this.$={type:"MapRecursive",value:null,query:c[d-1],range:this._$.range};break;case 80:this.$={type:"Pipeline",left:null,right:c[d],range:this._$.range};break;case 81:this.$={type:"Pipeline",left:null,right:{type:"Block",definitions:c[d-1],body:c[d]},range:this._$.range};break;case 82:this.$={type:"Pick",value:c[d-2],getter:null,range:this._$.range};break;case 83:this.$={type:"Pick",value:c[d-3],getter:c[d-1],range:this._$.range};break;case 84:this.$={type:"SliceNotation",value:c[d-3],arguments:c[d-1],range:this._$.range};break;case 85:this.$={type:"GetProperty",value:c[d-2],property:c[d],range:this._$.range};break;case 86:this.$={type:"MethodCall",value:c[d-2],method:c[d],range:this._$.range};break;case 87:this.$={type:"Map",value:c[d-3],query:c[d-1],range:this._$.range};break;case 88:this.$={type:"Filter",value:c[d-3],query:c[d-1],range:this._$.range};break;case 89:this.$={type:"MapRecursive",value:c[d-2],query:{type:"GetProperty",value:null,property:c[d]},range:this._$.range};break;case 90:this.$={type:"MapRecursive",value:c[d-2],query:{type:"MethodCall",value:null,method:c[d]},range:this._$.range};break;case 91:this.$={type:"MapRecursive",value:c[d-3],query:c[d-1],range:this._$.range};break;case 92:this.$={type:"Method",reference:{type:"Identifier",name:c[d-1],range:[f[d-1].range[0],f[d-1].range[1]-1]},arguments:[],range:this._$.range},this._mn=c[d-1];break;case 93:this.$={type:"Method",reference:{type:"Identifier",name:c[d-2],range:[f[d-2].range[0],f[d-2].range[1]-1]},arguments:c[d-1],range:this._$.range},this._mn=c[d-2];break;case 94:this.$={type:"Method",reference:{type:"Reference",name:{type:"Identifier",name:c[d-1],range:[f[d-1].range[0],f[d-1].range[1]-1]},range:[f[d-1].range[0],f[d-1].range[1]-1]},arguments:[],range:this._$.range},this._mn=c[d-1];break;case 95:this.$={type:"Method",reference:{type:"Reference",name:{type:"Identifier",name:c[d-2],range:[f[d-2].range[0],f[d-2].range[1]-1]},range:[f[d-2].range[0],f[d-2].range[1]-1]},arguments:c[d-1],range:this._$.range},this._mn=c[d-2];break;case 97:case 100:case 118:case 137:case 156:c[d-2].push(c[d]);break;case 102:this.$=[c[d-1],...c[d]];break;case 103:case 158:this.$=[null,c[d]];break;case 104:case 160:this.$=[c[d-1],c[d]];break;case 105:this.$=[null,c[d-1],...c[d]];break;case 106:this.$=[c[d-2],c[d-1],...c[d]];break;case 111:case 114:this.$={type:"Object",properties:[],range:this._$.range};break;case 112:this.$={type:"Object",properties:c[d-1],range:this._$.range};break;case 113:this.$={type:"Object",properties:c[d-2],range:this._$.range};break;case 115:this.$={type:"Block",definitions:c[d-2],body:{type:"Object",properties:c[d-1]},range:this._$.range};break;case 116:this.$={type:"Block",definitions:c[d-3],body:{type:"Object",properties:c[d-2]},range:this._$.range};break;case 122:this.$={type:"ObjectEntry",key:{type:"Current"},value:null,range:this._$.range};break;case 123:this.$={type:"ObjectEntry",key:{type:"Reference",name:c[d]},value:null,range:this._$.range};break;case 124:case 126:this.$={type:"ObjectEntry",key:c[d],value:null,range:this._$.range};break;case 125:this.$={type:"ObjectEntry",key:{type:"Literal",value:this._mn},value:c[d],range:this._$.range};break;case 127:case 128:this.$={type:"ObjectEntry",key:c[d-2],value:c[d],range:this._$.range};break;case 129:this.$={type:"ObjectEntry",key:{type:"Identifier",name:"$"+c[d-2].name},value:c[d],range:this._$.range};break;case 130:this.$={type:"ObjectEntry",key:c[d-1],value:{type:"Pipeline",left:{type:"Reference",name:c[d-1]},right:c[d]},range:this._$.range};break;case 131:this.$={type:"ObjectEntry",key:c[d-1],value:{type:"Pipeline",left:{type:"GetProperty",value:null,property:c[d-1]},right:c[d]},range:this._$.range};break;case 132:this.$={type:"ObjectEntry",key:{type:"Literal",value:this._mn},value:{type:"Pipeline",left:c[d-1],right:c[d]},range:this._$.range};break;case 133:this.$={type:"ObjectEntry",key:c[d-3],value:c[d],range:this._$.range};break;case 134:this.$={type:"Spread",query:null,array:!1,range:this._$.range};break;case 135:this.$={type:"Spread",query:c[d],array:!1,range:this._$.range};break;case 139:this.$={type:"Spread",query:null,array:!0,range:this._$.range};break;case 140:this.$={type:"Spread",query:c[d],array:!0,range:this._$.range};break;case 141:this.$={type:"Array",elements:[],range:this._$.range};break;case 142:this.$={type:"Array",elements:c[d-1],range:this._$.range};break;case 143:this.$={type:"Array",elements:c[d-2],range:this._$.range};break;case 144:this.$={type:"Assertion",negation:!1,assertion:c[d],range:this._$.range};break;case 145:this.$={type:"Assertion",negation:!0,assertion:c[d],range:this._$.range};break;case 146:this.$={type:"Assertion",negation:!1,assertion:c[d-1],range:this._$.range};break;case 147:this.$={type:"Assertion",negation:!0,assertion:c[d-1],range:this._$.range};break;case 150:this.$={type:"Method",reference:{type:"Reference",name:c[d]},arguments:[],range:this._$.range};break;case 151:this.$={type:"Identifier",name:String(c[d]),range:this._$.range};break;case 153:case 154:c[d-2].push(c[d-1],c[d]);break;case 157:this.$={type:"Compare",query:c[d-1],order:c[d],range:this._$.range};break;case 159:this.$=[null,c[d-1],c[d]];break;case 161:this.$=[c[d-2],c[d-1],c[d]];break}},trace(...n){this.DEBUG&&Jison.print(...n)},parseError(n,t){if(t.recoverable)this.trace(n);else{let i=new Error(n);throw i.hash=t,i}},parse(n,...t){let d=H=>{O.length-=2*H,L.length-=H,S.length-=H},g=()=>{let H=y.lex()||1;return typeof H!="number"&&(H=this.symbols_[H]||H),H},y=Object.create(this.lexer),b=y.options&&y.options.ranges,k={...this.yy,parser:this,lexer:y};y.setInput(n,k),typeof k.parseError=="function"&&(this.parseError=k.parseError),typeof y.yylloc>"u"&&(y.yylloc={});let C=this.table,E={},M=y.yylloc,O=[0],L=[null],S=[M],T=[],N="",A=0,j=0,I=0,z,W;for(;;){let H=O[O.length-1],te;if(this.defaultActions[H]?te=this.defaultActions[H]:((z===null||typeof z>"u")&&(z=g()),te=C[H]&&C[H][z]),!te||!te[0]){let D=function(Q){let X=O.length-1,de=0;for(;;){if("2"in C[Q])return de;if(Q===0||X<2)return!1;X-=2,Q=O[X],++de}},_,$="";if(!I){let Q=[];for(let X in C[H])X in this.terminals_&&X>2&&Q.push("'"+this.terminals_[X]+"'");$=y.showPosition?"Parse error on line "+(A+1)+`:
`+y.showPosition()+`
Expecting `+Q.join(", ")+", got '"+(this.terminals_[z]||z)+"'":"Parse error on line "+(A+1)+": Unexpected "+(z===1?"end of input":"'"+(this.terminals_[z]||z)+"'"),this.parseError($,{text:y.match,token:this.terminals_[z]||z,line:y.yylineno,loc:M,expected:Q})}if(I===3){if(z===1||W===1)throw new Error($||"Parsing halted while starting to recover from another error.");j=y.yyleng,N=y.yytext,A=y.yylineno,M=y.yylloc,z=g()}if(_===!1)throw new Error($||"Parsing halted. No suitable error recovery rule available.");d(_),W=z==2?null:z,z=2,H=O[O.length-1],te=C[H]&&C[H][2],I=3}if(Array.isArray(te[0])&&te.length>1)throw new Error("Parse Error: multiple actions possible at state: "+H+", token: "+z);switch(te[0]){case 1:O.push(z),L.push(y.yytext),S.push(y.yylloc),O.push(te[1]),z=null,W?(z=W,W=null):(j=y.yyleng,N=y.yytext,A=y.yylineno,M=y.yylloc,I>0&&I--);break;case 2:{let _=this.productions_[te[1]][1],$=S[S.length-(_||1)],D=S[S.length-1];E.$=L[L.length-_],E._$={first_line:$.first_line,last_line:D.last_line,first_column:$.first_column,last_column:D.last_column},b&&(E._$.range=[$.range[0],D.range[1]]);let Q=this.performAction.call(E,N,j,A,k,te[1],L,S,...t);if(typeof Q<"u")return Q;_&&d(_),O.push(this.productions_[te[1]][0]),L.push(E.$),S.push(E._$),O.push(C[O[O.length-2]][O[O.length-1]]);break}case 3:return!0}}}};var Zb=function(t){function i(T,N){Object.entries(N).forEach(([A,j])=>T[A]=j(T[A]))}let o=new Map([["EOF",["<end of input>"]],["IDENT",["ident"]],["$IDENT",["$ident"]],["NOT",["'not'"]],["NO",["'no'"]],["IS",["'is'"]],["IN",["'in'"]],["HAS",["'has'"]],["NOTIN",["'not in'"]],["HASNO",["'has no'"]],["AND",["'and'"]],["OR",["'or'"]],["STRING",["string"]],["TPL_START",["template"]],["TEMPLATE",["template"]],["NUMBER",["number"]],["REGEXP",["regexp"]],["LITERAL",["'true'","'false'","'null'","'undefined'","'NaN'","'Infinity'"]],["ORDER",["'asc'","'desc'","'ascN'","'descN'"]],["METHOD(",["'method('"]],["$METHOD(",["'$method('"]]]),l=T=>o.get(T)||`'${T}'`,c=function(T,N={},A){if(N.recoverable)this.trace(T);else{if(Array.isArray(N.inside)){let H=A.lexer.offset-A.lexer.match.length;A.lexer.setMatch(H+N.inside[0],H+N.inside[1])}let j=A.lexer.yylloc,I=[T.split(/\n/)[0],"",A.lexer.showPosition()],z=Array.isArray(N.expected)?[...new Set([].concat(...N.expected.map(H=>l(H.slice(1,-1)))))]:null;z&&I.push("","Expecting "+z.join(", ")+" got "+l(N.token));let W=new SyntaxError(I.join(`
`));throw W.details={rawMessage:T,text:N.text,token:N.token,expected:z,loc:{range:j.range,start:{line:j.first_line,column:j.first_column,offset:j.range[0]},end:{line:j.last_line,column:j.last_column,offset:j.range[1]}}},W}},f=new Set([`
`,"\r","\u2028","\u2029"]),d=new Map([["undefined",void 0],["null",null],["false",!1],["true",!0],["Infinity",1/0],["NaN",NaN]]);Object.assign(t.lexer,{ident:T=>T.replace(/\\u[0-9a-fA-F]{4}/g,N=>String.fromCharCode(parseInt(N.slice(2),16))),toLiteral:T=>d.get(T),toNumberLiteral(T,N,A=!1){if(N){let j=T.match(A?/(?:^|[^0-9a-fA-F])_|_(?:[^0-9a-fA-F]|$)/:/(?:^|\D)_|_(?:\D|$)/);if(j){let I=j[0],z=j.index+ +(I[1]==="_"),W=I==="__"?"Only one underscore is allowed":"Wrong underscore";this.parseError(W+" as numeric separator",{inside:[z,z+1]})}T=T.replace(/_/g,"")}return A?parseInt(T,16):parseFloat(T)},toStringLiteral(T,N=!1,A=1){let j=T.length-A,I="";for(let z=1;z<j;z++){if(!N&&f.has(T[z])&&this.parseError("Invalid line terminator",{inside:[z,z+1]}),T[z]!=="\\"){I+=T[z];continue}z===j-1&&this.parseError("Invalid backslash",{inside:[z,z+1]});let W=T[++z];switch(W){case"\r":z+=T[z+1]===`
`;break;case`
`:case"\u2028":case"\u2029":break;case"0":I+="\0";break;case"b":I+="\b";break;case"n":I+=`
`;break;case"r":I+="\r";break;case"f":I+="\f";break;case"t":I+="	";break;case"v":I+="\v";break;case"u":{let[H=""]=T.slice(z+1,z+5).match(/^[0-9a-f]*/i)||[];if(H.length===4){I+=String.fromCharCode(parseInt(H,16)),z+=4;break}this.parseError("Invalid Unicode escape sequence",{inside:[z-1,Math.min(z+1+H.length,j)]});break}case"x":{let[H=""]=T.slice(z+1,z+3).match(/^[0-9a-f]*/i)||[];if(H.length===2){I+=String.fromCharCode(parseInt(H,16)),z+=2;break}this.parseError("Invalid hexadecimal escape sequence",{inside:[z-1,Math.min(z+1+H.length,j)]});break}default:I+=W}}return I},toRegExp(T){let N=T.lastIndexOf("/")+1,A=T.substr(N);return A.split("").forEach((j,I,z)=>{let W=z.indexOf(j,I+1);W!==-1&&this.parseError("Duplicate flag in regexp",{inside:[N+W,N+W+1]})}),new RegExp(T.substr(1,T.lastIndexOf("/")-1),A)}}),i(t.lexer,{setInput:T=>function(N,A){let j=[];return A.commentRanges=j,A.buildResult=I=>({ast:I,commentRanges:j}),A.parseError=function(...I){return c.call(this,...I,A)},A.pks=()=>{this.eof()||this.begin("preventKeyword")},A.pps=()=>{this.eof()||this.begin("preventPrimitive")},this.bracketStack=[],this.prevToken=null,this.prevYylloc={first_line:1,last_line:1,first_column:0,last_column:0,range:[0,0]},T.call(this,N,A)}});let g=new t.Parser;g.lexer={...t.lexer},g.yy={...t.yy};let y=["AND","OR","IN","NOTIN","HAS","HASNO","IS"],b=[...y,"NOT","NO","ORDER"],k=["+","-","*","/","%","|","=","!=","~=",">=","<=","<",">"],C=[null,"?",":",";",",",".","..","(",".(","..(","METHOD(","$METHOD(","[",".[","=>",...k,...y,"NOT","NO"],E=[",","?",":",";","EOF","]",")","}","TPL_CONTINUE","TPL_END",...k,...y,"ORDER"],M=new Map(C.map(T=>[T,new Set(E)]));for(let T of[".(","..(","METHOD(","$METHOD("])M.get(T).delete(")");for(let T of["[",".["])M.get(T).delete("]");i(g.lexer,{lex:T=>function(){let A=this.offset,j=T.call(this);if(M.has(this.prevToken)&&M.get(this.prevToken).has(j)){let I={first_line:this.prevYylloc.last_line,last_line:this.yylloc.first_line,first_column:this.prevYylloc.last_column,last_column:this.yylloc.first_column,range:[this.prevYylloc.range[1],this.yylloc.range[0]]};if(this.unput(this.match),this.pushState("preventPrimitive"),this.done=!1,this.yytext="",this.yylloc=this.prevYylloc=I,A!==this.offset&&b.includes(j))switch(this._input[A]){case" ":case"	":I.last_column--,I.range[1]--;break;case`
`:{let z=this._input.lastIndexOf(`
`,A-1);I.last_line--,I.last_column=z===-1?I.last_column-1:A-z,I.range[1]--;break}}return this.prevToken="IDENT"}if(this.prevYylloc=this.yylloc,b.includes(j))switch(this._input[this.offset]){case" ":case"	":this.prevYylloc={...this.prevYylloc,last_column:this.prevYylloc.last_column+1,range:[this.prevYylloc.range[0],this.prevYylloc.range[1]+1]};break;case`
`:this.prevYylloc={...this.prevYylloc,last_line:this.prevYylloc.last_line+1,last_column:0,range:[this.prevYylloc.range[0],this.prevYylloc.range[1]+1]};break}return this.prevToken=j}});let O=new Map([["(",")"],[".(",")"],["..(",")"],["METHOD(",")"],["$METHOD(",")"],["[","]"],[".[","]"],["{","}"],["TPL_START","TPL_END"]]),L=new Set([")","]","}","TPL_END"]),S=T=>function(){let A=T.call(this);if(L.has(A)){let j=this.bracketStack.pop();j!==A&&this.parseError(`Expected "${j}" got "${A}"`)}return O.has(A)&&this.bracketStack.push(O.get(A)),A};return i(t.lexer,{lex:S}),i(g.lexer,{lex:S}),{parse(T,N){return N?g.parse(T):t.parse(T)},*tokenize(T,N,A){let j=N?g:t,I=Object.create(j.lexer);for(I.setInput(T,{parser:j});!I.done;){let z={type:I.lex(),value:I.match,offset:I.yylloc.range[0]};A&&(z.loc={range:I.yylloc.range,start:{line:I.yylloc.first_line,column:I.yylloc.first_column},end:{line:I.yylloc.last_line,column:I.yylloc.last_column}}),yield z}}}}(new fl),ws=Zb;var dl={};Ae(dl,{compile:()=>Xb,stringify:()=>tw,walk:()=>ew});function Xb(n,t){t.put(t.scope.arg1?"arguments[1]":"undefined")}function ew(){}function tw(n,t){t.put("$$")}var pl={};Ae(pl,{compile:()=>rw,stringify:()=>ow,suggest:()=>nw,walk:()=>iw});function nw(n,t){n.elements.length===0&&t.queryRoot(n.range[0]+1,n.range[1]-1)}function rw(n,t){t.put("["),t.list(n.elements,","),t.put("]")}function iw(n,t){t.list(n.elements)}function ow(n,t){t.put("["),t.list(n.elements,","),t.put("]")}var hl={};Ae(hl,{compile:()=>aw,stringify:()=>uw,suggest:()=>sw,walk:()=>lw});function sw(n,t){Array.isArray(n.assertion)||(t.range(n.assertion.range,"var"),t.range(n.assertion.range,"assertion"))}function aw(n,t){if(Array.isArray(n.assertion)){t.put(n.negation?"!(":"(");for(let i=0;i<n.assertion.length;i++)if(i%2===0)t.node(n.assertion[i]);else switch(n.assertion[i]){case"and":t.put("&&");break;case"or":t.put("||");break;default:t.error("Bad conjuction operator in assertion",n)}t.put(")")}else switch(n.negation&&t.put("!"),n.assertion.type){case"Identifier":n.assertion.name?(t.put("!!"),t.tolerant&&t.put("(typeof "),t.put("a."),t.put(n.assertion.name),t.tolerant&&(t.put('==="function"?a.'),t.put(n.assertion.name)),t.put(".call(mctx,"),t.nodeOrCurrent(),t.put(")"),t.tolerant&&t.put(":false)"),t.usedAssertions.has(n.assertion.name)?t.usedAssertions.get(n.assertion.name).push(n.assertion.range):t.usedAssertions.set(n.assertion.name,n.assertion.range)):t.put("false");break;case"Method":t.put("!!"),t.node(n.assertion);break;default:t.error('Unknown assertion node type "'+n.assertion.type+'"',n.assertion)}}function lw(n,t){if(Array.isArray(n.assertion))for(let i=0;i<n.assertion.length;i++)i%2===0&&t.node(n.assertion[i]);else t.node(n.assertion)}function uw(n,t){if(n.negation&&t.put("not "),Array.isArray(n.assertion)){t.put("(");for(let i=0;i<n.assertion.length;i++)i%2===0?t.node(n.assertion[i]):(t.put(" "),t.put(n.assertion[i]),t.put(" "));t.put(")")}else t.node(n.assertion)}var gl={};Ae(gl,{compile:()=>fw,stringify:()=>pw,suggest:()=>cw,walk:()=>dw});var Pd={in:"in","not in":"notIn",has:"has","has no":"hasNo",and:"and",or:"or","??":"nullish","+":"add","-":"sub","*":"mul","/":"div","%":"mod","=":"eq","!=":"ne","<":"lt","<=":"lte",">":"gt",">=":"gte","~=":"match"};function xs(n,t,i){if(i.type==="Array"){if(i.elements.length===0){n.range([i.range[0]+1,i.range[1]-1],"value-subset",t,!1);return}let o=[];for(let{type:c,range:f,value:d}of i.elements)f&&(c==="Literal"||c==="Identifier")&&o.push(d);let l=o.length?n.literalList(o):!1;for(let{type:c,range:f,value:d}of i.elements)f&&(c==="Literal"||c==="Identifier"||c==="GetProperty"&&d===null)&&n.range(f,"value-subset",t,l)}}function cw(n,t){switch(n.operator){case"in":t.range(n.left.range,"in-value",n.right,null),xs(t,n.left,n.right);break;case"not in":xs(t,n.left,n.right);break;case"has":t.range(n.right.range,"in-value",n.left,null),xs(t,n.right,n.left);break;case"has no":xs(t,n.right,n.left);break;case"=":case"!=":t.range(n.right.range,"value",n.left,null);break}}function fw(n,t){if(!(n.operator in Pd)){t.error('Unknown operator "'+n.operator+'"',n);return}switch(n.operator){case"and":t.put("!");case"or":{let i=t.allocateVar();t.put(`${t.buildinFn("bool")}(${i}=`),t.node(n.left),t.put(`)?${i}:`),t.createScope(()=>t.node(n.right),o=>(t.put(")"),"("+o+","),t.scope.$ref);break}case"??":{let i=t.allocateVar();t.put(`(${i}=`),t.node(n.left),t.put(`,${i}!==null&&${i}!==undefined)?${i}:`),t.createScope(()=>t.node(n.right),o=>(t.put(")"),"("+o+","),t.scope.$ref);break}case"has no":t.put("!");case"has":t.put(t.buildinFn("in")),t.put("("),t.node(n.right),t.put(","),t.node(n.left),t.put(")");break;default:t.put(t.buildinFn(Pd[n.operator])),t.put("("),t.node(n.left),t.put(","),t.node(n.right),t.put(")")}}function dw(n,t){t.node(n.left),t.node(n.right)}function pw(n,t){t.node(n.left),/^[a-z]/i.test(n.operator)?(t.put(" "),t.put(n.operator),t.put(" ")):t.put(n.operator),t.node(n.right)}var ml={};Ae(ml,{compile:()=>gw,stringify:()=>yw,suggest:()=>hw,walk:()=>mw});function hw(n,t){n.body===null&&t.queryRoot(n.range[1])}function gw(n,t){n.definitions.length?(t.put("(()=>{"),t.createScope(()=>{for(let i of n.definitions)t.scope.awaitInit.add(i.declarator.name);t.list(n.definitions),t.put("return "),t.nodeOrCurrent(n.body)},i=>i+";",t.scope.$ref),t.put("})()")):n.body&&n.body.type==="Object"?(t.put("("),t.nodeOrCurrent(n.body),t.put(")")):t.nodeOrCurrent(n.body)}function mw(n,t){t.list(n.definitions),t.nodeOrNothing(n.body)}function yw(n,t){t.list(n.definitions),t.nodeOrNothing(n.body)}var yl={};Ae(yl,{compile:()=>vw,stringify:()=>ww,walk:()=>bw});var Nd={"":"cmp",N:"cmpNatural",A:"cmpAnalytical",NA:"cmpNaturalAnalytical",AN:"cmpNaturalAnalytical"};function vw(n,t){let i=n.order.startsWith("desc"),o=Nd[n.order.slice(i?4:3)]||Nd[""];i&&t.put("-"),t.put(t.buildinFn(o)),t.put("((_q=$=>("),t.createScope(()=>t.node(n.query),l=>l+","),t.put("))(_a),_q(_b))")}function bw(n,t){t.node(n.query)}function ww(n,t){t.node(n.query),t.put(" "),t.put(n.order)}var vl={};Ae(vl,{compile:()=>xw,stringify:()=>Cw,walk:()=>kw});function xw(n,t){t.put("(_a, _b)=>{let _q;return "),t.list(n.compares,"||"),t.put("||0}")}function kw(n,t){t.list(n.compares)}function Cw(n,t){t.list(n.compares,",")}var bl={};Ae(bl,{compile:()=>Sw,stringify:()=>Aw,walk:()=>Tw});function Sw(n,t){t.put(t.buildinFn("bool")),t.put("("),t.nodeOrCurrent(n.test),t.put(")?"),t.createScope(()=>t.nodeOrCurrent(n.consequent),i=>(t.put(")"),"("+i+","),t.scope.$ref),t.put(":"),t.createScope(()=>{n.alternate?n.alternate.type==="Placeholder"?(t.put("("),t.node(n.alternate),t.put(",undefined)")):t.node(n.alternate):t.put("undefined")},i=>(t.put(")"),"("+i+","),t.scope.$ref)}function Tw(n,t){t.nodeOrNothing(n.test),t.nodeOrNothing(n.consequent),t.nodeOrNothing(n.alternate)}function Aw(n,t){t.nodeOrNothing(n.test),t.put("?"),t.nodeOrNothing(n.consequent),n.alternate&&(t.put(":"),t.node(n.alternate))}var wl={};Ae(wl,{compile:()=>Ew,stringify:()=>Mw,walk:()=>Lw});function Ew(n,t){t.put("context")}function Lw(){}function Mw(n,t){t.put("#")}var xl={};Ae(xl,{compile:()=>Ow,stringify:()=>Nw,suggest:()=>Dw,walk:()=>Pw});function Dw(n,t){n.range&&t.range(n.range,"var")}function Ow(n,t){t.put(t.scope.$ref)}function Pw(){}function Nw(n,t){t.put("$")}var kl={};Ae(kl,{compile:()=>Iw,stringify:()=>Bw,walk:()=>Rw});function Iw(n,t){t.put("data")}function Rw(){}function Bw(n,t){t.put("@")}var Cl={};Ae(Cl,{compile:()=>jw,stringify:()=>Fw,walk:()=>zw});function jw(n,t){n.name&&t.put("$"+n.name)}function zw(){}function Fw(n,t){t.put(n.name?"$"+n.name:"$")}var Sl={};Ae(Sl,{compile:()=>qw,stringify:()=>Vw,suggest:()=>_w,walk:()=>Ww});function no(n,t){return{type:"GetProperty",value:n,property:t}}function ro(n){return{type:"Identifier",name:n}}var Hw=["data","context","ctx","array","idx","index"];function _w(n,t){n.value===null&&t.range(n.declarator.range,"path")}function qw(n,t){if(n.declarator.name===null){t.node(n.declarator),t.nodeOrCurrent(n.value),t.put(";");return}if(t.scope.own.has(n.declarator.name)){t.error(`Identifier "$${n.declarator.name}" has already been declared`,n.declarator);return}if(Hw.includes(n.declarator.name)){t.error(`Identifier "$${n.declarator.name}" is reserved for future use`,n.declarator);return}t.put("const "),t.node(n.declarator),t.put("="),t.node(n.value||no(null,ro(n.declarator.name))),t.put(";"),t.scope.add(n.declarator.name),t.scope.own.add(n.declarator.name),t.scope.awaitInit.delete(n.declarator.name)}function Ww(n,t){t.node(n.declarator),t.nodeOrNothing(n.value)}function Vw(n,t){t.node(n.declarator),n.value!==null&&(t.put(":"),t.node(n.value)),t.put(";")}var Tl={};Ae(Tl,{compile:()=>Uw,stringify:()=>Gw,walk:()=>$w});function Uw(n,t){t.put(t.buildinFn("filter")),t.put("("),t.nodeOrCurrent(n.value),t.put(",$=>"),t.createScope(()=>t.node(n.query),i=>(t.put(")"),"("+i+",")),t.put(")")}function $w(n,t){t.nodeOrNothing(n.value),t.node(n.query)}function Gw(n,t){t.nodeOrNothing(n.value),t.put(".["),t.node(n.query),t.put("]")}var Al={};Ae(Al,{compile:()=>Kw,stringify:()=>Qw,walk:()=>Yw});function Kw(n,t){let i=n.arguments.map(l=>"$"+l.name),o=n.arguments.find((l,c)=>c>0&&i.lastIndexOf("$"+l.name,c-1)!==-1);o&&t.error('Duplicate parameter name "$'+o.name+'" is not allowed',o),t.put("function("),t.put(String(i)||"$"),t.put("){return "),t.createScope(()=>{t.scope.arg1=!0,t.scope.$ref=i[0]||"$";for(let l of n.arguments)t.scope.add(l.name);t.node(n.body)},l=>l+","),t.put("}")}function Yw(n,t){t.node(n.body)}function Qw(n,t){t.put("=>"),t.node(n.body)}var El={};Ae(El,{compile:()=>Zw,stringify:()=>ex,suggest:()=>Jw,walk:()=>Xw});function Jw(n,t){t.range(n.property.range,"path",n.value||void 0,!n.value),n.value===null&&t.range(n.property.range,"var"),n.range&&n.value===null&&n.property.range[0]!==n.range[0]&&t.queryRoot(n.range[0])}function Zw(n,t){t.put(t.buildinFn("map")),t.put("("),t.nodeOrCurrent(n.value),t.put(","),n.property.type==="Identifier"?t.put(JSON.stringify(n.property.name)):t.node(n.property),t.put(")")}function Xw(n,t){t.nodeOrNothing(n.value),t.node(n.property)}function ex(n,t){t.nodeOrNothing(n.value)&&t.put("."),t.node(n.property)}var Ll={};Ae(Ll,{compile:()=>tx,stringify:()=>rx,walk:()=>nx});function tx(n,t){t.put(n.name)}function nx(){}function rx(n,t){t.put(n.name)}var Ml={};Ae(Ml,{compile:()=>ix,stringify:()=>sx,walk:()=>ox});function ix(n,t){t.put(typeof n.value=="string"?JSON.stringify(n.value):String(n.value))}function ox(){}function sx(n,t){t.put(typeof n.value=="string"?JSON.stringify(n.value):String(n.value))}var Dl={};Ae(Dl,{compile:()=>ax,stringify:()=>ux,walk:()=>lx});function ax(n,t){t.put(t.buildinFn("map")),t.put("("),t.nodeOrCurrent(n.value),t.put(",$=>"),t.createScope(()=>t.node(n.query),i=>(t.put(")"),"("+i+",")),t.put(")")}function lx(n,t){t.nodeOrNothing(n.value),t.node(n.query)}function ux(n,t){t.nodeOrNothing(n.value),t.put(".("),t.node(n.query),t.put(")")}var Ol={};Ae(Ol,{compile:()=>cx,stringify:()=>dx,walk:()=>fx});function cx(n,t){t.put(t.buildinFn("mapRecursive")),t.put("("),t.nodeOrCurrent(n.value),t.put(",$=>"),t.createScope(()=>t.node(n.query),i=>(t.put(")"),"("+i+",")),t.put(")")}function fx(n,t){t.nodeOrNothing(n.value),t.node(n.query)}function dx(n,t){t.nodeOrNothing(n.value),t.put(".."),t.isSimpleGetPropertyQuery(n.query)||t.isSimpleMethodCallQuery(n.query)?t.node(n.query):(t.put("("),t.node(n.query),t.put(")"))}var Pl={};Ae(Pl,{compile:()=>hx,stringify:()=>mx,suggest:()=>px,walk:()=>gx});function px(n,t){n.arguments.length===0&&t.queryRoot(n.range[1]-1)}function hx(n,t,i){let o=n.reference.type==="Identifier";t.tolerant&&t.put("(typeof "),o&&(t.usedMethods.has(n.reference.name)?t.usedMethods.get(n.reference.name).push(n.reference.range):t.usedMethods.set(n.reference.name,[n.reference.range]),t.put("m.")),t.node(n.reference),t.tolerant&&(t.put('==="function"?'),o&&t.put("m."),t.node(n.reference)),t.put(o?".call(mctx,":"("),t.nodeOrCurrent(i),n.arguments.length&&(t.put(","),t.list(n.arguments,",")),t.put(")"),t.tolerant&&t.put(":undefined)")}function gx(n,t){t.node(n.reference),t.list(n.arguments)}function mx(n,t){t.node(n.reference),t.put("("),t.list(n.arguments,","),t.put(")")}var Nl={};Ae(Nl,{compile:()=>yx,stringify:()=>bx,walk:()=>vx});function yx(n,t){t.node(n.method,n.value)}function vx(n,t){t.nodeOrNothing(n.value),t.node(n.method)}function bx(n,t){t.nodeOrNothing(n.value)&&t.put("."),t.node(n.method)}var Il={};Ae(Il,{compile:()=>xx,stringify:()=>Cx,suggest:()=>wx,walk:()=>kx});function wx(n,t){n.properties.length===0&&t.queryRoot(n.range[0]+1,n.range[1]-1)}function xx(n,t){t.put("{"),t.list(n.properties,","),t.put("}")}function kx(n,t){t.list(n.properties)}function Cx(n,t){t.put("{"),t.list(n.properties,","),t.put("}")}var Rl={};Ae(Rl,{compile:()=>Ax,stringify:()=>Lx,suggest:()=>Tx,walk:()=>Ex});var Sx=new Set(["Literal","Identifier","Reference","Current"]);function Tx(n,t){if(n.value===null)switch(n.key.type){case"Literal":case"Identifier":t.range(n.range,"path"),t.range(n.range,"var");break;case"Current":case"Reference":t.range(n.range,"var");break}}function Ax(n,t){let i=n.value;switch(n.key.type){case"Current":t.put("...null");return;case"Literal":t.node(n.key),i=i||no(null,ro(String(n.key.value)));break;case"Identifier":t.node(n.key),i=i||no(null,ro(n.key.name));break;case"Reference":t.node(n.key.name),i=i||n.key;break;default:t.put("["),t.node(n.key),t.put("]")}t.put(":"),t.node(i)}function Ex(n,t){t.node(n.key),t.nodeOrNothing(n.value)}function Lx(n,t){if(Sx.has(n.key.type)){if(t.node(n.key),n.value===null)return}else t.put("["),t.node(n.key),t.put("]");t.put(":"),t.node(n.value)}var Bl={};Ae(Bl,{compile:()=>Mx,stringify:()=>Ox,walk:()=>Dx});function Mx(n,t){t.put("("),t.node(n.body),t.put(")")}function Dx(n,t){t.node(n.body)}function Ox(n,t){t.put("("),t.node(n.body),t.put(")")}var jl={};Ae(jl,{compile:()=>Nx,stringify:()=>Rx,suggest:()=>Px,walk:()=>Ix});function Px(n,t){if(n.getter===null){let i=n.range[1]-1;t.range([i,i],"key",n.value,!1),t.queryRoot(i)}else(n.getter.type==="GetProperty"||n.getter.type==="Reference"||n.getter.type==="Literal"&&typeof n.getter.value=="string")&&t.range(n.getter.range,"key",n.value,!1)}function Nx(n,t){t.put(t.buildinFn("pick")),t.put("("),t.node(n.value),n.getter&&(t.put(","),t.node(n.getter)),t.put(")")}function Ix(n,t){t.node(n.value),n.getter!==null&&t.node(n.getter)}function Rx(n,t){t.node(n.value),t.put("["),n.getter!==null&&t.node(n.getter),t.put("]")}var zl={};Ae(zl,{compile:()=>Bx,stringify:()=>zx,walk:()=>jx});function Bx(n,t){t.put("($=>("),t.createScope(()=>t.node(n.right),i=>i+","),t.put("))"),t.put("("),t.nodeOrCurrent(n.left),t.put(")")}function jx(n,t){t.node(n.left),t.node(n.right)}function zx(n,t){t.node(n.left),t.put("|"),t.node(n.right)}var Fl={};Ae(Fl,{compile:()=>Hx,stringify:()=>qx,suggest:()=>Fx,walk:()=>_x});function Fx(n,t){t.queryRoot(n.range[1])}function Hx(n,t){t.put(t.scope.$ref)}function _x(){}function qx(){}var Hl={};Ae(Hl,{compile:()=>Wx,stringify:()=>Ux,walk:()=>Vx});function Wx(n,t){if(n.operator&&n.operator.type){t.put("($=>("),t.createScope(()=>t.node(n.operator),i=>i+","),t.put("))"),t.put("("),t.node(n.argument),t.put(")");return}t.error('Unknown operator "'+n.operator+'"',n)}function Vx(n,t){t.node(n.argument),n.operator&&n.operator.type&&t.node(n.operator)}function Ux(n,t){t.node(n.argument),t.put(" "),t.node(n.operator)}var _l={};Ae(_l,{compile:()=>$x,stringify:()=>Kx,walk:()=>Gx});function $x(n,t){switch(n.operator){case"no":case"not":t.put("!"),t.put(t.buildinFn("bool")),t.put("("),t.node(n.argument),t.put(")");break;case"+":case"-":t.put(n.operator),t.node(n.argument);break;case"is":t.put("!!("),t.node(n.argument),t.put(")");break;default:t.error('Unknown operator "'+n.operator+'"',n)}}function Gx(n,t){t.node(n.argument),n.operator&&n.operator.type&&t.node(n.operator)}function Kx(n,t){t.put(n.operator),n.operator!=="-"&&n.operator!=="+"&&t.put(" "),t.node(n.argument)}var ql={};Ae(ql,{compile:()=>Qx,stringify:()=>Zx,suggest:()=>Yx,walk:()=>Jx});function Yx(n,t){n.range&&t.range(n.range,"var")}function Qx(n,t){let i=n.name,o=t.scope.has(i.name),l=t.scope.awaitInit.has(i.name);if(!o||l){l?(t.put("f.unsafeRef(()=>$"),t.node(i),t.tolerant||(t.put(","),t.put(JSON.stringify(i.name)),t.put(","),t.put(JSON.stringify(i.range))),t.put(")")):t.tolerant?t.put("undefined"):t.error(`$${i.name} is not defined`,i);return}t.put("$"),t.node(i)}function Jx(n,t){t.node(n.name)}function Zx(n,t){t.put("$"),t.node(n.name)}var Wl={};Ae(Wl,{compile:()=>Xx,stringify:()=>tk,walk:()=>ek});function Xx(n,t){t.put(t.buildinFn("slice")),t.put("("),t.nodeOrCurrent(n.value),n.arguments.slice(0,3).forEach(i=>{t.put(","),i?t.node(i):t.put("undefined")}),t.put(")")}function ek(n,t){t.nodeOrNothing(n.value);for(let i of n.arguments.slice(0,3))i&&t.node(i)}function tk(n,t){let[i,o,l]=n.arguments;t.nodeOrNothing(n.value),t.put("["),i&&t.node(i),t.put(":"),o&&t.node(o),l&&(t.put(":"),t.node(l)),t.put("]")}var Vl={};Ae(Vl,{compile:()=>rk,stringify:()=>ok,suggest:()=>nk,walk:()=>ik});function nk(n,t){n.query===null&&t.queryRoot(n.range[1])}function rk(n,t){if(n.array){t.put("..."),t.put(t.buildinFn("ensureArray")),t.put("("),t.nodeOrCurrent(n.query),t.put(")");return}t.put("..."),t.nodeOrCurrent(n.query)}function ik(n,t){t.nodeOrNothing(n.query)}function ok(n,t){t.put("..."),t.nodeOrNothing(n.query)}var Ul={};Ae(Ul,{compile:()=>ak,stringify:()=>uk,suggest:()=>sk,walk:()=>lk});function sk(n,t){for(let[i,o]of Object.entries(n.values))o===null&&t.queryRoot(n.values[Number(i)-1].range[1])}function ak(n,t){for(let[i,o]of Object.entries(n.values)){let l=Number(i);o!==null&&(l!==0&&t.put("+"),l%2===0?t.put('"'+Id(o.value,ck)+'"'):(t.put("("),t.node(o),t.put(")")))}}function lk(n,t){for(let i of n.values)i!==null&&t.node(i)}function uk(n,t){let i=n.values.length-1;for(let[o,l]of Object.entries(n.values)){let c=Number(o);c%2===0?(t.put(c===0?"`":"}"),t.put(Id(l.value,fk)),t.put(c===i?"`":"${")):l!==null&&t.node(l)}}var ck=new Map([["\b","\\b"],[`
`,"\\n"],["\r","\\r"],["\f","\\f"],["	","\\t"],["\v","\\v"],["\u2028","\\u2028"],["\u2029","\\u2029"],["\\","\\\\"],['"','\\"']]),fk=new Map([["\b","\\b"],["\f","\\f"],["	","\\t"],["\v","\\v"],["\\","\\\\"],["$","\\$"]]);function Id(n,t){let i="";for(let o=0;o<n.length;o++)i+=t.get(n[o])||n[o];return i}var dk={Arg1:dl,Array:pl,Assertion:hl,Binary:gl,Block:ml,Compare:yl,Conditional:bl,Context:wl,Current:xl,Data:kl,Declarator:Cl,Definition:Sl,Filter:Tl,Function:Al,GetProperty:El,Identifier:Ll,Literal:Ml,Map:Dl,MapRecursive:Ol,Method:Pl,MethodCall:Nl,Object:Il,ObjectEntry:Rl,Parentheses:Bl,Pick:jl,Pipeline:zl,Placeholder:Fl,Postfix:Hl,Prefix:_l,Reference:ql,SliceNotation:Wl,CompareFunction:vl,Spread:Vl,Template:Ul},io=n=>new Map(Object.entries(dk).map(([t,i])=>[t,i[n]]).filter(([,t])=>typeof t=="function")),pk={};io("build").forEach((n,t)=>pk[t]=n);var $l=io("compile"),Gl=io("walk"),Kl=io("stringify"),Yl=io("suggest");function oo(n,t){function i(f){if(Gl.has(f.type))l(f),Gl.get(f.type)(f,o),c(f);else throw new Error('Unknown node type "'+f.type+'"')}let o={node:i,nodeOrNothing(f){f!==null&&i(f)},list(f){f.forEach(i)}},l=()=>{},c=()=>{};typeof t=="function"&&(t={enter:t}),t&&(typeof t.enter=="function"&&(l=t.enter),typeof t.leave=="function"&&(c=t.leave)),i(n)}function Rd(n,t){return t>=0&&t<n.length&&/[a-zA-Z_$0-9]/.test(n[t])}function Ql(n,t){let i=n.charCodeAt(t);return i===9||i===10||i===13||i===32}function hk(n,t,i){for(;t<i;t++)if(!Ql(n,t))return!1;return!0}function gk(n,t,i,o,l){let c=[];for(let f=0;f<o.length;f++){let[d,g]=o[f];if(d>=t)break;d<n||(c.push(n,d),n=g)}return(n!==i.length||!l)&&c.push(n,t),c}function mk(n,t,i,o){let l=[];for(let c=0;c<n.length;c++){let[f,d,g,y]=n[c];if(hk(t,f,d)){for(;f>=0&&Ql(t,f-1);)f--;for(;d<t.length&&Ql(t,d);)d++;if(Rd(t,f-1)){if(f===d)continue;f++}if(Rd(t,d)){if(f===d)continue;d--}}let b=gk(f,d,t,i,o);for(let k=0;k<b.length;k+=2)l.push([b[k],b[k+1],g,y])}return l}function yk(n){let t=null,i=[],o=Object.assign(new Map,{literalList:i}),l=(f,d)=>{o.has(f)?o.get(f).push(d):o.set(f,[d])},c={range(f,d,g=t,y=!0){l(g,[...f,d,y])},literalList(f){let d="l"+i.length;return i.push([d,f]),d},queryRoot(f,d=f){l(t,[f,d,"var",!0]),l(t,[f,d,"path",!0])}};return oo(n,f=>{if(Yl.has(f.type)){let d=t;t=f,Yl.get(f.type)(f,c),t=d}}),o}function ks(n,{ast:t,commentRanges:i}){let o=yk(t),l=i.length&&i[i.length-1][1]===n.length&&!/[\r\n]$/.test(n);for(let[c,f]of o)o.set(c,mk(f,n,i,l));return o}function vk(n){return n.type==="GetProperty"}function bk(n){return n.type==="MethodCall"}function Cs(n){function t(l){if(Kl.has(l.type))Kl.get(l.type)(l,o);else throw new Error('Unknown node type "'+l.type+'"')}let i=[],o={isSimpleGetPropertyQuery:vk,isSimpleMethodCallQuery:bk,put(l){i.push(l)},node:t,nodeOrNothing(l){if(l!==null)return t(l),!0},list(l,c){if(!c){l.forEach(t);return}l.forEach((f,d)=>{d>0&&o.put(c),t(f)})}};return t(n),i.join("")}function Jl(n,t,i){let o=Object.assign(Object.create(SyntaxError.prototype),i),l=new Error;return o.name=n,o.message=t,Object.defineProperty(o,"stack",{get:function(){return(l.stack||"").replace(/^(.+\n){1,3}/,n+": "+t+`
`)}}),o}function Xl(n,t,i){return Bd(n,"query",t,i)}function eu(n,t,i){return Bd(n,"method",t,i)}var Zl=class n extends Set{constructor(t,i=[],o=!1,l="$"){super(t),this.own=new Set,this.awaitInit=new Set(i),this.firstCurrent=null,this.captureCurrent=[],this.arg1=o,this.$ref=l}spawn(t,i){return new n(this,this.awaitInit,t,i)}};function Bd(n,t,i=!1,o=null){function l(S){let T="s"+y.length;return y.push(S?[T,S]:[T]),T}function c(S){let T=b.get(S);return T||b.set(S,T=l()),T}function f(S,T,N,A,j){let I=[S,T,JSON.stringify(N)];if(N==="var"){if(!L.scope.size)return;I.push(JSON.stringify([...L.scope]))}else A||(A=l()),I.push(A),j&&I.push(typeof j=="string"?j:c(j));return C.push(I),A}function d(S,T,N="$"){let A=L.scope,j=E.length-1;if(L.scope=A.spawn(A.arg1||t==="method",N),S(),L.scope.captureCurrent.length){let z="stat("+L.scope.captureCurrent.reduce((W,H)=>f(...H,W),void 0)+","+L.scope.$ref+")";L.scope.firstCurrent?E[L.scope.firstCurrent]=z:E[j]+=T(z)}L.scope=A}function g(S,T){let N=!1;if(o!==null){if(o.has(S))for(let[A,j,I,z]of o.get(S))I==="var"?f(A,j,I):z===!0?L.scope.captureCurrent.push([A,j,I]):(N||(N=c(S),E.push("stat("+N+",")),I&&f(A,j,I,N,z));S.type==="Current"&&L.scope.firstCurrent===null&&(L.scope.firstCurrent=E.length)}if($l.has(S.type))$l.get(S.type)(S,L,T);else throw new Error('Unknown node type "'+S.type+'"');N&&E.push(")")}let y=[],b=new WeakMap,k=[],C=[],E=[{toString(){if(t==="query")return["((data,context)=>{",...L.usedMethods.size||L.usedAssertions.size?["const method = (name,...args)=>m[name].apply(mctx,args);","const assertion = (name,...args)=>a[name].apply(mctx,args);","const mctx = Object.freeze({context,method,assertion});"]:[]].join(`
`)+`
`;if(t==="method")return["(function(data){","const mctx = this;","const context = mctx.context;"].join(`
`)+`
`;throw new Error("Unknown kind: "+t)}},{toString(){return k.length>0?"let "+k+`;
`:""}},{toString(){return y.length>0?[`const stat=(s,v)=>(s.add(v),v);
`,"const "+y.map(([S,T])=>S+"=new Set("+(T?JSON.stringify(T):"")+")")+`;
`].join(""):""}},{toString(){let S=o&&Array.isArray(o.literalList)&&o.literalList.map(([T,N])=>T+"="+JSON.stringify(N));return S&&S.length?"const "+S+`;
`:""}},o===null?"return ":`return{
value: `],M={},O=new Set,L={tolerant:i,usedAssertions:new Map,usedMethods:new Map,suggestions:o!==null,buildinFn(S){return O.add(S),"f."+S},scope:new Zl,createScope:d,error:(S,T)=>{let N=new SyntaxError(S);if(T&&T.range&&(N.details={loc:{range:T.range}}),!i)throw N},allocateVar(){let S="tmp"+k.length;return k.push(S),S},put:S=>E.push(S),node:g,nodeOrCurrent(S,T){g(S||{type:"Current"},T)},list(S,T,N){S.forEach((A,j)=>{j>0&&E.push(T),g(A,N)})}};if(d(()=>g(n),S=>(E.push(")"),"("+S+","),"data"),!i){let{usedMethods:S,usedAssertions:T}=L;T.size&&(E.unshift(" this.assertAssertions(a)||"),M.assertAssertions=function(N){for(let[A,j]of T.entries())if(!wt(N,A))return()=>{throw Object.assign(new Error(`Assertion "${A}" is not defined`),{details:{loc:{range:j}}})}}),S.size&&(E.unshift(" this.assertMethods(m)||"),M.assertMethods=function(N){for(let[A,j]of S.entries())if(!wt(N,A))return()=>{throw Object.assign(new Error(`Method "${A}" is not defined. If that's a custom method make sure you added it with "methods" section in options`),{details:{loc:{range:j[0]}}})}})}o!==null&&E.push(`,
stats: [`+C.map(S=>"["+S+"]")+`],
methods: m,
assertions: a
}`);try{let S=new Function("f,m,a","return"+E.join("")+"})");return Object.assign(S.bind(M),{toString(){return S.toString().replace(/^(\S+\s+)anonymous([^)\s]+)\s*\)/,"$1query$2)")}})}catch(S){throw Jl("SyntaxError","Jora query compilation error",{compiledSource:E.join(""),details:S})}}var jd=n=>typeof n=="number"||typeof n=="string",Qt=(n,t)=>t<n.length?n.charCodeAt(t):0,so=n=>n===43||n===45,fn=n=>n>=48&&n<=57,tu=n=>n===9||n===10||n===12||n===13||n===32,nu=n=>n>32&&n<256&&(n<65||n>90)&&(n<97||n>122)&&!fn(n)&&!so(n)||n===8470,wk=n=>n&&!tu(n)&&!nu(n)&&!fn(n),xk=(n,t,i)=>so(n)?fn(t)?2:t===46&&fn(i)?3:0:fn(n)?1:0,ti=(n,t,i)=>{for(;i(Qt(n,++t)););return t},kk=(n,t,i)=>{let o=Qt(n,t);if(so(o)&&(o=Qt(n,t+=1)),fn(o)&&(t=ti(n,t,fn),o=Qt(n,t)),o===46&&fn(Qt(n,t+1))){if(i)return t;let l=ti(n,t+1,fn);if(o=Qt(n,l),o===46)return t;t=l}if(o===69||o===101){let l=1;o=Qt(n,t+1),so(o)&&(l=2,o=Qt(n,t+2)),fn(o)&&(t=ti(n,t+l,fn))}return t},zd=(n,t,i,o)=>{if(t>=n.length)return 0;let l=Qt(n,t);return tu(l)?1|ti(n,t,tu)-t<<4:nu(l)||o&&so(l)?2|ti(n,t,nu)-t<<4:xk(l,Qt(n,t+1),Qt(n,t+2))?4|kk(n,t,i)-t<<4:8|ti(n,t,wk)-t<<4},Ck=(n,t,i)=>{let o=0,l=0,c=!1,f=!1,d=0,g=0,y=!0;for(;;){let b=zd(n,o,c,f),k=zd(t,l,c,f),C=b&15,E=b>>4,M=k&15,O=k>>4;if(C!==M){if(y&&C&3&&M&12){d=1,g=C,o+=E;continue}if(y&&M&3&&C&12){d=-1,g=M,l+=O;continue}return C-M}if(C===0)return d;y=!1,c=!1,f=!1;let L=E<O?E:O,S=E-O,T="",N="";for(let A=0;A<L;A++)if(T=n[o+A],N=t[l+A],T!==N){S=T<N?-1:1;break}if(C&3)c=n[o+E-1]===".",S!==0&&C>g&&(g=C,d=S);else if(C&4){if(f=!0,S!==0){let A=n.substr(o,E)-t.substr(l,O);if(A!==0)return i?-A:A;if(C>g){let j=Qt(n,o),I=Qt(t,l),z=j===45?-1:1;g=C,d=j!==I&&(j===45||I===43)?-1:j!==I&&(j===43||I===45)?1:(E-O||S)<0?-z:z,i&&(d=-d)}}}else if(S!==0){if(T!==N){let A=n.substr(o,E),j=t.substr(l,O),I=A.toLowerCase(),z=j.toLowerCase();return I!==z?I<z?-1:1:A<j?-1:1}return S}o+=E,l+=O}},Fd=n=>(t,i)=>jd(t)&&jd(i)?Math.sign(Ck(String(t),String(i),n)):0,Hd=Fd(!1),_d=Fd(!0);var Sk=1,Tk=2,ni=3,ao=4,Ak=5,Ek=6,Lk=7,Mk=8;function Kn(n){switch(typeof n){case"boolean":return Sk;case"number":return n!==n?Tk:ni;case"string":return ao;case"object":return n===null?Ak:Ek;case"undefined":return Mk;default:return Lk}}function ri(n,t){let i=Kn(n),o=Kn(t);return i!==o?i<o?-1:1:n<t?-1:n>t?1:0}function qd(n,t){let i=Kn(n),o=Kn(t);return i!==o?i<o?-1:1:i===ni?t-n:n<t?-1:n>t?1:0}function hr(n,t){let i=Kn(n),o=Kn(t);return(i===ni||i===ao)&&(o===ni||o===ao)?Hd(n,t):i!==o?i<o?-1:1:n<t?-1:n>t?1:0}function Wd(n,t){let i=Kn(n),o=Kn(t);return(i===ni||i===ao)&&(o===ni||o===ao)?_d(n,t,!0):i!==o?i<o?-1:1:n<t?-1:n>t?1:0}function ru(n,t){return n.length===1?(i,o)=>t(n(i),n(o)):n}var Bt=Object.freeze({unsafeRef:Dk,ensureArray:Ok,bool:Yt,and:(n,t)=>Yt(n)?t:n,or:(n,t)=>Yt(n)?n:t,add:Pk,sub:Nk,mul:Ik,div:Rk,mod:Bk,eq:jk,ne:zk,lt:Fk,lte:Hk,gt:_k,gte:qk,in:Ss,notIn:(n,t)=>!Ss(n,t),has:(n,t)=>Ss(t,n),hasNo:(n,t)=>!Ss(t,n),cmp:ri,cmpAnalytical:qd,cmpNatural:hr,cmpNaturalAnalytical:Wd,match:Wk,pick:Vk,indexOf:Uk,lastIndexOf:$k,map:iu,mapRecursive:Kk,some:ou,filter:Yk,slice:Qk});function Dk(n,t,i){try{return n()}catch{if(t)throw Object.assign(new ReferenceError(`Cannot access $${t} before initialization`),{details:{name:t,loc:{range:i}}})}}function Ok(n){return ze(n)?n:[n]}function Pk(n,t){return ze(n)||ze(t)?[...new Set([...ze(n)?n:[n],...ze(t)?t:[t]])]:n+t}function Nk(n,t){if(ze(n)){let i=new Set(n);return ze(t)?t.forEach(o=>i.delete(o)):i.delete(t),[...i]}return n-t}function Ik(n,t){return n*t}function Rk(n,t){return n/t}function Bk(n,t){return n%t}function jk(n,t){return Object.is(n,t)}function zk(n,t){return!Object.is(n,t)}function Fk(n,t){return n<t}function Hk(n,t){return n<=t}function _k(n,t){return n>t}function qk(n,t){return n>=t}function Ss(n,t){return cn(t)?wt(t,n):t?Vd(t,n)!==-1:!1}function Wk(n,t){return typeof t=="function"?ou(n,t):Gn(t)?ou(n,t.test.bind(t)):t==null}function Vk(n,t=()=>!0){if(n){if(typeof t=="function"){if(ze(n)||typeof n=="string"){for(let i=0;i<n.length;i++)if(Yt(t(n[i],i)))return n[i]}for(let i in n)if(wt(n,i)&&Yt(t(n[i],i)))return n[i];return}return ze(n)||typeof n=="string"?isFinite(t)?n[t<0?n.length+Number(t):Number(t)||0]:void 0:wt(n,t)?n[t]:void 0}}function Uk(n,t,i){return n?Vd(n,t,i):-1}function Vd(n,t,i=0){if(Number.isNaN(t)&&Nn(n)){for(let o=pr(i,0);o<n.length;o++)if(Number.isNaN(n[o]))return o}return typeof n.indexOf=="function"?n.indexOf(t,i):-1}function $k(n,t,i){return n?Gk(n,t,i):-1}function Gk(n,t,i){if(Number.isNaN(t)&&Nn(n)){for(let o=pr(i,n.length-1);o>=0;o--)if(Number.isNaN(n[o]))return o}return typeof n.lastIndexOf=="function"?n.lastIndexOf(t,pr(i,n.length-1)):-1}function iu(n,t){let i=typeof t=="function"?t:o=>Od(o,t);return ze(n)?[...n.reduce((o,l)=>ei(o,i(l)),new Set)]:n!==void 0?i(n):n}function Kk(n,t){let i=new Set;return ei(i,iu(n,t)),i.forEach(o=>ei(i,iu(o,t))),[...i]}function ou(n,t){return ze(n)?n.some(i=>Yt(t(i))):Yt(t(n))}function Yk(n,t){return ze(n)?n.filter(i=>Yt(t(i))):Yt(t(n))?n:void 0}function Qk(n,t,i,o=1){if(!Nn(n))return[];if(t=pr(t,0),i=pr(i,n.length),o=pr(o,1)||1,t=t<0?Math.max(0,n.length+t):Math.min(n.length,t),i=i<0?Math.max(0,n.length+i):Math.min(n.length,i),t>=0&&i>=0&&t<=i&&o===1)return typeof n=="string"?n.slice(t,i):Array.prototype.slice.call(n,t,i);t>i&&([t,i]=[i,t],o=-o);let l=[];if(o>0)for(let c=t;c<i;c+=o)l.push(n[c]);else for(let c=i-1;c>=t;c+=o)l.push(n[c]);return typeof n=="string"?l.join(""):l}var Jk=Ud(20)?1/0:Ud(10)?10:0;function Ud(n){return Array.from({length:n},(t,i)=>({idx:i})).sort((t,i)=>t.idx%2-i.idx%2).every((t,i)=>i<n/2?t.idx>>1===i:Math.ceil(n/2)+(t.idx>>1)===i)}function $d(n,t){return n.length<=Jk?n.slice().sort(t):n.map((i,o)=>({value:i,idx:o})).sort((i,o)=>(i.value===void 0?o.value!==void 0:o.value===void 0?-1:t(i.value,o.value))||i.idx-o.idx).map(i=>i.value)}var Zk=(n,t)=>n-t,Xk=(n,t)=>t-n,Ts=class{constructor(t,i,o,l=!1){this.maxSize=t||1/0,this.compare=i||Xk,this.accept=o||null,this.values=[],this.valuesSet=l?new Set:null}add(t){this.accept!==null&&!this.accept(t)||this.valuesSet!==null&&this.valuesSet.has(t)||(this.values.length<this.maxSize?(this.valuesSet!==null&&this.valuesSet.add(t),this.values.push(t),this.heapifyUp(this.values.length-1)):this.compare(this.values[0],t)>0&&(this.valuesSet!==null&&(this.valuesSet.delete(this.values[0]),this.valuesSet.add(t)),this.values[0]=t,this.heapifyDown()))}addArray(t){for(let i=0;i<t.length;i++)this.add(t[i])}extract(){let t=this.values[0],i=this.values.pop();return this.values.length>0&&(this.values[0]=i,this.heapifyDown()),this.valuesSet!==null&&this.valuesSet.delete(t),t}heapifyUp(t){let i=this.values,o=i[t];for(;t>0;){let l=t-1>>1,c=i[l];if(this.compare(c,o)>0)break;i[l]=o,i[t]=c,t=l}}heapifyDown(){let t=this.values,i=t.length,o=i>>1,l=0,c=t[l],f=l,d=c;for(;l<o;){let g=2*l+1,y=t[g],b=g+1;if(this.compare(y,c)>0&&(f=g,d=y),b<i){let k=t[b];this.compare(k,d)>0&&(f=b,d=k)}if(f===l)break;t[l]=d,t[f]=c,l=f,d=c}}[Symbol.iterator](){return this.values.slice().sort(this.compare)[Symbol.iterator]()}},Yn=class extends Ts{},As=class extends Ts{constructor(t,i,o,l){super(t,i?(c,f)=>-i(c,f):Zk,o,l)}};var e0=n=>n;function t0(n){return n!==null&&typeof n=="object"?NaN:Number(n)}function ii(n,t,i){if(Nn(n)){typeof t!="function"&&(t=e0);for(let o of n){let l=t(o);l!==void 0&&i(t0(l))}}}function Gd(n,t,i,o,l){if(n.length===0||!isFinite(t)||t<0||t>100)return;let c=0,f=t*(n.length-1)/100,d=Math.floor(f),g=Math.ceil(f),y=!1,b=t<50?new As(g+1,l):new Yn(n.length-d,l);if(ii(n,i,k=>{Number.isNaN(k)&&(y=!0),b.add(k),c++}),y)return NaN;if(n.length!==c){if(c===0)return;f=t*(c-1)/100,d=Math.floor(f),g=Math.ceil(f);let k=t<50?g+1:c-d;for(let C=b.values.length;C>k;C--)b.extract()}if(d!==g){let k=b.extract(),C=b.values[0];return k<=C?k+(C-k)*(f-d):C+(k-C)*(f-d)}return b.values[0]}var n0=n=>n;function Kd(n,t){let i,o=0,l=0;return ii(n,t,c=>{if(l++,i===void 0)i=c;else{let f=i,d=Math.abs(f),g=Math.abs(c);i+=c,d!==1/0&&g!==1/0&&(d>=g?o+=f-i+c:o+=c-i+f)}}),i!==void 0&&(i+=o),{sum:i,count:l}}function Yd(n,t){let i=[];return ii(n,t,i.push.bind(i)),i}function Qd(n,t){let i=0;if(Nn(n)){typeof t!="function"&&(t=n0);for(let o of n)t(o)!==void 0&&i++}return i}function Jd(n,t){return Kd(n,t).sum}function Zd(n,t){let{sum:i,count:o}=Kd(n,t);if(o>0)return i/o}function su(n,t){let i=0,o=0,l=0;if(ii(n,t,c=>{i+=1;let f=c-o;o+=f/i,l+=f*(c-o)}),i>0)return l/i}function Xd(n,t){let i=su(n,t);if(i!==void 0)return Math.sqrt(i)}function ep(n,t=hr){let i;if(n&&isFinite(n.length)&&typeof t=="function"){t=ru(t,hr);for(let o=0;o<n.length;o++){let l=n[o];(i===void 0||t(l,i)<0)&&t(l,void 0)!==0&&(i=l)}}return i}function tp(n,t=hr){let i;if(n&&isFinite(n.length)&&typeof t=="function"){t=ru(t,hr);for(let o=0;o<n.length;o++){let l=n[o];(i===void 0||t(l,i)>=0)&&t(l,void 0)!==0&&(i=l)}}return i}function Es(n,t,i){if(Nn(n))return Gd(n,t,i)}function np(n,t){return Es(n,50,t)}function r0(){}function i0(n){return n}function rp(n){return n===null?null:{matched:n.slice(),start:n.index,end:n.index+n[0].length,input:n.input,groups:n.groups||null}}function o0(n){let t=n.pop(),i=typeof t=="string"?null:t,o=i===null?t:n.pop(),l=n.pop();return{matched:n,start:l,end:l+n[0].length,input:o,groups:i}}var s0=String.prototype.replaceAll||function(n,t){return Gn(n)?this.replace(n,t):this.split(n).join(String(t))},lo=Object.freeze({bool:Bt.bool,filter:Bt.filter,map:Bt.map,pick:Bt.pick,indexOf:Bt.indexOf,lastIndexOf:Bt.lastIndexOf,keys(n){return Object.keys(n||{})},values(n){let t=new Set;for(let i in n)wt(n,i)&&ei(t,n[i]);return[...t]},entries(n){let t=[];for(let i in n)wt(n,i)&&t.push({key:i,value:n[i]});return t},fromEntries(n){let t=Object.create(null);if(Array.isArray(n))for(let i of n)i&&(t[i.key]=i.value);return t},size(n){return cn(n)?Object.keys(n).length:n&&n.length||0},sort(n,t=ri){if(!ze(n))return n;if(typeof t=="function"&&t.length!==2){let i=t;t=(o,l)=>{if(o=i(o),l=i(l),Array.isArray(o)&&Array.isArray(l)){if(o.length!==l.length)return o.length<l.length?-1:1;for(let c=0;c<o.length;c++){let f=ri(o[c],l[c]);if(f!==0)return f}return 0}return ri(o,l)}}return $d(n,t)},reverse(n){return ze(n)?n.slice().reverse():n},slice(n,t,i){return typeof n=="string"||ze(n)?n.slice(t,i):Array.prototype.slice.call(n,t,i)},group(n,t,i){let o=new Map,l=[];typeof t!="function"&&(t=r0),typeof i!="function"&&(i=i0),ze(n)||(n=[n]);for(let c of n){let f=t(c);if(ze(f))if(f.length>0){let d=i(c);for(let g of f)bs(o,g,d)}else bs(o,void 0,i(c));else bs(o,f,i(c))}for(let[c,f]of o)l.push({key:c,value:[...f]});return l},join(n,t){return ze(n)?n.join(t):String(n)},match(n,t,i){let o=String(n),l=Gn(t)?t.flags:"";if(i||l.includes("g")){let c=[],f=new RegExp(t,(l||"").replace(/g|$/,"g")),d;for(;d=f.exec(o);)c.push(rp(d));return c}return rp(o.match(t))},reduce(n,t,i=void 0){return ze(n)?i!==void 0?n.reduce((o,l)=>t(l,o),i):n.reduce((o,l)=>t(l,o)):t(n,i)},split(n,t){if(ze(n)){let i=typeof t=="function"?t:Object.is.bind(null,t),o=[],l=0,c=0;for(;c<n.length;c++)i(n[c])&&(o.push(n.slice(l,c)),l=c+1);return o.push(n.slice(l,c)),o}return String(n).split(t)},replace(n,t,i){if(ze(n)){let o=typeof t=="function"?t:Object.is.bind(null,t),l=[...n];for(let c=0;c<l.length;c++){let f=l[c];o(f)&&(l[c]=typeof i=="function"?i(f):i)}return l}return Gn(t)&&!t.flags.includes("g")&&(t=new RegExp(t,t.flags+"g")),s0.call(String(n),t,typeof i=="function"?(...o)=>i(o0(o)):i)},toLowerCase(n,t){return String(n).toLocaleLowerCase(t)},toUpperCase(n,t){return String(n).toLocaleUpperCase(t)},trim(n){return String(n).trim()},...["abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","hypot","imul","log10","log2","pow","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].reduce((n,t)=>(n[t]=Math[t],n),{}),ln:Math.log,ln1p:Math.log1p,numbers:Yd,count:Qd,sum:Jd,avg:Zd,variance:su,stdev:Xd,min:ep,max:tp,percentile:Es,p:Es,median:np});var uo=Object.freeze({function:n=>typeof n=="function",symbol:n=>typeof n=="symbol",primitive:n=>n===null||typeof n!="object"&&typeof n!="function",string:n=>typeof n=="string",number:n=>typeof n=="number",int:Number.isInteger,finite:n=>Number.isFinite(n),nan:n=>Number.isNaN(n),infinity:n=>n===1/0||n===-1/0,boolean:n=>n===!0||n===!1,null:n=>n===null,undefined:n=>n===void 0,nullish:n=>n==null,object:cn,array:ze,regexp:Gn,truthy:Yt,falsy:n=>!Yt(n)});var a0={path:"property",key:"value",value:"value","in-value":"value","value-subset":"value",var:"variable",assertion:"assertion"};function Ls(n,t){Object.keys(n).forEach(t.add,t)}function l0(n,t,i,o=new Set){let l=c=>{switch(typeof c){case"string":case"number":o.add(c);break}};switch(n){case"path":{let c=new Set;for(let f of t)if(Array.isArray(f))for(let d of f)cn(d)&&Ls(d,c);else cn(f)&&Ls(f,c);c.forEach(o.add,o);break}case"key":{let c=new Set;for(let f of t)f!==null&&typeof f=="object"&&!Array.isArray(f)&&Ls(f,c);c.forEach(o.add,o);break}case"value":for(let c of t)l(c);break;case"in-value":{let c=new Set;for(let f of t)ze(f)?f.forEach(l):cn(f)&&Ls(f,c);c.forEach(o.add,o);break}case"var":for(let c of t)o.add("$"+c);break;case"value-subset":{let c=new Set(i);for(let f of t)c.has(f)||l(f);break}}return o}function ip(n,t,i,o=!1){let l=[];for(let[c,f,d,g,y=null]of i)if(t>=c&&t<=f&&(o||g.size||g.length)){let b=n.substring(c,f);/\S/.test(b)||(c=f=t,b=""),l.push({context:d,from:c,to:f,text:b,values:g,related:y})}return l}function op(n,t){return typeof n=="function"?n:n===!0?t:!1}function sp(n){if(/^(["']).*\1$/.test(n))try{return n[0]==="'"&&(n=`"${n.slice(1,-1).replace(/\\.|"/g,t=>t==="\\'"?"'":t==='"'?'\\"':t)}"`),JSON.parse(n)}catch{}return n}function u0(n){return t=>(typeof t=="string"?t:String(t)).toLowerCase().indexOf(n)!==-1}var au=(n,{value:t,stats:i,assertions:o})=>({get value(){return t},stat(l,c){return ip(n,l,i,c)},suggestion(l,c){let{limit:f=1/0,sort:d,filter:g}=c||{};d=op(d,Bt.cmp),g=op(g,u0);let y=d&&isFinite(f)?Yn:Set,b=ip(n,l,i,!0),k=new Map,C=[];for(let E of b){let{context:M,text:O,from:L,to:S,values:T,related:N}=E,A=a0[M];if(!k.has(A)){let I;switch(y){case Yn:I=new Yn(f,d,g&&g(sp(O)),!0);break;case Set:I=new Set;break}k.set(A,{type:A,from:L,to:S,text:O,suggestions:I})}let{suggestions:j}=k.get(A);switch(M){case"assertion":if(j.size===0||j.values&&j.values.length===0)for(let I of Object.keys(o))j.add(I);break;default:l0(M,T,N,j)}}if(y===Set)for(let E of k.values()){let{suggestions:M}=E;if(d&&(M=[...M].sort(d)),g||isFinite(f)){let O=[],L=g?g(sp(E.text)):()=>!0;for(let S of M)if(L(S)&&O.push(S)>=f)break;M=O}E.suggestions=M}for(let E of k.values())E.suggestions=Array.isArray(E.suggestions)?E.suggestions:[...E.suggestions],E.suggestions.length&&C.push(E);return C.length?C:null}});var c0=new Map,f0=new Map,d0=new Map,p0=new Map;function ap(n,t,i,o,l){typeof i=="string"?Object.defineProperty(n,t,{configurable:!0,get(){let f=lu(i,"method")(Bt,o,l);return Object.defineProperty(n,t,{enumerable:!0,value:f}),f}}):typeof i=="function"&&Object.defineProperty(n,t,{enumerable:!0,value:i})}function lp(n,t){if(!n&&!t)return{queryMethods:lo,queryAssertions:uo};let i={...lo},o={...uo};for(let[l,c]of Object.entries(n||{})){if(wt(lo,l))throw new Error(`Builtin method "${l}" can't be overridden`);ap(i,l,c,i,o)}for(let[l,c]of Object.entries(t||{})){if(wt(uo,l))throw new Error(`Builtin assertion "${l}" can't be overridden`);ap(o,l,c,i,o)}return{queryMethods:i,queryAssertions:o}}function h0(n,t){console.log(`[${n}]`),typeof t=="string"?console.log(t):t!==void 0&&console.dir(t,{depth:null}),console.log()}function lu(n,t,i,o,l){l=typeof l=="function"?l:l?h0:!1,l&&(l("========================="),l("Compile query from source",n));let c=ws.parse(n,o);l&&(l("AST",c.ast),l("Restored source",Cs(c.ast)));let f=i?ks(n,c):null;if(l&&f){let g=C=>JSON.stringify(C).slice(1,-1),y=[].concat(...[...f.entries()].map(([C,E])=>E.map(M=>[C,...M]))),b=[],k=null;l("Stat/suggestion ranges",y.sort((C,E)=>C[1]-E[1]).map(([C,...E])=>{let[M,O,L,S]=E,T;if(M===b[0]&&O===b[1])T=" ".repeat(k.length);else{let N=g(n.slice(0,M)).length,A=g(n.substring(M,O)).length;b=E,k=" ".repeat(N)+(A?"~".repeat(A):"\\")+" "+M+":"+O,T=g(n)+`
`+k}return T+" ["+L+"] on "+C.type+(S===!0?" (current)":S&&S.type?" & "+S.type:"")}).join(`
`))}let d=t==="method"?eu(c.ast,o,f):Xl(c.ast,o,f);return l&&l("Compiled code",d.toString()),d}function g0(n,t){t=t||{};let i=!!t.stat,o=!!t.tolerant,l=i?o?p0:f0:o?d0:c0,{methods:c,assertions:f}=t||{},{queryMethods:d,queryAssertions:g}=lp(c,f),y;return n=String(n),l.has(n)&&!t.debug?y=l.get(n):(y=lu(n,"query",i,o,t.debug),l.set(n,y)),y=y(Bt,d,g),i?Object.assign((b,k)=>au(n,y(b,k)),{query:y}):y}function m0(n){let t=new Map,i=new Map,o=new Map,l=new Map,{methods:c,assertions:f}=n||{},{queryMethods:d,queryAssertions:g}=lp(c,f);return function(b,k){k=k||{};let C=!!k.stat,E=!!k.tolerant,M=C?E?l:i:E?o:t,O;if(b=String(b),M.has(b)&&!k.debug)O=M.get(b);else{let L=lu(b,"query",C,E,k.debug)(Bt,d,g);O=C?Object.assign((S,T)=>au(b,L(S,T)),{query:L}):L,M.set(b,O)}return O}}var en=Object.assign(g0,{version:Dd,buildin:Bt,methods:lo,assertions:uo,setup:m0,syntax:{tokenize:ws.tokenize,parse:ws.parse,suggest:ks,walk:oo,stringify:Cs,compile:Xl,compileMethod:eu}});var dn=class{listeners;constructor(){this.listeners=Object.create(null)}on(t,i){return this.listeners[t]={callback:i,next:this.listeners[t]||null},this}once(t,i){return this.on(t,function o(...l){i.apply(this,l),this.off(t,o)})}off(t,i){let o=this.listeners[t]||null,l=null;for(;o!==null;){if(o.callback===i){o.callback=null,l?l.next=o.next:this.listeners[t]=o.next;break}l=o,o=o.next}return this}emit(t,...i){let o=this.listeners[t]||null,l=!1;for(;o!==null;)typeof o.callback=="function"&&o.callback.apply(this,i),l=!0,o=o.next;return l}};var Jt=class extends dn{#e;#t;static define(t,i,o){return t.#e.set(i,o),t.emit("define",i,o),o}constructor(t){super(),this.#e=new Map,this.#t=!!t}revoke(t){if(!this.#t)throw new Error("Entry revoking is not allowed");this.#e.delete(t),this.emit("revoke",t)}isDefined(t){return this.#e.has(t)}has(t){return this.#e.has(t)}get(t){return this.#e.get(t)}get names(){return[...this.#e.keys()]}get keys(){return this.#e.keys()}get values(){return this.#e.values()}get entries(){return this.#e.entries()}};var co=class n extends Jt{#e;constructor(){super(!0),this.#e=Object.create(null)}define(t,i){if(typeof i!="function")throw new Error("callback is not a function");return this.#e=Object.freeze({...this.#e,[t]:i}),n.define(this,t,Object.freeze({name:t,callback:i}))}revoke(t){if(this.has(t)){let i={...this.#e};delete i[t],this.#e=Object.freeze(i)}super.revoke(t)}get actionMap(){return this.#e}call(t,...i){let o=this.get(t);if(o===void 0)throw new Error(`action "${t}" doesn't exist`);let{callback:l}=o;return l(...i)}};function y0(n){if(!n||typeof n!="object")return"value is not an object";let{name:t,test:i,decode:o}=n;return typeof t!="string"?"missed name":typeof i!="function"?"missed test function":typeof o!="function"?"missed decode function":!1}function v0(n){let t=y0(n);if(t)throw new Error(`Bad encoding config${n?.name?` "${n.name}"`:""}: ${t}`);let{name:i,test:o,streaming:l,decode:c}=n;return Object.freeze(l?{name:i||"unknown",test:o,streaming:!0,decode:c}:{name:i||"unknown",test:o,streaming:!1,decode:c})}function Ms(n){if(!n)return[];if(!Array.isArray(n))throw new Error("Encodings must be an array");return n.map(v0)}var uu={};Ae(uu,{hasOwn:()=>Le,objectToString:()=>pn});var{toString:b0,hasOwnProperty:w0}=Object.prototype,pn=n=>b0.call(n),Le=Object.hasOwn||((n,t)=>w0.call(n,t));var fo=new Map,cu=null;function x0(n){cu=null;for(let[t,i]of fo.entries())n({level:"warn",message:`${t} (${i.length})`,collapsed:i});fo.clear()}function k0(n,t,...i){cu===null&&fo.size===0&&(cu=setTimeout(()=>x0(n),1));let o=fo.get(t);o!==void 0?o.push(i):fo.set(t,[i])}function dp(n,t,i){switch(typeof t){case"function":return t;case"string":return Object.assign(o=>o&&Le(o,t)?o[t]:void 0,{getterFromString:`object[${JSON.stringify(t)}]`});default:throw new Error(`[Discovery] Bad type "${typeof t}" for ${i} in object marker "${n}" config (must be a string or a function)`)}}function up(n,t,i,o){let l=t&&Le(t,i)?t[i]:void 0;return l!==void 0?dp(n,l,`"${i}" option`):o}function cp(n,t,i){return(Array.isArray(t[i])?t[i]||[]:[]).map(l=>dp(n,l,`"${i}" option`))}function fp(n,t=!1){return n===null?!1:t?typeof n=="object":typeof n=="object"||typeof n=="number"||typeof n=="string"}function C0(n,t){let{name:i,indexRefs:o,lookupRefs:l,annotateScalars:c,page:f,getRef:d,getTitle:g}=t;d!==null&&o.unshift(d),f&&d===null&&n("warn",`Option "ref" for "${i}" marker must be specified when "page" options is defined ("page" option ignored)`),o.length>0&&l.unshift(L=>L);let y=new Set,b=new Map,k=new Map,C=new WeakMap;return{name:i,page:d!==null?f:null,mark:L=>{if(L===null||typeof L!="object"){n("warn",`Invalid value used for "${i}" marker (should be an object)`);return}y.add(L);for(let S of o){let T=S(L);if(fp(T)){if(!b.has(T)){b.set(T,L);continue}b.get(T)!==L&&k0(n,`The same reference value used for different objects for "${i}" marker`,`Reference value "${T}"`,{refGetter:S.getterFromString||S,ref:T,currentObject:b.get(T),newObject:L})}}},lookup:(L,S=!1)=>{if(!fp(L,S?!c:!1))return null;let T=typeof L=="object",N=T?C.get(L):k.get(L);if(N!==void 0)return N;let A=null;if(T&&y.has(L))A=L;else for(let W of l){let H=W(L),te=b.get(H);if(te!==void 0){A=te;break}}if(A===null)return null;let j=k.get(A);if(j!==void 0)return j;let I=d!==null?d(A):null,z=Object.freeze({type:i,object:A,ref:I,title:g(A),href:f!==null&&I!==null?`#${encodeURIComponent(f)}:${encodeURIComponent(I)}`:null});return k.set(A,z),L!==A&&(T?C.set(L,z):k.set(L,z)),z},reset:()=>{y.clear(),b.clear(),k.clear(),C=new WeakMap}}}var gr=class n extends Jt{constructor(i=()=>{}){super();this.logger=i}#e=!1;lock(){this.#e=!0}define(i,o){if(this.#e)throw new Error("Object marker definition is not allowed after setup");if(this.isDefined(i))throw new Error(`Object marker "${i}" is already defined, new definition ignored`);o=o||{};let l=cp(i,o,"refs"),c=cp(i,o,"lookupRefs"),f=!!o.annotateScalars,d=o.page,g=typeof d=="string"?d:null,y=up(i,o,"ref",null),b=up(i,o,"title",y||(()=>null));return n.define(this,i,Object.freeze(C0(this.logger,{name:i,indexRefs:l,lookupRefs:c,annotateScalars:f,page:g,getRef:y,getTitle:b})))}reset(){for(let{reset:i}of this.values)i()}markerMap(){return Object.fromEntries([...this.entries].map(([i,o])=>[i,o.mark]))}lookup(i,o){if(typeof o=="string")return this.get(o)?.lookup(i)||null;for(let{lookup:l}of this.values){let c=l(i);if(c!==null)return c}return null}lookupAll(i){let o=[];for(let{lookup:l}of this.values){let c=l(i);c!==null&&o.push(c)}return o}};var wu={};Ae(wu,{convertToBlobIfPossible:()=>Ap,createDatasetFactoryFromStreamRequest:()=>bo,createLoadDataState:()=>vo,dataFromStream:()=>Tp,dataSource:()=>pC,extractResourceMetadata:()=>bu,getReadableStreamFromSource:()=>CC,loadDataFromEvent:()=>Rs,loadDataFromFile:()=>wo,loadDataFromPush:()=>js,loadDataFromStream:()=>si,loadDataFromUrl:()=>Bs,syncLoaderWithProgressbar:()=>vu});var jt=class{subscriber;value;constructor(t,i){this.subscriber=null,this.value=t,this.shouldUpdate=typeof i=="function"?i:this.shouldUpdate}get readonly(){let t=this;return{subscribe:this.subscribe.bind(this),subscribeSync:this.subscribeSync.bind(this),unsubscribe:this.unsubscribe.bind(this),get value(){return t.value}}}subscribe(t){return this.subscriber={callback:t,subscriber:this.subscriber},()=>this.unsubscribe(t)}subscribeSync(t){let i=this.subscribe(t);return t(this.value,i),i}unsubscribe(t){let i=this,o=this.subscriber;for(;o!==null;){if(o.callback===t){o.callback=null,i.subscriber=o.subscriber;break}i=o,o=o.subscriber}}shouldUpdate(t,i){return t!==i}set(t){return this.#e(t)!==!1}asyncSet(t){let i=this.#e(t);return i===!1?Promise.resolve(!1):Promise.all(i).then(()=>!0)}#e(t){if(!this.shouldUpdate(t,this.value))return!1;let i=[],o=this.subscriber;for(this.value=t;o!==null;){let{callback:l}=o;l!==null&&i.push(l(t,()=>this.unsubscribe(l))),o=o.subscriber}return i}};function fu(n){return typeof n=="object"&&n!==null&&(typeof n[Symbol.iterator]=="function"||typeof n[Symbol.asyncIterator]=="function")}function du(n,t,i,o){switch(i&&typeof i.toJSON=="function"&&(i=i.toJSON()),o!==null&&(i=o.call(n,String(t),i)),typeof i){case"function":case"symbol":i=void 0;break;case"object":if(i!==null){let l=i.constructor;(l===String||l===Number||l===Boolean)&&(i=i.valueOf())}break}return i}function S0(n){return typeof n=="function"?n:Array.isArray(n)?[...new Set(n.map(i=>{let o=i&&i.constructor;return o===String||o===Number?String(i):null}).filter(i=>typeof i=="string"))]:null}function T0(n){return typeof n=="number"?!Number.isFinite(n)||n<1?!1:" ".repeat(Math.min(n,10)):typeof n=="string"&&n.slice(0,10)||!1}function pu(n,t){(n===null||Array.isArray(n)||typeof n!="object")&&(n={replacer:n,space:t});let i=S0(n.replacer),o=Object.keys;if(Array.isArray(i)){let l=i;o=()=>l,i=null}return{...n,replacer:i,getKeys:o,space:T0(n.space)}}var po=1,A0=2,E0=new TextDecoder;function L0(n,t){return n.name==="SyntaxError"&&t.jsonParseOffset&&(n.message=n.message.replace(/at position (\d+)/,(i,o)=>"at position "+(Number(o)+t.jsonParseOffset))),n}function M0(n,t){let i=n.length;n.length+=t.length;for(let o=0;o<t.length;o++)n[i+o]=t[o]}async function Ds(n){let t=typeof n=="function"?n():n;if(fu(t)){let i=new hu;try{for await(let o of t){if(typeof o!="string"&&!ArrayBuffer.isView(o))throw new TypeError("Invalid chunk: Expected string, TypedArray or Buffer");i.push(o)}return i.finish()}catch(o){throw L0(o,i)}}throw new TypeError("Invalid chunk emitter: Expected an Iterable, AsyncIterable, generator, async generator, or a function returning an Iterable or AsyncIterable")}var hu=class{constructor(){this.value=void 0,this.valueStack=null,this.stack=new Array(100),this.lastFlushDepth=0,this.flushDepth=0,this.stateString=!1,this.stateStringEscape=!1,this.pendingByteSeq=null,this.pendingChunk=null,this.chunkOffset=0,this.jsonParseOffset=0}parseAndAppend(t,i){this.stack[this.lastFlushDepth-1]===po?(i&&(this.jsonParseOffset--,t="{"+t+"}"),Object.assign(this.valueStack.value,JSON.parse(t))):(i&&(this.jsonParseOffset--,t="["+t+"]"),M0(this.valueStack.value,JSON.parse(t)))}prepareAddition(t){let{value:i}=this.valueStack;if(Array.isArray(i)?i.length!==0:Object.keys(i).length!==0){if(t[0]===",")return this.jsonParseOffset++,t.slice(1);if(t[0]!=="}"&&t[0]!=="]")return this.jsonParseOffset-=3,"[[]"+t}return t}flush(t,i,o){let l=t.slice(i,o);if(this.jsonParseOffset=this.chunkOffset+i,this.pendingChunk!==null&&(l=this.pendingChunk+l,this.jsonParseOffset-=this.pendingChunk.length,this.pendingChunk=null),this.flushDepth===this.lastFlushDepth)this.flushDepth>0?this.parseAndAppend(this.prepareAddition(l),!0):(this.value=JSON.parse(l),this.valueStack={value:this.value,prev:null});else if(this.flushDepth>this.lastFlushDepth){for(let c=this.flushDepth-1;c>=this.lastFlushDepth;c--)l+=this.stack[c]===po?"}":"]";this.lastFlushDepth===0?(this.value=JSON.parse(l),this.valueStack={value:this.value,prev:null}):this.parseAndAppend(this.prepareAddition(l),!0);for(let c=this.lastFlushDepth||1;c<this.flushDepth;c++){let f=this.valueStack.value;if(this.stack[c-1]===po){let d;for(d in f);f=f[d]}else f=f[f.length-1];this.valueStack={value:f,prev:this.valueStack}}}else{l=this.prepareAddition(l);for(let c=this.lastFlushDepth-1;c>=this.flushDepth;c--)this.jsonParseOffset--,l=(this.stack[c]===po?"{":"[")+l;this.parseAndAppend(l,!1);for(let c=this.lastFlushDepth-1;c>=this.flushDepth;c--)this.valueStack=this.valueStack.prev}this.lastFlushDepth=this.flushDepth}push(t){if(typeof t!="string"){if(this.pendingByteSeq!==null){let c=t;t=new Uint8Array(this.pendingByteSeq.length+c.length),t.set(this.pendingByteSeq),t.set(c,this.pendingByteSeq.length),this.pendingByteSeq=null}if(t[t.length-1]>127)for(let c=0;c<t.length;c++){let f=t[t.length-1-c];if(f>>6===3){c++,(c!==4&&f>>3===30||c!==3&&f>>4===14||c!==2&&f>>5===6)&&(this.pendingByteSeq=t.slice(t.length-c),t=t.slice(0,-c));break}}t=E0.decode(t)}let i=t.length,o=0,l=0;e:for(let c=0;c<i;c++){if(this.stateString){for(;c<i;c++)if(this.stateStringEscape)this.stateStringEscape=!1;else switch(t.charCodeAt(c)){case 34:this.stateString=!1;continue e;case 92:this.stateStringEscape=!0}break}switch(t.charCodeAt(c)){case 34:this.stateString=!0,this.stateStringEscape=!1;break;case 44:l=c;break;case 123:l=c+1,this.stack[this.flushDepth++]=po;break;case 91:l=c+1,this.stack[this.flushDepth++]=A0;break;case 93:case 125:l=c+1,this.flushDepth--,this.flushDepth<this.lastFlushDepth&&(this.flush(t,o,l),o=l);break;case 9:case 10:case 13:case 32:o===c&&o++,l===c&&l++;break}}l>o&&this.flush(t,o,l),l<i&&(this.pendingChunk!==null?this.pendingChunk+=t:this.pendingChunk=t.slice(l,i)),this.chunkOffset+=i}finish(){return this.pendingChunk!==null&&(this.flush("",0,0),this.pendingChunk=null),this.value}};var D0=typeof Object.hasOwn=="function"?Object.hasOwn:(n,t)=>Object.hasOwnProperty.call(n,t),O0={8:"\\b",9:"\\t",10:"\\n",12:"\\f",13:"\\r",34:'\\"',92:"\\\\"},P0=Uint8Array.from({length:2048},(n,t)=>D0(O0,t)?2:t<32?6:t<128?1:2);function N0(n){return n>=55296&&n<=56319}function I0(n){return n>=56320&&n<=57343}function pp(n){if(!/[^\x20\x21\x23-\x5B\x5D-\x7F]/.test(n))return n.length+2;let t=0,i=!1;for(let o=0;o<n.length;o++){let l=n.charCodeAt(o);if(l<2048)t+=P0[l];else if(N0(l)){t+=6,i=!0;continue}else I0(l)?t=i?t-2:t+6:t+=3;i=!1}return t+2}function R0(n){let t=0;return n<0&&(t=1,n=-n),n>=1e9&&(t+=9,n=(n-n%1e9)/1e9),n>=1e4?n>=1e6?t+(n>=1e8?9:n>=1e7?8:7):t+(n>=1e5?6:5):t+(n>=100?n>=1e3?4:3:n>=10?2:1)}function B0(n){switch(typeof n){case"string":return pp(n);case"number":return Number.isFinite(n)?Number.isInteger(n)?R0(n):String(n).length:4;case"boolean":return n?4:5;case"undefined":case"object":return 4;default:return 0}}function ho(n,...t){let{replacer:i,getKeys:o,...l}=pu(...t),c=!!l.continueOnCircular,f=l.space?.length||0,d=new Map,g=new Map,y=new Set,b=[],k={"":n},C=!1,E=0,M=0,O=0;return L(k,"",n),E===0&&(E+=9),{bytes:isNaN(E)?1/0:E+M,spaceBytes:f>0&&isNaN(E)?1/0:M,circular:[...y]};function L(S,T,N){if(!C)if(N=du(S,T,N,i),N===null||typeof N!="object")(N!==void 0||Array.isArray(S))&&(E+=B0(N));else{if(b.includes(N)){y.add(N),E+=4,c||(C=!0);return}if(g.has(N)){E+=g.get(N);return}O++;let A=O,j=E,I=0;if(b.push(N),Array.isArray(N)){I=N.length;for(let z=0;z<I;z++)L(N,z,N[z])}else{let z=E;for(let W of o(N))if(L(N,W,N[W]),z!==E){let H=d.get(W);H===void 0&&d.set(W,H=pp(W)+1),E+=H,I++,z=E}}E+=I===0?2:1+I,f>0&&I>0&&(M+=(Array.isArray(N)?0:I)+(1+b.length*f)*(I+1)-f),b.pop(),A!==O&&g.set(N,E-j)}}}var gu=Object.freeze({name:"json",test:()=>!0,streaming:!0,decode:Ds});var z0=new Uint8Array([0,0,74,83,79,78,88,76]),yp=9,F0=268435455,H0=4294967295,Os=2,go=4,mu=8,yo=16,Ps=32,Ns=64,oi=128,_0=0,q0=1,W0=2,V0=3,U0=4,$0=5,G0=6,K0=8,Y0=9,Q0=10,J0=11,Z0=12,X0=224,eC=7936,vp=0,yu=1,tC=2,nC=3,rC=4,iC=5,bp=6,wp=7,oC=8,hp=16,gp=32,IA=~yo,sC=Os|Ps|Ns,xp=new Uint8Array(256).map((n,t)=>{for(let i=0;i<8;i++)n+=t>>i&1;return n});function aC(n,t,i,o=new Array(i)){let l=t&15,c=t&48,f=i,d=0,g=0;switch(c){case hp:{d=o[0]=n.readIntVar(),f--,g=1;break}case gp:{d=n.readIntVar();break}}switch(l){case tC:{for(let y=0;y<f;y++)o[g+y]=n.readVlq();break}case nC:{for(let y=0;y<f;y++)o[g+y]=n.readIntVar();break}case rC:{let y=n.readBytes(Math.ceil(f/2));for(let b=0,k=0;b<f;b++)k=b&1?k>>4:y[b>>1],o[g+b]=k&8?n.readVlq()*8+(k&7):k&7;break}case iC:{let y=n.readBytes(Math.ceil(f/2));for(let b=0,k=0;b<f;b++){k=b&1?k>>4:y[b>>1];let C=k&4?-1:1;o[g+b]=k&8?C*(n.readVlq()*4+(k&3)):C*(k&3)}break}case bp:{let y=t>>8,b=(1<<y)-1,k=n.readBytes(Math.ceil(f*y/8)),C=0,E=0,M=0;for(let O=0;O<f;O++){for(;E<y;)M|=k[C++]<<E,E+=8;o[g+O]=M&b,M>>=y,E-=y}break}case wp:{let y=t>>8,b=(1<<y)-1,k=n.readBytes(Math.ceil(f*y/8)),C=0,E=0,M=0;for(let O=0;O<f;O++){for(;E<y;)M|=k[C++]<<E,E+=8;o[g+O]=M&1?-((M&b)>>1):(M&b)>>1,M>>=y,E-=y}break}case oC:{let y=o[0]=n.readIntVar(),b=n.readIntVar();for(let k=1;k<i;k++)o[k]=y+=b;break}case vp:case yu:{let y=l===yu,b=t>>8,k=y?t&eC|b&X0:b;if(xp[b]>1){let C=n.readTypeIndex(f,k);for(let E=0;E<f;E++)o[g+E]=n.readNumber(C[E])}else{let C=31-Math.clz32(k);for(let E=0;E<f;E++)o[g+E]=n.readNumber(C)}break}default:throw new Error(`Unknown numeric array encoding method: ${l}`)}switch(c){case hp:{o[0]=d;for(let y=1;y<i;y++)o[y]+=o[y-1];break}case gp:{for(let y=0;y<i;y++)o[y]+=d;break}}return o}var mo=12;function lC(n){return n===yp||n===9}function kp(n){try{let{version:t}=Cp(n);if(lC(t))return!0;throw new Error(`Unsupported jsonxl version "${t}", expected "${yp}"`)}catch{return!1}}function Cp(n){if(n.byteLength<mo)throw new Error(`Header length must be at least ${mo} bytes`);let t=new Uint8Array(n.buffer,n.byteOffset,mo);if(t.subarray(0,8).some((c,f)=>c!==z0[f]))throw new Error("Bad magic number");let i=new DataView(t.buffer,t.byteOffset,mo),o=i.getUint16(8,!0),l=i.getUint16(10,!0);return{version:o,flags:l,headerSize:mo}}var uC=new TextDecoder("utf8",{ignoreBOM:!0});function cC(n){let t=uC.decode(n.readBytes(n.readVlq())),i=n.readNumericArray(),o=n.readNumericArray(),l=n.readNumericArray(),c=new Array(i);for(let f=0,d=0,g=0,y=0,b="";f<i.length;f++){let k=i[f],C=t.slice(d,d+=k>>2);k&2&&(C=b.slice(0,o[g++])+C),k&1&&(C=C+b.slice(-l[y++])),c[f]=C,b=C}return c}var fC=class{constructor(n,t){this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.bytes=n,this.pos=0,typeof t=="function"&&t(this),this.consumeHeader(),this.loadStrings(),this.loadArrayLengths(),this.loadArrayHeaders(),this.loadObjectEntries()}consumeHeader(){let{version:n,flags:t,headerSize:i}=Cp(this.view);return this.pos+=i,{version:n,flags:t}}loadStrings(){this.strings=cC(this),this.stringRefs=this.readNumericArray(),this.stringRefsCursor=0}loadArrayHeaders(){this.arrayHeaders=this.readNumericArray(),this.arrayHeaderRefs=this.readNumericArray(),this.arrayHeaderRefsCursor=0}loadArrayLengths(){this.arrayLengths=this.readNumericArray(),this.arrayLengthsCursor=0}loadObjectEntries(){let n=this.readVlq(),t=this.readVlq();this.objectEntries=new Array(n),this.objectKeys=t?this.stringRefs.slice(-t).map(i=>this.strings[i]):[];for(let i=0;i<n;i++)this.objectEntries[i]={dict:this.readNumericArray(),refs:this.readNumericArray(),cursor:0}}readString(){return this.strings[this.stringRefs[this.stringRefsCursor++]]}readArrayHeader(){return this.arrayHeaders[this.arrayHeaderRefs[this.arrayHeaderRefsCursor++]]}readArrayLength(){return this.arrayLengths[this.arrayLengthsCursor++]}readObjectEntry(n){let t=this.objectEntries[n],i=t.refs[t.cursor++],o=t.dict[i];return o===0?null:{key:this.objectKeys[o>>8],type:o&255}}readBytes(n){return this.bytes.subarray(this.pos,this.pos+=n)}readTypeIndex(n,t,i){let o=0,l=0,c=0;for(;t>0;)t&1&&(o|=c<<(l++<<2)),c++,t>>=1;let f=new Uint8Array(n),d=32-Math.clz32(l-1),g=(1<<d)-1,y=this.readBytes(Math.ceil(d*n/8)),b=0,k=0,C=0;for(let E=0;E<n;E++){C<d&&(k|=y[b++]<<C,C+=8);let M=o>>((k&g)<<2)&15;f[E]=i?1<<M:M,k>>=d,C-=d}return f}readVlq(){let n=this.view.getUint8(this.pos);if(!(n&1))n=n>>1,this.pos+=1;else if(!(n&2))n=this.view.getUint8(this.pos+1)<<6|n>>2,this.pos+=2;else if(!(n&4))n=this.view.getUint16(this.pos+1,!0)<<5|n>>3,this.pos+=3;else{let t=this.view.getUint32(this.pos,!0);n=t>>>3&F0,this.pos+=4,t>>>31&&(n+=this.readUintVar()*(1<<28))}return n}readUintVar(){let n=this.view.getUint8(this.pos++),t=n&127,i=128;for(;n&128;)n=this.view.getUint8(this.pos++),t+=(n&127)*i,i*=128;return t}readIntVar(){let n=this.readUintVar();return n&1?-(n-1)/2:n<=H0?n>>>1:n/2}readUint8(){let n=this.view.getUint8(this.pos);return this.pos++,n}readInt8(){let n=this.view.getInt8(this.pos);return this.pos++,n}readUint16(){let n=this.view.getUint16(this.pos,!0);return this.pos+=2,n}readInt16(){let n=this.view.getInt16(this.pos,!0);return this.pos+=2,n}readUint24(){let n=this.view.getUint16(this.pos,!0)|this.view.getUint8(this.pos+2)<<16;return this.pos+=3,n}readInt24(){let n=this.view.getUint16(this.pos,!0),t=this.view.getUint8(this.pos+2),i=t&128?(t<<16|n)-16777216:t<<16|n;return this.pos+=3,i}readUint32(){let n=this.view.getUint32(this.pos,!0);return this.pos+=4,n}readInt32(){let n=this.view.getInt32(this.pos,!0);return this.pos+=4,n}readFloat32(){let n=this.view.getFloat32(this.pos,!0);return this.pos+=4,n}readFloat64(){let n=this.view.getFloat64(this.pos,!0);return this.pos+=8,n}readNumber(n){switch(n){case _0:return this.readUint8();case q0:return this.readUint16();case W0:return this.readUint24();case V0:return this.readUint32();case U0:return this.readUintVar();case K0:return this.readInt8();case Y0:return this.readInt16();case Q0:return this.readInt24();case J0:return this.readInt32();case Z0:return this.readIntVar();case $0:return this.readFloat32();case G0:return this.readFloat64()}}readNumericArrayEncoding(){let n=this.readUint8();switch(n&15){case vp:case yu:case bp:case wp:n|=this.readUint8()<<8;break}return n}readNumericArray(n=this.readVlq()){if(n===0)return[];let t=this.readNumericArrayEncoding();return this.readNumbers(t,n)}readNumbers(n,t,i){return aC(this,n,t,i)}};function mp(n,t){let i=0;for(let o=0;o<n.length;o++)n[o]===t&&i++;return i}function Sp(n,t){function i(d={}){let g=0,y;for(;y=c.readObjectEntry(g++);)d[y.key]=l(y.type);return d}function o(d=c.readArrayLength()){if(d===0)return[];let g=c.readArrayHeader(),y=g>>16,b=g&65535,k=y&1,C=y>>5&1,E=y>>9&1,M=y>>1&255|(y&1)<<4,O=new Array(d),L=xp[M]>1?c.readTypeIndex(d,M,!0):null;if(M&sC)if(L===null)switch(M){case Os:O.fill(null);break;case Ps:O.fill(!0);break;case Ns:O.fill(!1);break}else for(let S=0;S<d;S++)switch(L[S]){case Os:O[S]=null;break;case Ps:O[S]=!0;break;case Ns:O[S]=!1;break}if(M&mu)for(let S=0;S<d;S++)(L===null||L[S]===mu)&&(O[S]=c.readString());if(M&go)if(M===go)c.readNumbers(b,d,O);else{let S=mp(L,go),T=c.readNumbers(b,S);for(let N=0,A=0;N<d;N++)L[N]===go&&(O[N]=T[A++])}if(M&oi)if(E){let S=M===oi?d:mp(L,oi),T=c.readNumericArray(S),N=o();for(let A=0,j=0,I=0;A<d;A++)(L===null||L[A]===oi)&&(O[A]=N.slice(I,I+=T[j++]))}else for(let S=0;S<d;S++)(L===null||L[S]===oi)&&(O[S]=o());if(M&yo){let S=M===yo?O:[];for(let T=0,N=0;T<d;T++)(L===null||L[T]===yo)&&(O[T]=S[N++]={});if(C){let T=c.readVlq(),N=new Array(T);for(let A=0;A<T;A++)N[A]=c.readString();for(let A=0;A<T;A++){let j=N[A],I=o(S.length);for(let z=0;z<S.length;z++)I[z]!==void 0&&(S[z][j]=I[z])}}if(k)for(let T=0;T<S.length;T++)i(S[T])}return O}function l(d){switch(1<<(d&7)){case Os:return null;case mu:return c.readString();case go:return c.readNumber(d>>3);case yo:return i();case Ps:return!0;case Ns:return!1;case oi:return o()}}let c=new fC(n,t),f=l(c.readUint8());if(c.pos!==n.byteLength)throw new Error("End of input is not reached");return f}var Is=Object.freeze({name:"jsonxl/snapshot9",test:kp,streaming:!1,decode:Sp});var pC={stream:si,event:Rs,file:wo,url:Bs,push:js};function hC(n){try{return new URL(n,location.origin).origin===location.origin}catch{return!1}}function gC(n){return n.ok}function mC(n){return n.headers.get("x-file-encoded-size")||n.headers.get("content-length")}function yC(n){return n.headers.get("x-file-size")||(hC(n.url)&&!n.headers.get("content-encoding")?n.headers.get("content-length"):void 0)}function vC(n){return n.headers.get("x-file-created-at")||n.headers.get("last-modified")||void 0}function bC(n){let t=n?Object.keys(n):[],i=["name","createdAt","elapsedTime","data"];return!(t.length!==4||t.some(o=>!i.includes(o)))}function wC(n,t,{size:i,encoding:o}){let l=null;if(bC(n)){let{data:O,...L}=n;n=O,t={...t,createdAt:O.createdAt},l=L}let c=n,f=l||{},{type:d,name:g,encoding:y,size:b,encodedSize:k,createdAt:C,...E}=t||{};return{resource:{type:d||"unknown",name:g||"unknown",encoding:o,...Number.isFinite(i)?{size:i}:null,...Number.isFinite(k)?{encodedSize:k}:null,createdAt:new Date((typeof C=="string"?Date.parse(C):C)||Date.now()),...E},meta:f,data:c}}async function xC(n){let t=[],i=0;for await(let c of n)t.push(c),i+=c.byteLength;let o=new Uint8Array(i),l=0;for(let c of t)o.set(c,l),l+=c.length;return o}async function Tp(n,t,i,o){let c=n.getReader(),f=Date.now(),d=[...Ms(t),Is,gu],g=0,y="unknown",b=0;await o("receiving",k(!1));try{let M=await c.read(),{value:O,done:L}=M;if(L)throw new Error("Empty payload");for(let{name:S,test:T,streaming:N,decode:A}of d)if(T(O))return y=S,{data:await(N?A(C(M)):xC(C(M)).then(E(A))),encoding:y,size:b,decodingTime:g};throw new Error("No matched encoding found for the payload")}finally{c.releaseLock()}function k(M){return{done:M,elapsed:Date.now()-f,units:"bytes",completed:b,total:i}}async function*C(M){for(;;){let{value:O,done:L}=M||await c.read();if(M=void 0,L)break;for(let S=0;S<O.length;S+=1048576){let T=performance.now(),N=S===0&&O.length-S<1048576?O:O.slice(S,S+1048576);yield N,g+=performance.now()-T,b+=N.length,await o("receiving",k(!1))}}await o("receiving",k(!0))}function E(M){return async O=>{await o("decoding",void 0,y);let L=performance.now();try{return await M(O)}finally{g=performance.now()-L}}}}async function kC(n,t){try{await t.asyncSet({stage:"request"});let i=new Date,{method:o,stream:l,resource:c,options:f,data:d}=await n(),g=new Date,y=c?.size,{encodings:b}=f||{},{data:k,encoding:C="unknown",size:E=void 0,decodingTime:M=0}=d?{data:d}:await Tp(l,b,Number(y)||0,(j,I,z)=>t.asyncSet({stage:j,progress:I,step:z}));await t.asyncSet({stage:"received"});let{data:O,resource:L,meta:S}=wC(k,c,{size:E,encoding:C}),T=new Date,N=Number(T)-Number(i),A=Math.round(M||0);return{loadMethod:o,resource:L,meta:S,data:O,timings:{time:N,start:i,end:T,loadingTime:N-A,decodingTime:A,requestTime:Number(g)-Number(i),requestStart:i,requestEnd:g,responseTime:Number(T)-Number(g),responseStart:g,responseEnd:T}}}catch(i){throw console.error("[Discovery] Error loading data:",i),await t.asyncSet({stage:"error",error:i}),i}}function vo(n,t){let i=new jt({stage:"inited"});return{state:i,dataset:n(i),...t}}function bo(n){return t=>kC(n,t)}function si(n,t){return vo(bo(()=>({method:"stream",stream:n,resource:t?.resource,options:t})))}function wo(n,t){let i=bu(n);return vo(bo(()=>({method:"file",stream:n.stream(),resource:t?.resource||i,options:t})),{title:"Load data from file: "+(i?.name||"unknown")})}function Rs(n,t){let o=(n.dataTransfer||n.target)?.files?.[0];if(n.stopPropagation(),n.preventDefault(),!o)throw new Error("Can't extract a file from an event object");return wo(o,t)}function Bs(n,t){return t=t||{},vo(bo(async()=>{let i=await fetch(n,t.fetch),o=bu(i,t);if(o&&i.body)return{method:"fetch",stream:i.body,resource:t.resource||o,options:t};let l=i.headers.get("content-type")||"",c=await i.text();if(l.toLowerCase().startsWith("application/json"))try{let f=JSON.parse(c);c=f.error||f}catch{}throw c=new Error(c),c.isFetchError=!0,c.status=i.status,c.statusText=i.statusText,c.stack=null,c}),{title:`Load data from url: ${n}`})}function js(n){let t,i=new ReadableStream({start(f){t=f},cancel(){t=null}}),o,l=null,c=new Promise(f=>{o=d=>f({method:"push",stream:i,resource:d?l=d:n?.resource,options:n})});return n=n||{},vo(bo(()=>c),{start(f){o(f)},push(f){o(),t?.enqueue(f)},finish(f){t?.close(),t=null,f!==void 0&&isFinite(f)&&l!==null&&(l.encodedSize=Number(f)),l=null}})}function vu({dataset:n,state:t},i){return new Promise((o,l)=>t.subscribeSync(async(c,f)=>{if(c.stage==="error"){f(),l(c.error);return}let{stage:d,progress:g,step:y}=c;await i.setState({stage:d,progress:g},y),d==="received"&&(f(),o(n))}))}function bu(n,t){if(n instanceof Response){let i=t?.isResponseOk||gC,o=t?.getContentSize||yC,l=t?.getContentEncodedSize||mC,c=t?.getContentCreatedAt||vC;if(i(n))return{type:"url",name:n.url,size:Number(o(n))||null,encodedSize:Number(l(n)),createdAt:c(n)}}if(n instanceof File)return{type:"file",name:n.name,size:n.size,createdAt:n.lastModified};if(n instanceof Blob)return{size:n.size};if(ArrayBuffer.isView(n))return{size:n.byteLength};if(typeof n=="string")return{size:n.length}}function Ap(n){let t=n;return(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t&&!(Symbol.iterator in t)&&!(Symbol.asyncIterator in t))&&(t=[t]),t&&Symbol.iterator in t?new Blob(t):n}function CC(n){if(n instanceof ReadableStream)return n;if(n instanceof Response){if(n.body===null)throw new Error("Response has no body");return n.body}return n=Ap(n),n instanceof Blob?n.stream():new ReadableStream({start(){let t=n?n[Symbol.asyncIterator]:void 0;if(!t)throw new Error("Bad value type (can't convert to a stream)");this.iterator=t()},async pull(t){let{value:i,done:o}=await this.iterator.next();o?(this.iterator=null,t.close()):t.enqueue(i)},cancel(){this.iterator=null}})}function Ep(n,t){return{before(){n.objectMarkers.reset()},contextApi:{markers:n.objectMarkers.markerMap(),setWorkTitle:t?.setPrepareWorkTitle||(()=>Promise.resolve()),rejectData(i,o){throw Object.assign(new Error(i),{renderContent:o})}}}}function xu(n,t){let i=n.objectMarkers,o={setPrepare:n.setPrepare.bind(n),defineObjectMarker:c,addQueryHelpers(g){l={...l,...g}}},l={query:n.query.bind(n),overrideProps:f,pageLink:(g,y,b)=>n.encodePageHash(y,g,b),marker:i.lookup.bind(i),markerAll:i.lookupAll.bind(i),callAction:d,actionHandler:(g,...y)=>n.action.has(g)?()=>d(g,...y):void 0};typeof t=="function"&&t(o),i.lock(),n.queryFnFromString=en.setup({methods:l});function c(g,y){let{mark:b,lookup:k}=i.define(g,y);return k?b:()=>{}}function f(g,y=this.context.props){if(!y)return g;let b={...g};for(let k of Object.keys(b))Le(y,k)&&(b[k]=y[k]);return b}function d(g,...y){let b=y[y.length-1],k=null;typeof b=="function"&&(k=b,y.pop());let C=n.action.call(g,...y);return C&&k&&typeof C.then=="function"?C.then(k):k?k(C):C}}function Lp(n,t){let i=new gr,o=[],l=[],c={setWorkTitle:t?.setPrepareWorkTitle||(()=>Promise.resolve()),rejectData(M,O){throw Object.assign(new Error(M),{renderContent:O})},defineObjectMarker:g,lookupObjectMarker:y,lookupObjectMarkerAll:b,addValueAnnotation:C,addQueryHelpers(M){d=en.setup({methods:f={...f,...M}})},query(M,...O){return n.queryFn.call({queryFnFromString:d},M)(...O)}},f={query:n.query.bind(n),overrideProps:k,pageLink:(M,O,L)=>n.encodePageHash(O,M,L),marker:y,markerAll:b,callAction:E,actionHandler:(M,...O)=>n.action.has(M)?()=>E(M,...O):void 0},d=en.setup({methods:f});return{contextApi:c,after(M){Object.assign(M,{objectMarkers:i,linkResolvers:o,annotations:l,queryFnFromString:d})}};function g(M,O){let{page:L,mark:S,lookup:T}=i.define(M,O)||{};if(!T)return()=>{};if(L!==null){if(!n.page?.isDefined(L))return n.log("error",`Page reference "${L}" doesn't exist`),()=>{};o.push(N=>{let A=T(N);return A&&{type:L,text:A.title,href:A.href,entity:A.object}})}return C((N,A)=>{let j=T(N,!0);if(j!==null&&j.object!==A.host)return{place:"before",style:"badge",text:M,href:j.href}}),S}function y(M,O){return i.lookup(M,O)}function b(M){return i.lookupAll(M)}function k(M,O=this.context.props){if(!O)return M;let L={...M};for(let S of Object.keys(L))Le(O,S)&&(L[S]=O[S]);return L}function C(M,O=!1){typeof O=="boolean"&&(O={debug:O}),l.push({query:M,...O})}function E(M,...O){let L=O[O.length-1],S=null;typeof L=="function"&&(S=L,O.pop());let T=n.action.call(M,...O);return T&&S&&typeof T.then=="function"?T.then(S):S?S(T):T}}var Mp=new WeakMap,Dp=["variable","property","value","method"],SC=(n,t)=>Dp.indexOf(n.type)-Dp.indexOf(t.type),TC=n=>{let t=n.toLowerCase();return i=>i!==n&&(typeof i=="string"?i:String(i)).toLowerCase().indexOf(t)!==-1};function AC(n,t){return typeof n!="string"?String(n):(n=JSON.stringify(n),t[0]!=="'"?n:`'${n.slice(1,-1).replace(/\\.|'/g,i=>i==='\\"'?'"':i==="'"?"\\'":i)}'`)}function EC(n,t,i){if(t===i)return!0;let o=n.stat(t)||[],l=n.stat(i)||[];if(o.length!==l.length)return!1;for(let c=0;c<o.length;c++){let f=o[c],d=l[c];for(let g of Object.keys(f))if(f[g]!==d[g])return!1}return!0}function Op(n,t,i,o,l){try{let c=Mp.get(n);if(!c||c.query!==t||c.data!==o||c.context!==l){let d={tolerant:!0,stat:!0};Mp.set(n,c={query:t,data:o,context:l,offset:-1,suggestions:null,api:null}),c.api=n.queryFnFromString(t,d)(o,l)}if(c.api===null)return null;if(c.offset!==-1&&EC(c.api,c.offset,i))return c.suggestions;let f=c.api.suggestion(c.offset=i,{sort:!0,filter:TC,limit:50});if(f){c.suggestions=[];for(let d of f.sort(SC))c.suggestions.push(...d.suggestions.map(g=>({type:d.type,from:d.from,to:d.to,text:d.text,value:d.type==="value"?AC(g,d.text):g})))}else c.suggestions=null;return c.suggestions}catch(c){n.log({level:"error",message:"Error while attempting to retrieve suggestions for the query",collapsed:c});return}}var LC=()=>{},MC=new Proxy({},{get:()=>()=>{}}),zs=["silent","error","warn","info","perf","debug"],ku="[Discovery]",Fs=(n,t)=>({...t,encodings:Array.isArray(t?.encodings)?[...t.encodings,...n.encodings]:n.encodings}),xo=class extends dn{options;logger;logLevel;action;objectMarkers;linkResolvers;encodings;datasets;data;context;prepare;#e;#t;constructor(t){super(),this.options=t||{};let{logLevel:i="warn",logger:o=console,extensions:l,encodings:c,setup:f}=t||{};this.logger=o||MC,this.logLevel=zs.includes(i)?i:"warn",this.action=new co,this.objectMarkers=new gr(this.log.bind(this)),this.linkResolvers=[],this.datasets=[],this.encodings=Ms(c),this.data=void 0,this.context=void 0,this.prepare=d=>d,this.#e=!0,this.apply(l),typeof f=="function"?(this.#e=!1,xu(this,f)):xu(this,()=>{});for(let{page:d,lookup:g}of this.objectMarkers.values)d&&this.linkResolvers.push(y=>{let b=g(y);return b&&{type:d,text:b.title,href:b.href,entity:b.object}})}apply(t){Array.isArray(t)?t.forEach(i=>this.apply(i)):typeof t=="function"?t.call(null,this):t&&this.apply(Object.values(t))}log(t,...i){let{level:o,lazy:l=null,message:c=null,collapsed:f=null}=typeof t=="object"&&t!==null?t:{level:t},d=zs.indexOf(o);if(d>0&&o!=="silent"&&d<=zs.indexOf(this.logLevel)){let g=o==="perf"?"log":o;if(f){this.logger.groupCollapsed(`${ku} ${c??i[0]}`);let y=typeof f=="function"?f():f;for(let b of Array.isArray(y)?y:[y])this.logger[g](...Array.isArray(b)?b:[b]);this.logger.groupEnd()}else this.logger[g](ku,...typeof l=="function"?l():i)}else d===-1&&this.logger.error(`${ku} Bad log level "${o}", supported: ${zs.slice(1).join(", ")}`)}setPrepare(t){if(typeof t!="function")throw new Error("An argument should be a function");this.prepare=t}setData(t,i){i=i||{};let o=Symbol();this.#t=o;let l=Date.now(),c=()=>{if(this.#t!==o)throw new Error("Prevented by another setData()")},f=this.#e?Lp(this,i):Ep(this,i);return Promise.resolve().then(()=>(c(),f.before?.(this),this.prepare.call(null,t,f.contextApi)||t)).then(g=>{c(),this.datasets=[{...i.dataset,data:g}],this.data=g,f.after?.(this),this.emit("data"),this.log("perf",`Data prepared in ${Date.now()-l}ms`)})}async trackLoadDataProgress(t){let i=Date.now(),o=await t.dataset;return this.log("perf",`Data loaded in ${Date.now()-i}ms`),this.setData(o.data,{dataset:o})}loadDataFromStream(t,i){return this.trackLoadDataProgress(si(t,Fs(this,i)))}loadDataFromEvent(t,i){return this.trackLoadDataProgress(Rs(t,Fs(this,i)))}loadDataFromFile(t,i){return this.trackLoadDataProgress(wo(t,Fs(this,i)))}loadDataFromUrl(t,i){return this.trackLoadDataProgress(Bs(t,Fs(this,i)))}unloadData(){this.hasDatasets()&&(this.datasets=[],this.data=void 0,this.context=void 0,this.emit("unloadData"))}hasDatasets(){return this.datasets.length!==0}getQueryEngineInfo(){return{name:"jora",version:en.version,link:"https://discoveryjs.github.io/jora/#article:jora-syntax"}}queryFnFromString(){return LC}queryFn(t){switch(typeof t){case"function":return t;case"string":return this.queryFnFromString(t)}}query(t,i,o){switch(typeof t){case"function":return t(i,o);case"string":return this.queryFn(t)(i,o);default:return t}}queryBool(t,i,o){return en.buildin.bool(this.query(t,i,o))}querySuggestions(t,i,o,l){return Op(this,t,i,o,l)}pathToQuery(t){return t.map((i,o)=>i==="*"?o===0?"values()":".values()":typeof i=="number"||!/^[a-zA-Z_][a-zA-Z_$0-9]*$/.test(i)?o===0?`$[${JSON.stringify(i)}]`:`[${JSON.stringify(i)}]`:o===0?i:"."+i).join("")}encodePageHash(t,i=null,o){let l=o;return l&&typeof l!="string"&&(Array.isArray(l)||(l=Object.entries(l)),l=l.map(c=>c.map(encodeURIComponent).join("=")).join("&")),`#${t?encodeURIComponent(t):""}${typeof i=="string"&&i||typeof i=="number"?":"+encodeURIComponent(i):""}${l?"&"+l:""}`}decodePageHash(t,i=()=>Object.fromEntries){let o=(t.indexOf("&")+1||t.length+1)-1,[l,c=null]=t.substring(t[0]==="#"?1:0,o).split(":").map(decodeURIComponent),f=t.slice(o+1).split("&").filter(Boolean).map(d=>{let g=d.indexOf("=");return g!==-1?[decodeURIComponent(d.slice(0,g)),decodeURIComponent(d.slice(g+1))]:[decodeURIComponent(d),!0]});return{pageId:l,pageRef:c,pageParams:i(l)(f)}}resolveValueLinks(t){let i=[],o=typeof t;if(t&&(o==="object"||o==="string"))for(let l of this.linkResolvers){let c=l(t);c&&i.push(c)}return i.length?i:null}};var Cu={};Ae(Cu,{createElement:()=>U,createFragment:()=>mr,createText:()=>ko,passiveCaptureOptions:()=>zt,passiveSupported:()=>Pp});function U(n,t,i){let o=document.createElement(n);typeof t=="string"&&(t={class:t});for(let l in t)if(Le(t,l)){let c=t[l];if(typeof c>"u")continue;typeof c=="function"?o.addEventListener(l.slice(2),c):o.setAttribute(l,c)}return Array.isArray(i)?o.append(...i):typeof i=="string"&&(o.innerHTML=i),o}function ko(n){return document.createTextNode(String(n))}function mr(...n){let t=document.createDocumentFragment();return n.forEach(i=>t.appendChild(i instanceof Node?i:ko(i))),t}var Pp=(()=>{let n=!1;try{let t={get passive(){return n=!0,!1}},i=()=>{};window.addEventListener("test-passive",i,t),window.removeEventListener("test-passive",i)}catch{}return n})(),zt=Pp?Object.freeze({passive:!0,capture:!0}):!0;async function Co(n,t){let i=U("style",null,":host{display:none}"),o=new Set;Array.isArray(t)&&(n.append(...t.map(l=>{switch(typeof l=="string"&&(l={type:"style",content:l}),l.type){case"style":case"inline":return U("style",{media:l.media},l.content);case"link":case"external":{let c,f,d=new Promise((y,b)=>{c=y,f=b});return o.add(d),U("link",{rel:"stylesheet",href:l.href,media:l.media,onerror(y){o.delete(d),f(y)},onload(){o.delete(d),c()}})}default:throw new Error(`Unknown type "${l.type}" for a style descriptor`)}})),o.size&&(n.append(i),await Promise.all(o),i.remove()))}var Su={};Ae(Su,{deepEqual:()=>Hs,equal:()=>_s});var Hs=(n,t)=>_s(n,t,Hs);function _s(n,t,i=Object.is){if(Object.is(n,t))return!0;if(!n||typeof n!="object"||!t||typeof t!="object")return!1;for(let o in n)if(Le(n,o)&&(!Le(t,o)||!i(n[o],t[o])))return!1;for(let o in t)if(Le(t,o)&&!Le(n,o))return!1;return!0}var Au={};Ae(Au,{localStorageEntry:()=>Tu,sessionStorageEntry:()=>PC});function DC(n){let t="__storage_test__"+Math.random(),i;try{i=window[n]}catch{return null}try{i.setItem(t,t),i.removeItem(t)}catch(o){if(!(o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&i.length!==0))return null}return i}function Np(n){let t=DC(n),i=Object.assign(new Map,{storage:t,getOrCreate:Object.assign(o=>i.get(o)||NC(o,i),{available:t!==null})});return i}var Ip=Np("sessionStorage"),Rp=Np("localStorage"),OC=new Map([["session",Ip],["local",Rp]]),PC=Ip.getOrCreate,Tu=Rp.getOrCreate;addEventListener("storage",n=>{for(let[,t]of OC)if(t.storage===n.storageArea){let i=t.get(n.key);i&&i.forceSync()}});function NC(n,t){let i=null,o=new dn,l=(f=t.storage?.getItem(n)??null)=>{i!==f&&o.emit("change",i=f)},c={get value(){return this.get()},get(){return i},set(f){t.storage&&(t.storage.setItem(n,f),l())},delete(){t.storage&&(t.storage.removeItem(n),l())},forceSync(){return t.storage&&l(),this.get()},on(f,d){return o.on("change",f),d&&f(i),()=>o.off("change",f)},off(f){o.off("change",f)}};return t.set(n,c),c.forceSync(),c}var Eu=new Set([!0,!1,"auto","disabled","only"]),qs=new Set,Ws=matchMedia("(prefers-color-scheme:dark)"),Lu=Tu("discoveryjs:darkmode"),IC=new Map([["true",!0],["false",!1],["auto","auto"]]),Vs=null;function RC(){for(let n of qs)n.mode==="auto"&&n.set("auto")}function Bp(n){let t=IC.get(n)??null;if(Vs!==t){Vs=t;for(let i of qs)i.persistent&&i.mode!=="disabled"&&i.mode!=="only"&&i.set(t!==null?t:"auto")}}Bp(Lu.value);Lu.on(Bp);Ws.addListener(RC);function jp(n,t){return(n==="off"||n==="disable"||!Eu.has(n))&&(n="disabled"),n!=="disabled"&&n!=="only"&&t&&Vs!==null&&(n=Vs),n}function zp(n){switch(Eu.has(n)||(n="disabled"),n){case"only":return!0;case"auto":return Ws.matches;default:return n===!0}}function Fp(n="disabled",t=!1){return zp(jp(n,t))}var Us=class{persistent;handlers;value;mode;constructor(t,i=!1){this.persistent=i?Lu:null,this.handlers=[],this.set(jp(t,i),!0),qs.add(this)}subscribe(t,i=!1){let o={fn:t};return this.handlers.push(o),i&&o.fn(this.value,this.mode),()=>{let l=o!==null?this.handlers.indexOf(o):-1;o=null,l!==-1&&this.handlers.splice(l,1)}}destroy(){qs.delete(this)}set(t,i=!1){let o=this.value,l=this.mode;Eu.has(t)||(console.warn(`Bad value "${t}" for darkmode, ${i?'fallback to "disabled"':"ignored"}`),t="disabled"),!(!i&&(l==="disabled"||t==="disabled"||l==="only"||t==="only"))&&(this.mode=typeof t=="boolean"?"manual":t,this.value=zp(t),this.mode!=="disabled"&&(this.persistent&&!i&&this.persistent.set(this.mode==="auto"?"auto":this.value),(this.value!==o||this.mode!==l)&&this.handlers.forEach(({fn:c})=>c(this.value,this.mode))))}toggle(t=!1){switch(this.mode){case"auto":this.set(!Ws.matches);break;case"manual":this.set(t&&this.value!==Ws.matches?"auto":!this.value);break}}};var Mu={};Ae(Mu,{ContentRect:()=>yr});var BC=typeof ResizeObserver=="function",yr=class extends jt{el;observer;constructor(){super(null),this.el=null,this.observer=BC?new ResizeObserver(t=>{for(let i of t)this.set(i.contentRect)}):null}observe(t){if(this.observer===null){this.el=null;return}t=t||null,this.el!==t&&(this.el!==null&&this.observer.unobserve(this.el),t!==null&&this.observer.observe(t),this.el=t)}dispose(){this.el=null,this.observer=null}};function Hp(n){n.nav.append({name:"index-page",when:"#.widget | pageId != defaultPageId",data:'{ text: "Index", href: pageLink(#.widget.defaultPageId) }'})}function _p(n){n.nav.append({name:"discovery-page",when:"#.widget | pageId != discoveryPageId",data:'{ text: "Discover", href: pageLink(#.widget.discoveryPageId) }'})}function qp(n){n.nav.append({name:"load-data",when:"#.actions.uploadFile and (#.datasets or (#.widget | pageId != defaultPageId))",content:'text:"Open file\u2026"',onClick:"=#.actions.uploadFile"})}function Wp(n){let t=()=>{};n.nav.menu.append({view:"block",className:["toggle-menu-item","dark-mode-switcher"],name:"dark-mode",when:'#.widget | darkmode.mode not in ["disabled", "only"]',postRender:(i,o,l,{widget:c,hide:f})=>{let d;t(),t=c.darkmode.subscribe((g,y)=>{let b=y==="auto"?"auto":g;b!==d&&(i.innerHTML="",d=b,c.view.render(i,{view:"toggle-group",beforeToggles:'text:"Color schema"',onChange:k=>{d=k,c.darkmode.set(k),f()},value:b,data:()=>[{value:!1,text:"Light"},{value:!0,text:"Dark"},{value:"auto",text:"Auto"}]},null,{widget:c}))},!0)}})}function Vp(n){let i=null,o=0;n.nav.append({name:"inspect",tooltip:{position:"trigger",showDelay:!0,content:'md:"**Enable view inspection**<br>To suspend enabling inspect mode by 3 seconds,<br>click the button with Cmd (\u2318) or Ctrl-key"'},onClick:(l,c,f,d)=>{!n.inspectMode.value&&(d.metaKey||d.ctrlKey)?(i===null&&(o=0,i=setTimeout(function g(){o--,o===0?(i=null,delete l.dataset.suspendSeconds,n.inspectMode.set(!0)):(i=setTimeout(g,1e3),l.dataset.suspendSeconds=String(o))},1e3)),o+=3,l.dataset.suspendSeconds=String(o)):i!==null?(clearTimeout(i),i=null,delete l.dataset.suspendSeconds):(n.view.tooltip?.hide(),n.inspectMode.set(!n.inspectMode.value))}})}var So=class{items;host;baseConfig;constructor(t,i){this.host=t,this.baseConfig=i,this.items=[]}insert(t,i,o){switch(i){case"after":i=this.items.findIndex(c=>c.name===o),i===-1?i=this.items.length:i++;break;case"before":i=this.items.findIndex(c=>c.name===o),i===-1&&(i=this.items.length);break;default:(i===void 0||isNaN(i)||!isFinite(i))&&(i=this.items.length)}i=Math.max(0,Math.min(this.items.length,i));let l=this.host.view.composeConfig(this.baseConfig,t);this.items.splice(i,0,l)}prepend(t){this.insert(t,0)}append(t){this.insert(t)}before(t,i){this.insert(i,"before",t)}after(t,i){this.insert(i,"after",t)}replace(t,i){let o=this.items.findIndex(l=>l.name===t);o!==-1?this.items[o]=this.host.view.composeConfig(this.baseConfig,i):this.insert(i)}remove(t){let i=this.items.findIndex(o=>o.name===t);if(i!==-1)return this.items.splice(i,1)[0]}},$s=class extends So{host;popup;data;context;config;primary;secondary;menu;contentRect;constructor(t,i="nav-button"){super(t,i);let o=U("div","powered-by-discoveryjs",["powered by ",U("a",{class:"view-link",href:"https://github.com/discoveryjs/discovery",target:"_blank"},"Discovery.js"),` ${cl}`]);this.host=t,this.popup=null,this.data=null,this.context=null,this.primary=new So(t,"nav-button"),this.secondary=this,this.menu=new So(t,"menu-item"),this.config=[this.secondary.items,{view:"nav-button",name:"burger",whenData:!0,data:async()=>{let l=mr();return await this.host.view.render(l,this.menu.items,this.host.data,{...this.context,hide:()=>this.popup?.hide()}),[...l.childNodes].filter(c=>c.nodeType===1||c.nodeType===3)},onClick:(l,c)=>{let f=this.popup||new this.host.view.Popup({className:"discovery-nav-popup"});this.popup||(this.popup=f,f.el.addEventListener("click",({target:d})=>{d.closest("a[href]")&&setTimeout(()=>f.hide(),50)},!0)),f.toggle(l,d=>d.append(...c,o))}},this.primary.items],this.contentRect=new yr,this.contentRect.subscribe(l=>{let{container:c}=t.dom;if(c&&l){let{width:f,height:d}=l;c.style.setProperty("--discovery-nav-width",f+"px"),c.style.setProperty("--discovery-nav-height",d+"px")}})}render(t,i,o){this.contentRect.observe(t),t&&(this.data=i,this.context={...o,widget:this.host},this.host.view.setViewRoot(t,"nav",{config:this.config,data:this.data,context:this.context}),t.innerHTML="",this.host.view.render(t,this.config,this.data,this.context))}};var Up=Symbol("config"),jC={name:"not-found",render:(n,{name:t})=>{n.style.cssText="color:#a00",n.innerText=`Page \`${t}\` not found`}},To=class n extends Jt{#e;#t;lastPage;lastPageRef;pageOverscrolled;setPageOverscroll;constructor(t,i){if(super(),this.#e=t,this.#t=i,this.lastPage=null,this.lastPageRef=null,this.pageOverscrolled=new jt(!1),this.setPageOverscroll=()=>{},typeof IntersectionObserver=="function"){let o=U("div",{style:"position:absolute"}),l=t.dom?.content||null,c=()=>{};if(l!==null){let f=new IntersectionObserver(d=>this.pageOverscrolled.set(!d[d.length-1].isIntersecting),{root:l});this.setPageOverscroll=d=>{f.unobserve(o),c(),d&&(d.prepend(o),f.observe(o),c=this.pageOverscrolled.subscribeSync(g=>{d.classList.toggle("page_overscrolled",g)}))}}}}define(t,i,o){return n.define(this,t,Object.freeze({name:t,render:typeof i=="function"?i.bind(this.#t):(l,c,f)=>this.#t.render(l,i,c,f),options:Object.freeze({...o}),[Up]:i}))}render(t,i,o,l){let c=Date.now(),f=this.get(i),d;f||(f=this.get("not-found")||jC,o={name:i});let{reuseEl:g,init:y,keepScrollOffset:b=!0}=f.options||{},k=this.lastPage!==i,C=l&&l.id,E=this.lastPageRef!==C,M=g&&!k?t:document.createElement("article"),O=t.parentNode;this.lastPage=i,this.lastPageRef=C,M.id=t.id,M.classList.add("page","page-"+i),k&&typeof y=="function"&&y(M);try{d=f.render(M,o,l)}catch(L){d=this.#t.render(M,"alert-danger",String(L)+" (see details in console)"),this.#e.log("error","Page render error:",L)}return O!==null&&(k||E||!b)&&(O.scrollTop=0),M!==t&&(t.replaceWith(M),this.setPageOverscroll(M)),{pageEl:M,config:f[Up],renderState:Promise.resolve(d).finally(()=>this.#e.log("perf",`Page "${f.name}" rendered in ${Date.now()-c}ms`))}}};var Jp=Object.freeze({}),Zp=Object.freeze({view:""}),Ou=new WeakMap,Xp=new WeakMap,eh=new WeakMap,$p=new WeakMap,zC=new Set(["view","when","context","data","whenData","postRender","className","tooltip"]);function FC(n){return n.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function vr(n,t){return eh.set(n,t),n}function th(n,t,i,o){if(t===null||o.has(t))return;let l=n.fragmentEls.get(t);if(l!==void 0)for(let f of l){let d=i.children.find(g=>g.view===f);d?i=d:i.children.push(i={node:null,parent:i,view:f,children:[]})}let c=Xp.get(t);if(c!==void 0)i.children.push(i={node:t,parent:i,viewRoot:c,children:[]});else{let f=n.viewEls.get(t);f!==void 0&&i.children.push(i={node:t,parent:i,view:f,children:[]})}if(t.nodeType===1)for(let f=t.firstChild;f;f=f.nextSibling)th(n,f,i,o)}function HC(n){return{name:"config-error",options:Jp,render(t,i){if(t.className="discovery-buildin-view-render-error",t.dataset.type=i.type,t.textContent=i.reason,"config"in i){let o=t.appendChild(document.createElement("span"));o.className="toggle-config",o.textContent="show config...",o.addEventListener("click",()=>{t.classList.toggle("expanded")?(o.textContent="hide config...",n.render(t,{view:"struct",expanded:1},i.config)):(o.textContent="show config...",t.lastChild?.remove())})}}}}function Gp(n,t,i,o,l,c,f,d){return!Le(i,n)||i[n]===void 0||t.host.queryBool(i[n]===!0?"":i[n],o,l)?!0:(t.viewEls.set(d,{skipped:n,config:i,inputData:c,inputDataIndex:f,data:o,context:l}),!1)}function nh(n,t,i,o){let l=t;return typeof l=="string"&&l.startsWith("=")&&(l=n.queryFn(l.slice(1))),typeof l=="function"&&(l=l(i,o)),typeof l=="string"&&(l=l.trim().split(/\s+/)),Array.isArray(l)&&(l=l.map(c=>typeof c=="function"?c(i,o):c).filter(Boolean),l.length)?l:null}async function rh(n,t,i,o,l,c,f,d,g){let{tag:y}=t.options,b=y===null?document.createDocumentFragment():document.createElement(y||"div");await t.render(b,l,c,f),typeof o.postRender=="function"&&await o.postRender(b,o,c,f);let k={config:o,props:l,inputData:d,inputDataIndex:g,data:c,context:f};if(FC(b))for(let C of b.childNodes){let E=n.fragmentEls.get(C);E!==void 0?E.unshift(k):n.fragmentEls.set(C,[k])}else{if(n.viewEls.set(b,k),t.name&&b.classList.add(`view-${t.name}`),o.className){let C=nh(n.host,o.className,c,f);C!==null&&b.classList.add(...C)}o.tooltip&&Nu(n.host,b,o.tooltip,c,f)}i.replaceWith(b)}function Kp(n,t,i,o){return rh(n,n.defaultRenderErrorRenderer,i,Zp,{type:"render",reason:t,config:o})}function _C(n,t){return{name:t,normalizeConfig:n.normalizeConfig.bind(n),ensureValidConfig:n.ensureValidConfig.bind(n),composeConfig:n.composeConfig.bind(n),propsFromConfig:n.propsFromConfig.bind(n),render:n.render.bind(n),listLimit:n.listLimit.bind(n),renderList:n.renderList.bind(n),maybeMoreButtons:n.maybeMoreButtons.bind(n),renderMoreButton:n.renderMoreButton.bind(n),tooltip(i,o,l,c){i&&i.nodeType===1?Nu(n.host,i,o,l,c):n.host.log("warn","A tooltip can be attached to a HTML element only")}}}function Nu(n,t,i,o,l){t.classList.add("discovery-view-has-tooltip"),Ou.set(t,{config:i,data:o,context:l}),n.view.tooltip===null&&(n.view.tooltip=qC(n))}function Yp(n){return!!n&&!Array.isArray(n)&&typeof n!="string"&&typeof n!="function"&&!n.view}function Qp(n,t){return Number.isFinite(n)?Number(n):t}function qC(n){let t=null,i=new n.view.Popup({className:"discovery-buildin-view-tooltip",hoverTriggers:".discovery-view-has-tooltip",position:"pointer",showDelay(o){let{config:l}=Ou.get(o)||{};return Yp(l)?l.showDelay??!0:!0},render(o,l){let{config:c,data:f,context:d}=Ou.get(l)||{},g="pointer",y="natural",b=3,k=3,C=c;return t!==null&&(o.classList.remove(...t),t=null),Yp(c)&&(t=nh(n,c.className,f,d),t!==null&&o.classList.add(...t),g=c.position||g,y=c.positionMode||y,b=Qp(c.pointerOffsetX,b),k=Qp(c.pointerOffsetY,k),C=c.content),i.position=g,i.positionMode=y,i.pointerOffsetX=b,i.pointerOffsetY=k,C?n.view.render(o,C,f,d):n.view.render(o,{view:n.view.defaultRenderErrorRenderer.render,reason:"Element marked as having a tooltip but related data is not found"})}});return i}async function ih(n,t,i,o,l,c){if(Array.isArray(i)){await Promise.all(i.map(y=>ih(n,t,y,o,l,c)));return}let f=o&&typeof l=="number"?o[l]:o,d=null;switch(typeof i.view){case"function":d={name:!1,options:Jp,render:i.view};break;case"string":if(i.view==="render"){let{config:y="",context:b=""}=i;d={name:!1,options:{tag:null},render(k,C,E){let M=y!==""?n.host.query(y,f,c):E,O=n.host.query(b,c,f);return n.render(k,M,E!==M?E:f,O)}}}else if(i.view.startsWith("preset/")){let y=i.view.substr(7);d={name:!1,options:{tag:null},render:n.host.preset.isDefined(y)?n.host.preset.get(y).render:()=>{}}}else d=n.get(i.view)||null;break}t||(t=document.createDocumentFragment());let g=t.appendChild(document.createComment(""));if(!d){let y=typeof i.view=="string"?"View `"+i.view+"` is not found":"Render is not a function";return n.host.log("error",y,i),Kp(n,y,g,i)}try{if(Gp("when",n,i,f,c,o,l,g)){let y="context"in i?await n.host.query(i.context,f,c):c,b="data"in i?await n.host.query(i.data,f,y):f;if(Gp("whenData",n,i,b,y,o,l,g))return await rh(n,d,g,i,n.propsFromConfig(i,b,y),b,y,o,l)}}catch(y){return n.host.log("error","View render error:",y),Kp(n,String(y),g,Zp)}}var Pu=class{el;position;positionMode;pointerOffsetX;pointerOffsetY;constructor(){}toggle(){}async show(){}hide(){}},Ao=class n extends Jt{host;defaultRenderErrorRenderer;viewEls;fragmentEls;tooltip;Popup=Pu;constructor(t){super(),this.host=t,this.defaultRenderErrorRenderer=HC(this),this.viewEls=new WeakMap,this.fragmentEls=new WeakMap,this.tooltip=null}define(t,i,o){let{tag:l,props:c}=o||{};return n.define(this,t,Object.freeze({name:t,options:Object.freeze({...o,tag:typeof l=="string"||l===void 0?l:null,props:typeof c=="string"?this.host.queryFn(c):c}),render:typeof i=="function"?i.bind(_C(this,t)):(f,d,g,y)=>this.render(f,i,g,y)}))}normalizeConfig(t){if(!t)return null;if(Array.isArray(t))return t.reduce((i,o)=>i.concat(this.normalizeConfig(o)||[]),[]);if(typeof t=="string"){let[,i,o,l]=t.match(/^(\S+?)([:{])((?:.|\s)+)$/)||[];if(i){if(o==="{")try{return vr(this.host.queryToConfig(i,o+l),t)}catch(c){return vr(this.badConfig(t,c),t)}return vr({view:i,data:l},t)}return vr({view:t},t)}else if(typeof t=="function")return vr({view:t},t);return t}badConfig(t,i){let o=i?.message||"Unknown error";return this.host.log("error",o,{config:t,error:i}),{view:this.defaultRenderErrorRenderer.render,type:"config",reason:o,config:t}}ensureValidConfig(t){return Array.isArray(t)?t.map(i=>this.ensureValidConfig(i)).flat():!t||!t.view?this.badConfig(t,new Error(t?"Option `view` is missed":"Config is not a valid value")):t}composeConfig(t,i){return t=this.normalizeConfig(t),i=this.normalizeConfig(i),t&&i?Array.isArray(t)?t.map(o=>vr({...o,...i},[o,i])):vr({...t,...i},[t,i]):t||i}propsFromConfig(t,i,o,l=this.get(t?.view)?.options.props){let c={};for(let[f,d]of Object.entries(t))zC.has(f)||(c[f]=typeof d=="string"&&d.startsWith("=")?this.host.query(d.slice(1),i,o):d);if(typeof l=="function"){let f=l(i,{props:c,context:o});f!==null&&typeof f=="object"&&f!==c&&($p.set(f,{props:c,fn:l}),c=f)}return c}render(t,i,o,l,c){return ih(this,t,this.ensureValidConfig(this.normalizeConfig(i)),o,c,l)}listLimit(t,i){return t===!1?!1:!t||isNaN(t)?i:Math.max(parseInt(t,10),0)||i}renderList(t,i,o,l,c=0,f=!1,d){f===!1&&(f=o.length);let g=Promise.all(o.slice(c,c+f).map((y,b,k)=>this.render(t,i,o,{...l,index:c+b,array:o,sliceIndex:b,slice:k},c+b)));return this.maybeMoreButtons(d||t,null,o.length,c+f,f,(y,b)=>this.renderList(t,i,o,l,y,b,d)),g}maybeMoreButtons(t,i,o,l,c,f){if(o<=l)return null;let d=o-l,g=document.createElement("span");return d>c&&this.renderMoreButton(g,"Show "+c+" more...",()=>f(l,c)),d>0&&this.renderMoreButton(g,"Show all the rest "+d+" items...",()=>f(l,1/0)),g!==null&&(g.className="more-buttons",t.insertBefore(g,i)),g}renderMoreButton(t,i,o){let l=document.createElement("button");l.className="more-button",l.innerHTML=i,l.addEventListener("click",()=>{t.remove(),o()}),t.appendChild(l)}attachTooltip(t,i,o,l){Nu(this.host,t,i,o,l)}adoptFragment(t,i){let o=this.fragmentEls.get(i);if(o)for(let l of t.childNodes)this.fragmentEls.set(l,o)}setViewRoot(t,i,o){Xp.set(t,{name:i,...o})}getViewTree(t){let i=new Set(t||[]),o=[];return th(this,this.host.dom?.container||null,{parent:null,children:o},i),o}getViewStackTrace(t){let{container:i}=this.host.dom;if(!i||!(t instanceof Node)||!i.contains(t))return null;let o=[],l=t;for(;l!==null&&l!==i;){let c=this.viewEls.get(l);c!==void 0&&o.push(c),l=l.parentNode}return o.length===0?null:o.reverse()}getViewConfigTransitionTree(t){let i=eh.get(t)||[];return Array.isArray(i)||(i=[i]),{value:t,deps:i.map(this.getViewConfigTransitionTree,this)}}getViewPropsTransition(t){let i=$p.get(t)||null;return i&&{props:i.props,fn:i.fn,query:i.fn.query||null}}};var Eo=class n extends Jt{#e;constructor(t){super(),this.#e=t}define(t,i){return i=JSON.parse(JSON.stringify(i)),n.define(this,t,Object.freeze({name:t,render:(o,l,c,f)=>this.#e.render(o,i,c,f),config:i}))}render(t,i,o,l){let c=this.get(i);if(!c){let f="Preset `"+i+"` is not found";console.error(f,i);let d=t.appendChild(document.createElement("div"));return d.className="discovery-buildin-view-config-error",d.textContent=f,Promise.resolve()}return c.render(t,null,o,l)}};var Bu={};Ae(Bu,{getBoundingRect:()=>Ft,getOffsetParent:()=>Lo,getOverflowParent:()=>Mo,getPageOffset:()=>Iu,getViewportRect:()=>Ru});var{documentElement:ai}=document,oh=document.compatMode==="CSS1Compat";function Lo(n){let t=n.offsetParent;for(;t!==null&&t!==ai&&getComputedStyle(t).position==="static";)t=t.offsetParent;return t||ai}function Mo(n){let t=n.parentNode;for(;t!==null&&t!==ai&&getComputedStyle(t).overflow==="visible";)t=t.parentNode;return t||ai}function Iu(n=null){let t=0,i=0;if(typeof n?.getBoundingClientRect=="function"){let o=n.getBoundingClientRect();t=-o.top,i=-o.left}else if(oh)t=window.pageYOffset||ai.scrollTop,i=window.pageXOffset||ai.scrollLeft;else{let{body:o}=document;n!==o&&(t=o.scrollTop-o.clientTop,i=o.scrollLeft-o.clientLeft)}return{left:i,top:t}}function Ft(n,t=null){let i=Iu(t),o=0,l=0,c=0,f=0;return n instanceof HTMLElement&&typeof n?.getBoundingClientRect=="function"&&({top:o,left:l,right:c,bottom:f}=n.getBoundingClientRect()),{top:o+i.top,left:l+i.left,right:c+i.left,bottom:f+i.top,width:c-l,height:f-o}}function Ru(n,t=null){let i=oh?document.documentElement:document.body,{top:o,left:l}=n===i&&!t?Iu():Ft(n,t),c,f;return!n||n instanceof Window?(c=window.innerWidth||0,f=window.innerHeight||0):(o+=n.clientTop,l+=n.clientLeft,c=n.clientWidth,f=n.clientHeight),{top:o,left:l,right:l+c,bottom:o+f,width:c,height:f}}var ju={};Ae(ju,{pointerXY:()=>Qn});var sh=new jt({x:0,y:0},(n,t)=>n.x!==t.x||n.y!==t.y);document.addEventListener("pointermove",({x:n,y:t})=>sh.set({x:n,y:t}),zt);var Qn=sh.readonly;function WC(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function In(n,t){if(typeof n!="function")throw new TypeError("Expected a function");if(typeof t=="number"&&(t={wait:t}),!WC(t)){let W;return Object.assign(function(...H){return W=n.apply(this,H)},{cancel(){},flush(){return W},pending(){return!1}})}let i=Math.max(0,Number(t.wait)||0),o=!!t.leading,l="maxWait"in t,c=l?Math.max(Number(t.maxWait)||0,i):1/0,f="trailing"in t?!!t.trailing:!0,d,g,y,b,k,C=0;function E(W){let H=d,te=g;return d=g=void 0,C=W,y=n.apply(te,H),y}function M(W,H){return setTimeout(W,H)}function O(W){clearTimeout(W)}function L(W){return C=W,b=M(N,i),o?E(W):y}function S(W,H){let te=W-H,_=W-C,$=i-te;return Math.min($,c-_)}function T(W,H){let te=W-H,_=W-C;return te>=i||te<0||_>=c}function N(){let W=Date.now();if(k===void 0||T(W,k))return A(W);b=M(N,S(W,k))}function A(W){return b=void 0,f&&d?E(W):(d=g=void 0,y)}function j(){b!==void 0&&O(b),C=0,d=k=g=b=void 0}function I(){return b===void 0?y:A(Date.now())}function z(){return b!==void 0}return Object.assign(function(...W){let H=Date.now(),te=k===void 0||T(H,k);if(d=W,g=this,k=H,te){if(b===void 0)return L(k);if(l)return b=M(N,i),E(k)}return b===void 0&&(b=M(N,i)),y},{cancel:j,flush:I,pending:z})}var zu=0,ah=[{view:"badge",when:'view.data != parent.(view or viewRoot).data or "data" in view.config',data:{text:"D"},tooltip:'text:"Data value was changed"'},{view:"badge",when:"view.context != parent.(view or viewRoot).context",data:{text:"C"},tooltip:'text:"Context value was changed"'}];function VC(n){let t=Mo(n),i=Ft(n,t),o=0,l=0,{scrollTop:c,scrollLeft:f,clientWidth:d,clientHeight:g}=t,y=c+o,b=f+l,k=f+d,C=c+g,E=c+i.top,M=f+i.left,O=M+i.width,L=c,S=f;(E<y||E>C)&&(L=E-o),M<b?S=M-l:O>k&&(S=Math.max(M,f-(O-k))-l),t?.scrollTo(S,L)}function lh(){zu=0}function uh(n,{selectTreeViewLeaf:t,detailsSidebarLeafExpanded:i}){return{view:"tree",when:"#.selectedView",data:"$[0]",className:"sidebar",limitLines:!1,itemConfig:{collapsible:"=not viewRoot",expanded:o=>o.viewRoot||i.has(o),onToggle:(o,l,c)=>o?i.add(c):i.delete(c)},item:{view:"switch",content:[{when:"viewRoot",content:{view:"block",className:"view-root",content:"text:viewRoot.name"}},{when:"$ = #.selectedView",content:[{view:"block",className:[o=>o.view?.skipped?"skipped":!1,"selected"],content:'text:view.config.view or "#root" | is string ?: "\u0192n"',postRender(o){requestAnimationFrame(()=>{n.querySelector(".sidebar").scrollTop=zu,VC(o)})}},...ah]},{content:[{view:"link",className:o=>o.view?.skipped?"skipped":!1,data:'{ text: view.config.view or "#root" | is string ?: "\u0192n", href: false, view, self: $ }',onClick(o,l){zu=n.querySelector(".sidebar")?.scrollTop||0,t(l.self)}},...ah]}]}}}function Gs(n){n=n.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1").trimRight(),n=n.replace(/\n[ \t]+(?=\n)/g,`
`);let t=n.split(/\n+/),i=+(n.match(/^\s/)===null),o=1e3;for(var l=i;l<t.length;l++){let c=t[l].match(/^\s*/);if(c[0].length<o&&(o=c[0].length),o==0)break}return o>0&&(n=n.replace(new RegExp("^ {"+o+"}","gm"),"")),n}var ch={view:"block",className:["content","props-config"],data:"#.view | view or viewRoot",content:[{view:"block",className:"content-section skip",when:"skipped",content:'block{ content: "badge:{ text: skipped }" }'},{view:"block",className:"content-section render",when:"config.view is not string",content:'source:{ content: config.view + "", syntax: "js" }'},{view:"block",when:"props != undefined",className:"content-section props",content:[{view:"struct",expanded:2,data:"props"},{view:"context",data:(n,t)=>t.host.view.getViewPropsTransition(n.props),whenData:!0,content:[{view:"block",className:"transition-fn",data:n=>({...n,query:typeof n.query=="string"?Gs(n.query):void 0}),content:{view:"switch",content:[{when:"query is string",content:{view:"source",data:'{ content: query, syntax: "jora", lineNum: false }'}},{content:"struct:fn"}]}},{view:"struct",expanded:2,data:"props"}]}]},{view:"block",className:"content-section config",content:[{view:"struct",expanded:1,data:"config"},{view:"tree",data:(n,t)=>t.host.view.getViewConfigTransitionTree(n.config).deps,whenData:!0,expanded:3,children:"deps",item:{view:"struct",expanded:1,data:"value"}}]}]};var fh={view:"list",className:"data-flow-transitions",limit:1,when:".[view]",data:`
        [null]    // to show empty list on first render
        + .[view] // filter viewRoot
        .(
            $parent;
            $parentName: parent.view.config.view;
            $queryData: view | inputDataIndex != undefined ? inputData[inputDataIndex] : inputData;

            view | [
                ...'data' in config ? { inputData: $queryData, transition: config.data, name: config.view, view: $, $parent } : [],
                ...inputDataIndex != undefined ? { inputData, transition: \`$[\${inputDataIndex}]\`, name: \`\${$parentName} \u2192 \${config.view}\`, view: $, $parent } : []
            ]
        )
    `,whenData:"size() > 1",itemConfig:{when:!0},item:[{view:"block",className:"root-data",when:"inputData = ..parent.viewRoot[].data",content:'badge:"Root data"'},{view:"struct",data:"inputData"},{view:"block",className:"data-flow-transition",content:[{view:"switch",content:[{when:"transition is (string or undefined)",content:{view:"context",data(n){return{content:Gs(n.transition),refs:[]}},content:{view:"source",data:`{
                                    ...,
                                    syntax: "jora",
                                    lineNum: false
                                }`}}},{content:{view:"struct",data:"transition"}}]},{view:"block",className:"view-name",content:"text:name"}]}]},dh={view:"block",className:"content-section data",data:"#.view",content:[{view:"context",data:"..parent",content:fh},{view:"context",content:{...fh,limit:!1}},{view:"block",className:"root-data",when:"view or viewRoot | data = ([@] + @..parent).viewRoot[].data",content:'badge:"Root data"'},{view:"struct",expanded:1,data:"view or viewRoot | data"}]};function UC(n,t){if(n===null)return!0;for(let i of["top","left","width","height"])if(n[i]!==t[i])return!0;return!1}var Fu=n=>{let t=!1,i=null,o=null,l=null,c=null,f,d=new Set,g=new Map,y=new Map,b=U("div","cancel-hint view-alert view-alert-warning"),k=U("div",{class:"discovery-view-inspector-overlay",onclick:()=>S(o&&!l?o:null)},[b]),C=In(()=>{if(!t||l!==null)return;let I=n.view.getViewTree([A.el]),z=new Set([...y.keys()]);(function H(te,_){for(let $ of te){if(!$.node||!$.view&&!$.viewRoot){$.children.length&&H($.children,_);continue}let D=Ft($.node,_),Q=y.get($.node)||null;Q===null?(Q={el:_.appendChild(U("div",$.viewRoot?"overlay view-root":"overlay")),box:null},$.node.nodeType===1&&(Q.el.style.zIndex=getComputedStyle($.node).zIndex),$.viewRoot&&$.viewRoot.inspectable!==!1&&(Q.el.dataset.inspectable=!0),y.set($.node,Q),g.set(Q.el,$)):z.delete($.node),UC(Q.box,D)&&(Q.el.style.top=`${D.top}px`,Q.el.style.left=`${D.left}px`,Q.el.style.width=`${D.width}px`,Q.el.style.height=`${D.height}px`,Q.box=D),$.children.length&&($.node.nodeType===1&&(Q.el.style.overflow=getComputedStyle($.node).overflow!=="visible"?"hidden":"visible"),H($.children,Q.el))}})(I,k);for(let H of z)y.get(H).el.remove(),y.delete(H);E()},{maxWait:0,wait:50}),E=()=>{let{x:I,y:z}=Qn.value;N([...n.dom.container.parentNode.elementsFromPoint(I|0,z|0)||[]].find(W=>g.has(W))||null)},M=I=>{(I.key==="Escape"||I.keyCode===27||I.which===27)&&n.inspectMode.set(!1)},O=()=>{t||(t=!0,document.addEventListener("scroll",C,zt),document.addEventListener("keydown",M,!0),Qn.subscribe(C),f=setInterval(C,500),n.dom.container.append(k),C())},L=()=>{t&&(t=!1,clearInterval(f),document.removeEventListener("scroll",C,zt),document.removeEventListener("keydown",M,!0),Qn.unsubscribe(C),j=!1,delete b.dataset.alt,k.remove(),T())},S=I=>{if(l=I||null,I){let{innerWidth:z,innerHeight:W}=window,{left:H,top:te,width:_,height:$}=A.el.getBoundingClientRect();A.el.style.top=`${te}px`,A.el.style.left=`${H}px`,A.el.style.right=`${z-(H+_)}px`,A.el.style.bottom=`${W-(te+$)}px`,A.frozen=!0,requestAnimationFrame(()=>{N(y.get(I.node)?.el||null),clearTimeout(c),A.show(),A.freeze()}),delete b.dataset.alt}else j?n.inspectMode.set(!1):(d.clear(),lh(),T(),C())},T=()=>{i&&i.classList.remove("hovered"),i=null,o=null,l=null,A.hide()},N=I=>{if(I===i)return;if(i!==null&&i.classList.remove("hovered"),i=I,I===null){c=setTimeout(T,100);return}I.classList.add("hovered");let z=g.get(I)||null;if(z===null){o=null;return}o!==null&&z.view===o.view||(o=z,clearTimeout(c),A.show())},A=new n.view.Popup({className:"discovery-inspect-details-popup",position:"pointer",hideIfEventOutside:!1,hideOnResize:!1,render(I){let z=l||o,W=[],H=z;for(;H!==null&&(H.view||H.viewRoot);)H!==z&&l!==null&&d.add(H),W.unshift(H),H=H.parent;return n.view.render(I,{view:"context",modifiers:[uh(I,{selectTreeViewLeaf:S,detailsSidebarLeafExpanded:d})],content:{view:"context",modifiers:{view:"block",className:"toolbar",content:[{view:"toggle-group",className:"stack-view-chain",name:"view",data:".({ value: $ })",value:"=$[-1].value",toggleConfig:{className:[te=>te.value.viewRoot?"view-root":!1,te=>te.value.view&&te.value.view.skipped?"skipped":!1],content:['text:value | viewRoot.name or view.config.view | is string ?: "\u0192n"']}},{view:"button",when:l!==null,content:'text:"Close inspector"',onClick(){n.inspectMode.set(!1)}}]},content:[ch,{view:"block",className:["content","data-context"],content:[dh,{view:"block",className:"content-section context",data:"$[-1] | view or viewRoot",content:{view:"struct",expanded:1,data:"context"}}]}]}},W,{selectedView:l,host:n})}});n.action.define("startInspect",O),n.action.define("stopInspect",L),n.inspectMode.subscribeSync(I=>I?O():L());let j=!1};var la={};Ae(la,{alerts:()=>dg,autoLink:()=>pg,badges:()=>mg,block:()=>Kh,button:()=>ph,checkbox:()=>yh,checkboxList:()=>gh,column:()=>Yh,columns:()=>Qh,contentFilter:()=>bh,context:()=>Dm,dropdown:()=>xh,editors:()=>$h,expand:()=>Zh,headers:()=>Lg,hstack:()=>eg,html:()=>Dg,image:()=>Pg,imagePreview:()=>Ig,indicator:()=>Bg,input:()=>Sh,link:()=>zg,listItem:()=>tg,lists:()=>ng,markdown:()=>Fg,menu:()=>Ah,menuItem:()=>Lh,navButton:()=>Dh,pageHeader:()=>ig,popup:()=>lg,progressbar:()=>Ph,section:()=>cg,select:()=>Ih,signature:()=>zm,source:()=>xm,struct:()=>iy,switchView:()=>Pm,tab:()=>zh,table:()=>ly,tableCell:()=>cy,tableRow:()=>uy,tabs:()=>Bh,text:()=>Cm,textMatch:()=>Am,textNumeric:()=>Lm,tocSection:()=>fg,toggle:()=>Fh,toggleGroup:()=>Hh,tree:()=>py,treeItem:()=>hy});var Do=(n,t)=>({demo:{view:n,text:"Button",onClick:Function('return () => alert("Hello world!")')()},examples:[{title:"Variations",demo:t.map(i=>`${i}{ text: "${i}" }`)},{title:"Disabled state",demo:t.map(i=>({view:i,disabled:!0,text:i}))},{title:"Complex content",demo:{view:"button",content:['text:"Example "',"pill-badge:123"]}},{title:"Button as a link",demo:{view:"button",text:"Click me",href:"#url",external:!0}},{title:"Using data as source of options",beforeDemo:{view:"md",source:["The following properties are taken from the data when the appropriate options are not specified for a legacy reasons (is subject to remove in the future):","- `text`","- `href`","- `external`"].join(`
`)},highlightProps:["data"],demo:{view:n,data:{text:"demo",href:"#example",external:!0}}}]});var Ks=`is not array? | {
    text: #.props has no 'content' ? is (string or number or boolean) ?: text,
    content: undefined,
    disabled: false,
    href,
    external,
    onClick: undefined
} | overrideProps()`;function ph(n){function t(i,o,l,c){let{text:f,content:d,disabled:g,href:y,external:b,onClick:k}=o;if(i.classList.add("view-button"),g?i.disabled=!0:typeof k=="function"?(i.addEventListener("click",()=>k(i,l,c)),i.classList.add("onclick")):y&&i.addEventListener("click",()=>U("a",{href:y,target:b?"_blank":""}).click()),d)return n.view.render(i,d,l,c);i.textContent=f}n.view.define("button",t,{tag:"button",props:Ks,usage:Do}),n.view.define("button-primary",t,{tag:"button",props:Ks,usage:Do}),n.view.define("button-danger",t,{tag:"button",props:Ks,usage:Do}),n.view.define("button-warning",t,{tag:"button",props:Ks,usage:Do})}var hh={demo:{view:"checkbox-list",checkbox:{content:"text"},data:["one","two","three"]}};function gh(n){n.view.define("checkbox-list",function(t,i,o,l){let{name:c="filter",checkbox:f,checkboxValue:d="$",emptyText:g,limit:y,onChange:b,onInit:k}=i,C=new Set;if(g!==!1&&g!==""&&t.setAttribute("emptyText",g||"Empty list"),!Array.isArray(o)&&o&&(o=[o]),Array.isArray(o))return n.view.renderList(t,this.composeConfig({view:"checkbox",...f,onInit:(E,M,O,L)=>{E&&C.add(n.query(d,O,L))},onChange:(E,M,O,L)=>{let S=C.size,T=n.query(d,O,L);E?C.add(T):C.delete(T),S!==C.size&&typeof b=="function"&&b([...C],c)}}),o,l,0,n.view.listLimit(y,25)).then(()=>{typeof k=="function"&&k([...C],c)})},{usage:hh})}var mh={demo:{view:"checkbox",content:'text:"checkbox caption"'},examples:[{title:"Checked state",beforeDemo:"Checked state is set up with `checked` property. Its value can be a query",demo:[{view:"checkbox",checked:!0,content:'text:"should be checked"'},{view:"checkbox",checked:"1 > 5",content:`text:"shouldn't be checked"`},{view:"checkbox",checked:"1 < 5",content:'text:"should be checked"'}]},{title:"Readonly checkbox",demo:{view:"checkbox",readonly:!0,content:'text:"checkbox caption"'}},{title:"On change",demo:{view:"checkbox",onChange:Function("return (value, name, data, context) => alert(`Changed to ${value}!`)")(),content:'text:"click me!"'}}]};function yh(n){function t(i,o,l,c,f,d){if(i===null)return;let g=f?{...c,[f]:d.checked}:c;return i.innerHTML="",n.view.render(i,o,l,g)}n.view.define("checkbox",function(i,o,l,c){let{name:f,checked:d,readonly:g,content:y,onInit:b,onChange:k}=o,C=i.appendChild(U("input")),E=y?i.appendChild(U("span","view-checkbox__label")):null;return C.type="checkbox",C.checked=d!==void 0?n.queryBool(d,l,c):!!c[f],C.readOnly=g,C.addEventListener("click",M=>{g&&M.preventDefault()}),C.addEventListener("change",()=>{typeof k=="function"&&(k(C.checked,f,l,c),t(E,y,l,c,f,C))}),typeof b=="function"&&b(C.checked,f,l,c),t(E,y,l,c,f,C)},{tag:"label",usage:mh})}var vh={demo:{view:"content-filter",data:["foo","bar","baz"],content:{view:"list",data:".[$ ~= #.filter]"}},examples:[{title:"Using with text-match",demo:{view:"content-filter",data:[{name:"foo"},{name:"bar"},{name:"baz"}],name:"customName",content:{view:"list",data:".[name ~= #.customName]",item:"text-match:{ text: name, match: #.customName }"}}}]};function bh(n){n.view.define("content-filter",function(t,i,o,l){let{name:c="filter",type:f="regexp",placeholder:d,content:g,onInit:y,onChange:b}=i;return n.view.render(t,{view:"context",modifiers:{view:"input",name:c,type:f,placeholder:d||"Filter"},content:{view:"block",className:"content",content:g,onInit:y,onChange:b}},o,l)},{usage:vh})}var wh={demo:{view:"context",modifiers:{view:"dropdown",name:"demo",value:{foo:"two",bar:"hello"},resetValue:{foo:"one",bar:""},caption:"text:`${#.demo.foo} / ${#.demo.bar}`",content:[{view:"select",name:"foo",data:["one","two","three","four"]},{view:"input",name:"bar"}]},content:[{view:"block",content:'text:"Modified context (see values in \\"demo\\" section):"'},{view:"struct",expanded:1,data:"#"}]}};function $C(n,t){if(!n||!t||typeof n!="object"||typeof t!="object")return n===t;for(let i in n)if(Le(n,i)&&n[i]!==t[i])return!1;for(let i in t)if(Le(t,i)&&n[i]!==t[i])return!1;return!0}function xh(n){n.view.define("dropdown",function(t,i,o,l){function c(I,z){return typeof O=="function"?O(I,z):$C(I,z)}function f(){return A.innerHTML="",n.view.render(A,E||"text",o,{...l,[y||"__self"]:T})}function d(I){T=I,typeof S=="function"&&S(T,y,o,l),N.hide(),f()}function g(I,z){if(j){let W={changed:!c(I,z)};j.innerHTML="",n.view.render(j,[{view:"button-primary",disabled:"=not changed",content:'text:"Apply"',onClick(H,te,_){d(_)}},{view:"button",when:()=>b&&!c(b,T),content:'text:"Reset"',onClick(){d(b)}},{view:"button",disabled:"=not changed",content:'text:"Cancel"',onClick(){N.hide()}}],W,z)}}let{name:y,resetValue:b,value:k,placeholder:C,caption:E,content:M,compare:O,onInit:L,onChange:S}=i,T="value"in i?k:l[y],N=null,A=t.appendChild(document.createElement("div")),j;return C&&(t.dataset.placeholder=C),t.tabIndex=0,t.addEventListener("click",()=>{N===null&&(N=new n.view.Popup({className:"view-dropdown-popup"}));let I={...T},z;N.toggle(t,W=>n.view.render(W,[{view:"block",className:"content",content:n.view.composeConfig(M,{onInit(H,te){I[te]=H},onChange(H,te){I[te]=H,g(z,I)}})},{view:"block",className:"confirm",postRender(H){j=H}}],o,{...l,...T}).then(()=>{z={...I},g(z,I)}))}),A.className="view-dropdown__caption",typeof L=="function"&&L(T,y,o,l),f()},{usage:wh})}function GC(n,t){try{return new RegExp("((?:"+n+")+)",t)}catch{}return new RegExp("((?:"+n.replace(/[\[\]\(\)\?\+\*\{\}\\]/g,"\\$&")+")+)",t)}function Oo(n,t="i"){return Object.assign(GC(n,t),{rawSource:n})}var kh=Function("return (value) => alert(`Changed to ${value}!`)")(),Ch={examples:[{title:"Input with value",demo:{view:"input",value:'"value"'}},{title:"Input with placeholder",demo:{view:"input",placeholder:"placeholder"}},{title:"Input type number with min and max",demo:{view:"input",htmlType:"number",htmlMin:10,htmlMax:20}},{title:"Input with onChange",demo:{view:"input",onChange:kh}},{title:"Input with onChange debounced",demo:{view:"input",onChange:kh,debounce:300}}]};function Sh(n){let t={regexp:i=>i?Oo(i):null,text:i=>i};n.view.define("input",function(i,o,l,c){let{name:f,value:d,type:g="text",placeholder:y,onInit:b,onChange:k,htmlType:C="text",htmlMin:E,htmlMax:M,debounce:O}=o,L=t[g]||t.text,S=i.appendChild(document.createElement("input")),T=d?n.query(d,l,c):c[f];typeof T!="string"&&(T=""),S.type=C,S.value=T,S.placeholder=[y||"",L!==t.text?"("+g+")":""].filter(Boolean).join(" "),typeof E<"u"&&(S.min=E),M&&(S.max=M),S.addEventListener("input",In(()=>{let N=S.value.trim();T!==N&&(T=N,typeof k=="function"&&k(L(N),f,l,c))},O)),typeof b=="function"&&b(L(S.value.trim()),f,l,c)},{usage:Ch})}var KC=Function("return (value) => alert(`Changed to ${value.text}!`)")(),Th={demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}]},examples:[{title:"With limit",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}],limit:2}},{title:"With custom item",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}],item:"h1:text"}},{title:"On chage handler",demo:{view:"menu",onChange:KC,data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}]}}]};function Ah(n){n.view.define("menu",function(t,i,o,l){let{name:c="filter",item:f,itemConfig:d,limit:g,emptyText:y,onClick:b,onInit:k,onChange:C}=i;if(y!==!1&&y!==""&&t.setAttribute("emptyText",y||"No items"),Array.isArray(o)){let E=this.composeConfig({view:"menu-item",content:f,onClick:typeof b=="function"?b:typeof C=="function"?M=>C(M,c):void 0},d);return n.view.renderList(t,E,o,l,0,n.view.listLimit(g,25)).then(()=>{typeof k=="function"&&k(n.query(".[selected].pick()",o,l),c)})}},{usage:Th})}var Eh={demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#"},{text:"three",href:"#"}]},examples:[{title:"Preselected item",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#",selected:!0},{text:"three",href:"#"}]}},{title:"Disabled item",demo:{view:"menu",data:[{text:"one",href:"#"},{text:"two",href:"#",disabled:!0},{text:"three",href:"#"}]}},{title:"External links",demo:{view:"menu",data:[{text:"one",external:!0,href:"https://github.com/discoveryjs/discovery"},{text:"two",external:!0,href:"https://github.com/discoveryjs/discovery"},{text:"three",external:!0,href:"https://github.com/discoveryjs/discovery"}]}}]};function Lh(n){n.view.define("menu-item",function(t,i,o,l){let{content:c,onClick:f}=i,{text:d,selected:g=!1,disabled:y=!1,href:b,external:k}=o||{};if(y?t.classList.add("disabled"):typeof f=="function"?(t.addEventListener("click",()=>f(o,l)),t.classList.add("onclick")):b&&(t.href=b,t.target=k?"_blank":""),g&&t.classList.add("selected"),c)return n.view.render(t,c,o,l);t.textContent=typeof o=="string"?o:d||"Untitled item"},{tag:"a",usage:Eh})}var YC=()=>alert("changed!"),Mh={demo:{view:"nav-button",data:{text:"I am nav button"}},examples:[{title:"With href",demo:{view:"nav-button",data:{text:"I am nav button",href:"#"}}},{title:"External link",demo:{view:"nav-button",data:{text:"I am nav button",external:!0,href:"https://github.com/discoveryjs/discovery"}}},{title:"On click handler",demo:{view:"nav-button",data:{text:"I am nav button"},onClick:YC}}]};function Dh(n){n.view.define("nav-button",function(t,i,o,l){let{name:c,content:f,disabled:d=!1,onClick:g}=i,{text:y="",href:b,external:k}=o||{};if(c&&(t.dataset.name=c),n.query(d,o,l)?t.classList.add("disabled"):typeof g=="function"?(t.addEventListener("click",C=>g(t,o,l,C)),t.classList.add("onclick")):b&&(t.href=b,t.target=k?"_blank":""),f)return n.view.render(t,f,o,l);t.textContent=y},{tag:"a",usage:Mh})}var Oh={demo:{view:"progress",progress:.5,content:'text:"Loading..."'},examples:[{title:"With no label (content)",demo:{view:"progress",progress:.25}},{title:"Custom color",demo:{view:"progress",progress:.85,color:"#bdab77",content:'text:"Yellow progress"'}}]};function Ph(n){n.view.define("progress",function(t,i,o,l){let{content:c,progress:f,color:d}=i;if(t.append(U("div",{class:"progress",style:`--progress: ${Math.max(0,Math.min(1,Number(f)))};--color: ${d||"unset"};`})),c){let g=U("div","content");return t.prepend(g),n.view.render(g,c,o,l)}},{usage:Oh})}var QC=Function("return (value) => alert(`Changed to ${value}!`)")(),Nh={demo:{view:"select",data:["one","two","three","four"]},examples:[{title:"Select with value",demo:{view:"select",value:'"three"',data:["one","two","three","four"]}},{title:"Select with reset option",demo:{view:"select",resetItem:!0,value:'"three"',data:["one","two","three","four"]}},{title:"Select with placeholder",demo:{view:"select",placeholder:"placeholder",data:["one","two","three","four"]}},{title:"Select with onChange",demo:{view:"select",onChange:QC,data:["one","two","three","four"]}},{title:"Select with custom options",demo:{view:"select",item:"h1:text",data:["one","two","three","four"]}}]};function Ih(n){let t="text-match:{ text, match: #.filter }",i="{ value: $, text: #.selectVariantTextQuery.query($, #) }",o=new n.view.Popup({className:"view-select-popup"});n.view.define("select",function(l,c,f,d){function g(){if(l.innerHTML="",I!==void 0)return n.view.render(l,n.view.composeConfig({view:"menu-item",data:i,content:L},S),I,z)}let{name:y,value:b,text:k="$",placeholder:C,limit:E,minItemsFilter:M=10,resetItem:O=!1,item:L=t,itemConfig:S,beforeItems:T,afterItems:N,onInit:A,onChange:j}=c,I=b?n.query(b,f,d):d[y],z={...d,selectMinItemsFilter:M,selectCurrentValue:I,selectVariantTextQuery:k,selectResetItem:O?[{value:void 0,text:"",...O,resetItem:!0}]:[]},W=[];return T&&W.push(n.view.composeConfig(T,{onInit:A,onChange:j})),W.push({view:"context",data:`.(${i})`,modifiers:{view:"input",when:"size() >= #.selectMinItemsFilter",type:"regexp",name:"filter",className:"view-select__filter",placeholder:"Filter"},content:{view:"menu",className:"view-select__variants",data:"#.selectResetItem + .[no #.filter or text~=#.filter]",limit:E,itemConfig:n.view.composeConfig({className:[H=>H.resetItem?"reset-item":"",H=>H.value===I?"selected":""]},S),item:L,onClick(H){o.hide(),I!==H.value&&(I=H.value,z={...z,selectCurrentValue:I},g(),typeof j=="function"&&j(H.value,y,H,d))}}}),N&&W.push(n.view.composeConfig(N,{onInit:A,onChange:j})),C&&(l.dataset.placeholder=C),l.tabIndex=0,l.addEventListener("click",()=>{o.toggle(l,H=>n.view.render(H,W,f,z).then(()=>(H.querySelector(".view-select__filter input")||{focus(){}}).focus()))}),typeof A=="function"&&A(I,y,f,d),g()},{usage:Nh})}var Rh={demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}},examples:[{title:"With before and after content",demo:{view:"tabs",name:"example",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],beforeTabs:'text:"<Content before tabs>"',afterTabs:'text:"<Content after tabs>"',content:'text:"Selected: " + #.example'}},{title:"On change handler",demo:{view:"tabs",name:"example",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],onChange:Function('return (value) => alert("changed to " + value)')(),content:'text:"Selected: " + #.example'}}]};function Bh(n){n.view.define("tabs",function(t,i,o,l){async function c(j){let I=T?b:y;if(N===j)return;let z=d||g||f?{...l,[k]:j}:null;N=j,T=!0,Array.isArray(C)&&(M.innerHTML="",d&&(L.innerHTML="",await n.view.render(L,d,o,z),M.appendChild(L)),await Promise.all(C.map(W=>n.view.render(M,n.view.composeConfig(W,{active:W.value===N}),o,l))),g&&(S.innerHTML="",await n.view.render(S,g,o,z),M.appendChild(S))),f&&(O.innerHTML="",await n.view.render(O,f,o,z)),typeof I=="function"&&I(N,k,o,l)}let{content:f,beforeTabs:d,afterTabs:g,onInit:y,onChange:b}=i,{name:k,tabs:C,tabConfig:E}=i,M=t.appendChild(document.createElement("div")),O=null,L=null,S=null,T=!1,N=NaN,A="value"in i?i.value:k in l?l[k]:void 0;return C=n.query(C,o,l),E=n.view.composeConfig({view:"tab",onClick:c},E),M.className="view-tabs-buttons",d&&(L=document.createElement("div"),L.className="view-tabs-buttons-before"),g&&(S=document.createElement("div"),S.className="view-tabs-buttons-after"),f&&(O=t.appendChild(document.createElement("div")),O.className="view-tabs-content"),typeof k!="string"&&(k="filter"),Array.isArray(C)?C=C.map(j=>{let I=typeof j;return(I==="string"||I==="number"||I==="boolean")&&(j={value:j}),(A===void 0||j.active)&&(A=j.value),n.view.composeConfig(E,j)}):C=[],c(A)},{usage:Rh})}var Hu=()=>alert("clicked!"),jh={demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}},examples:[{title:"Active & disabled tab",demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One"},{value:"two",text:"Two",active:!0},{value:"three",text:"Three",disabled:!0}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}}},{title:"On click handler",demo:{view:"tabs",name:"tabs",tabs:[{value:"one",text:"One",onClick:Hu},{value:"two",text:"Two",onClick:Hu},{value:"three",text:"Three",onClick:Hu}],content:{view:"switch",content:[{when:'#.tabs="one"',content:'text:"One"'},{when:'#.tabs="two"',content:'text:"Two"'},{when:'#.tabs="three"',content:'text:"Three"'}]}}}]};function zh(n){n.view.define("tab",function(t,i,o,l){let{content:c,active:f=!1,disabled:d=!1,onClick:g,value:y,text:b=String(y).replace(/^./,k=>k.toUpperCase())}=i;if(n.query(d,o,l)?t.classList.add("disabled"):typeof g=="function"&&(t.addEventListener("click",()=>g(y)),t.classList.add("onclick")),f&&t.classList.add("active"),c)return n.view.render(t,c,o,l);t.textContent=b},{usage:jh})}var Ys={demo:{view:"context",modifiers:{view:"toggle-group",name:"toggleValue",data:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}]},content:{view:"switch",content:[{when:'#.toggleValue="one"',content:'text:"One"'},{when:'#.toggleValue="two"',content:'text:"Two"'},{when:'#.toggleValue="three"',content:'text:"Three"'}]}},examples:[{title:"With before and after content",demo:{view:"toggle-group",data:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}],beforeToggles:'text:"<Content before toggles>"',afterToggles:'text:"<Content after toggles>"'}},{title:"On change handler",demo:{view:"toggle-group",name:"example",onChange:Function('return (value) => alert("changed to " + value)')(),data:[{value:"one",text:"One"},{value:"two",text:"Two"},{value:"three",text:"Three"}]}}]};function Fh(n){n.view.define("toggle",function(t,i,o,l){let{content:c,disabled:f=!1,onToggle:d,value:g,text:y=String(g).replace(/^./,k=>k.toUpperCase())}=i,{checked:b=!1}=i;if(f?t.classList.add("disabled"):typeof d=="function"&&(t.addEventListener("click",()=>{b=!b,d(b,g)}),t.classList.add("onclick")),b&&t.classList.add("checked"),c)return n.view.render(t,c,o,l);t.textContent=y},{usage:Ys})}function Hh(n){n.view.define("toggle-group",function(t,i,o,l){async function c(T,N){let A=O?y:g;L!==N&&(L=N,O=!0,Array.isArray(C)&&(t.innerHTML="",f&&(E.innerHTML="",await n.view.render(E,f,o,{...l,[b]:N}),t.appendChild(E)),d&&(M.innerHTML="",await n.view.render(M,d,o,{...l,[b]:N}),t.appendChild(M)),await Promise.all(C.map((j,I)=>n.view.render(t,n.view.composeConfig(j,{checked:j.value===L}),o[I],l)))),typeof A=="function"&&A(L,b,o,l))}let{beforeToggles:f,afterToggles:d,onInit:g,onChange:y}=i,{name:b,toggleConfig:k}=i,C=[],E=null,M=null,O=!1,L=NaN,S="value"in i?i.value:b in l?l[b]:void 0;return k=n.view.composeConfig({view:"toggle",onToggle:c},k),f&&(E=document.createElement("div"),E.className="view-toggle-group-before"),d&&(M=document.createElement("div"),M.className="view-toggle-group-after"),typeof b!="string"&&(b="filter"),Array.isArray(o)&&(C=o.map(T=>{let N=typeof T;return(N==="string"||N==="number"||N==="boolean")&&(T={value:T}),(S===void 0||T.active)&&(S=T.value),n.view.composeConfig(k,T)})),c(!0,S)},{usage:Ys})}var _u={};Ae(_u,{escapeHtml:()=>Ge,numDelim:()=>Dt});function Ge(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Dt(n,t=!0){let i=t&&typeof n!="number"?Ge(String(n)):String(n);return i.length>3?i.replace(/\.\d+(eE[-+]?\d+)?|\B(?=(\d{3})+(\D|$))/g,o=>o||'<span class="num-delim"></span>'):i}var br=un(Sn(),1);var Vu=un(Sn(),1);function Uu(n){let t=new Set(["has","in","no","not","and","or","is","asc","ascN","ascA","ascAN","ascNA","desc","descN","descA","descAN","descNA"]),i=Vu.default.getMode(n,{name:"javascript",json:!0});return{...i,indent(o,l){return o.indented+n.indentUnit*(o.lastType==="{"&&l.trim()[0]!=="}"||o.lastType==="("&&l.trim()[0]!==")"||o.lastType==="["&&l.trim()[0]!=="]")},token(o,l){let c=o.peek();if(c==="#"||c==="@")return i.token(new Vu.default.StringStream("$",4,o.lineOracle),l),o.pos++,"variable";let f=i.token(o,l),d=o.string.slice(o.start,o.pos);if(o.string[o.start-1]!=="."){if(l.isAssertionContext){if((f==="variable"||f==="atom")&&l.isAssertionParen===0&&d!=="not")return"type";d==="("?l.isAssertionParen++:d===")"&&(l.isAssertionParen>0&&l.isAssertionParen--,l.isAssertionParen===0&&(l.isAssertionContext=!1))}if(t.has(d))return d==="is"&&(l.isAssertionContext=!0,l.isAssertionParen=0),"keyword"}if(l.isAssertionContext){if(f==="variable"||f==="atom"||f==="def"||d==="function")return"type";l.isAssertionParen===0&&(f||/\S/.test(d))&&(l.isAssertionContext=!1)}return f}}}var _h=un(Sn(),1);function qh(n,t){let i=typeof t.isDiscoveryViewDefined=="function"?t.isDiscoveryViewDefined:()=>{},o=_h.default.getMode(n,{name:"javascript",json:!0});return{...o,indent(l,c){return l.indented+n.indentUnit*(l.lastType==="{"&&c.trim()[0]!=="}"||l.lastType==="("&&c.trim()[0]!==")"||l.lastType==="["&&c.trim()[0]!=="]")},token:function(l,c){if(c.suspendTokens){let{pos:g,token:y}=c.suspendTokens.shift();return l.pos=g,c.suspendTokens.length===0&&(c.suspendTokens=null),y}let f=l.pos,d=o.token(l,c);if(d==="string"){let g=l.pos,[,y]=l.string.slice(f+1,g-1).match(/^(.+?)([:{]|$)/)||[];i(y)&&(l.pos=f+1,c.suspendTokens=[{pos:f+1+y.length,token:"string discovery-view-name"},{pos:g,token:d}])}return d}}}var oM=un($u(),1);var Ht=un(Sn(),1);var JC="discovery-view-editor-hints-popup",ZC="discovery-view-editor-hint",Gu="active",XC=window.requestAnimationFrame||(n=>setTimeout(n,1e3/60)),e1=window.cancelAnimationFrame||clearTimeout;Ht.default.commands.autocomplete=Ht.default.showHint;Ht.default.defineOption("showHintOptions",null);Ht.default.defineExtension("showHint",function(n){n={closeOnUnfocus:!0,container:null,...this.options.showHintOptions,...n},this.state.completionActive&&this.state.completionActive.close(),!(this.listSelections().length>1)&&(this.somethingSelected()||typeof n.hint=="function"&&(this.state.completionActive=new Ku(this,n),this.state.completionActive.update(!0),Ht.default.signal(this,"startCompletion",this)))});var Ku=class{constructor(t,i){if(this.cm=t,this.options=i,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,t.on("cursorActivity",this.activityFunc=()=>this.cursorActivity()),i.closeOnUnfocus){let o;this.onFocus=()=>clearTimeout(o),this.onBlur=()=>o=setTimeout(()=>this.close(),100),t.on("focus",this.onFocus),t.on("blur",this.onBlur)}}close(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.options.closeOnUnfocus&&(this.cm.off("blur",this.onBlur),this.cm.off("focus",this.onFocus)),this.widget&&(this.data&&Ht.default.signal(this.data,"close"),this.widget.close()),Ht.default.signal(this.cm,"endCompletion",this.cm))}active(){return this.cm.state.completionActive===this}pick(t,i){let o=t.list[i];this.cm.state.completionEnabled=!1,o.hint?o.hint(this.cm,t,o):this.cm.replaceRange(Uh(o),o.from||t.from,o.to||t.to,"complete"),Ht.default.signal(t,"pick",o),this.close()}cursorActivity(){this.debounce&&(e1(this.debounce),this.debounce=0);let t=this.cm.getCursor(),i=this.cm.getLine(t.line);t.line!=this.startPos.line||i.length-t.ch!=this.startLen-this.startPos.ch||t.ch<this.startPos.ch||this.cm.somethingSelected()?this.close():(this.debounce=XC(()=>this.update()),this.widget&&this.widget.disable())}update(t){if(this.tick===null)return;let i=++this.tick;Promise.resolve(this.options.hint(this.cm,this.options)).then(o=>{this.tick==i&&this.finishUpdate(o,t)})}finishUpdate(t){this.data&&Ht.default.signal(this.data,"update");let i=this.widget&&this.widget.picked;this.widget&&this.widget.close(),this.data=t,t&&t.list.length&&(i&&t.list.length==1?this.pick(t,0):(this.widget=new Yu(this,t),Ht.default.signal(t,"shown")))}};function Uh(n){return typeof n=="string"?n:n.text}function t1(n,t){for(;t&&t.parentNode!==n;)t=t.parentNode;return t}var Yu=class{constructor(t,i){let o=t.cm,l=this.hintsEl=document.createElement("ul"),c=[JC,t.cm.options.theme].filter(Boolean),f=t.options.container||document.body;this.rootEls=new Set([f.getRootNode()]),this.completion=t,this.data=i,this.picked=!1,this.selectedHint=i.selectedHint||0,l.style.visibility="hidden",l.classList.add(...c),f.appendChild(l),this.items=i.list.map((d,g)=>{let y=l.appendChild(document.createElement("li"));return y.className=ZC,g===this.selectedHint&&y.classList.add(Gu),d.render?d.render(y,i,d):y.appendChild(document.createTextNode(d.displayText||Uh(d))),y}),o.addKeyMap(this.keyMap={Up:()=>this.changeActive(this.selectedHint-1),Down:()=>this.changeActive(this.selectedHint+1),Enter:()=>this.pick(),Tab:()=>this.pick(),Esc:()=>{o.state.completionEnabled=!1,t.close()}}),this.updatePosSize(),this.onScroll=()=>this.updatePosSize();for(let d of this.rootEls)d.addEventListener("scroll",this.onScroll,zt);Ht.default.on(l,"mousedown",d=>{let g=t1(l,d.target),y=this.items.indexOf(g);y!==-1&&(this.close(),this.selectedHint=y,this.pick(),setTimeout(()=>o.focus(),1))}),Ht.default.signal(i,"select",i.list[this.selectedHint],this.items[this.selectedHint])}close(){if(this.completion.widget===this){this.completion.widget=null,this.completion.cm.removeKeyMap(this.keyMap),this.hintsEl.remove();for(let t of this.rootEls)t.removeEventListener("scroll",this.onScroll,zt)}}disable(){this.completion.cm.removeKeyMap(this.keyMap),this.keyMap={Enter:()=>this.picked=!0},this.completion.cm.addKeyMap(this.keyMap)}pick(){this.completion.pick(this.data,this.selectedHint)}changeActive(t,i){t>=this.items.length?t=i?this.items.length-1:0:t<0&&(t=i?0:this.items.length-1);let o=this.items[this.selectedHint],l=this.items[this.selectedHint=t];l!==o&&(o&&o.classList.remove(Gu),l.classList.add(Gu),l.offsetTop<this.hintsEl.scrollTop?this.hintsEl.scrollTop=l.offsetTop-3:l.offsetTop+l.offsetHeight>this.hintsEl.scrollTop+this.hintsEl.clientHeight&&(this.hintsEl.scrollTop=l.offsetTop+l.offsetHeight-this.hintsEl.clientHeight+3),Ht.default.signal(this.data,"select",this.data.list[this.selectedHint],l))}getCursorCoords(){let{completion:t,hintsEl:i}=this,o=t.cm,l=Lo(i),c=o.cursorCoords(null,"local"),f=Ft(o.display.wrapper,l);return{top:f.top+c.top+5,left:f.left+c.left+9,bottom:f.top+c.bottom+5,right:f.left+c.right+9}}updatePosSize(){let{hintsEl:o}=this,l=this.getCursorCoords(),{clientWidth:c,clientHeight:f}=Mo(o);o.style.left="0px",o.style.top="0px";let{width:d,height:g}=o.getBoundingClientRect(),y=f-l.bottom,b=l.top;if(y<g&&b>y){let E=Math.min(g,b-6-1);o.style.top=`${l.top-1-E-6}px`,o.style.maxHeight=`${E}px`}else o.style.top=`${l.bottom+1}px`,o.style.maxHeight=`${y-1-6}px`;let k=c-l.right,C=l.left;k<d&&C>k?(o.style.left=`${l.left+1-Math.min(d,C-6)}px`,o.style.maxWidth=`${C-6}px`):(o.style.left=`${l.right}px`,o.style.maxWidth=`${k-6}px`),o.style.visibility="visible"}};Object.defineProperty(br.default.prototype,"display",{configurable:!0,set(n){let t=n.scroller.addEventListener;return n.scroller.addEventListener=function(i,o,l){t.call(this,i,o,typeof l!="boolean"?l:{capture:l,passive:["touchstart","touchmove","wheel","mousewheel"].includes(i)})},Object.defineProperty(this,"display",{configurable:!0,enumerable:!0,value:n}),n}});function n1(n,t,{entry:{type:i,text:o,value:l}}){let c=o[0],f=o[o.length-1],d=c==='"'||c==="'"?1:0,g=f==='"'||f==="'"?1:0,y=o.toLowerCase().substring(d,o.length-g),b=y?l.toLowerCase().indexOf(y,l[0]==='"'||l[0]==="'"?1:0):-1;b!==-1&&(l=Ge(l.substring(0,b))+'<span class="match">'+Ge(l.substr(b,y.length))+"</span>"+Ge(l.substr(b+y.length))),n.classList.add("type-"+i),n.appendChild(U("span","name",l))}var Qs=class extends dn{static CodeMirror=br.default;constructor({hint:t,mode:i}){super(),this.el=document.createElement("div"),this.el.className="discovery-view-editor";let o=this,l=(0,br.default)(this.el,{extraKeys:{"Alt-Space":"autocomplete"},mode:i||"javascript",theme:"neo",indentUnit:0,showHintOptions:{hint:t,get container(){return o.container}}});l.on("change",()=>this.emit("change",l.getValue())),typeof t=="function"&&(l.on("cursorActivity",f=>{f.state.completionEnabled&&f.state.focused&&f.showHint()}),l.on("focus",f=>{f.getValue()===""&&(f.state.completionEnabled=!0),f.state.completionEnabled&&!f.state.completionActive&&f.showHint()}),l.on("change",(f,d)=>{d.origin!=="complete"&&(l.state.completionEnabled=!0)})),this.cm=l;let c=new yr;c.subscribe(()=>l.refresh()),c.observe(l.display.wrapper)}getValue(){return this.cm.getValue()}setValue(t){requestAnimationFrame(()=>this.cm.refresh()),typeof t=="string"&&this.getValue()!==t&&this.cm.setValue(t||"")}focus(){this.cm.focus()}},Qu=class extends Qs{constructor(t){super({mode:"discovery-query",hint:i=>{let o=i.getCursor(),l=t(i.getValue(),i.doc.indexFromPos(o),this.queryData,this.queryContext);if(l)return{list:l.slice(0,50).map(c=>({entry:c,text:c.value,render:n1,from:i.posFromIndex(c.from),to:i.posFromIndex(c.to)}))}}}),this.inputPanelEl=U("div","discovery-view-editor__input-panel"),this.outputPanelEl=U("div","discovery-view-editor__output-panel"),this.el.append(this.inputPanelEl,this.outputPanelEl)}setValue(t,i,o){let l=typeof t=="string"&&this.getValue()!==t,c=this.queryData!==i||this.queryContext!==o;this.queryData=i,this.queryContext=o,super.setValue(t),c&&!l&&this.cm.state.completionEnabled&&this.cm.state.focused&&this.cm.showHint()}},Ju=class extends Qs{constructor(){super({mode:{name:"discovery-view",isDiscoveryViewDefined:t=>this.isViewDefined(t)}})}};br.default.defineMode("jora",Uu);br.default.defineMode("discovery-query",Uu);br.default.defineMode("discovery-view",qh);function $h(n){Object.assign(n.view,{QueryEditor:class extends Qu{get container(){return n.dom.container}},ViewEditor:class extends Ju{isViewDefined(t){return n.view.isDefined(t)}}})}var Gh={beforeDemo:['md:"A block has no its own look. It\'s using for wrapping some content with a `className` (btw `className` is a common property for any view when appropriate)"'],demo:{view:"block",className:"foo",content:['text:"Content inside block"']}};function Kh(n){n.view.define("block",function(t,i,o,l){let{content:c=[],onInit:f,onChange:d}=i,g=typeof f!="function"&&typeof d!="function"?c:this.composeConfig(c,{onInit:f,onChange:d});return n.view.render(t,g,o,l)},{usage:Gh})}var Js={demo:{view:"columns",data:["one","two","three","four"],column:"text"}};function Yh(n){n.view.define("column",function(t,i,o,l){let{content:c=[]}=i;return n.view.render(t,c,o,l)},{usage:Js})}function Qh(n){n.view.define("columns",function(i,o,l,c){let{column:f,columnConfig:d,emptyText:g,limit:y}=o;if(g!==!1&&g!==""&&i.setAttribute("emptyText",g||"Empty"),!Array.isArray(l)&&l&&(l=[l]),Array.isArray(l))return n.view.renderList(i,this.composeConfig({view:"column",content:f},d),l,c,0,n.view.listLimit(y,25))},{usage:Js})}var Jh={demo:{view:"expand",header:'text:"Expand me!"',content:'text:"Content"'}};function Zh(n){n.view.define("expand",function(t,i,o,l){function c(){if(t.classList.toggle("expanded",f),f)return C=U("div","content"),n.view.render(C,g,o,l).then(()=>t.appendChild(C));C!==null&&(C.remove(),C=null)}let{expanded:f,header:d,content:g,onToggle:y}=i,b=t.appendChild(U("div","header")),k=b.appendChild(U("div","header-content")),C=null;return f=n.queryBool(f,o,l),b.appendChild(U("div","trigger")),b.addEventListener("click",()=>{f=!f,c(),typeof y=="function"&&y(f)}),Promise.all([n.view.render(k,d||'text:"\xA0"',o,l),c()])},{usage:Jh})}var Xh={demo:{view:"hstack",content:['button:{text:"First button"}','button-primary:{text:"Second button"}']}};function eg(n){n.view.define("hstack",function(t,i,o,l){let{content:c=[]}=i;return n.view.render(t,c,o,l)},{usage:Xh})}function tg(n){n.view.define("list-item",function(t,i,o,l){let{content:c="text"}=i;return n.view.render(t,c,o,l)},{tag:"li"})}var li=(n,t)=>({demo:{view:n,data:["one","two","three","four"]},examples:[{title:"Variations",demo:{view:"context",data:["foo","bar","baz"],content:t.map(i=>[`header{ content: 'md:${JSON.stringify('`view: \\"'+i+'\\"`')}' }`,i])}},{title:"Configure item's content",demo:[{view:n,data:["one","two","three","four"],item:['text:"<item> "',{view:"link",data:'{ href: "#" + $ }'}]}]},{title:"Configure item's config",demo:{view:n,data:["one","two","three","four"],itemConfig:{className:"special"},item:{view:"text",data:'"prefix-" + $'}}}]});function ng(n){function t(i,o,l,c){let{item:f,itemConfig:d,limit:g,emptyText:y}=o;if(y!==!1&&y!==""&&i.setAttribute("emptyText",y||"Empty list"),!Array.isArray(l)&&l&&(l=[l]),Array.isArray(l))return n.view.renderList(i,this.composeConfig({view:"list-item",content:f},d),l,c,0,n.view.listLimit(g,25))}n.view.define("list",t,{usage:li}),n.view.define("inline-list",t,{usage:li}),n.view.define("comma-list",t,{usage:li}),n.view.define("ol",t,{tag:"ol",usage:li}),n.view.define("ul",t,{tag:"ul",usage:li})}var rg=n=>({beforeDemo:['md:"A special view to be used as the first view in the body of the page. This view stays in place as the page scrolls (although it may move slightly to the top of the page at the start of the scroll), so that the most relevant information and important action elements can remain accessible despite page scrolling."'],demoFixed:100,demo:`${n}:"That's a \\"${n}\\""`,examples:[{title:"Prelude",demoFixed:150,highlightProps:["prelude"],demo:{view:n,prelude:['badge:{ text: "demo" }','badge:{ text: "demo", prefix: "prelude", postfix: "postfix" }'],content:'h1:"Header"'}}]});function ig(n){n.view.define("page-header",function(i,o,l,c){let{prelude:f,content:d,onInit:g,onChange:y}=o,b=i.appendChild(U("div","view-page-header__prelude")),k=i.appendChild(U("div","view-page-header__content")),C=E=>typeof g!="function"&&typeof y!="function"?E:this.composeConfig(E,{onInit:g,onChange:y});return Promise.all([n.view.render(b,C(f||[]),l,c),n.view.render(k,C(d||"text"),l,c)])},{usage:rg})}var r1=[!1,"popup-hover","trigger-click"],i1=300;function og(n){return n?n.getRootNode({composed:!0})===document:!0}function sg(n,t){return typeof n=="function"&&(n=n(t)),typeof n=="number"?Zu(n):typeof n=="boolean"&&n?i1:0}function ag(n,t){n.lastChild!==t&&n.appendChild(t)}function Zu(n,t=0){return Number.isFinite(n)?n:t}function o1(n){return r1.includes(n)}function lg(n){let t=[],i=new Set,o=[],l=new Set,c=null,f=S=>{c===null&&(c=setTimeout(()=>b(S),0))},d=()=>{c!==null&&(clearTimeout(c),c=null)},g=null,y=()=>{g===null&&(g=[n.addHostElEventListener("mouseenter",({target:S})=>{for(let T of o){let N=E(T,S),A=N?N.el:S.closest(T.hoverTriggers);A&&(T.hideTimer!==null&&(clearTimeout(T.hideTimer),T.hideTimer=null),A!==T.lastHoverTriggerEl&&((!N||!N.hoverPinned)&&(T.lastHoverTriggerEl=A),N||(T.hoverPinned=!1,T.el.classList.remove("pinned"),T.show(A))))}},zt),n.addHostElEventListener("mouseleave",({target:S})=>{for(let T of o)T.lastHoverTriggerEl===S&&(M(T),T.lastHoverTriggerEl=null,T.hideTimer=setTimeout(T.hide,100))},zt),n.addGlobalEventListener("scroll",f,zt),n.addHostElEventListener("scroll",S=>{d(),b(S)},zt),n.addGlobalEventListener("click",f,!0),n.addHostElEventListener("click",S=>{d(),b(S),setTimeout(k,50);for(let T of o)T.hoverPin==="trigger-click"&&T.lastHoverTriggerEl&&T.lastTriggerEl?.contains(S.target)&&(T.lastHoverTriggerEl=null,T.hoverPinned=!0,T.el.classList.add("pinned"),S.stopPropagation())},!0)])};Qn.subscribe(()=>{for(let S of t)S.position==="pointer"&&!S.hoverPinned&&!S.frozen&&!l.has(S)&&S.updatePosition();for(let S of i){let{showDelayArgs:T}=S;O(S,T?.[0],T?.[1])}}),n.inspectMode.subscribe(S=>S?t.forEach(T=>l.add(T)):l.clear());function b(S){t.slice().forEach(T=>T.hideIfEventOutside(S))}function k(){t.slice().forEach(S=>S.hideOnTriggerHasLeftDocument())}function C(){t.slice().forEach(S=>S.hideOnResize())}function E(S,T){return S.el.contains(T)?S:S.relatedPopups.find(N=>E(N,T))||null}function M(S){S.showDelayTimer!==null&&clearTimeout(S.showDelayTimer),S.showDelayTimer=null,S.showDelayArgs=null,i.delete(S)}function O(S,T,N){S.showDelayTimer!==null&&clearTimeout(S.showDelayTimer),S.showDelayTimer=setTimeout(()=>S.show(T,N,!0),sg(S.showDelay,T)),S.showDelayArgs=[T,N],i.add(S)}class L{el;showDelayTimer;showDelayArgs;showDelay;lastTriggerEl;lastHoverTriggerEl;render;position;positionMode;pointerOffsetX;pointerOffsetY;hoverTriggers;hoverPin;hideIfEventOutsideDisabled;hideOnResizeDisabled;hideTimer;hoverPinned;frozen;lastRenderMarker;constructor(T){let{render:N,showDelay:A=!1,position:j="trigger",positionMode:I="safe",pointerOffsetX:z,pointerOffsetY:W,hoverTriggers:H,hoverPin:te,hideIfEventOutside:_=!0,hideOnResize:$=!0,className:D}=T||{};this.el=document.createElement("div"),this.el.classList.add("discovery-view-popup"),this.showDelayTimer=null,this.showDelayArgs=null,this.showDelay=A,this.hideTimer=null,this.hide=this.hide.bind(this),this.lastTriggerEl=null,this.lastHoverTriggerEl=null,this.hoverPinned=!1,this.frozen=!1,this.render=N,this.lastRenderMarker=null,this.position=j,this.positionMode=I,this.pointerOffsetX=Zu(z,3),this.pointerOffsetY=Zu(W,3),this.hoverTriggers=H||null,this.hoverPin=o1(te)?te:!1,this.hideIfEventOutsideDisabled=!_,this.hideOnResizeDisabled=!$,D&&this.el.classList.add(D),this.hoverTriggers&&(this.el.classList.add("show-on-hover"),this.el.dataset.pinMode=this.hoverPin||"none",o.push(this),y())}get relatedPopups(){return t.filter(T=>this.el.contains(T.lastTriggerEl))}get visible(){return t.includes(this)}toggle(...T){this.visible?this.hide():this.show(...T)}async show(T,N=this.render,A=!1){if(!this.visible&&!A&&sg(this.showDelay,T)>0){O(this,T,N);return}M(this),l.delete(this),n.view.setViewRoot(this.el,"popup",{config:N});let j=n.dom.container;if(this.hideTimer!==null&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.relatedPopups.forEach(I=>I.hide()),this.el.classList.toggle("inspect",n.inspectMode.value),this.lastTriggerEl&&this.lastTriggerEl.classList.remove("discovery-view-popup-active"),T&&T.classList.add("discovery-view-popup-active"),this.lastTriggerEl=T||null,this.visible||(t.push(this),t.length===1&&window.addEventListener("resize",C)),typeof N=="function"){this.el.innerHTML="";let I=Symbol();if(this.lastRenderMarker=I,requestAnimationFrame(()=>{this.lastRenderMarker===I&&(ag(j,this.el),this.updatePosition())}),await N(this.el,T,this.hide),this.lastRenderMarker!==I)return;this.lastRenderMarker=null}ag(j,this.el),this.updatePosition()}updatePosition(){if(!this.visible)return;let T=this.position==="pointer",N=T?null:this.lastTriggerEl;if(T?this.frozen:!N)return;let A=n.dom.container,j=Lo(A.firstChild),I=Ru(window,j),{x:z,y:W}=Qn.value,{pointerOffsetX:H,pointerOffsetY:te}=this,_=N?Ft(N,A):{left:Math.round(z)-H,right:Math.round(z)+H,top:Math.round(W)-te,bottom:Math.round(W)+te},$=T?_.left:_.right,D=T?_.right:_.left,Q=_.top-I.top-3,X=I.bottom-_.bottom-3,de=$-I.left-3,De=I.right-D-3,Be=De>=de,Ke=X>=Q;if(Ke||(this.el.style.maxHeight=Q+"px",this.el.style.top="auto",this.el.style.bottom=I.bottom-_.top+"px",this.el.dataset.vTo="top"),Be||(this.el.style.left="auto",this.el.style.right=I.right-$+"px",this.el.style.maxWidth=de+"px",this.el.dataset.hTo="left"),this.positionMode==="natural"&&(!Be||!Ke)){let{height:Ot,width:Ue}=Ft(this.el);Ke=Ot<=X,Be=Ue<=De}Ke&&(this.el.style.maxHeight=X+"px",this.el.style.top=_.bottom-I.top+"px",this.el.style.bottom="auto",this.el.dataset.vTo="bottom"),Be&&(this.el.style.left=D-I.left+"px",this.el.style.right="auto",this.el.style.maxWidth=De+"px",this.el.dataset.hTo="right"),this.relatedPopups.forEach(Ot=>Ot.updatePosition())}freeze(){this.frozen=!0,this.el.classList.add("frozen")}unfreeze(){this.frozen=!1,this.el.classList.remove("frozen"),this.updatePosition()}hide(){this.lastRenderMarker=null,this.hideTimer!==null&&(clearTimeout(this.hideTimer),this.hideTimer=null),M(this),this.visible&&!l.has(this)&&(this.relatedPopups.forEach(T=>T.hide()),t.splice(t.indexOf(this),1),this.el.remove(),this.unfreeze(),this.lastTriggerEl&&(this.lastTriggerEl.classList.remove("discovery-view-popup-active"),this.lastTriggerEl=null),t.length===0&&window.removeEventListener("resize",C))}hideIfEventOutside({target:T}){this.hideIfEventOutsideDisabled||l.has(this)||this.lastTriggerEl&&this.lastTriggerEl.contains(T)||E(this,T)||this.hide()}hideOnTriggerHasLeftDocument(){(!og(this.lastHoverTriggerEl)||!og(this.lastTriggerEl))&&this.hide()}hideOnResize(){this.hideOnResizeDisabled||l.has(this)||this.hide()}destroy(){l.delete(this),M(this);let T=o.indexOf(this);T!==-1&&o.splice(T,1),this.hide(),this.el=null,this.lastTriggerEl=null,this.lastHoverTriggerEl=null}}n.view.Popup=L}var ug={demo:{view:"section",header:'text:"I am section"',content:['text:"content"']}};function cg(n){n.view.define("section",function(t,i,o,l){let{header:c,content:f}=i;return n.view.render(t,[{view:"header",content:c},f],o,l)},{usage:ug})}function fg(n){n.view.define("toc-section",function(t,i,o,l){let{header:c,content:f}=i;return n.view.render(t,[{view:"block",className:"header",content:c},{view:"block",className:"content",content:f}],o,l)},{tag:"section"})}var ui=(n,t)=>({demo:{view:n,data:'"Alert"'},examples:[{title:"Variations",demo:t.map(i=>`${i}:"${i}"`)},{title:"Complex content",demo:{view:n,content:['h3:"Some header"','text:"Hello world!"']}}]});function dg(n){function t(i,o,l,c){let{content:f="text"}=o;return i.classList.add("view-alert"),n.view.render(i,f,l,c)}n.view.define("alert",t,{usage:ui}),n.view.define("alert-primary",t,{usage:ui}),n.view.define("alert-success",t,{usage:ui}),n.view.define("alert-danger",t,{usage:ui}),n.view.define("alert-warning",t,{usage:ui})}function pg(n){n.view.define("auto-link",function(t,i,o,l){let{content:c,fallback:f,href:d}=i;if(!o)return;let g=n.resolveValueLinks(o),b=g?(typeof d=="function"?d:k=>k)(g[0].href,o,l):null;return b?n.view.render(t,{view:"link",content:c},{...g[0],href:b},l):n.view.render(t,f||c||"text",o,l)},{tag:!1})}var Xu=(n,t)=>({demo:{view:n,text:"hello world"},examples:[{title:"Variations",demo:t.map(i=>`${i}:"${i}"`)},{title:"Displaying content",beforeDemo:{view:"md",source:["There are several ways to specify the main content of a badge:","- `content` option \u2013 allows to specify any renderable content and has the highest precedence","- `text` option \u2013 used when `content` is omitted or falsy; it renders as plain text","- When both `content` and `text` options are omitted, the `data` is used for content:","  - If `data` is a string, a number, or a boolean value, it is used as the `text` value","  - If `data` is an object, the value of `text` property of `data` coerced to a string is used","  - Otherwise, render an undefined"].join(`
`)},demo:[{view:n,data:'"data"',text:"text",content:'text:"RENDER"'},{view:n,data:'"data"',text:"RENDER",content:"=undefined"},{view:n,data:'"data"',content:"=undefined"},{view:n,data:'"data"',text:"RENDER"},{view:n,data:'"data"',text:"=undefined"},{view:n,data:'"RENDER"'},{view:n,data:'{ text: "RENDER" }'},{view:n,data:"{}"},{view:n,data:[1,2,3]}]},{title:"Using data as source of options",beforeDemo:{view:"md",source:["The following properties are taken from the data when the appropriate options are not specified for a legacy reasons (is subject to remove in the future):","- `color`","- `textColor`","- `darkColor`","- `darkTextColor`","- `text`","- `href`","- `external`","- `prefix`","- `postfix`"].join(`
`)},highlightProps:["data"],demo:{view:n,data:{text:"demo",href:"#example"}}},{title:"Custom colors",beforeDemo:{view:"md",source:["Data properties to setup a custom colors:","* `color` \u2013 default background color","* `textColor` \u2013 default text color","* `darkColor` \u2013 background color in dark mode","* `darkTextColor` \u2013 text color in dark mode"].join(`
`)},demo:{view:n,text:"Colored badge",color:"rgba(237, 177, 9, 0.35)",textColor:"orange",darkColor:"#ffff00",darkTextColor:"black"}},{title:"As a link",highlightProps:["href","external"],demo:{view:n,text:"Link to something",href:"#",external:!0}},{title:"Using onClick handler",highlightProps:["onClick"],demo:{view:n,text:'Show "Hello world"',onClick:Function('return () => alert("Hello world!")')()}},{title:"Prefix and postfix",highlightProps:["prefix","postfix"],demo:{view:n,prefix:"prefix",text:"link",postfix:"postfix"}},{title:"Complex content",highlightProps:["content"],demo:{view:n,content:['text:"text "','link{ href: "#example" }']}}]});var hg=`is not array? | {
    color,
    textColor,
    darkColor,
    darkTextColor,
    text: #.props has no 'content' ? is (string or number or boolean) ?: text,
    content: undefined,
    href,
    external,
    onClick: undefined,
    prefix,
    postfix
} | overrideProps()`;function gg(n,t,i){if(!i)return;let o=n.appendChild(document.createElement("span"));o.className=t,o.textContent=i}function mg(n){function t(i,o,l,c){let{color:f,textColor:d,darkColor:g,darkTextColor:y,text:b,content:k,href:C,external:E,onClick:M,prefix:O,postfix:L}=o,S;return f&&i.style.setProperty("--discovery-view-badge-color",f),g&&i.style.setProperty("--discovery-view-badge-dark-color",g),d&&i.style.setProperty("--discovery-view-badge-text-color",d),y&&i.style.setProperty("--discovery-view-badge-dark-text-color",y),C&&(i.href=C),E&&i.setAttribute("target","_blank"),typeof M=="function"&&(i.classList.add("onclick"),i.addEventListener("click",T=>{T.preventDefault(),M(i,l,c)})),gg(i,"prefix",O),k?S=this.render(i,k,l,c):i.append(document.createTextNode(b)),gg(i,"postfix",L),S}n.view.define("badge",t,{tag:"a",props:hg,usage:Xu}),n.view.define("pill-badge",t,{tag:"a",props:hg,usage:Xu})}function Cg(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var kr=Cg();function s1(n){kr=n}var Sg=/[&<>"']/,a1=new RegExp(Sg.source,"g"),Tg=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,l1=new RegExp(Tg.source,"g"),u1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yg=n=>u1[n];function xt(n,t){if(t){if(Sg.test(n))return n.replace(a1,yg)}else if(Tg.test(n))return n.replace(l1,yg);return n}var c1=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Ag(n){return n.replace(c1,(t,i)=>(i=i.toLowerCase(),i==="colon"?":":i.charAt(0)==="#"?i.charAt(1)==="x"?String.fromCharCode(parseInt(i.substring(2),16)):String.fromCharCode(+i.substring(1)):""))}var f1=/(^|[^\[])\^/g;function qe(n,t){n=typeof n=="string"?n:n.source,t=t||"";let i={replace:(o,l)=>(l=l.source||l,l=l.replace(f1,"$1"),n=n.replace(o,l),i),getRegex:()=>new RegExp(n,t)};return i}var d1=/[^\w:]/g,p1=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function vg(n,t,i){if(n){let o;try{o=decodeURIComponent(Ag(i)).replace(d1,"").toLowerCase()}catch{return null}if(o.indexOf("javascript:")===0||o.indexOf("vbscript:")===0||o.indexOf("data:")===0)return null}t&&!p1.test(i)&&(i=y1(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}var Zs={},h1=/^[^:]+:\/*[^/]*$/,g1=/^([^:]+:)[\s\S]*$/,m1=/^([^:]+:\/*[^/]*)[\s\S]*$/;function y1(n,t){Zs[" "+n]||(h1.test(n)?Zs[" "+n]=n+"/":Zs[" "+n]=Xs(n,"/",!0)),n=Zs[" "+n];let i=n.indexOf(":")===-1;return t.substring(0,2)==="//"?i?t:n.replace(g1,"$1")+t:t.charAt(0)==="/"?i?t:n.replace(m1,"$1")+t:n+t}var ea={exec:function(){}};function bg(n,t){let i=n.replace(/\|/g,(c,f,d)=>{let g=!1,y=f;for(;--y>=0&&d[y]==="\\";)g=!g;return g?"|":" |"}),o=i.split(/ \|/),l=0;if(o[0].trim()||o.shift(),o.length>0&&!o[o.length-1].trim()&&o.pop(),o.length>t)o.splice(t);else for(;o.length<t;)o.push("");for(;l<o.length;l++)o[l]=o[l].trim().replace(/\\\|/g,"|");return o}function Xs(n,t,i){let o=n.length;if(o===0)return"";let l=0;for(;l<o;){let c=n.charAt(o-l-1);if(c===t&&!i)l++;else if(c!==t&&i)l++;else break}return n.slice(0,o-l)}function v1(n,t){if(n.indexOf(t[1])===-1)return-1;let i=n.length,o=0,l=0;for(;l<i;l++)if(n[l]==="\\")l++;else if(n[l]===t[0])o++;else if(n[l]===t[1]&&(o--,o<0))return l;return-1}function b1(n){n&&n.sanitize&&!n.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function wg(n,t){if(t<1)return"";let i="";for(;t>1;)t&1&&(i+=n),t>>=1,n+=n;return i+n}function xg(n,t,i,o){let l=t.href,c=t.title?xt(t.title):null,f=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){o.state.inLink=!0;let d={type:"link",raw:i,href:l,title:c,text:f,tokens:o.inlineTokens(f)};return o.state.inLink=!1,d}return{type:"image",raw:i,href:l,title:c,text:xt(f)}}function w1(n,t){let i=n.match(/^(\s+)(?:```)/);if(i===null)return t;let o=i[1];return t.split(`
`).map(l=>{let c=l.match(/^\s+/);if(c===null)return l;let[f]=c;return f.length>=o.length?l.slice(o.length):l}).join(`
`)}var Po=class{constructor(t){this.options=t||kr}space(t){let i=this.rules.block.newline.exec(t);if(i&&i[0].length>0)return{type:"space",raw:i[0]}}code(t){let i=this.rules.block.code.exec(t);if(i){let o=i[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:this.options.pedantic?o:Xs(o,`
`)}}}fences(t){let i=this.rules.block.fences.exec(t);if(i){let o=i[0],l=w1(o,i[3]||"");return{type:"code",raw:o,lang:i[2]?i[2].trim().replace(this.rules.inline._escapes,"$1"):i[2],text:l}}}heading(t){let i=this.rules.block.heading.exec(t);if(i){let o=i[2].trim();if(/#$/.test(o)){let l=Xs(o,"#");(this.options.pedantic||!l||/ $/.test(l))&&(o=l.trim())}return{type:"heading",raw:i[0],depth:i[1].length,text:o,tokens:this.lexer.inline(o)}}}hr(t){let i=this.rules.block.hr.exec(t);if(i)return{type:"hr",raw:i[0]}}blockquote(t){let i=this.rules.block.blockquote.exec(t);if(i){let o=i[0].replace(/^ *>[ \t]?/gm,""),l=this.lexer.state.top;this.lexer.state.top=!0;let c=this.lexer.blockTokens(o);return this.lexer.state.top=l,{type:"blockquote",raw:i[0],tokens:c,text:o}}}list(t){let i=this.rules.block.list.exec(t);if(i){let o,l,c,f,d,g,y,b,k,C,E,M,O=i[1].trim(),L=O.length>1,S={type:"list",raw:"",ordered:L,start:L?+O.slice(0,-1):"",loose:!1,items:[]};O=L?`\\d{1,9}\\${O.slice(-1)}`:`\\${O}`,this.options.pedantic&&(O=L?O:"[*+-]");let T=new RegExp(`^( {0,3}${O})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;t&&(M=!1,!(!(i=T.exec(t))||this.rules.block.hr.test(t)));){if(o=i[0],t=t.substring(o.length),b=i[2].split(`
`,1)[0].replace(/^\t+/,A=>" ".repeat(3*A.length)),k=t.split(`
`,1)[0],this.options.pedantic?(f=2,E=b.trimLeft()):(f=i[2].search(/[^ ]/),f=f>4?1:f,E=b.slice(f),f+=i[1].length),g=!1,!b&&/^ *$/.test(k)&&(o+=k+`
`,t=t.substring(k.length+1),M=!0),!M){let A=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),j=new RegExp(`^ {0,${Math.min(3,f-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),I=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:\`\`\`|~~~)`),z=new RegExp(`^ {0,${Math.min(3,f-1)}}#`);for(;t&&(C=t.split(`
`,1)[0],k=C,this.options.pedantic&&(k=k.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(I.test(k)||z.test(k)||A.test(k)||j.test(t)));){if(k.search(/[^ ]/)>=f||!k.trim())E+=`
`+k.slice(f);else{if(g||b.search(/[^ ]/)>=4||I.test(b)||z.test(b)||j.test(b))break;E+=`
`+k}!g&&!k.trim()&&(g=!0),o+=C+`
`,t=t.substring(C.length+1),b=k.slice(f)}}S.loose||(y?S.loose=!0:/\n *\n *$/.test(o)&&(y=!0)),this.options.gfm&&(l=/^\[[ xX]\] /.exec(E),l&&(c=l[0]!=="[ ] ",E=E.replace(/^\[[ xX]\] +/,""))),S.items.push({type:"list_item",raw:o,task:!!l,checked:c,loose:!1,text:E}),S.raw+=o}S.items[S.items.length-1].raw=o.trimRight(),S.items[S.items.length-1].text=E.trimRight(),S.raw=S.raw.trimRight();let N=S.items.length;for(d=0;d<N;d++)if(this.lexer.state.top=!1,S.items[d].tokens=this.lexer.blockTokens(S.items[d].text,[]),!S.loose){let A=S.items[d].tokens.filter(I=>I.type==="space"),j=A.length>0&&A.some(I=>/\n.*\n/.test(I.raw));S.loose=j}if(S.loose)for(d=0;d<N;d++)S.items[d].loose=!0;return S}}html(t){let i=this.rules.block.html.exec(t);if(i){let o={type:"html",raw:i[0],pre:!this.options.sanitizer&&(i[1]==="pre"||i[1]==="script"||i[1]==="style"),text:i[0]};if(this.options.sanitize){let l=this.options.sanitizer?this.options.sanitizer(i[0]):xt(i[0]);o.type="paragraph",o.text=l,o.tokens=this.lexer.inline(l)}return o}}def(t){let i=this.rules.block.def.exec(t);if(i){let o=i[1].toLowerCase().replace(/\s+/g," "),l=i[2]?i[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",c=i[3]?i[3].substring(1,i[3].length-1).replace(this.rules.inline._escapes,"$1"):i[3];return{type:"def",tag:o,raw:i[0],href:l,title:c}}}table(t){let i=this.rules.block.table.exec(t);if(i){let o={type:"table",header:bg(i[1]).map(l=>({text:l})),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:i[3]&&i[3].trim()?i[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(o.header.length===o.align.length){o.raw=i[0];let l=o.align.length,c,f,d,g;for(c=0;c<l;c++)/^ *-+: *$/.test(o.align[c])?o.align[c]="right":/^ *:-+: *$/.test(o.align[c])?o.align[c]="center":/^ *:-+ *$/.test(o.align[c])?o.align[c]="left":o.align[c]=null;for(l=o.rows.length,c=0;c<l;c++)o.rows[c]=bg(o.rows[c],o.header.length).map(y=>({text:y}));for(l=o.header.length,f=0;f<l;f++)o.header[f].tokens=this.lexer.inline(o.header[f].text);for(l=o.rows.length,f=0;f<l;f++)for(g=o.rows[f],d=0;d<g.length;d++)g[d].tokens=this.lexer.inline(g[d].text);return o}}}lheading(t){let i=this.rules.block.lheading.exec(t);if(i)return{type:"heading",raw:i[0],depth:i[2].charAt(0)==="="?1:2,text:i[1],tokens:this.lexer.inline(i[1])}}paragraph(t){let i=this.rules.block.paragraph.exec(t);if(i){let o=i[1].charAt(i[1].length-1)===`
`?i[1].slice(0,-1):i[1];return{type:"paragraph",raw:i[0],text:o,tokens:this.lexer.inline(o)}}}text(t){let i=this.rules.block.text.exec(t);if(i)return{type:"text",raw:i[0],text:i[0],tokens:this.lexer.inline(i[0])}}escape(t){let i=this.rules.inline.escape.exec(t);if(i)return{type:"escape",raw:i[0],text:xt(i[1])}}tag(t){let i=this.rules.inline.tag.exec(t);if(i)return!this.lexer.state.inLink&&/^<a /i.test(i[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(i[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:i[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):xt(i[0]):i[0]}}link(t){let i=this.rules.inline.link.exec(t);if(i){let o=i[2].trim();if(!this.options.pedantic&&/^</.test(o)){if(!/>$/.test(o))return;let f=Xs(o.slice(0,-1),"\\");if((o.length-f.length)%2===0)return}else{let f=v1(i[2],"()");if(f>-1){let g=(i[0].indexOf("!")===0?5:4)+i[1].length+f;i[2]=i[2].substring(0,f),i[0]=i[0].substring(0,g).trim(),i[3]=""}}let l=i[2],c="";if(this.options.pedantic){let f=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(l);f&&(l=f[1],c=f[3])}else c=i[3]?i[3].slice(1,-1):"";return l=l.trim(),/^</.test(l)&&(this.options.pedantic&&!/>$/.test(o)?l=l.slice(1):l=l.slice(1,-1)),xg(i,{href:l&&l.replace(this.rules.inline._escapes,"$1"),title:c&&c.replace(this.rules.inline._escapes,"$1")},i[0],this.lexer)}}reflink(t,i){let o;if((o=this.rules.inline.reflink.exec(t))||(o=this.rules.inline.nolink.exec(t))){let l=(o[2]||o[1]).replace(/\s+/g," ");if(l=i[l.toLowerCase()],!l){let c=o[0].charAt(0);return{type:"text",raw:c,text:c}}return xg(o,l,o[0],this.lexer)}}emStrong(t,i,o=""){let l=this.rules.inline.emStrong.lDelim.exec(t);if(!l||l[3]&&o.match(/[\p{L}\p{N}]/u))return;let c=l[1]||l[2]||"";if(!c||c&&(o===""||this.rules.inline.punctuation.exec(o))){let f=l[0].length-1,d,g,y=f,b=0,k=l[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(k.lastIndex=0,i=i.slice(-1*t.length+f);(l=k.exec(i))!=null;){if(d=l[1]||l[2]||l[3]||l[4]||l[5]||l[6],!d)continue;if(g=d.length,l[3]||l[4]){y+=g;continue}else if((l[5]||l[6])&&f%3&&!((f+g)%3)){b+=g;continue}if(y-=g,y>0)continue;g=Math.min(g,g+y+b);let C=t.slice(0,f+l.index+(l[0].length-d.length)+g);if(Math.min(f,g)%2){let M=C.slice(1,-1);return{type:"em",raw:C,text:M,tokens:this.lexer.inlineTokens(M)}}let E=C.slice(2,-2);return{type:"strong",raw:C,text:E,tokens:this.lexer.inlineTokens(E)}}}}codespan(t){let i=this.rules.inline.code.exec(t);if(i){let o=i[2].replace(/\n/g," "),l=/[^ ]/.test(o),c=/^ /.test(o)&&/ $/.test(o);return l&&c&&(o=o.substring(1,o.length-1)),o=xt(o,!0),{type:"codespan",raw:i[0],text:o}}}br(t){let i=this.rules.inline.br.exec(t);if(i)return{type:"br",raw:i[0]}}del(t){let i=this.rules.inline.del.exec(t);if(i)return{type:"del",raw:i[0],text:i[2],tokens:this.lexer.inlineTokens(i[2])}}autolink(t,i){let o=this.rules.inline.autolink.exec(t);if(o){let l,c;return o[2]==="@"?(l=xt(this.options.mangle?i(o[1]):o[1]),c="mailto:"+l):(l=xt(o[1]),c=l),{type:"link",raw:o[0],text:l,href:c,tokens:[{type:"text",raw:l,text:l}]}}}url(t,i){let o;if(o=this.rules.inline.url.exec(t)){let l,c;if(o[2]==="@")l=xt(this.options.mangle?i(o[0]):o[0]),c="mailto:"+l;else{let f;do f=o[0],o[0]=this.rules.inline._backpedal.exec(o[0])[0];while(f!==o[0]);l=xt(o[0]),o[1]==="www."?c="http://"+o[0]:c=o[0]}return{type:"link",raw:o[0],text:l,href:c,tokens:[{type:"text",raw:l,text:l}]}}}inlineText(t,i){let o=this.rules.inline.text.exec(t);if(o){let l;return this.lexer.state.inRawBlock?l=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):xt(o[0]):o[0]:l=xt(this.options.smartypants?i(o[0]):o[0]),{type:"text",raw:o[0],text:l}}}},Ce={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:ea,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ce._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Ce._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Ce.def=qe(Ce.def).replace("label",Ce._label).replace("title",Ce._title).getRegex();Ce.bullet=/(?:[*+-]|\d{1,9}[.)])/;Ce.listItemStart=qe(/^( *)(bull) */).replace("bull",Ce.bullet).getRegex();Ce.list=qe(Ce.list).replace(/bull/g,Ce.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ce.def.source+")").getRegex();Ce._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Ce._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Ce.html=qe(Ce.html,"i").replace("comment",Ce._comment).replace("tag",Ce._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Ce.paragraph=qe(Ce._paragraph).replace("hr",Ce.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ce._tag).getRegex();Ce.blockquote=qe(Ce.blockquote).replace("paragraph",Ce.paragraph).getRegex();Ce.normal={...Ce};Ce.gfm={...Ce.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};Ce.gfm.table=qe(Ce.gfm.table).replace("hr",Ce.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ce._tag).getRegex();Ce.gfm.paragraph=qe(Ce._paragraph).replace("hr",Ce.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ce.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ce._tag).getRegex();Ce.pedantic={...Ce.normal,html:qe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ce._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ea,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:qe(Ce.normal._paragraph).replace("hr",Ce.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ce.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};var ge={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:ea,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:ea,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};ge._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";ge.punctuation=qe(ge.punctuation).replace(/punctuation/g,ge._punctuation).getRegex();ge.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;ge.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;ge._comment=qe(Ce._comment).replace("(?:-->|$)","-->").getRegex();ge.emStrong.lDelim=qe(ge.emStrong.lDelim).replace(/punct/g,ge._punctuation).getRegex();ge.emStrong.rDelimAst=qe(ge.emStrong.rDelimAst,"g").replace(/punct/g,ge._punctuation).getRegex();ge.emStrong.rDelimUnd=qe(ge.emStrong.rDelimUnd,"g").replace(/punct/g,ge._punctuation).getRegex();ge._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;ge._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;ge._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;ge.autolink=qe(ge.autolink).replace("scheme",ge._scheme).replace("email",ge._email).getRegex();ge._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;ge.tag=qe(ge.tag).replace("comment",ge._comment).replace("attribute",ge._attribute).getRegex();ge._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;ge._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;ge._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;ge.link=qe(ge.link).replace("label",ge._label).replace("href",ge._href).replace("title",ge._title).getRegex();ge.reflink=qe(ge.reflink).replace("label",ge._label).replace("ref",Ce._label).getRegex();ge.nolink=qe(ge.nolink).replace("ref",Ce._label).getRegex();ge.reflinkSearch=qe(ge.reflinkSearch,"g").replace("reflink",ge.reflink).replace("nolink",ge.nolink).getRegex();ge.normal={...ge};ge.pedantic={...ge.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:qe(/^!?\[(label)\]\((.*?)\)/).replace("label",ge._label).getRegex(),reflink:qe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ge._label).getRegex()};ge.gfm={...ge.normal,escape:qe(ge.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};ge.gfm.url=qe(ge.gfm.url,"i").replace("email",ge.gfm._extended_email).getRegex();ge.breaks={...ge.gfm,br:qe(ge.br).replace("{2,}","*").getRegex(),text:qe(ge.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function x1(n){return n.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function kg(n){let t="",i,o,l=n.length;for(i=0;i<l;i++)o=n.charCodeAt(i),Math.random()>.5&&(o="x"+o.toString(16)),t+="&#"+o+";";return t}var wr=class n{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||kr,this.options.tokenizer=this.options.tokenizer||new Po,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let i={block:Ce.normal,inline:ge.normal};this.options.pedantic?(i.block=Ce.pedantic,i.inline=ge.pedantic):this.options.gfm&&(i.block=Ce.gfm,this.options.breaks?i.inline=ge.breaks:i.inline=ge.gfm),this.tokenizer.rules=i}static get rules(){return{block:Ce,inline:ge}}static lex(t,i){return new n(i).lex(t)}static lexInline(t,i){return new n(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let i;for(;i=this.inlineQueue.shift();)this.inlineTokens(i.src,i.tokens);return this.tokens}blockTokens(t,i=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(d,g,y)=>g+"    ".repeat(y.length));let o,l,c,f;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(d=>(o=d.call({lexer:this},t,i))?(t=t.substring(o.raw.length),i.push(o),!0):!1))){if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length),o.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length),l=i[i.length-1],l&&(l.type==="paragraph"||l.type==="text")?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue[this.inlineQueue.length-1].src=l.text):i.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length),l=i[i.length-1],l&&(l.type==="paragraph"||l.type==="text")?(l.raw+=`
`+o.raw,l.text+=`
`+o.raw,this.inlineQueue[this.inlineQueue.length-1].src=l.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),i.push(o);continue}if(c=t,this.options.extensions&&this.options.extensions.startBlock){let d=1/0,g=t.slice(1),y;this.options.extensions.startBlock.forEach(function(b){y=b.call({lexer:this},g),typeof y=="number"&&y>=0&&(d=Math.min(d,y))}),d<1/0&&d>=0&&(c=t.substring(0,d+1))}if(this.state.top&&(o=this.tokenizer.paragraph(c))){l=i[i.length-1],f&&l.type==="paragraph"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=l.text):i.push(o),f=c.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length),l=i[i.length-1],l&&l.type==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=l.text):i.push(o);continue}if(t){let d="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,i}inline(t,i=[]){return this.inlineQueue.push({src:t,tokens:i}),i}inlineTokens(t,i=[]){let o,l,c,f=t,d,g,y;if(this.tokens.links){let b=Object.keys(this.tokens.links);if(b.length>0)for(;(d=this.tokenizer.rules.inline.reflinkSearch.exec(f))!=null;)b.includes(d[0].slice(d[0].lastIndexOf("[")+1,-1))&&(f=f.slice(0,d.index)+"["+wg("a",d[0].length-2)+"]"+f.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(d=this.tokenizer.rules.inline.blockSkip.exec(f))!=null;)f=f.slice(0,d.index)+"["+wg("a",d[0].length-2)+"]"+f.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(d=this.tokenizer.rules.inline.escapedEmSt.exec(f))!=null;)f=f.slice(0,d.index+d[0].length-2)+"++"+f.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;t;)if(g||(y=""),g=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(b=>(o=b.call({lexer:this},t,i))?(t=t.substring(o.raw.length),i.push(o),!0):!1))){if(o=this.tokenizer.escape(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.tag(t)){t=t.substring(o.raw.length),l=i[i.length-1],l&&o.type==="text"&&l.type==="text"?(l.raw+=o.raw,l.text+=o.text):i.push(o);continue}if(o=this.tokenizer.link(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(o.raw.length),l=i[i.length-1],l&&o.type==="text"&&l.type==="text"?(l.raw+=o.raw,l.text+=o.text):i.push(o);continue}if(o=this.tokenizer.emStrong(t,f,y)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.codespan(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.br(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.del(t)){t=t.substring(o.raw.length),i.push(o);continue}if(o=this.tokenizer.autolink(t,kg)){t=t.substring(o.raw.length),i.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(t,kg))){t=t.substring(o.raw.length),i.push(o);continue}if(c=t,this.options.extensions&&this.options.extensions.startInline){let b=1/0,k=t.slice(1),C;this.options.extensions.startInline.forEach(function(E){C=E.call({lexer:this},k),typeof C=="number"&&C>=0&&(b=Math.min(b,C))}),b<1/0&&b>=0&&(c=t.substring(0,b+1))}if(o=this.tokenizer.inlineText(c,x1)){t=t.substring(o.raw.length),o.raw.slice(-1)!=="_"&&(y=o.raw.slice(-1)),g=!0,l=i[i.length-1],l&&l.type==="text"?(l.raw+=o.raw,l.text+=o.text):i.push(o);continue}if(t){let b="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(b);break}else throw new Error(b)}}return i}},No=class{constructor(t){this.options=t||kr}code(t,i,o){let l=(i||"").match(/\S*/)[0];if(this.options.highlight){let c=this.options.highlight(t,l);c!=null&&c!==t&&(o=!0,t=c)}return t=t.replace(/\n$/,"")+`
`,l?'<pre><code class="'+this.options.langPrefix+xt(l)+'">'+(o?t:xt(t,!0))+`</code></pre>
`:"<pre><code>"+(o?t:xt(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t){return t}heading(t,i,o,l){if(this.options.headerIds){let c=this.options.headerPrefix+l.slug(o);return`<h${i} id="${c}">${t}</h${i}>
`}return`<h${i}>${t}</h${i}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,i,o){let l=i?"ol":"ul",c=i&&o!==1?' start="'+o+'"':"";return"<"+l+c+`>
`+t+"</"+l+`>
`}listitem(t){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>
`}table(t,i){return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,i){let o=i.header?"th":"td";return(i.align?`<${o} align="${i.align}">`:`<${o}>`)+t+`</${o}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,i,o){if(t=vg(this.options.sanitize,this.options.baseUrl,t),t===null)return o;let l='<a href="'+t+'"';return i&&(l+=' title="'+i+'"'),l+=">"+o+"</a>",l}image(t,i,o){if(t=vg(this.options.sanitize,this.options.baseUrl,t),t===null)return o;let l=`<img src="${t}" alt="${o}"`;return i&&(l+=` title="${i}"`),l+=this.options.xhtml?"/>":">",l}text(t){return t}},ta=class{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,i,o){return""+o}image(t,i,o){return""+o}br(){return""}},ci=class{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,i){let o=t,l=0;if(this.seen.hasOwnProperty(o)){l=this.seen[t];do l++,o=t+"-"+l;while(this.seen.hasOwnProperty(o))}return i||(this.seen[t]=l,this.seen[o]=0),o}slug(t,i={}){let o=this.serialize(t);return this.getNextSafeSlug(o,i.dryrun)}},xr=class n{constructor(t){this.options=t||kr,this.options.renderer=this.options.renderer||new No,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ta,this.slugger=new ci}static parse(t,i){return new n(i).parse(t)}static parseInline(t,i){return new n(i).parseInline(t)}parse(t,i=!0){let o="",l,c,f,d,g,y,b,k,C,E,M,O,L,S,T,N,A,j,I,z=t.length;for(l=0;l<z;l++){if(E=t[l],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[E.type]&&(I=this.options.extensions.renderers[E.type].call({parser:this},E),I!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(E.type))){o+=I||"";continue}switch(E.type){case"space":continue;case"hr":{o+=this.renderer.hr();continue}case"heading":{o+=this.renderer.heading(this.parseInline(E.tokens),E.depth,Ag(this.parseInline(E.tokens,this.textRenderer)),this.slugger);continue}case"code":{o+=this.renderer.code(E.text,E.lang,E.escaped);continue}case"table":{for(k="",b="",d=E.header.length,c=0;c<d;c++)b+=this.renderer.tablecell(this.parseInline(E.header[c].tokens),{header:!0,align:E.align[c]});for(k+=this.renderer.tablerow(b),C="",d=E.rows.length,c=0;c<d;c++){for(y=E.rows[c],b="",g=y.length,f=0;f<g;f++)b+=this.renderer.tablecell(this.parseInline(y[f].tokens),{header:!1,align:E.align[f]});C+=this.renderer.tablerow(b)}o+=this.renderer.table(k,C);continue}case"blockquote":{C=this.parse(E.tokens),o+=this.renderer.blockquote(C);continue}case"list":{for(M=E.ordered,O=E.start,L=E.loose,d=E.items.length,C="",c=0;c<d;c++)T=E.items[c],N=T.checked,A=T.task,S="",T.task&&(j=this.renderer.checkbox(N),L?T.tokens.length>0&&T.tokens[0].type==="paragraph"?(T.tokens[0].text=j+" "+T.tokens[0].text,T.tokens[0].tokens&&T.tokens[0].tokens.length>0&&T.tokens[0].tokens[0].type==="text"&&(T.tokens[0].tokens[0].text=j+" "+T.tokens[0].tokens[0].text)):T.tokens.unshift({type:"text",text:j}):S+=j),S+=this.parse(T.tokens,L),C+=this.renderer.listitem(S,A,N);o+=this.renderer.list(C,M,O);continue}case"html":{o+=this.renderer.html(E.text);continue}case"paragraph":{o+=this.renderer.paragraph(this.parseInline(E.tokens));continue}case"text":{for(C=E.tokens?this.parseInline(E.tokens):E.text;l+1<z&&t[l+1].type==="text";)E=t[++l],C+=`
`+(E.tokens?this.parseInline(E.tokens):E.text);o+=i?this.renderer.paragraph(C):C;continue}default:{let W='Token with "'+E.type+'" type was not found.';if(this.options.silent){console.error(W);return}else throw new Error(W)}}}return o}parseInline(t,i){i=i||this.renderer;let o="",l,c,f,d=t.length;for(l=0;l<d;l++){if(c=t[l],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[c.type]&&(f=this.options.extensions.renderers[c.type].call({parser:this},c),f!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(c.type))){o+=f||"";continue}switch(c.type){case"escape":{o+=i.text(c.text);break}case"html":{o+=i.html(c.text);break}case"link":{o+=i.link(c.href,c.title,this.parseInline(c.tokens,i));break}case"image":{o+=i.image(c.href,c.title,c.text);break}case"strong":{o+=i.strong(this.parseInline(c.tokens,i));break}case"em":{o+=i.em(this.parseInline(c.tokens,i));break}case"codespan":{o+=i.codespan(c.text);break}case"br":{o+=i.br();break}case"del":{o+=i.del(this.parseInline(c.tokens,i));break}case"text":{o+=i.text(c.text);break}default:{let g='Token with "'+c.type+'" type was not found.';if(this.options.silent){console.error(g);return}else throw new Error(g)}}}return o}},Io=class{constructor(t){this.options=t||kr}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(t){return t}postprocess(t){return t}};function k1(n,t,i){return o=>{if(o.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let l="<p>An error occurred:</p><pre>"+xt(o.message+"",!0)+"</pre>";if(t)return Promise.resolve(l);if(i){i(null,l);return}return l}if(t)return Promise.reject(o);if(i){i(o);return}throw o}}function Eg(n,t){return(i,o,l)=>{typeof o=="function"&&(l=o,o=null);let c={...o};o={...xe.defaults,...c};let f=k1(o.silent,o.async,l);if(typeof i>"u"||i===null)return f(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return f(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(b1(o),o.hooks&&(o.hooks.options=o),l){let d=o.highlight,g;try{o.hooks&&(i=o.hooks.preprocess(i)),g=n(i,o)}catch(k){return f(k)}let y=function(k){let C;if(!k)try{o.walkTokens&&xe.walkTokens(g,o.walkTokens),C=t(g,o),o.hooks&&(C=o.hooks.postprocess(C))}catch(E){k=E}return o.highlight=d,k?f(k):l(null,C)};if(!d||d.length<3||(delete o.highlight,!g.length))return y();let b=0;xe.walkTokens(g,function(k){k.type==="code"&&(b++,setTimeout(()=>{d(k.text,k.lang,function(C,E){if(C)return y(C);E!=null&&E!==k.text&&(k.text=E,k.escaped=!0),b--,b===0&&y()})},0))}),b===0&&y();return}if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(i):i).then(d=>n(d,o)).then(d=>o.walkTokens?Promise.all(xe.walkTokens(d,o.walkTokens)).then(()=>d):d).then(d=>t(d,o)).then(d=>o.hooks?o.hooks.postprocess(d):d).catch(f);try{o.hooks&&(i=o.hooks.preprocess(i));let d=n(i,o);o.walkTokens&&xe.walkTokens(d,o.walkTokens);let g=t(d,o);return o.hooks&&(g=o.hooks.postprocess(g)),g}catch(d){return f(d)}}}function xe(n,t,i){return Eg(wr.lex,xr.parse)(n,t,i)}xe.options=xe.setOptions=function(n){return xe.defaults={...xe.defaults,...n},s1(xe.defaults),xe};xe.getDefaults=Cg;xe.defaults=kr;xe.use=function(...n){let t=xe.defaults.extensions||{renderers:{},childTokens:{}};n.forEach(i=>{let o={...i};if(o.async=xe.defaults.async||o.async||!1,i.extensions&&(i.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if(l.renderer){let c=t.renderers[l.name];c?t.renderers[l.name]=function(...f){let d=l.renderer.apply(this,f);return d===!1&&(d=c.apply(this,f)),d}:t.renderers[l.name]=l.renderer}if(l.tokenizer){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[l.level]?t[l.level].unshift(l.tokenizer):t[l.level]=[l.tokenizer],l.start&&(l.level==="block"?t.startBlock?t.startBlock.push(l.start):t.startBlock=[l.start]:l.level==="inline"&&(t.startInline?t.startInline.push(l.start):t.startInline=[l.start]))}l.childTokens&&(t.childTokens[l.name]=l.childTokens)}),o.extensions=t),i.renderer){let l=xe.defaults.renderer||new No;for(let c in i.renderer){let f=l[c];l[c]=(...d)=>{let g=i.renderer[c].apply(l,d);return g===!1&&(g=f.apply(l,d)),g}}o.renderer=l}if(i.tokenizer){let l=xe.defaults.tokenizer||new Po;for(let c in i.tokenizer){let f=l[c];l[c]=(...d)=>{let g=i.tokenizer[c].apply(l,d);return g===!1&&(g=f.apply(l,d)),g}}o.tokenizer=l}if(i.hooks){let l=xe.defaults.hooks||new Io;for(let c in i.hooks){let f=l[c];Io.passThroughHooks.has(c)?l[c]=d=>{if(xe.defaults.async)return Promise.resolve(i.hooks[c].call(l,d)).then(y=>f.call(l,y));let g=i.hooks[c].call(l,d);return f.call(l,g)}:l[c]=(...d)=>{let g=i.hooks[c].apply(l,d);return g===!1&&(g=f.apply(l,d)),g}}o.hooks=l}if(i.walkTokens){let l=xe.defaults.walkTokens;o.walkTokens=function(c){let f=[];return f.push(i.walkTokens.call(this,c)),l&&(f=f.concat(l.call(this,c))),f}}xe.setOptions(o)})};xe.walkTokens=function(n,t){let i=[];for(let o of n)switch(i=i.concat(t.call(xe,o)),o.type){case"table":{for(let l of o.header)i=i.concat(xe.walkTokens(l.tokens,t));for(let l of o.rows)for(let c of l)i=i.concat(xe.walkTokens(c.tokens,t));break}case"list":{i=i.concat(xe.walkTokens(o.items,t));break}default:xe.defaults.extensions&&xe.defaults.extensions.childTokens&&xe.defaults.extensions.childTokens[o.type]?xe.defaults.extensions.childTokens[o.type].forEach(function(l){i=i.concat(xe.walkTokens(o[l],t))}):o.tokens&&(i=i.concat(xe.walkTokens(o.tokens,t)))}return i};xe.parseInline=Eg(wr.lexInline,xr.parseInline);xe.Parser=xr;xe.parser=xr.parse;xe.Renderer=No;xe.TextRenderer=ta;xe.Lexer=wr;xe.lexer=wr.lex;xe.Tokenizer=Po;xe.Slugger=ci;xe.Hooks=Io;xe.parse=xe;var KM=xe.options,YM=xe.setOptions,QM=xe.use,JM=xe.walkTokens,ZM=xe.parseInline;var XM=xr.parse,eD=wr.lex;var Cr=(n,t)=>({demo:`${n}:"Header \\"${n}\\""`,examples:[{title:"Variations",view:t.map(i=>`${i}:"Header \\"${i}\\""`)},{title:"Complex content",demo:{view:n,content:['text:"Text "','link:{ text: "Link" }']}},{title:"Using anchor",demo:[{view:n,anchor:"foo",content:'text:"Explicit value for an anchor"'},{view:n,anchor:!0,content:'text:"Auto generated anchor based on text content of header"'}]}]});function Lg(n){let t=new ci;function i(o,l,c,f){let{content:d,anchor:g=!1}=l;o.classList.add("view-header");let y=n.view.render(o,d||"text",c,f);return g&&y.then(()=>{let b=t.slug(g===!0?o.textContent:String(g),{dryrun:!0}),k=n.encodePageHash(n.pageId,n.pageRef,{...n.pageParams,"!anchor":b});o.prepend(U("a",{class:"view-header__anchor",id:`!anchor:${b}`,href:k}))}),y}n.view.define("header",i,{tag:"h4",usage:Cr}),n.view.define("h1",i,{tag:"h1",usage:Cr}),n.view.define("h2",i,{tag:"h2",usage:Cr}),n.view.define("h3",i,{tag:"h3",usage:Cr}),n.view.define("h4",i,{tag:"h4",usage:Cr}),n.view.define("h5",i,{tag:"h5",usage:Cr})}var Mg={demo:{view:"html",data:'"<h1>I am inner HTML</h1>"'}};function Dg(n){let t=document.createElement("div");n.view.define("html",function(i,o,l){t.innerHTML=l,i.append(...t.childNodes)},{tag:null,usage:Mg})}var ec="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMjggMTI4Ij4KICAgIDxyZWN0IHg9IjY1LjYiIHk9IjI0LjYiIHRyYW5zZm9ybT0ibWF0cml4KDAuOTM5NyAtMC4zNDIgMC4zNDIgMC45Mzk3IC05Ljk0MjYgMzEuODI4KSIgZmlsbD0iI0ZGRkZGRiIgd2lkdGg9IjM5LjMiIGhlaWdodD0iMzkiPjwvcmVjdD4KICAgIDxyZWN0IHg9IjcwLjYiIHk9IjUyLjciIHRyYW5zZm9ybT0ibWF0cml4KC0wLjkzOTcgMC4zNDIgLTAuMzQyIC0wLjkzOTcgMTk0Ljc4NTIgODEuMTIwNCkiIGZpbGw9IiNDN0Q3RTIiIHdpZHRoPSIzOS4zIiBoZWlnaHQ9IjEwIj48L3JlY3Q+CiAgICA8cGF0aCBmaWxsPSIjOThCRUQ4IiBkPSJNMTExLjUsNTQuNmwtMS4xLDEuMUw5Ny4xLDE5LjFsMS41LDAuMmM4LDAuOSwxNC43LDYuMiwxNy40LDEzLjdsMCwwQzExOC44LDQwLjQsMTE3LDQ4LjgsMTExLjUsNTQuNnoiPjwvcGF0aD4KICAgIDxwYXRoIGZpbGw9IiM0NTRCNTQiIGQ9Ik03My41LDcyLjJjLTEuMiwwLTIuNC0wLjgtMi44LTJMNTcuMywzMy41Yy0wLjMtMC43LTAuMi0xLjYsMC4xLTIuM2MwLjMtMC43LDAuOS0xLjMsMS43LTEuNmwzNi45LTEzLjRjMS42LTAuNiwzLjMsMC4yLDMuOCwxLjhsMTMuMywzNi42YzAuMywwLjcsMC4yLDEuNi0wLjEsMi4zYy0wLjMsMC43LTAuOSwxLjMtMS43LDEuNkw3NC41LDcyQzc0LjIsNzIuMSw3My44LDcyLjIsNzMuNSw3Mi4yek02NCwzNC4zbDExLjMsMzFsMzEuMy0xMS40bC0xMS4zLTMxTDY0LDM0LjN6Ij48L3BhdGg+CiAgICA8cmVjdCB4PSIzNSIgeT0iNDYuNyIgdHJhbnNmb3JtPSJtYXRyaXgoMC45Mzk3IC0wLjM0MiAwLjM0MiAwLjkzOTcgLTE2LjIwMTEgMjAuOTg4KSIgZmlsbD0iI0ZGRkZGRiIgd2lkdGg9IjMyLjgiIGhlaWdodD0iMTkuNSI+PC9yZWN0PgogICAgPHJlY3QgeD0iMzcuMyIgeT0iNTkuOCIgdHJhbnNmb3JtPSJtYXRyaXgoLTAuOTM5NyAwLjM0MiAtMC4zNDIgLTAuOTM5NyAxMjUuNjc2MyAxMDMuMzk0NikiIGZpbGw9IiNDN0Q3RTIiIHdpZHRoPSIzMi44IiBoZWlnaHQ9IjYiPjwvcmVjdD4KICAgIDxwYXRoIGZpbGw9IiM0NTRCNTQiIGQ9Ik0zOS40LDc0LjJjLTAuNCwwLTAuOS0wLjEtMS4zLTAuM2MtMC43LTAuMy0xLjMtMC45LTEuNi0xLjdsLTYuNy0xOC4zYy0wLjMtMC43LTAuMi0xLjYsMC4xLTIuM2MwLjMtMC43LDAuOS0xLjMsMS43LTEuNmwzMC44LTExLjJjMC43LTAuMywxLjYtMC4yLDIuMywwLjFjMC43LDAuMywxLjMsMC45LDEuNiwxLjdMNzMsNTljMC42LDEuNi0wLjIsMy4zLTEuOCwzLjhMNDAuNCw3NEM0MCw3NC4xLDM5LjcsNzQuMiwzOS40LDc0LjJ6IE0zNi41LDU0LjdsNC42LDEyLjdsMjUuMi05LjJsLTQuNi0xMi43TDM2LjUsNTQuN3oiPjwvcGF0aD4KICAgIDxwYXRoIGZpbGw9IiM0NTRCNTQiIGQ9Ik03MCwxMTguOWMtMS4yLDAtMi40LTAuNy0yLjgtMS45bC0xNC0zNy4ybC04LjQsMy4xbC0xNy4yLDM0LjRjLTAuNywxLjUtMi41LDIuMS00LDEuM2MtMS41LTAuNy0yLjEtMi41LTEuMy00TDQwLDc5YzAuMy0wLjcsMC45LTEuMiwxLjctMS41TDU0LDczLjFjMS41LTAuNiwzLjMsMC4yLDMuOCwxLjhsMTUsNDBjMC42LDEuNi0wLjIsMy4zLTEuOCwzLjlDNzAuNywxMTguOCw3MC40LDExOC45LDcwLDExOC45eiI+PC9wYXRoPgogICAgPHBhdGggZmlsbD0iIzQ1NEI1NCIgZD0iTTEzLjYsODAuMWMtMS4yLDAtMi40LTAuOC0yLjgtMkw2LjMsNjUuOWMtMC42LTEuNiwwLjItMy4zLDEuOC0zLjhjMS42LTAuNiwzLjMsMC4yLDMuOCwxLjhsNC40LDEyLjJjMC42LDEuNi0wLjIsMy4zLTEuOCwzLjhDMTQuMyw4MC4xLDE0LDgwLjEsMTMuNiw4MC4xeiI+PC9wYXRoPgogICAgPHBhdGggZmlsbD0iIzQ1NEI1NCIgZD0iTTEzLjIsNzMuM2MtMS4yLDAtMi40LTAuOC0yLjgtMmMtMC42LTEuNiwwLjItMy4zLDEuOC0zLjhMMzUsNTkuMmMxLjYtMC42LDMuMywwLjIsMy44LDEuOGMwLjYsMS42LTAuMiwzLjMtMS44LDMuOGwtMjIuOCw4LjNDMTMuOSw3My4zLDEzLjYsNzMuMywxMy4yLDczLjN6Ij48L3BhdGg+Cjwvc3ZnPgo=",Og={demo:{view:"image",src:ec,height:100},examples:[{title:"Src is not defined",demo:"image"},{title:"Bad url",demo:'image{ src: "<bad url>" }'}]};function Pg(n){n.view.define("image",function(t,i){Object.assign(t,i),t.onerror=()=>t.classList.add("error"),t.onload=()=>t.classList.add("loaded")},{tag:"img",usage:Og})}var Ng={beforeDemo:['md:"Similar to the `image` view but displays as a block with the image centered. The block has a checkered background to highlight image transparency."'],demo:{view:"image-preview",src:ec,height:100},examples:[{title:"Src is not defined",demo:"image-preview"},{title:"Bad url",demo:'image-preview{ src: "<bad url>" }'}]};function Ig(n){n.view.define("image-preview",function(t,i,o,l){this.render(t,{view:"image",...i},o,l)},{usage:Ng})}var Rg={demo:{view:"indicator",data:{label:"Label",value:"1234"}},examples:[{title:"Indicator as link",demo:{view:"indicator",data:{label:"Label",value:"4321",href:"#"}}}]};function Bg(n){n.view.define("indicator",function(t,i,o,l){let{value:c,label:f}=i,{href:d}=o||{},g=document.createElement("div"),y=document.createElement("div");return g.className="value",y.className="label",d&&(t.href=d),Promise.all([n.view.render(g,c||"text:value",o,l),n.view.render(y,f||"text:label",o,l)]).then(()=>t.append(g,y))},{tag:"a",usage:Rg})}var jg={demo:{view:"link",text:"I am a link",href:"#example"},examples:[{title:"Link opened in new tab",highlightProps:["external"],demo:{view:"link",text:"Discovery github",href:"https://github.com/discoveryjs/discovery",external:!0}},{title:"Infering text \u21FF href",highlightProps:["text","href","data"],beforeDemo:'md:"When `text` is omitted but `href` is specified, or vice versa, the opposite component is inferred from the specified one"',demo:[{view:"link",text:"http://example1.com"},{view:"link",href:"http://example2.com"},{view:"link",data:'"http://example3.com"'}]},{title:"Using onClick handler",highlightProps:["onClick"],demo:{view:"link",text:'Show "Hello world"',onClick:Function('return () => alert("Hello world!")')()}},{title:"Using data as source of options",beforeDemo:{view:"md",source:["The following properties are taken from the data when the appropriate options are not specified for a legacy reasons (is subject to remove in the future):","- `text`","- `href`","- `external`"].join(`
`)},highlightProps:["data"],demo:{view:"link",data:{text:"demo",href:"#example"}}},{title:"Complex content",highlightProps:["content"],demo:{view:"link",href:"#example",content:['text:"text "','html:"<b>bold</b>"']}}]};var C1=`is not array? | {
    text: #.props.content is undefined ? is string ?: text,
    content: undefined,
    href,
    external,
    onClick: undefined
} | overrideProps() | {
    $text; $href;
    ...,
    text: $text | is not undefined or no $href ?: $href,
    href: $href | is not undefined or no $text ?: $text
}`;function zg(n){n.view.define("link",function(t,i,o,l){let{text:c,content:f,href:d,external:g,onClick:y}=i;if(d&&(t.href=d),g&&t.setAttribute("target","_blank"),typeof y=="function"&&(t.classList.add("onclick"),t.addEventListener("click",b=>{b.preventDefault(),y(t,o,l)})),f)return n.view.render(t,f,o,l);t.textContent=c},{tag:"a",props:C1,usage:jg})}var tc={demo:{view:"markdown",source:`# Markdown example

> NOTE: The \`markdown\` view is based on [marked](https://github.com/markedjs/marked) package

Markdown is good because:
* You'll get **formatted** *text* with _no tags_
* It's much simpler than \`HTML\`

\`\`\`html
<b>bold</b><i>italic</i>
\`\`\`
[Read more](https://guides.github.com/features/mastering-markdown/)`},examples:[{title:"Inline config",demo:'markdown{ source: "**Hello** `world`!" }'},{title:"Shorthand syntax",beforeDemo:['md:"You can use `md` as an alias for `markdown` with a string as data. That\'s a **shortest** definition for a marked text"'],demo:'md:"**Hello** `world`!"'},{title:"Array of strings as a source",beforeDemo:['md:"Array of strings might be passed as a value for `source` property which is useful for a long sources\\n> NOTE: This doesn\'t work a source passed via data"'],demo:{view:"markdown",source:["Array","of","`strings`"]}},{title:"Interpolation",beforeDemo:['md:"Interpolation can be used almost anywhere in a markdown to embed the result of a jora query into resulting HTML. Just place a jora query between `{{`{{`}}` and `{{`}`+`}`}}`:"'],demo:{view:"md",source:["Simple evaluation: 2 + 2 = `{{ 2 + 2 }}`","","Markdown view has {{ viewDef.examples.size() }} examples"]}},{title:"Disable anchors for headers",highlightProps:["anchors"],beforeDemo:"Hover a header to see a chain icon on the left side of header when anchors are enabled:",demo:[{view:"markdown",source:"## header with default settings"},{view:"markdown",anchors:!1,source:"## header with disabled anchor"}]},{title:"Sections prelude and postlude",highlightProps:["sectionPrelude","sectionPostlude"],demo:{view:"markdown",sectionPrelude:"struct",sectionPostlude:{view:"link",data:'{ href: "#top", text: "Scroll to top \u2191" }'},source:`Some text

## Header level 2

Some text

### Header level 3

Some text

## Header level 2

Some text`}},{title:"Additional action buttons for code blocks",highlightProps:["codeActionButtons"],beforeDemo:['md:"Use `codeActionButtons` to add additional buttons to code blocks. The option is the same as `actionButtons` for `source` view."'],demo:{view:"markdown",codeActionButtons:[{view:"button",content:'text:"Say \\"Hello world\\""',onClick:Function('return () => alert("Hello world!")')()}],source:'```js\nconsole.log("Hello world")\n```'}},{title:"Configuration for code blocks",highlightProps:["codeConfig"],beforeDemo:['md:"Use `codeConfig` to specify any settings for code blocks available for `source` view."'],demo:{view:"markdown",codeConfig:{prelude:{view:"block",content:["badge:syntax",'text:"Length: " + content.size()']},postlude:"struct:{ data: $, context: # }"},source:`# Header 1

\`\`\`js
console.log("Hello world")
\`\`\`

## Header 2

text

## Header 3



\`\`\`jora
foo.bar.baz
\`\`\``}},{title:"Showcase",demo:{view:"markdown",source:`
# Header
## Header
### Header
#### Header
##### Header
* One
* Two
    * Three

4. Four
5. Five
    6. Six
- [{{ true }}] Task 1
- [x] Task 2

Interpolation in text: 2 + 2 = \`{{ 2 + 2 }}\`, or in attribute: [link](#dummy-link/{{"exam" + "ple"}} "{{ "example" + " title" }}")

Paragraph **bold** __bold__ *italic* _italic_ ~line-through~ \`code\` [link](#href)

>Blockquote
> > Line 2

\`\`\`js
var some = "code";
\`\`\`

foo | bar
----|-----
1 | A
2 | C
3 | E
`.trim().split(/\n/)}}]};var nc=class extends xe.Renderer{heading(t,i,o,l){let{discovery:c,anchors:f}=this.options,d=l.slug(o),g="";if(f){let y=c.encodePageHash(c.pageId,c.pageRef,{...c.pageParams,"!anchor":d});g=`<a class="view-header__anchor" id="!anchor:${Ge(d)}" href="${y}"></a>`}return`<h${i} class="view-header view-h${i}" data-slug="${d}">${g}${t}</h${i}>
`}link(t,i,o){if(t===null)return o;let l='<a class="view-link" href="'+Ge(t)+'"';return i&&(l+=' title="'+Ge(i)+'"'),t.startsWith("#")||(l+=' target="_blank"'),l+=">"+o+"</a>",l}checkbox(t){return'<label class="view-checkbox"><input type="checkbox" disabled'+(t?" checked":"")+"/></label> "}list(t,i,o){let l=i?"ol":"ul",c=i&&o!==1?` start="${o}"`:"";return`<${l} class="view-${l}"${c}>
`+t+`
</${l}>
`}listitem(t){return'<li class="view-list-item">'+t+`</li>
`}table(t,i){return`<table class="view-table">
<thead>
`+t.replace(/ class="view-table-row"/g,"")+`</thead>
`+(i?"<tbody>"+i+"</tbody>":"")+`</table>
`}tablerow(t){return`<tr class="view-table-row">
`+t+`</tr>
`}tablecell(t,i){let o=i.header?"th":"td";return`<${o} class="view-table-cell"${i.align?` align="${i.align}"`:""}>`+t+`</${o}>
`}};xe.setOptions({smartLists:!0,langPrefix:"discovery-markdown-",renderer:new nc});function Fg(n){let t={discovery:n};function i(c,f){return c.replace(/{{(\d+)}}/gs,(d,g)=>f[g])}function o(c,f){for(let d of c.childNodes)switch(d.nodeType){case document.ELEMENT_NODE:if(!d.classList.contains("view-source")){o(d,f);for(let g of d.attributes)g.nodeValue=i(g.nodeValue,f)}break;case document.TEXT_NODE:d.nodeValue=i(d.nodeValue,f);break}}function l(c,f,d,g){let{source:y,anchors:b=!0,sectionPrelude:k,sectionPostlude:C,codeConfig:E}=f,M=new Map,O=typeof d=="string"?d:y||"";return Array.isArray(O)&&(O=O.join(`
`)),O=O.replace(/{{(.+?)}}/gs,(L,S)=>(S=S.trim(),M.has(S)||M.set(S,M.size),`{{${M.get(S)}}}`)),c.classList.add("view-markdown"),new Promise(L=>{xe(O,{...t,anchors:b},(S,T)=>{let N=[];if(c.innerHTML=T,M.size>0){let I=new Array(M.size);for(let[z,W]of M.entries())try{I[W]=n.query(z,d,g)}catch(H){n.log("error","Interpolation query error in markdown:",H)}o(c,I)}let A=new Map,j={after:I=>c.prepend(I)};if(E||k||C){let{firstElementChild:I}=c,z={next:null,data:{sectionIdx:0,slug:null,text:null,href:null}};A.set(j,z);for(let W of[...c.querySelectorAll(":scope > :is(h1, h2, h3, h4, h5, h6)")]){W===I&&(A.delete(j),j=W,z=null);let H=W.querySelector(':scope > a[id^="!anchor:"]'),te={next:null,data:{sectionIdx:A.size,slug:W.dataset.slug,text:W.textContent.trim(),href:H?.hash}};A.set(W,te),z&&(z.next=W),z=te}}for(let I of[...c.querySelectorAll("pre > code")]){let z=document.createDocumentFragment(),W=I.textContent.replace(/\n$/,""),H=(I.className.match(/discovery-markdown-(\S+)/)||[])[1],te=A.get(j),_=I.parentNode;for(;_!==null&&_!==c;){if(A.has(_)){te=A.get(_);break}_=_.previousSibling||_.parentNode}N.push(this.render(z,typeof E=="object"?{view:"source",...E}:E||"source",{syntax:H,content:W},{...g,section:te?.data}).then(()=>I.parentNode.replaceWith(z)))}if(k||C){let I=(z,W,H)=>{let te=document.createDocumentFragment();N.push(this.render(te,z,d,{...g,section:W.data}).then(()=>H(te)))};for(let[z,W]of A)k&&I(k,W,H=>z.after(H)),C&&I(C,W,H=>W.next?W.next.before(H):c.append(H))}Promise.all(N).then(L)})})}n.view.define("markdown",l,{usage:tc}),n.view.define("md",l,{usage:tc})}var wm=un(fm(),1),Ar=un(Sn(),1),UD=un($u(),1),$D=un(hm(),1),GD=un(ym(),1);function R1(n){let t=U("div",{style:["position: fixed","overflow: hidden","font-size: 1px","width: 1px","height: 1px","top: 0","left: 0","white-space: pre"].join(";")});document.body.append(t);try{let i=window.getSelection(),o=document.createRange();t.append(n),o.selectNodeContents(t),i?.removeAllRanges(),i?.addRange(o),document.execCommand("copy")}finally{t.remove()}}async function kt(n){try{if(navigator.clipboard){let t=await navigator.permissions.query({name:"clipboard-write"});if(t.state==="granted"||t.state==="prompt")return navigator.clipboard.writeText(n)}}catch{}R1(n)}var fi=un(Sn(),1);var Tr='let name = "world";\n\nconsole.log(`Hello, ${name}!`);',B1=Function("return num => num + 5")(),j1=Function('return () => alert("Hello world!")')();function z1(){let n=new Set,t=new Map,i=o=>{let l=fi.default.resolveMode(o),c=[...t.keys()].find(f=>_s(f,l));return c||(t.set(l,{name:new Set,mime:new Set}),l)};for(let[o,l]of Object.entries(fi.default.modeToMime)){let c=t.get(i(l));c.mime.add(l),c.name.add(o),n.add(o)}for(let[o,l]of Object.entries(fi.default.mimeModes)){let c=t.get(i(o));c.mime.add(o),typeof l=="string"&&(c.name.add(l),n.add(l))}for(let[o]of Object.entries(fi.default.modes))if(!n.has(o)){let l=fi.default.modes[o];t.has(l)||t.set(l,{name:new Set,mime:[]}),t.get(l).name.add(o)}return[...t.values()].map(o=>({name:[...o.name],mime:[...o.mime]}))}var vm={demo:{view:"source",data:{syntax:"js",content:Tr}},examples:[{title:"Supported syntaxes",beforeDemo:['md:"Following values (for both `name` and `mime`) are supported for `syntax` option:"','html:"<br>"',{view:"table",data:z1,cols:{name:{content:"comma-list:name"},mime:{content:"comma-list:mime"}}},'html:"<br>"',"md:\"More syntaxes may be added via `import 'codemirror/mode/[name]/[name]';`\""],source:!1},{title:"Custom line numbers",highlightProps:["lineNum"],demo:{view:"source",data:{content:Tr,syntax:"js",lineNum:B1}}},{title:"Hide line numbers",highlightProps:["lineNum"],beforeDemo:['md:"Pass falsy value to `lineNum` option to hide line numbers:"'],demo:{view:"source",data:{content:Tr,syntax:"js",lineNum:!1}}},{title:"Additional action buttons",highlightProps:["actionButtons"],demo:{view:"source",actionButtons:[{view:"button",content:'text:"Say \\"Hello world\\""',onClick:j1}],data:{content:Tr,syntax:"js"}}},{title:"Prelude and postlude slots",highlightProps:["prelude","postlude"],demo:{view:"source",prelude:['text:"Prelude:"',"struct:{ data: $, context: # }"],postlude:['text:"Postlude:"',"struct:{ data: $, context: # }"],data:{content:Tr,syntax:"js"}}},{title:"Highlight ranges",highlightProps:["refs"],demo:{view:"source",data:{syntax:"js",content:Tr,refs:[{range:[4,8]},{range:[21,28],type:"link",href:"#example",tooltip:{position:"trigger",content:['text:"Link to "',"text:href"]}}]}}},{title:"Max content size for syntax highlight",highlightProps:["maxSourceSizeToHighlight"],beforeDemo:['md:"By default a syntax highlighing is not appling to a source longer than 250Kb. Option `maxSourceSizeToHighlight` is using to change max size of source to be syntax highlighted."'],demo:{view:"source",data:{content:Tr,syntax:"js",maxSourceSizeToHighlight:4}}}]};var F1=250*1024;Ar.default.modeToMime={js:"application/javascript",ts:"application/typescript",typescript:"application/typescript",json:"application/json",html:"text/html",css:"text/css",scss:"text/x-scss",less:"text/x-less"};function H1(n,t){let i=Ar.default.getMode(Ar.default.defaults,{name:Ar.default.modeToMime[n]||n,isDiscoveryViewDefined:o=>t.view.isDefined(o)});return(o,l)=>{let c=Ar.default.startState(i),f=o.split(/(\n|\r\n?)/),d=0;for(let g=0;g<f.length;g++){if(g%2===0){let y=new Ar.default.StringStream(f[g],4,{lookAhead:b=>f[g+b],baseToken:function(){}});for(;!y.eol();){let b=i.token(y,c);b&&l(d+y.start,d+y.pos,b),y.start=y.pos}}d+=f[g].length}}}function _1(n,t){let i=n&&n.className,o=[t,Array.isArray(i)?i.join(" "):typeof i=="string"?i:!1].filter(Boolean).join(" ");return o?` class="${o}"`:""}function bm(n){return`${_1(n,"spotlight")}${n.marker?` data-marker="${n.marker}"`:""}${typeof n.tooltipId=="number"?` data-tooltip-id="${n.tooltipId}"`:""}`}var q1={html:{open({data:n}){switch(n.type){case"link":return`<a href="${n.href}"${bm(n)}>`;case"spotlight":return`<span${bm(n)}>`}},close({data:n}){switch(n.type){case"link":return"</a>";case"spotlight":return"</span>"}}}};function xm(n){n.view.define("source",function(t,i,o,l){let c=t.appendChild(U("div","view-source__prelude")),f=t.appendChild(U("div","view-source__content")),d=t.appendChild(U("div","view-source__postlude")),g=new Map,y=[],{mime:b,binary:k,size:C,maxSourceSizeToHighlight:E=F1,syntax:M,lineNum:O=!0,content:L,refs:S}=o;if(typeof L=="string")if(L.length<E&&y.push([H1(M||b,n),{html:{open({data:T}){return'<span class="token '+T+'">'},close(){return"</span>"}}}]),Array.isArray(S)&&y.push([(T,N)=>S.forEach(A=>{if(A.range){let j;A.tooltip&&g.set(j=g.size,A),N(A.range[0],A.range[1],{type:"spotlight",...A,tooltipId:j})}}),q1]),k)f.innerHTML="Binary content"+(typeof C=="number"?" ("+C+" bytes)":"");else{let T=typeof O=="function"?O:j=>j+1,N=O?'<div class="view-source__lines">'+L.split(/\r\n?|\n/g).map((j,I)=>"<span>"+T(I)+"</span>").join("")+"</div>":"";f.innerHTML=N+`<div class="view-source__source">${(0,wm.default)(y,"html")(L)}</div>`;let A=U("div","view-source__action-buttons");n.view.render(A,[i.actionButtons,{view:"button",className:"copy",async onClick(j){clearTimeout(j.copiedTimer),await kt(L),j.classList.add("copied"),j.copiedTimer=setTimeout(()=>j.classList.remove("copied"),1250)}}],o,l),f.prepend(A);for(let j of f.querySelectorAll(":scope [data-tooltip-id]")){let I=g.get(Number(j.dataset.tooltipId));delete j.dataset.tooltipId,this.tooltip(j,I.tooltip,I,l)}i.prelude&&n.view.render(c,i.prelude,o,l),i.postlude&&n.view.render(d,i.postlude,o,l)}},{usage:vm,tag:"pre"})}var km={demo:{view:"text",data:'"Hello world!"'},examples:[{title:"Shorthand usage",view:'text:"Hello world!"'}]};var W1=`{
    text: #.props has no 'text'?
} | overrideProps()`;function Cm(n){n.view.define("text",function(t,{text:i}){t.appendChild(document.createTextNode(String(i)))},{tag:!1,props:(...t)=>n.query(W1,...t),usage:km})}var cc={};Ae(cc,{has:()=>$1,matchAll:()=>uc});var lc={};Ae(lc,{isArray:()=>hn,isRegExp:()=>oa,isSet:()=>Jn,isTypedArray:()=>Sm});function Sm(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function hn(n){return Array.isArray(n)||Sm(n)}function Jn(n){return pn(n)==="[object Set]"}function oa(n){return pn(n)==="[object RegExp]"}function V1(n,t,i){let o=n.slice(i).search(t);return o!==-1?{offset:i+o,length:RegExp.lastMatch.length}:null}function U1(n,t,i){let o=n.indexOf(t,i);return o!==-1?{offset:o,length:t.length}:null}function $1(n,t,i=!1){return oa(t)?i&&!t.ignoreCase?new RegExp(t,t.flags+"i").test(n):t.test(n):typeof t=="string"?i?String(n).toLowerCase().indexOf(t.toLowerCase()):String(n).indexOf(t)!==-1:!1}function uc(n,t,i,o,l=!1){if(!oa(t)&&typeof t!="string"){i(n);return}let c=String(n);l&&(typeof t=="string"?(c=c.toLowerCase(),t=t.toLowerCase()):t.ignoreCase||(t=new RegExp(t,t.flags+"i")));let f=0;do{let d=typeof t=="string"?U1(c,t,f):V1(c,t,f);if(d===null||d.length===0&&d.offset===f){i(f>0?n.slice(f):n);break}d.length!==0&&(d.offset!==f&&i(n.slice(f,d.offset)),o(n.substr(d.offset,d.length))),f=d.offset+d.length}while(f!==n.length)}var Tm={demo:{view:"text-match",data:{text:"I am matched text or a text with matches!",match:/match/}},examples:[{title:"Raw string as match",demo:{view:"text-match",data:{text:"I am matched text or a text with matches!",match:"match"}}},{title:"Using with a link",demo:{view:"link",data:{href:"#"},content:'text-match:{ text: "Test link", match: /\\w+/i }'}},{title:"Various configurations",demo:{view:"table",cols:[{header:"text-match",content:"text-match"},{header:"Config",content:"struct"}],data:[null,{},{},{match:"test"},{match:"Test"},{match:"test",ignoreCase:!0},{match:"Test",ignoreCase:!0},{match:/test/},{match:/test/g},{match:/test/i},{match:/test/,ignoreCase:!0},{match:/test/g,ignoreCase:!0}].map((n,t)=>t>1?{text:"test Test",...n}:n)}}]};var G1=U("span","view-text-match"),K1=`is not array? | {
    text: #.props has no 'text' ? text,
    match,
    ignoreCase: ignoreCase or false
} | overrideProps()`;function Am(n){n.view.define("text-match",function(t,i){let{text:o,match:l,ignoreCase:c}=i;uc(String(o),l,f=>t.appendChild(ko(f)),f=>t.appendChild(G1.cloneNode()).appendChild(ko(f)),c)},{tag:!1,props:K1,usage:Tm})}var Em={demo:{view:"text-numeric",data:'"Like a `text` view but adds a thousands separator to integer part of numbers, e.g. 12345678 or 12345.67890"'},examples:[{title:"Shorthand usage",view:"text-numeric:1234567"}]};var Y1=`{
    text: #.props has no 'text'?
} | overrideProps()`;function Lm(n){n.view.define("text-numeric",function(t,{text:i}){t.innerHTML=Dt(i)},{tag:"span",props:Y1,usage:Em})}var Mm={demo:{view:"context",data:{name:"text",demo:123},content:["text:name","table"]},examples:[{title:"Using with modifiers",demo:{view:"context",modifiers:['h2:"Modifiers"',{view:"input",name:"inputValue"},{view:"select",name:"selectValue",data:["foo","bar","baz"]}],content:['h2:"Values"',"struct:#"]}}]};var Q1=`#.props | {
    modifiers is array ?: is truthy ? [$] : [],
    content,
    proxy.bool(),
    onInit,
    onChange
}`;function Dm(n){n.view.define("context",async function(t,i,o,l){let{modifiers:c=[],content:f=[],proxy:d,onInit:g,onChange:y}=i,b=l,k=null,C=!1;await this.render(t,this.composeConfig(c,{onInit:L,onChange:L}),o,l);let E=t.appendChild(document.createComment('{ view: "context" } content start')),M=t.appendChild(document.createComment('{ view: "context" } content end'));d&&(g||y)&&(f=this.composeConfig(f,{onInit:g,onChange:y})),C=!0,await O();async function O(){let S=M.previousSibling;for(;S&&S!==E;)S=S.previousSibling,S.nextSibling.remove();let T=k=document.createDocumentFragment();await n.view.render(T,f,o,b),T===k&&(n.view.adoptFragment(T,E),E.after(T),k=null)}function L(S,T){T&&(!Le(b,T)||b[T]!==S)&&(b={...b,[T]:S},C?(O(),d&&typeof y=="function"&&y(S,T)):typeof g=="function"&&g(S,T))}},{tag:!1,props:Q1,usage:Mm})}var Om={demo:{view:"switch",data:{enabled:!0},content:[{when:"not enabled",content:'text:"I am disabled"'},{when:"enabled",content:'text:"I am enabled"'}]},examples:[{title:"Using with tabs",demo:{view:"context",modifiers:{view:"tabs",tabs:["foo","bar","baz"],name:"section"},content:{view:"switch",content:[{when:'#.section="foo"',content:'text:"FOO!"'},{when:'#.section="bar"',content:'text:"BAR!!"'},{content:'text:"When no other conditions are met"'}]}}}]};function Pm(n){n.view.define("switch",function(t,i,o,l){let{content:c}=i,f='alert-warning:"No case choosen"';if(Array.isArray(c))for(let d=0;d<c.length;d++){let g=c[d];if(g&&n.queryBool(g.when||!0,o,l)){f="data"in g?{view:"context",data:g.data,content:g.content}:g.content;break}}return n.view.render(t,f,o,l)},{tag:!1,usage:Om})}function fc(n,t,i){for(let o in n){if(!Le(n,o))continue;let l;i.dictMode?(l=i.dictMode,l.count++,l.keys.add(o)):i.properties.has(o)?(l=i.properties.get(o),l.count++):(l={count:1,map:Object.create(null)},i.properties.set(o,l)),di(n[o],t-1,l.map)}}function di(n,t,i=Object.create(null)){let o=n===null?"null":hn(n)?"array":Jn(n)?"set":typeof n;switch(o){default:o in i||(i[o]=new Map),i[o].set(n,(i[o].get(n)||0)+1);break;case"object":"object"in i||(i.object=new Map,i.object.count=0,i.object.properties=t?new Map:null,i.object.dictMode=null,i.object.sortKeys=!1),i.object.count++,i.object.has(n)?i.object.set(n,i.object.get(n)+1):(i.object.set(n,1),t&&fc(n,t,i.object));break;case"array":"array"in i||(i.array=new Map,i.array.count=0,i.array.map=Object.create(null)),i.array.count++,i.array.set(n,(i.array.get(n)||0)+1);for(let l=0;l<n.length;l++)di(n[l],t,i.array.map);break;case"set":"set"in i||(i.set=new Map,i.set.count++,i.set.map=Object.create(null)),i.set.count++,i.set.set(n,(i.set.get(n)||0)+1);for(let l of n)di(l,t,i.set.map);break}return i}var sa=["rgba(83,211,75,0.75)","rgba(241,235,44,0.75)","rgba(244,152,99,0.75)","rgba(148,99,244,0.75)","rgba(44,132,241,0.75)","rgba(233,117,117,0.75)","rgba(85,187,155,0.75)","rgba(151,147,99,0.75)","rgba(216,107,196,0.75)","rgba(108,204,227,0.75)","rgba(164,164,164,0.75)"],Ro=["null","undefined","string","number","bigint","boolean","symbol","function","array","set","object"];function pi(n,t,i,o=[],l="",c=null){Object.keys(t).sort((f,d)=>Ro.indexOf(f)-Ro.indexOf(d)).forEach((f,d,g)=>{switch(d>0&&n.append(" | "),f){default:{let y=n.appendChild(U("span","type",f));i.set(y,{type:"type",path:o,stat:t,name:f});break}case"object":{let y=t[f],{properties:b,dictMode:k,sortKeys:C}=y;if(b===null){i.set(n.appendChild(U("span","expand","{\u2026}")),{type:"expand",path:o,stat:t,map:t[f],offset:l});break}if(b.size===0){n.appendChild(U("span","object","{}"));break}let E=y.size,M=k?[["[key]",k]]:[...b.entries()],O=l+"    ",L=n.appendChild(U("span","object",["{",U("span",{"data-action":"collapse"})]));b.size>1&&(L.appendChild(U("span",{title:"Toggle dictionary mode (collapse all the values in a single signature)","data-action":"dict-mode","data-enabled":k!==null})),M.some(([S],T)=>T!==0&&S<M[T-1][0])&&L.appendChild(U("span",{title:"Toggle keys sorting","data-action":"sort-keys","data-enabled":C}))),i.set(L,{type:"shape",path:o,map:t[f],offset:l}),(E>1||g.length>1||c!==null&&Object.keys(c).length>1)&&(L.appendChild(U("span","count")).dataset.value=String(E)),C&&M.sort(([S],[T])=>S<T?-1:S>T?1:0);for(let[S,{count:T,map:N}]of M){let A=U("span","property",[S]);i.set(A,{type:"property",path:o,stat:t,name:S,map:N}),L.append(`
${O}`),L.appendChild(A),T!==E&&k===null&&A.appendChild(U("span","optional","?")),L.append(": "),pi(L,N,i,o.concat(k?"*":S),O),L.append(";")}L.lastChild.nodeValue===";"&&L.append(`
${l}`),L.append("}");break}case"array":n.append("["),pi(n,t[f].map,i,o,l),n.append("]");break;case"set":n.append("Set("),pi(n,t[f].map,i,o,l),n.append(")");break}})}function hi(n,t){return n.toFixed(t).replace(/\.?0+$/,"")}function Nm(n){let t=Math.cos(2*Math.PI*n),i=Math.sin(2*Math.PI*n);return[t,i]}function Im(n){let t=0;return['<svg viewBox="-1 -1 2 2" class="pie">',...n.map(i=>{let[o,l]=Nm(t),[c,f]=Nm(t+=i.percent),d=i.percent>.5?1:0;return`<path d="${[`M ${o} ${l}`,`A 1 1 0 ${d} 1 ${c} ${f}`,"L 0 0"].join(" ")}" fill="${i.color}"/>`}),"</svg>"].join(`
`)}function J1(n){let t=0;for(let i in n)n[i].forEach(o=>t+=o);return t}function Z1(n){let t=Object.create(null);for(let i in n)t[i]=0,n[i].forEach(o=>t[i]+=o);return t}function Rm(n,t,i){let o=t.stat.object,{map:l,count:c}=o.dictMode||o.properties.get(t.name),f=o.dictMode?o.dictMode.count:o.size,d={name:t.name,path:i.pathToQuery(t.path),total:c,count:f,percent:hi(100*f/c,1)+"%"};i.view.render(n,[{view:"block",when:"path",className:"path",content:"text:path"},{view:"h1",className:"property",content:["text:name",{view:"html",when:"count != total",data:`"<span class=\\"usage-stat optional\\">" + (
                        "(in <span class=\\"num\\">" + count + "</span> of <span class=\\"num\\">" + total + "</span> objects, <span class=\\"num\\">" + percent + "</span>)"
                    ) + "</span>"`}]}],d),Bm(n,{map:l,count:c},i)}function Bm(n,{map:t,count:i},o){let l=Z1(t),c=[],f=Ro.filter(d=>d in t);Object.entries(l).sort(([,d],[,g])=>g-d).forEach(([d,g],y)=>{c.push({name:Ge(d),count:g,percent:g/i,percent100:hi(100*g/i,1),color:sa[y]})}),o.view.render(n,{view:"block",when:"typeStat.size() > 1",data:"typeStat",className:"pie-stat",content:[{view:"block",content:{view:"html",data:Im}},{view:"block",content:['html:"<span class=\\"list-header\\">Types usage:</span>"',{view:"list",item:`html:
                            "<span class=\\"dot\\" style=\\"--size: 10px; background-color: " + color + "\\"></span> " +
                            "<span class=\\"caption\\">" + name + "</span>" +
                            "<span class=\\"times\\"> \xD7 " + count + " (" + percent100 + "%)</span>"
                        `}]}]},c),f.forEach(d=>dc(n,{name:d,stat:t},o))}function dc(n,t,i){let o=t.stat[t.name],l=J1(t.stat),c=[],f;switch(t.name){case"number":{let d=[],g=0,y=0,b=0,k=1/0,C=-1/0;o.forEach((E,M)=>{d.push({count:E,value:M}),g+=M*E,y+=E,E>1&&b++,M<k&&(k=M),M>C&&(C=M)}),f={type:t.name,count:y,distinct:o.size,duplicated:b,min:k,max:C,sum:g,avg:hi(g/y,3),values:d.sort((E,M)=>M.count-E.count||E.value-M.value)},f.distinct>1&&c.push({view:"block",className:"overview-stat",content:`html:
                        "range: (min) <span class=\\"num\\">" + min + "</span> ... " +
                        "<span class=\\"num\\">" + max + "</span> (max), " +
                        "avg: <span class=\\"num\\">" + avg + "</span>"
                    `});break}default:{let d=[],g=0,y=0;o.forEach((b,k)=>{d.push({count:b,value:k}),g+=b,b>1&&y++}),f={type:t.name,count:g,distinct:o.size,duplicated:y,values:t.name==="object"||t.name==="array"||t.name==="set"?d.sort((b,k)=>k.count-b.count):d.sort((b,k)=>k.count-b.count||b.value>k.value||-(b.value<k.value))};break}}if(t.name!=="undefined"&&t.name!=="null"){if(c.unshift({view:"block",className:"overview-stat",content:['html:"<span class=\\"num\\">" + count + "</span> " + (count > 1 ? "values, " : "value")',{view:"switch",when:"count > 1",content:[{when:"distinct = 1",content:'text:"a single unique value:"'},{when:"distinct = count",content:'text:"all unique, no duplicates"'},{content:['html:"<span class=\\"num\\">" + distinct + "</span> unique, "','html:duplicated = distinct ? "all occur more than once" : "<span class=\\"num\\">" + duplicated + "</span> occur more than once"']}]}]}),f.values.length>1&&f.duplicated&&t.name!=="object"&&t.name!=="set"&&t.name!=="array"){let d=[],g=f.values.length===10?10:Math.min(9,f.values.length),y=0;for(let b=0;b<g;b++){let{count:k,value:C}=f.values[b];y+=k,d.push({name:Ge(String(C)),count:k,percent:k/f.count,percent100:hi(100*k/f.count,1),color:sa[b]})}if(d.length){let b=f.count-y;b>0&&d.push({name:"...",count:b,percent:b/f.count,percent100:hi(100*b/f.count,1),color:sa[d.length]}),c.push({view:"block",className:"pie-stat",data:d,content:[{view:"block",content:{view:"html",data:Im}},{view:"block",content:['html:"<span class=\\"list-header\\">Dominators:</span>"',{view:"list",item:`html:
                                        "<span class=\\"dot\\" style=\\"--size: 10px; background-color: " + color + "\\"></span> " +
                                        "<span class=\\"caption\\" title=\\"" + name + "\\">" + name + "</span>" +
                                        "<span class=\\"times\\"> \xD7 " + count + " (" + percent100 + "%)</span>"
                                    `}]}]})}}f.values.length>1?(t.name==="number"||t.name==="string")&&c.push({view:"content-filter",name:"filter",content:{view:"menu",data:"values.[no #.filter or value~=#.filter].sort(=>value)",item:[{view:"block",className:"caption",content:"text-match:{ text: value, match: #.filter }"},{view:"block",when:"count > 1",className:"count",content:'text:" \xD7 " + count'}]}}):(t.name==="number"||t.name==="string"||t.name==="boolean")&&c.push({view:"struct",data:"values.pick().value"}),t.name==="object"&&c.push({view:"list",className:"struct-list",data:"values",item:["struct:value",{view:"block",when:"count > 1",className:"count",content:'text:" \xD7 " + count'}]}),(t.name==="array"||t.name==="set")&&Object.keys(o.map).length&&c.push({view:"block",className:t.name==="array"?"array-types":"set-types",content:d=>Bm(d,o,i)})}i.view.render(n,[{view:"block",when:"path",className:"path",data:d=>i.pathToQuery(d.path),content:"text"},{view:"h1",className:"type",content:["text:name",`html:"<span class=\\"usage-stat\\">" + (
                    count = total
                        ? "only this type is used"
                        : "used in <span class=\\"num\\">" + count + "</span> of <span class=\\"num\\">" + total + "</span> cases (<span class=\\"num\\">" + percent + "</span>)"
                ) + "</span>"`]},...c],{...f,name:t.name,path:t.path,total:l,percent:hi(100*f.count/l,1)+"%"},{})}var jm={beforeDemo:['md:"The `signature` view is used to output a type definition for current data using TypeScript like style:"'],demo:{view:"signature",expanded:!0}};function zm(n){let t=new WeakMap,i=({target:o})=>{let l="expand",c=o.closest(`
            .view-signature .expand,
            .view-signature [data-action]
        `);if(!c)return;c.dataset.action&&(l=c.dataset.action,c=c.parentNode);let f=t.get(c);if(f){let{path:d,stat:g,map:y,offset:b}=f,k=document.createDocumentFragment();switch(l){case"sort-keys":y.sortKeys=!y.sortKeys;break;case"dict-mode":if(y.dictMode)y.dictMode=null;else{let C=y.dictMode={keys:new Set,count:0,map:Object.create(null)};y.forEach((E,M)=>{for(let O in M)Le(M,O)&&(C.keys.add(O),C.count++,di(M[O],1,C.map))})}break;default:y.properties===null?(y.properties=new Map,y.forEach((C,E)=>fc(E,1,y))):y.properties=null}pi(k,{object:y},t,d,b,g),c.replaceWith(k)}};n.addHostElEventListener("click",i,!1),new n.view.Popup({className:"signature-details",hoverPin:"trigger-click",hoverTriggers:`
            .view-signature .property,
            .view-signature .type
        `,render:function(o,l){let c=t.get(l);switch(c.type){case"property":return Rm(o,c,n);case"type":return dc(o,c,n)}}}),n.view.define("signature",function(o,l,c){let{expanded:f,path:d}=l,g=di(c,f),y=Array.isArray(d)?d:void 0;pi(o,g,t,y)},{usage:jm})}var Fm=(n,t,i,o,l,c,f)=>({target:d})=>{let g="expand",y=d.closest(`
        .view-struct.struct-expand,
        .view-struct .struct-expand-value,
        .view-struct .struct-action-button
    `);if(y)switch(y.dataset.action&&(g=y.dataset.action),g){case"expand":y.classList.contains("struct-expand")&&(y=y.lastChild),n(y,0),i(),y.parentNode.classList.add("struct-expanded-value"),l.has(y.parentNode)&&y.parentNode.classList.remove("struct-expand");break;case"collapse":y=y.parentNode,t(y),i(),y.parentNode.classList.remove("struct-expanded-value"),y.classList.remove("view-as-table"),l.has(y.parentNode)&&y.parentNode.classList.add("struct-expand");break;case"show-signature":f.show(y);break;case"value-actions":c.show(y);break;case"toggle-sort-keys":n(y.parentNode,0,y.parentNode.classList.toggle("sort-keys")),i();break;case"toggle-string-mode":y=y.parentNode;let b=y.querySelector(".string-text").firstChild;b.nodeValue=y.classList.toggle("string-value-as-text")?JSON.parse(`"${b.nodeValue}"`):JSON.stringify(b.nodeValue).slice(1,-1);break;case"toggle-view-as-table":if(y=y.parentNode,y.classList.toggle("view-as-table"))o(y);else{let C=y.querySelector(":scope > .view-table");C&&C.remove()}break}};var pc={};Ae(pc,{jsonStringifyAsJavaScript:()=>Zn,jsonStringifyInfo:()=>ho});function X1(n,t,i){let o=String(n),[l,c]=o.match(/^(?:\S+\s+)?(\S+)\(/)||[];if(l!=="function"&&l!=="function*"&&c===i.trim().slice(0,-1)&&(i=""),o.indexOf(`
`)===-1)return i+o;let f=o.split(/\n/),d=f[f.length-1].match(/^\s*/)?.[0].length||0,g=new RegExp("^\\s{0,"+d+"}");return i+f.map((y,b)=>b&&y.length?y.replace(g,t):y).join(`
`)}function eS(n,t,i){return typeof n=="function"?X1(n,t,i):n instanceof Date?`${i}new Date("${n.toISOString()}")`:i+String(n)}var tS=new Set(["[object Function]","[object RegExp]","[object Date]"]);function Zn(n,t,i=4){let o=[];return String(JSON.stringify(n,t||function(c,f){return typeof f=="string"&&pn(this[c])==="[object Date]"&&(f=this[c]),f!==null&&tS.has(pn(f))?(o.push(f),"{{{__placeholder__}}}"):f},i)).replace(/"((?:\\.|[^"])*)"(:?)/g,(c,f,d)=>d&&/^[a-z$_][a-z$_\d]*$/i.test(f)?f+d:`'${f.replace(/\\"/g,'"').replace(/'/g,"\\'")}'`+d).replace(/(^|\n)([ \t]*)(.*?)([a-zA-Z$_][a-zA-Z0-9$_]+:\s*)?'{{{__placeholder__}}}'/g,(c,f,d,g,y)=>f+d+g+eS(o.shift(),d,y))}function Hm(n){return n?", "+Dt(n)+" bytes":""}function nS(n){for(;n.parent!==null;)n=n.parent;return n.host[""]}function _m(n,t,i,o){return new n.view.Popup({className:"view-struct-actions-popup",render(l,c,f){let d=c.parentNode,g=t.get(d),y=[];if(typeof g=="string")y=[{text:"Copy as quoted string",action:()=>kt(JSON.stringify(g))},{text:"Copy as unquoted string",action:()=>kt(JSON.stringify(g).slice(1,-1))},{text:"Copy a value (unescaped)",action:()=>kt(g)}];else{let b=n.pathToQuery(o(d)),k=1024*1024*1024,C=!1,E=!1,M=0,O=0;try{let{bytes:L,spaceBytes:S,circular:T}=ho(g,{space:4});T.length?E="Converting circular structure to JSON":(M=L-S,O=L+2,M>k&&(E="Resulting JSON is over 1 Gb"),O>k&&(C="Resulting JSON is over 1 Gb"))}catch(L){E=C=/Maximum call stack size|too much recursion/i.test(L.message)?"Too much nested structure":L.message}if(E&&(E="Can't be copied: "+E),C&&(C="Can't be copied: "+C),b){y.push({text:"Copy path:",notes:Ge(b),action:()=>kt(b)});let L=i.get(d),S=nS(L);n.action.has("queryAcceptChanges")&&n.action.call("queryAcceptChanges",S)&&(n.action.has("querySubquery")&&y.push({text:"Create a subquery from the path",action:()=>n.action.call("querySubquery",b,S)}),n.action.has("queryAppend")&&y.push({text:"Append path to current query",action:()=>n.action.call("queryAppend",b,S)}))}y.push({text:"Copy as JSON",notes:`(formatted${Hm(O)})`,error:C,disabled:!!C,action:()=>kt(JSON.stringify(g,null,4))}),y.push({text:"Copy as JSON",notes:`(compact${Hm(M)})`,error:E,disabled:!!E,action:()=>kt(JSON.stringify(g))})}n.view.render(l,{view:"menu",onClick(b){f(),b.action()},item:["html:text",{view:"block",when:"notes",className:"notes",content:"html:notes"},{view:"block",when:"error",className:"error",content:"text:error"}]},y)}})}var rS=/^(?:https?:)?\/\/(?:[a-z0-9\-]+(?:\.[a-z0-9\-]+)+|\d+(?:\.\d+){3})(?:\:\d+)?(?:\/\S*?)?$/i;function Rn(n,t){return`<span class="${n}">${t}</span>`}function aa(n){return Rn("more",`\u2026 ${Dt(n)} more`)}function Er(n,t,i){switch(typeof n){case"boolean":case"undefined":return Rn("keyword",String(n));case"number":case"bigint":return Rn("number",Dt(n));case"symbol":return Rn("symbol",String(n));case"function":return"\u0192n";case"string":{let o=n.length,l=t?i.maxCompactStringLength:i.maxStringLength,c=o>l+i.allowedExcessStringLength,f=c?Ge(JSON.stringify(n.slice(0,l)).slice(1,-1)):Ge(JSON.stringify(n).slice(1,-1)),d=c?aa(o-l):"";return Rn("string",!t&&(n[0]==="h"||n[0]==="/")&&rS.test(n)?`"<a href="${Ge(n)}" target="_blank">${f}</a>${d}"`:`"${f}${d}"`)}case"object":{if(n===null)return Rn("keyword","null");if(hn(n)){let f=n.length,d=i.limitCollapsed===!1||i.limitCollapsed>f?f:i.limitCollapsed,g=Array.from({length:d},(y,b)=>Er(n[b],!0,i));return f>d&&g.push(`${aa(f-d)} `),`[${g.join(", ")}]`}switch(pn(n)){case"[object Set]":{let f=n.size,d=i.limitCollapsed===!1||i.limitCollapsed>f?f:i.limitCollapsed,g=n.values(),y=Array.from({length:d},()=>Er(g.next().value,!0,i));return f>d&&y.push(`${aa(f-d)} `),`[${y.join(", ")}]`}case"[object Date]":return Rn("date",String(n));case"[object RegExp]":return Rn("regexp",String(n))}if(t&&i.limitCompactObjectEntries===0){for(let f in n)if(Le(n,f))return"{\u2026}";return"{}"}let o=t?i.limitCompactObjectEntries===!1?1/0:i.limitCompactObjectEntries:i.limitCollapsed===!1?1/0:i.limitCollapsed,l=[],c=0;for(let f in n)if(Le(n,f)){if(c<o){let d=Ge(f.length>i.maxCompactPropertyLength?f.slice(0,i.maxCompactPropertyLength)+"\u2026":f);l.push(`${Rn("property",d)}: ${Er(n[f],!0,i)}`)}c++}return c>o&&l.push(aa(c-o)),l.length?`{ ${l.join(", ")} }`:"{}"}default:return`unknown type "${typeof n}"`}}var iS=["none","default","badge"],qm=new WeakMap;function Wm(n){let t=[];for(let{name:i,lookup:o}of n.objectMarkers.values)t.push({query(l,c){let f=o(l,!0);if(f!==null&&f.object!==c.host)return{place:"before",style:"badge",text:i,href:f.href}}});return t.length>0?t:!1}function Vm(n,t){return Array.isArray(n)&&n.length>0?t.concat(n.map(i=>typeof i=="string"||typeof i=="function"?{query:i}:i)):t}function oS(n){return iS.includes(n)}function Um(n){let t=Date.now()+8,i=0;for(;i<n.length&&!(Date.now()>t);i++){let{el:o,config:l,renderer:c,data:f,context:d}=n[i],{place:g="after",className:y,text:b,icon:k,href:C,external:E,tooltip:M}=l,O=oS(l.style)?l.style:g==="before"?"none":"default",L=b===void 0?typeof l!="object"?String(l):"":String(b),S=L!=="",T=["value-annotation","style-"+O,g==="before"?"before":"after",S?"has-text":"",y||""].join(" "),N=U(C?"a":"span",{class:T,href:typeof C=="string"?C:void 0,target:E?"_blank":void 0});if(S&&(/\d{4}/.test(L)?N.innerHTML=Dt(L):N.append(L)),typeof k=="string"&&(N.classList.add("icon"),/^[a-z_$][a-z0-9_$-]*$/i.test(k)?N.classList.add("icon-"+k):N.style.setProperty("--annotation-image",`url("${k}")`)),M&&c.tooltip(N,M,f,{...d,config:l}),g==="before")o.before(N);else{let A=o.parentNode,j=qm.get(o);j===void 0&&(qm.set(o,j=U("span","value-annotations")),A.classList.contains("struct-expanded-value")?o.querySelector(":scope > .value-size, :scope > .string-length")?.after(j):A.append(j)),j.append(N)}}n.splice(0,i)}var $m={level_1:{level_2_1:{level_3_1:{level_4_1:{}},level_3_2:2,level_3_3:3,level_3_4:4,level_3_5:5,level_3_6:6},level_2_2:[{foo:1,bar:2},{foo:3}],level_2_3:3,level_2_4:4,level_2_5:5,level_2_6:6},level_1_2:2,level_1_3:3,level_1_4:4,level_1_5:5,level_1_6:6,level_1_7:7},Gm={beforeDemo:['md:"View to display the structure of any value. This is the simplest yet powerful way to enable data exploration."'],demo:{view:"struct",data:{foo:"bar",baz:[1,2,3]}},examples:[{title:"Default expanded depth",highlightProps:["expanded"],beforeDemo:['md:"By default `struct` view is collapsed in one line. The `expanded` option is using to specify an initial expanded depth. A value for the option can be a boolean (`false` \u2192 `0`, `true` \u2192 `1`) or a positive number."'],demoData:$m,demo:['badge:"Default (expanded option is not used)"',{view:"struct"},'badge:"expanded = true"',{view:"struct",expanded:!0},'badge:"expanded = 2"',{view:"struct",expanded:2}]},{title:"Annotations",highlightProps:["annotations"],beforeDemo:[{view:"md",source:["Clarity of data can be improved by adding annotations. An annotation is special marker before or after a value which displaying for expanded objects and arrays only.","Any number of annotations can be applied to a single value.","","Annotations are adding with `annotations` option which should contain an array of strings (jora queries) and functions to compute an annotation config. An annotation config is an object with following fields:","```ts","type AnnotationConfig = {",'   place?: "before" | "after"; // the placement of an annotation, "after" is by default','   style?: "none" | "badge" | "default"; // appereance of annotation, "default" is by default',"   className?: string;         // a class to add to an annotation element","   text?: any;                 // text content of an annotation element","   icon?: string;              // name of icon or url to an image","   href?: string;              // annotation is a link and that's an URL","   external?: boolean;         // open a link in new tab, make sence when `href` is specified only","   tooltip?: TooltipConfig;    // configuration for a tooltip, the same as for any view","}","```","",'An annotation is not displayed (not rendered) when computed annotation config is a falsy value. Any other value (truthy, but not an object) is used as value for `text` option, i.e. `"example"` is the same as `{ text: "example" }`.',"","In addition to a string or function, an object can be used as an element of `annotations` array","* `query` \u2013 a string (jora query) or a function to compute an annotation config","* `debug` (optional) - when truthy a debug information is output to the console; when value is a string, it's used in debug message"]}],demoData:{items:[{id:1,value:"example"},{id:2,value:"bar"},{id:3,value:"baz"}],"annotation styles":["none","default","badge"]},demo:{view:"struct",expanded:3,annotations:['#.key = "items" ? { place: "before", style: "badge", text: "view as table", tooltip: "table" } : null',`$ ~= /az/ and "Value has 'az' substring!"`,'$ in ["none", "default", "badge"] and { style: $, place: "before", text: $ + " before" }','$ in ["none", "default", "badge"] and { style: $, text: $ + " after" }']}},{title:"Limit number of array elements and object entries",beforeDemo:{view:"md",source:["The following options define the maximum number of elements in array or entries in object:","* `limit` (default: `50`) \u2013 max number of elements/entries for expanded array/object","* `limitCollapsed` (default: `4`) \u2013 max of elements/entries for collapsed array/object","* `limitCompactObjectEntries` (default: `0`) \u2013 max number of entries in a object which appears in a collapsed array or object","","> Use `false` for any of these options to disable a limitation"]},highlightProps:["limit","limitCollapsed","limitCompactObjectEntries"],demoData:$m,demo:{view:"struct",limit:4,limitCollapsed:1,expanded:2}},{title:"Maximum length for strings",beforeDemo:{view:"md",source:["The following options define the maximum string length in various cases:","* `maxStringLength` (default: `150`) \u2013 max string length when a host value is expanded","* `maxCompactStringLength` (default: `40`) \u2013 max of string length when a host value is collapsed",'* `allowedExcessStringLength` (default: `10`) \u2013 allowed excess in length before a string will be cut and \\"N more\\" label will be added',"* `maxPropertyLength` (default: `Infinity`) \u2013 max of property name length","* `maxCompactPropertyLength` (default: `35`) \u2013 max of property name length in collapsed objects","","> Expand and collapse `level2` branch to see difference in a value presentation"]},highlightProps:["maxStringLength","maxCompactStringLength","allowedExcessStringLength","maxPropertyLength","maxCompactPropertyLength"],demo:{view:"struct",maxStringLength:30,maxCompactStringLength:10,allowedExcessStringLength:5,maxPropertyLength:30,maxCompactPropertyLength:15,expanded:1},demoData:{stringsInExpandedObject:"Quite a long string value Quite a long string value",string_34_chars:"String with 34 chars length demo x",string_35_chars:"String with 35 chars length demo xx",string_36_chars:"String with 36 chars length demo xxx",very_very_very_very_very_very_very_very_very_very_long_property_name:"a property name should be truncated due to settings, but will not be by default",level2:{stringsInCollapsedObject:"Quite a long string value Quite a long string value",string_14_chars:"Short string x",string_15_chars:"Short string xx",string_16_chars:"Short string xxx"}}}]};var tn={get collapse(){return U("span",{class:"struct-action-button struct-collapse-value","data-action":"collapse"})},get signature(){return U("span",{class:"struct-action-button show-signature","data-action":"show-signature"})},get actions(){return U("span",{class:"struct-action-button",title:"Value actions","data-action":"value-actions"})},get stringMode(){return U("span",{class:"struct-action-button",title:"Toggle string show mode","data-action":"toggle-string-mode"})},get viewAsTable(){return U("span",{class:"struct-action-button",title:"Toggle view as table","data-action":"toggle-view-as-table"})},get sortKeys(){return U("span",{class:"struct-action-button",title:"Toggle key sorting","data-action":"toggle-sort-keys"})}},Km=mr('"',tn.collapse,tn.actions,tn.stringMode,U("span","string-length"),U("span","string-text-wrapper",[U("span","string-text")]),'"'),Ym=mr("[",tn.collapse,tn.signature,tn.actions,tn.viewAsTable,U("span","value-size"),"]"),Qm=mr("{",tn.collapse,tn.signature,tn.actions,tn.viewAsTable,tn.sortKeys,U("span","value-size"),"}"),Jm=U("div","entry-line"),Zm=U("span","value"),Xm=U("span","label",["\xA0\xA0\xA0\xA0",U("span","property"),":\xA0"]);function ey(n,t,i){return new n.view.Popup({className:"view-struct-signature-popup",hoverPin:"popup-hover",hoverTriggers:".view-struct .show-signature",showDelay:50,render(o,l){let c=l.parentNode,f=t.get(c);o.classList.add("computing"),setTimeout(()=>{n.view.render(o,{view:"signature",expanded:2,path:i(c)},f).then(()=>o.classList.remove("computing"))},16)}})}var ty=50,sS=4,aS=0,lS=150,uS=40,cS=10,fS=1/0,dS=35;function Bo(n,t){return typeof n=="number"&&isFinite(n)&&n>=1?parseInt(n,10):t}function ny(n,t){if(typeof n=="string")return n.length>t.maxStringLength||/[\r\n\f\t]/.test(n);if(hn(n))return n.length>0;if(typeof n=="object"&&n!==null)switch(pn(n)){case"[object Set]":return n.size>0;case"[object Object]":for(let i in n)if(Le(n,i))return!0}return!1}function hc(n,t){n.appendChild(document.createTextNode(t))}function ry(n,t,i){t>1&&(n.lastElementChild.innerHTML=Dt(t)+" "+i)}function pS(n,t,i){t.length<2||t.every(([l],c)=>c===0||l>t[c-1][0])?n.querySelector('[data-action="toggle-sort-keys"]').remove():i&&t.sort(([l],[c])=>l<c?-1:l>c?1:0)}function hS(n,t,i){let o=Xm.cloneNode(!0),l=t.length>i?t.slice(0,i)+"\u2026":t;hc(o.firstElementChild,l),n.appendChild(o)}function iy(n){function t(A){let j=C.get(A),I=b.get(A);A.classList.add("struct-expand-value"),A.innerHTML=Er(I,!1,j),A.annotationsEl&&A.parentNode.append(A.annotationsEl)}function i(A,j,I){let z=b.get(A);if(A.classList.remove("struct-expand-value"),typeof z=="string"){let W=Km.cloneNode(!0),H=W.lastChild.previousSibling,te=H.previousSibling,_=JSON.stringify(z);hc(H.firstChild,_.slice(1,-1)),te.innerHTML=`length: ${Dt(_.length)} chars`,A.replaceChildren(W),d(A,te)}else if(hn(z)||Jn(z)){let W=k.get(A),H=C.get(A),te=typeof z.size=="number"?z.size:z.length;A.replaceChildren(Ym.cloneNode(!0)),ry(A,te,"elements"),d(A,A.lastElementChild),l(A,A.lastChild,z.values(),te,(_,$,D)=>{D>0&&D%10===9&&(_.dataset.index=D+1),o(_,$,j,H,Object.freeze({parent:W,host:z,key:D,index:D}))},0,H.limit)}else{let W=k.get(A),H=C.get(A),te=Object.entries(z);A.replaceChildren(Qm.cloneNode(!0)),ry(A,te.length,"entries"),d(A,A.lastElementChild),pS(A,te,I),l(A,A.lastChild,te.values(),te.length,(_,[$,D],Q)=>{Q>0&&Q%10===9&&(_.dataset.index=Q+1),hS(_,$,H.maxPropertyLength),o(_,D,j,H,Object.freeze({parent:W,host:z,key:$,index:Q}))},0,H.limit)}}function o(A,j,I,z,W){let H=ny(j,z),te=Zm.cloneNode(!0);b.set(te,j),k.set(te,W),C.set(te,z),H&&typeof j!="string"&&I?(A.classList.add("struct-expanded-value"),i(te,I-1)):(H&&te.classList.add("struct-expand-value"),te.innerHTML=Er(j,!1,z)),g(te,j,z,W),A.appendChild(te)}function l(A,j,I,z,W,H=0,te=ty){te===!1&&(te=1/0);let _=document.createDocumentFragment(),$=z-1,D=0;for(;D<te;D++,H++){let{done:Q,value:X}=I.next();if(Q)break;let de=Jm.cloneNode(!0);W(de,X,H),H!==$&&hc(de,","),_.appendChild(de)}A.insertBefore(_,j),n.view.maybeMoreButtons(A,j,z,H,te,(Q,X)=>l(A,j,I,z,W,Q,X))}function c(A){let j=C.get(A),I=b.get(A);!hn(I)&&!Jn(I)&&(I=Object.entries(I).map(([z,W])=>({"[key]":z,"[value]":W}))),n.view.render(A,"table",I,j.context),A.append(A.lastChild.previousSibling)}function f(A){let j=[],I=k.get(A);for(;I!==null&&I.parent!==null;)j.unshift(I.key),I=I.parent;return j}function d(A,j){A.annotationsEl&&j.after(A.annotationsEl)}function g(A,j,I,z){if(I.annotations.length){for(let W of I.annotations)try{let{query:H,debug:te}=W,_={...z,context:I.context},$=n.query(H,j,_);te&&n.log("info",`Compute struct view annotation${typeof te=="string"?` "${te}"`:""}:`,{data:j,context:_,query:H,queryResult:$}),$&&O.push($.tooltip?{el:A,config:$,renderer:I.renderer,data:j,context:_}:{el:A,config:$})}catch(H){n.log("error",H)}y()}}function y(){L===null&&O.length&&(L=Promise.resolve().then(()=>{L=null,Um(O),O.length&&y()}))}let b=new WeakMap,k=new WeakMap,C=new WeakMap,E=new WeakSet,M=Wm(n),O=[],L=null,S=_m(n,b,k,f),T=ey(n,b,f),N=Fm(i,t,y,c,E,S,T);return n.addHostElEventListener("click",N,!1),n.view.define("struct",function(A,j,I,z){let{annotations:W,expanded:H,limit:te,limitCollapsed:_,limitCompactObjectEntries:$,maxStringLength:D,maxCompactStringLength:Q,allowedExcessStringLength:X,maxPropertyLength:de,maxCompactPropertyLength:De}=j,Be=Vm(W,M||n.annotations),Ke={renderer:this,context:z,annotations:Be||[],limit:n.view.listLimit(te,ty),limitCollapsed:n.view.listLimit(_,sS),limitCompactObjectEntries:n.view.listLimit($,aS),maxStringLength:Bo(D,lS),maxCompactStringLength:Bo(Q,uS),allowedExcessStringLength:Bo(X,cS),maxPropertyLength:Bo(de,fS),maxCompactPropertyLength:Bo(De,dS)};E.add(A),o(A,I,H,Ke,{parent:null,host:{"":I},key:"",index:0}),y(),!H&&ny(I,Ke)&&A.classList.add("struct-expand")},{usage:Gm}),()=>{document.removeEventListener("click",N,!1)}}var gi=[{name:"Alice",age:34,occupation:"Engineer"},{name:"Bob",age:42,occupation:"Doctor"},{name:"Charlie",age:9,occupation:"Student"},{name:"David",age:50,occupation:"Doctor"},{name:"Eve",age:15,occupation:"Engineer"}],oy={beforeDemo:['md:"A view to display tabular data, usually an array of objects. When no column setup is provided, it infers columns from all keys of objects in the input data and auto-detects sorting for scalar values."'],demo:{view:"table"},demoData:[{foo:1,bar:"bar",baz:"zab"},{foo:2,baz:"xyz"},{foo:3,bar:"qux",baz:"baz"},{foo:4,bar:"aaa",baz:"abc"}],examples:[{title:"Columns setup",highlightProps:["cols"],beforeDemo:{view:"md",source:["To set up columns, the `cols` property is used. When an array of objects is used for `cols`, it specifies the exact set of columns. Each object contains a configuration for the `table-cell` view with additional properties that apply at the table level:\n","- `header` \u2013 a text for the column header\n","- `sorting` \u2013 a sorting function or query for the column\n"]},demo:{view:"table",cols:[{header:"Name",sorting:"name asc",data:"name"},{header:"Age",className:"number",content:'text:age + " y.o."'}]},demoData:gi},{title:"Adjastments of infered columns",beforeDemo:{view:"md",source:["In cases where adjustments are needed for inferred columns, an object can be used for the `cols` option, where each key is the name of a property from the objects:","- If a key is missing from the inferred columns, a new column is added with the specified configuration.","- If a key matches one of the inferred columns:","  - If the specified configuration is falsy (i.e., `null`, `undefined`, or `false`), then the column is omitted.","  - Otherwise, options from the specified configuration override properties of the inferred configuration.","","> When specified configuration is a string, it expands into object `{ content: value }`.","The default inferred configuration:","```js","{","    header: key,","    sorting: `$[${JSON.stringify(key)}] ascN`,",'    view: "table-cell",',"    data: value => value?.[key]","}","```",'[test]({{"table".pageLink("views-showcase")}})'].join(`
`)},afterDemo:["struct:#.id.pageLink(#.page, #.params)"],highlightProps:["cols"],demo:{view:"table",cols:{age:'text:age + " y.o."',occupation:!1,extraColumn:{header:"Extra column",content:'text:age >= 21 ? "Adult" : "Child"'}}},demoData:gi},{title:"Sorting",beforeDemo:{view:"md",source:['To specify a sorting function, use the `sorting` property in the column options. When a value for `sorting` is set, the column becomes sortable, allowing users to toggle sorting by clicking the column header. The value can be a function `(a, b) => number` or a string representing a jora query that returns a [comparator function](https://discoveryjs.github.io/jora/#article:jora-syntax-functions&!anchor=comparator-functions) (e.g., "name asc, complex.expression desc"), otherwise the value ignores. The function should take two rows\' data (`a` and `b`) and return a negative number if `a` is less than `b`, a positive number if `a` is greater than `b`, or zero otherwise.',"","> The `table` view automatically displays a sorting direction indicator (icon) on a column when a comparator function returns `<= 0` or `>= 0` for each pair of consecutive rows.","","> Note: A sorting (comparator) function has no access to the table's context, so any attempt to access context (`#`) values within a comparator function produced by a query will return `undefined`.","","The `table` view attempts to infer a sorting function for a column when the `sorting` option is not explicitly specified, by executing the following steps:","- Use `data` if it is a string or function to extract column values from row data; otherwise, use the row's data.",'- If `content` is a string formatted as `"view-name:query"`, use the `query` to extract a value from the previous step.','  > To prevent sorting inference from the `content` value, specify content in another format, often by wrapping it in an array, e.g., `{ content: "text:name" }` \u2192 `{ content: ["text:name"] }`.',"- If any condition is met, construct a sorting (comparator) function.","  > If neither `data` nor `content` options meet the conditions, a sorting function cannot be inferred, and the column becomes non-sortable.","","> Note: When inferring a comparator function, the when, whenData, and contentWhen options are not considered for now. If these options are needed to affect sorting, an explicit sorting function should be specified."].join(`
`)},highlightProps:["sorting","data","content"],demo:{view:"table",cols:[{header:"Sorting from data",data:"name"},{header:"Sorting from content",content:"text:age"},{header:"Sorting from data&content",data:"{ name, age }",content:"text:`${age} ${name}`"},{header:"Explicit sorting",sorting:"name asc, age desc",content:["text:`${name} ${age}`"]}]},demoData:gi},{title:"Displaying non-object values",beforeDemo:['md:"When input data (an array) contains non-object values, such values are display using `struct` view in a single cell spanning all the columns"'],highlightProps:["data","valueCol"],demo:['h3:"Table with non-object values"',{view:"table",data:[123,"string",null,{foo:1,bar:2},[1,2,3]]},'h3:"Enforce displaying of a [value] column"',{view:"table",valueCol:!0}],demoData:gi},{title:"Setup cell display",beforeDemo:{view:"md",source:["To manage cell display, the following options are available in the `cols` setting:","- `colWhen` (similar to `when` and `whenData` options) allows disabling column rendering based on the table's data.","- `when` and `whenData` apply to `table-cell` and behave the same way as they do for any view, to disabling rendering of the cell itself.","- `contentWhen` (similar to `when` and `whenData` options) allows disabling cell content rendering based on the cell's data.","- `colSpan` allows setting a relevant attribute for a table cell. (Note: subsequent cells should be disabled using `when` or `whenData`)."].join(`
`)},highlightProps:["contentWhen","colWhen","colSpan","when"],demo:{view:"table",data:'.({ name, age, fare: age > 21 ? "Full" : age > 12 ? "Half" })',cols:{name:{contentWhen:'$ != "Bob"'},age:{colWhen:"size() > 10"},fare:{colSpan:"=fare ? 1 : 2",content:{data:"fare",view:"switch",content:[{when:"$",content:"text"},{content:'text:"Not applicable"'}]}},price:{when:"fare",data:'fare = "Full" ? 50 : 25',content:'text:"$" + $'}}},demoData:gi},{title:"Cell details",beforeDemo:{view:"md",source:["Table cells can display an additional detail view of their content when clicked. Clicking the same cell again, or a different cell with details, will hide the view. To enable and customize the detail view, use the `details` option.","","By default, if the `details` option is not explicitly defined, it will automatically activate for cells containing an object or a non-empty array, as long as no custom `content` is specified. In this case, a default `struct` view will be used to display the data.","","You can control the visibility of detail views using the `detailsWhen` option. This option accepts a function that checks the cell's data and disables the details view if the function returns a falsy value."]},highlightProps:["details","detailsWhen"],demo:{view:"table",cols:[{header:"Group",data:"group"},{header:"Default",data:"peoples"},{header:"Custom details",data:"peoples",details:['h2:"Custom detail views"',"table"]},{header:"Disable default details",data:"peoples",details:!1},{header:"Conditional details",data:"peoples",detailsWhen:"size() > 2"}]},demoData:[{group:"Kids",max:21},{group:"Adults",min:21},{group:"All"}].map(({group:n,min:t=0,max:i=100})=>({group:n,peoples:gi.filter(o=>o.age>t&&o.age<i)}))}]};function gc(n,t){return{header:n,sorting:`${t} ascN`,view:"table-cell",data:t}}function gS(n,t,i){let o="",l="";if("data"in n&&n.data!==void 0)switch(typeof n.data){case"string":l=`(${n.data||"$"})`;break;case"function":o="$dataQuery;",l="$dataQuery(#)";break;default:o="$dataQuery;",l="$dataQuery"}if(typeof n.content=="string"){let c=n.content.indexOf(":"),f=n.content.slice(0,c);if(c===-1||!t.view.has(f))return;let d=n.content.slice(c+1);d&&(l=l?`(${l} | ${d})`:`(${d})`)}return l?t.query(`${o} ${l} ascN`,{dataQuery:n.data},i):!1}function mS(n,t,i){return typeof t=="string"&&(t={content:t}),Le(t,"content")||Le(t,"data")?{header:n,view:"table-cell",...t}:{...gc(n,i),...t}}function sy(n){return Array.isArray(n)?n.length:n}function ay(n,t,i){if(typeof i!="function")return!1;let o=0;try{for(let l=1,c=sy(t[0]);l<t.length;l++){let f=sy(t[l]),d=Math.sign(i(c,f));if(d){if(o&&d!==o)return!1;o=d}c=f}}catch(l){return n.log("error","Error on column order detection in table view",l),0}return-o}function ly(n){let t=n.queryFn("is not object");n.view.define("table",function(i,o,l,c){let{rows:f,cols:d,rowConfig:g,limit:y,valueCol:b=!1}=o,k;"rows"in o||(f=l),Jn(f)&&(f=[...f]),hn(f)||(f=f?[f]:[]);let C=i.appendChild(U("thead")).appendChild(U("tr")),E=[],M=i.appendChild(U("tbody")),O=i.appendChild(U("tbody")),L=O.appendChild(U("tr")).appendChild(U("td")),S=T=>{M.innerHTML="",L.innerHTML="";for(let N of E){let A=ay(n,T,N.sorting);N.el.classList.toggle("asc",A===1),N.el.classList.toggle("desc",A===-1)}return n.view.renderList(M,k,T,{...c,cols:d},0,n.view.listLimit(y,25),L).then(()=>O.hidden=!L.firstChild)};if(Array.isArray(d))d=d.map((T,N)=>typeof T=="string"?gc(T,n.pathToQuery([T])):{header:"col"+N,view:"table-cell",...T});else{let T=new Set,N=d&&typeof d=="object"?d:{};d=[];for(let A of f)if(t(A))b=!0;else for(let j of Object.keys(A))T.add(j);for(let A of Object.keys(N))N[A]?T.add(A):T.delete(A);for(let A of T)d.push(Le(N,A)?mS(A,N[A],n.pathToQuery([A])):gc(A,n.pathToQuery([A])))}b&&d.unshift({header:"[value]",view:"table-cell",sorting:"$ ascN",colSpan:"=is not object ? #.cols.size() : 1",content:'=is not object ? "struct"',details:!1}),d=d.filter(T=>!Le(T,"colWhen")||n.queryBool(T.colWhen,l,c));for(let T of d){let N=Le(T,"sorting")?n.query(T.sorting,null,c):gS(T,n,c),A=typeof N=="function"?ay(n,f,N):0,j=C.appendChild(U("th")),I={el:j};E.push(I),j.textContent=T.header,A!==0?(I.sorting=N,j.classList.add("sortable"),j.addEventListener("click",()=>{j.classList.contains("asc")?S(f.slice().sort(N).reverse()):j.classList.contains("desc")&&!A?S(f):S(f.slice().sort(N))})):T.sorting=!1}return L.colSpan=d.length,k=this.composeConfig({view:"table-row",cols:"=is not object ? [#.cols[]] : #.cols"},g),S(f)},{tag:"table",usage:oy})}function uy(n){n.view.define("table-row",function(t,i,o,l){let{cols:c}=i;if(Array.isArray(c))return Promise.all(c.map((f,d)=>n.view.render(t,f,o,{...l,colIndex:d})))},{tag:"tr"})}var yS={view:"struct",expanded:1};function vS(n,t,i){if(Array.isArray(t)||ArrayBuffer.isView(t)){n.classList.add("number"),n.textContent=t.length||"";return}if(i){n.classList.add("complex");for(let o in t)if(Le(t,o)){n.textContent="{\u2026}";return}n.textContent="{}";return}if(t!==void 0){if(typeof t=="number"){let o=String(t);if(n.classList.add("number"),!Number.isFinite(t)){n.classList.add("keyword"),n.textContent=o;return}o.length>3?n.innerHTML=Dt(o,!1):n.textContent=o;return}(t===null||t===!1||t===!0)&&n.classList.add("keyword"),n.textContent=String(t)}}function cy(n){n.view.define("table-cell",function(t,i,o,l){let{content:c,contentWhen:f=!0,details:d,detailsWhen:g=!0,colSpan:y}=i,b=!c&&o!==null&&(Array.isArray(o)?o.length>0:typeof o=="object")&&!(o instanceof RegExp);if(typeof y=="number"&&y>1&&(t.colSpan=y),!!n.queryBool(f,o,l)){if((d||d===void 0&&b)&&n.queryBool(g,o,l)&&(t.classList.add("details"),t.addEventListener("click",k=>{let C=k.target;if(C===t){let E=C.parentNode,M=E.parentNode,O=Array.from(M.querySelectorAll(".view-table-cell.details-expanded")).find(S=>S.parentNode.parentNode===M),L=null;if(O){let S=O.parentNode;if(O.classList.remove("details-expanded"),O===t){E.nextSibling.remove();return}S!==E?S.nextSibling.remove():(L=E.nextSibling.firstChild,L.innerHTML="")}L===null&&(L=E.parentNode.insertBefore(document.createElement("tr"),E.nextSibling).appendChild(document.createElement("td")),L.parentNode.className="view-table-cell-details-row",L.className="view-cell-details-content",L.colSpan=1e3),t.classList.add("details-expanded"),n.view.render(L,d||yS,o,l)}})),c)return n.view.render(t,c,o,l);vS(t,o,b)}},{tag:"td"})}var bS=()=>alert("toggled!"),fy=([n,...t],i="")=>{let o=[];for(let l=0;l<n;l++){let c=i+"."+(l+1);o.push({title:c,children:t.length?fy(t,c):null})}return o},dy={demo:{view:"tree",item:"text:text",data:{text:"Root",children:[{text:"Child"},{text:"Another child",children:[{text:"Lvl 2 child"},{text:"Lvl 2 child"}]}]}},examples:[{title:"Expanded tree",highlightProps:["expanded"],demo:{view:"tree",item:"text:text",expanded:999},demoData:{text:"Root",children:[{text:"Child"},{text:"Another child",children:[{text:"Lvl 2 child"},{text:"Lvl 2 child"}]}]}},{title:"With empty text",highlightProps:["emptyText"],demo:{view:"tree",emptyText:"This tree is empty",data:null}},{title:"With toggle handler",highlightProps:["onToggle"],demo:{view:"tree",item:"text:text",onToggle:bS},demoData:{text:"Root",children:[{text:"Child"},{text:"Another child",children:[{text:"Lvl 2 child"},{text:"Lvl 2 child"}]}]}},{title:"limitLines",highlightProps:["limitLines"],demoData:fy([5,3,3]),demo:{view:"tree",item:"text:title",limitLines:7}}]};function py(n){function t(o,l,c,f,d,g){return g===!1&&(g=c.length),o.classList.add("incomplete"),c.slice(d,d+g).reduce((y,b)=>y.then(()=>{let{container:k,itemConfig:C}=l;return n.view.render(k,n.view.composeConfig(C,{expanded:b.expanded,last:b.last,hasChildren:b.hasChildren,children:b.children}),b.data,f).then(()=>{if(b.expanded&&b.hasChildren){let E=k.lastChild.querySelector(".view-tree-leaf-children");E.classList.add("incomplete"),l={container:E,itemConfig:n.view.composeConfig(C,C.itemConfig),prev:l}}else for(;b.shift--;)l.container.classList.remove("incomplete"),l=l.prev})}),Promise.resolve()).then(()=>n.view.maybeMoreButtons(o,null,c.length,d+g,g,(y,b)=>t(o,l,c,f,y,b))||o.classList.remove("incomplete"))}function i(o,l,c,f){function d(b,k,C,E=0){b.forEach((M,O,L)=>{let S=n.query(C.children,M,l),T=Array.isArray(S)&&S.length>0,N=O===L.length-1,A=y.has(M)?0:typeof k=="function"?k(M,l):k;y.add(M),g.push({data:M,expanded:A,last:N,hasChildren:T,children:A?null:C.children,shift:N&&(!A||!T)?E+1:0}),T&&A&&d(S,typeof k=="number"?k-1:k,n.view.composeConfig(C,C.itemConfig),N?E+1:0)})}let g=[],y=new Set;return d(o,f,c),g}n.view.define("tree",function(l,c,f,d){let{children:g="children",item:y="text",itemConfig:b,collapsible:k,emptyText:C,onToggle:E}=c,{expanded:M,limit:O,limitLines:L=!0}=c;if(C!==!1&&C!==""&&l.setAttribute("emptyText",C||"Empty tree"),!Array.isArray(f)&&f&&(f=[f]),Array.isArray(f)){if(O=n.view.listLimit(O,25),L=n.view.listLimit(L,25),M=typeof M=="function"?M:n.view.listLimit(M,1),L){let S=i(f,d,this.composeConfig({children:g},b),M),T={container:l,itemConfig:this.composeConfig({view:"tree-leaf",itemConfig:b,content:y,collapsible:k,onToggle:E},b)};return t(l,T,S,d,0,L)}return this.renderList(l,this.composeConfig({view:"tree-leaf",itemConfig:b,content:y,collapsible:k,expanded:M,children:g,limit:O,onToggle:E},b),f,d,0,O)}},{tag:"ul",usage:dy})}var wS=`#.props | {
    $items: children.query(@, #.context) | is array?;

    itemConfig,
    content is not undefined ?: 'text',
    collapsible is not undefined ?: true,
    onToggle,
    expanded,
    last,
    hasChildren: hasChildren or $items.size() > 0,
    children,
    $items,
    limit: limit | $ = false or is int ?: 25
}`;function hy(n){let t=new WeakMap,i=({target:o})=>{let l=o.closest(".view-tree-leaf-toggle");if(l){let c=t.get(l),f=!l.parentNode.classList.toggle("collapsed");typeof c.render=="function"&&c.render(),typeof c.onToggle=="function"&&c.onToggle(f,l.parentNode,c.data,c.context)}};n.addHostElEventListener("click",i,!1),n.view.define("tree-leaf",async function(o,l,c,f){let{expanded:d,hasChildren:g,children:y,items:b,content:k,itemConfig:C,collapsible:E,last:M,limit:O,onToggle:L}=l,S=o.appendChild(U("span","view-tree-leaf-toggle")),T=o.appendChild(U("span","view-tree-leaf-content"));if(M&&o.classList.add("last"),E||o.classList.add("non-collapsible"),await this.render(T,k,c,f),g){let N=o.appendChild(U("ul","view-tree-leaf-children")),A={data:c,context:f,onToggle:L,render:null},j=(I,z)=>(typeof z=="number"&&z--,this.renderList(N,this.composeConfig({view:"tree-leaf",expanded:z,itemConfig:C,content:k,collapsible:E,children:y,limit:O,onToggle:L},C),I,f,0,this.listLimit(O,25)));o.classList.add("has-children"),t.set(S,A),(typeof d=="function"?d(c,f):d)?b&&await j(b,d):(o.classList.add("collapsed"),b&&(A.render=()=>{A.render=null,j(b,d||1)}))}},{tag:"li",props:wS})}var ha={};Ae(ha,{default:()=>gy,discovery:()=>Py,notFound:()=>my,viewsShowcase:()=>Ny});function gy(n){n.page.define("default",{view:"switch",content:[{when:"not #.datasets",content:[{view:"h1",className:"no-data-loaded",content:'text:"Discovery.js"'},{view:"markdown",when:"#.meta.description",source:"=#.meta.description"},'html:"<br>"',"preset/upload"]},{content:['page-header{ content: "h1:#.name" }',{view:"struct",expanded:1}]}]})}function my(n){n.page.define("not-found",['alert-warning:"Page `" + name + "` not found"'])}var ua={};Ae(ua,{decode:()=>yi,decodeBase64Bytes:()=>xy,encode:()=>mi,encodeBytes:()=>wy});var yy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mc=new Uint8Array(64),vy=new Uint8Array(256),xS=new TextEncoder,by=new TextDecoder;for(let n=0;n<yy.length;n++){let t=yy.charCodeAt(n);vy[t]=n,mc[n]=t}function mi(n){return by.decode(wy(n))}function wy(n){typeof n=="string"&&(n=xS.encode(n));let t=new Uint8Array(Math.ceil(n.length/3)*4),i=0,o=0,l=0;for(let c=0;c<n.length;c++)for(o=o<<8|n[c],l+=8;l>=6;){let f=o>>(l-=6);t[i++]=mc[f],o-=f<<l}for(l!==0&&(t[i++]=mc[o<<6-l]);i<t.length;)t[i++]=61;return t}function yi(n){return by.decode(xy(n))}function xy(n){let t=n.length;for(;t>0&&n[t-1]==="=";)t--;let i=new Uint8Array(3*Math.ceil(t/4)),o=0,l=0,c=0;for(let f=0;f<t;f++)if(l=l<<6|vy[n.charCodeAt(f)&255],c+=6,c>8){let d=l>>(c-=8);i[o++]=d,l-=d<<c}return c!==0&&(i[o++]=l),i.subarray(0,(t>>2)*3+(t%4*6>>3))}function yc(n,t){return typeof n=="string"?n:t||""}var ky=["query","graph","view","title","dzen","noedit"],kS=["q","graph","v","title","dzen","noedit"];function Cy(n){let{query:t,graph:i,view:o,title:l,dzen:c,noedit:f,...d}=typeof n=="string"?{query:n}:n,g=[];return c&&g.push(["dzen"]),f&&g.push(["noedit"]),l&&g.push(["title",l]),t&&g.push(["q",mi(t)]),i&&g.push(["graph",mi(JSON.stringify(i))]),typeof o=="string"&&g.push(o?["v",mi(o)]:["v"]),Object.keys(d||{}).sort().forEach(y=>{ky.includes(y)||g.push([y,y.endsWith("-b64")&&typeof d[y]=="string"?mi(d[y]):d[y]])}),g}function Sy(n){let t=Object.fromEntries(n),i={title:t.title||"",query:yi(yc(t.q,"")),graph:JSON.parse(yi(yc(t.graph,""))||"null"),view:"v"in t?yi(yc(t.v,"")):void 0,dzen:"dzen"in t,noedit:"noedit"in t};return Object.keys(t).forEach(o=>{kS.includes(o)||(i[o]=o.endsWith("-b64")&&typeof t[o]=="string"?yi(t[o]):t[o])}),i}function CS(n){return Object.fromEntries(Object.entries(n).filter(([t])=>!ky.includes(t)))}function vc(n,t,...i){for(let o of Object.keys(n))if(n[o]!==t[o]&&!i.includes(o))return!1;for(let o of Object.keys(t))if(n[o]!==t[o]&&!i.includes(o))return!1;return!0}function ca(n,t={}){let i={...n,params:CS(n.params)};return!vc(t,i,"params","actions")||!vc(t.params,i.params)||!vc(t.actions,i.actions)?i:t}function SS(n){return n.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/'/g,"\\'")}function TS(n){let{title:t,query:i,view:o}=n,l={title:t,query:i,view:o};return`{
${Object.keys(l).reduce((c,f)=>c.concat(l[f]?`    ${f}: '${SS(l[f])}'`:[]),[]).join(`,
`)}
}`}function AS(n){if(n&&(typeof n=="number"||typeof n=="string")){let t=new Date(n);return isNaN(t)?null:t}return n instanceof Date?n:null}function Ty(n){let t=AS(n);return t?t.toISOString().replace(/^(\d{4})-(\d{2})-(\d{2})T([\d:]+).*/,"$3/$2/$1 $4 UTC"):null}function Ay(n,t){let i,o,l,c,f=new n.view.Popup({render:(b,k,C)=>n.view.render(b,{view:"menu",data:[{text:"Copy page permalink",disabled:!n.action.has("permalink"),action:async()=>kt(await n.action.call("permalink",n.pageHash))},{text:"Copy page hash",action:()=>kt(n.pageHash)},{text:"Copy page as JSON",action:()=>kt(TS(n.pageParams))}],onClick(E){C(),E.action()}})}),d=U("div","discovery-actions",[c=U("button",{class:"edit-mode discovery-hidden-in-dzen",title:"Toggle edit mode",onclick:({target:b})=>{b.blur(),t({noedit:!n.pageParams.noedit})}}),U("button",{class:"share",title:"Sharing",onclick:({target:b})=>{b.blur(),f.show(b)}}),U("button",{class:"toggle-fullscreen",title:"Toggle full page mode",onclick:({target:b})=>{b.blur(),t({dzen:!n.pageParams.dzen})}})]),g=b=>{b.parentNode.dataset.title=b.value||b.placeholder},y=U("div","discovery-header",[U("div",{class:"discovery-header-text","data-title":"\xA0"},[i=U("input",{class:"discovery-hidden-in-dzen",placeholder:"Untitled discovery",oninput:({target:b})=>{g(b)},onchange:({target:b})=>{g(b),t({title:b.value},!0)},onkeypress:b=>{(b.charCode===13||b.keyCode===13)&&b.target.blur()}}),U("span","timestamp",[o=U("span",null,"&nbsp;"),l=U("span")])])]);return{el:[d,y],render(b,k){let{title:C,noedit:E}=k.params,M=Ty(k.datasets?.[0]?.resource?.createdAt);i.value=C,g(i),c.classList.toggle("disabled",E),o.innerText=M?"Data collected at "+M+" | ":"",l.innerText="Rendered at "+Ty(new Date)}}}function Ey(n,t,i){return n.length?`${n.length} ${n.length===1?t:i}`:"empty"}function bc(n){return Array.isArray(n)?`Array (${Ey(n,"element","elements")})`:n&&typeof n=="object"?`Object (${Ey(Object.keys(n),"entry","entries")})`:`Scalar (${n===null?"null":typeof n})`}function wc(n,t){let i=document.createElementNS("http://www.w3.org/2000/svg",n);if(t)for(let[o,l]of Object.entries(t))i.setAttribute(o,l);return i}function ES(n,t,i){function o(){return n.appendChild(U("div","query-graph-box"))}function l(f,d,g,y){Array.isArray(y)||(y=[]),f||(f=o());let b=y.length===1,k=y.length>1,C=f.appendChild(U("div",{"data-path":g.join(" "),class:`query-graph-node${b?" target":k?" current":""}`}));if(i.view.attachTooltip(C,{className:"query-graph-tooltip",content:b?'badge:"Current query"':{view:"source",data:d.query?{syntax:"jora",content:d.query||"",lineNum:!1}:{content:"<empty query>",lineNum:!1}}}),Array.isArray(d.children))for(let E=0;E<d.children.length;E++){let M=l(f.nextSibling,d.children[E],g.concat(E),y[1]===E?y.slice(1):[]);c.push([C,M])}return C}let c=[];for(let f=0;f<t.children.length;f++)l(n.firstChild,t.children[f],[f],t.current[0]===f?t.current:[]);requestAnimationFrame(()=>{let f=n.appendChild(wc("svg"));for(let[d,g]of c){let y=Ft(d,f),b=Ft(g,f),k=y.right-2,C=y.top+y.height/2,E=b.left+2,M=b.top+b.height/2,O=(E-k)/3;f.append(C===M?wc("line",{stroke:"#888",x1:k,y1:C,x2:E,y2:M}):wc("path",{stroke:"#888",fill:"none",d:`M ${k} ${C} C ${k+2*O} ${C} ${E-2*O} ${M} ${E} ${M}`}))}})}function LS(n){Array.isArray(n.current)||(n.current=[]),n.current.length===0&&n.current.push(0),Array.isArray(n.children)||(n.children=[]),n.children.length===0&&n.children.push({})}function fa(n,t){let i=[n],o=n;for(let l=0;l<t.length;l++)o=o.children[t[l]],i.push(o);return i}function Ly(n,t){let i=!1,o=NaN,l=!1,c=NaN,f,d,g=null,y,b=null,k=null,C=[],E={},M,O=(V,ee,ie,me)=>n.querySuggestions(V,ee,ie,me),L=new n.view.QueryEditor(O).on("change",V=>M.checked&&t({query:V},!0)),S=n.getQueryEngineInfo(),T=U("div","query-graph-actions"),N=U("div","buttons"),A=U("div","query-input"),j=U("div","query-input-details"),I=U("div","data-query-result"),z=U("div","data-query-result-details"),W=U("div","query-graph"),H=U("div","query-path"),te=U("div","form query-editor-form",[W,H,U("div","query-editor",[L.el])]);L.inputPanelEl.append(T,A,j,U("a",{class:"view-link query-engine",href:S.link,target:"_blank"},[`${S.name} ${S.version||""}`])),L.outputPanelEl.append(I,N,z);let _=(V,ee=V)=>({position:"trigger",className:"hint-tooltip",showDelay:!0,content:{view:"context",data:()=>g.current.length<2?ee:V,content:"text"}});function $(V=""){Q(({nextGraph:ee,last:ie})=>(Array.isArray(ie.children)||(ie.children=[]),ie.query=f,ie.view=d,ee.current.push(ie.children.push({})-1),{query:V,view:void 0,graph:ee}))}n.view.render(T,[{view:"button",className:"subquery",tooltip:_("Create a new query for a result of current one"),onClick:$},{view:"button",className:"stash",tooltip:_("Stash current query and create a new empty query for current parent","Stash current query and create a new empty query"),onClick(){Q(({nextGraph:V,last:ee,preLast:ie})=>(ee.query=f,ee.view=d,V.current[V.current.length-1]=ie.children.push({})-1,{query:"",view:void 0,graph:V}))}},{view:"button",className:"clone",tooltip:_("Clone current query"),onClick(){Q(({nextGraph:V,last:ee,preLast:ie})=>(ee.query=f,ee.view=d,V.current[V.current.length-1]=ie.children.push({})-1,{graph:V}))}},{view:"button",className:"delete",tooltip:_("Delete current query and all the descendants"),onClick(){Q(({nextGraph:V,last:ee,preLast:ie})=>{let me=ie.children.indexOf(ee),ye=ie.query;if(ie.children.splice(me,1),ie.children.length===0&&(ie.children=void 0),V.current.pop(),V.current.length===0){let ae=Math.max(0,Math.min(me-1,(V.children?.length||0)-1));V.current.push(ae),ye=V.children?.[ae]?.query}return{query:ye,graph:V}})}}]),N.append(U("label","view-checkbox",[M=U("input",{class:"live-update",type:"checkbox",checked:!0,onchange:V=>{V.target.checked&&t({query:L.getValue()},!0)}}),U("span","view-checkbox__label","process on input")])),n.view.render(N,{view:"button-primary",content:'text:"Process"',onClick:()=>{C=C.slice(0,g.current.length-1),t({query:L.getValue()},!0),n.scheduleRender("page")}}),H.addEventListener("click",V=>{let ee=[...H.children].indexOf(V.target.closest(".query-path > *"));ee!==-1&&Q(({nextGraph:ie,currentPath:me,last:ye})=>{ye.query=f,ie.current=ie.current.slice(0,ee+1),t({query:me[ee+1].query,graph:ie})})}),W.addEventListener("click",V=>{let ee=V.target.dataset.path;typeof ee=="string"&&ee!==g.current.join(" ")&&Q(({nextGraph:ie,last:me})=>{let ye=ee.split(" ").map(Number),ae=fa(ie,ye),ke=ae[ae.length-1],Xe=ke.query,_t=ke.view;return ke.query=void 0,ke.view=void 0,me.query=f,me.view=d,ie.current=ye,{query:Xe,view:_t,graph:ie}})});function D(V,ee=!0,ie=!0){t(V,ie),ee&&setTimeout(()=>{L.focus(),L.cm.setCursor(L.cm.lineCount(),0)},0)}function Q(V){let ee=JSON.parse(JSON.stringify(g)),ie=fa(ee,ee.current),me=ie[ie.length-1],ye=ie[ie.length-2],ae=V({nextGraph:ee,currentPath:ie,last:me,preLast:ye});D(ae,!0)}function X(V){let ee=setTimeout(V,16);return()=>clearTimeout(ee)}function de(V){A.innerHTML="",A.append(U("div",{class:"query-input-data",onclick(){i=i==="data"?!1:"data",De(V)}},[U("span",{class:"query-input-variable","data-name":"input"},["@"]),V.state==="awaiting"?"Computing...":V.state==="canceled"?"Not available (undefined)":bc(V.data)]),U("div",{class:"query-input-context",onclick(){i=i==="context"?!1:"context",De(V)}},[U("span",{class:"query-input-variable","data-name":"context"},["#"]),V.state==="awaiting"?"Computing...":V.state==="canceled"?"Not available (undefined)":bc(V.context)])),De(V)}function De(V){if(L.inputPanelEl.classList.toggle("details-expanded",i),A.dataset.details=i,i){let ee=V.state!=="awaiting"&&V.state!=="canceled"?V[i]:NaN;ee!==o&&(o=ee,V.state==="awaiting"?j.textContent="Computing...":V.state==="canceled"?j.textContent="Not available because one of ancestor queries failed":(j.innerHTML="",n.view.render(j,[{view:"struct",expanded:1}],o)))}else o=NaN,j.innerHTML=""}function Be(V,ee,ie){ie||(ie=ee,ee=null);let me=[U("span","query-output-message",Array.isArray(ie)?ie:[ie])];ee&&me.unshift(U("span","query-output-prelude",[ee])),I.replaceChildren(U("div",{class:"query-result-data"+(V.state==="failed"?" error":""),onclick(){l=!l,Ot(V)}},me))}function Ke(V){switch(b&&(b.clear(),b=null),V.state){case"canceled":{L.setValue(V.query),Be(V,"Result","Not available");break}case"awaiting":{L.setValue(V.query),Be(V,"Avaiting...");break}case"computing":{L.setValue(V.query,V.data,V.context),Be(V,"Computing...");break}case"successful":{L.setValue(V.query,V.data,V.context),Be(V,"Result",[bc(V.computed),` in ${parseInt(V.duration,10)}ms`]);break}case"failed":{let{error:ee}=V,ie=ee?.details?.loc?.range,me=L.cm.doc;if(Array.isArray(ie)&&ie.length===2){let[ye,ae]=ie;b=ee.details?.token==="EOF"||ye===ae||V.query[ye]===`
`?me.setBookmark(me.posFromIndex(ye),{widget:U("span","discovery-editor-error"," ")}):me.markText(me.posFromIndex(ye),me.posFromIndex(ae),{className:"discovery-editor-error"})}L.setValue(V.query,V.data,V.context),Be(V,"Error",[ee.message.split(/\n/)[0].replace(/^(Parse error|Bad input).+/s,"Parse error")]);break}}Ot(V)}function Ot(V){if(L.outputPanelEl.classList.toggle("details-expanded",l),l){let ee=V.state!=="awaiting"&&V.state!=="canceled"&&V.state!=="computing"?V.error||V.computed:NaN;if(ee!==c)switch(c=ee,V.state){case"awaiting":z.innerHTML='<div class="state-message">Awaiting for all of ancestor queries done<div>';break;case"canceled":z.innerHTML='<div class="state-message">Not available because one of ancestor queries failed<div>';break;case"failed":z.innerHTML='<div class="discovery-error query-error">'+Ge(V.error.message)+"</div>";break;case"successful":z.innerHTML="",n.view.render(z,{view:"struct",expanded:1},c);break}}else c=NaN,z.innerHTML=""}function Ue(V){let ee=V.path.join(" "),ie=W.querySelector(`[data-path="${ee}"]`);ie&&(ie.dataset.state=V.state),C[g.current.length-1]===V&&(de(V),Ke(V))}function Ye(V,ee,ie,me){k&&(k.cancel(),k.computation.state="canceled",k=null);let ye=!1;if(me)for(let ae=V;ae<g.current.length;ae++){let ke=C[ae];ke.state!=="computing"&&Ue(ke)}for(let ae=V;ae<g.current.length;ae++){let ke=C[ae],Xe=ae===g.current.length-1;if(ke.state==="awaiting"&&(ke.state="computing"),ke.state==="failed"?ye=!0:ye&&(ke.state="canceled"),ke.state!=="computing"){if(ee=ke.computed,ie=ke.context,Ue(ke),Xe)return Promise.resolve(ke);continue}return new Promise((_t,Ee)=>{ke.data=ee,ke.context=ie,Ue(ke),k={computation:ke,cancel:X(()=>{let Pe=Date.now();k=null;try{ke.computed=n.query(ke.query,ke.data,ke.context),ke.state="successful"}catch(We){ke.error=We,ke.state="failed"}ke.duration=Date.now()-Pe,Ye(ae,ee,ie).then(_t,Ee)})}})}}function Fe(V,ee){let ie=fa(g,g.current).slice(1),me=-1,ye=null;for(let ae=0;ae<g.current.length;ae++){let ke=ie[ae],Xe=C[ae]||{},Ee=ae===g.current.length-1?f:ke.query,Pe=g.current.slice(0,ae+1);if(me===-1&&Xe.query===Ee&&Xe.data===V&&Xe.context===ee&&String(Xe.path)===String(Pe)){V=Xe.computed,ye=Xe.error;continue}let We=C[ae]={state:"awaiting",path:g.current.slice(0,ae+1),query:Ee,data:void 0,context:void 0,computed:void 0,error:null,duration:0};if(ye){We.state="canceled";continue}if(me===-1){me=ae,We.state="computing",We.data=V,We.context=ee;continue}}return me!==-1?C.slice(me,g.current.length):[]}return{el:te,createSubquery:$,appendToQuery(V){let ee=f.trimRight()!==""?f.replace(/(\n[ \t]*)*$/,()=>`
| `+V):V;D({query:ee},!0,!0)},perform(V,ee){let ie=ca(ee,y),me=ee.params.query,ye=ee.params.view,ae={...ee.params.graph||E};LS(ae),T.classList.toggle("root",ae.current.length<2),W.innerHTML="",ES(W,ae,n),H.innerHTML="";for(let ke of fa(ae,ae.current).slice(1,-1))H.append(U("div","query",ke.query||""));return g=ae,y=ie,f=me,d=ye,Fe(V,ie),Ye(0,V,ie,!0)}}}function da(n){return!!(n&&n.nodeType===Node.TEXT_NODE)}function xc(n,t=`
`){let i="";for(let o of n.childNodes)!da(o)&&o.previousSibling&&!da(o.previousSibling)&&(i+=t),i+=MS(o,t);return i}function MS(n,t=`
`){switch(n.nodeType){case Node.ELEMENT_NODE:let[i,o=""]=n.cloneNode().outerHTML.split(/(?=<\/[^>]+>$)/);return i+(n.firstChild&&!da(n.firstChild)?t+"  ":"")+xc(n,t+"  ")+(n.lastChild&&!da(n.lastChild)?t:"")+o;case Node.TEXT_NODE:return n.nodeValue;case Node.COMMENT_NODE:return"<!--"+n.nodeValue+"-->";case Node.DOCUMENT_FRAGMENT_NODE:return xc(n,t)}return""}function My(n,t){let i=[],o=[...Array.isArray(n.highlight)?n.highlight:n.highlight?[n.highlight]:[]];Array.isArray(n.highlightProps)&&o.push(`(")?(?:${n.highlightProps.join("|")})\\1(?=:)`);for(let l of o){let c=new RegExp(l,"gm"),f;for(;f=c.exec(t);)i.push({range:[f.index,f.index+f[0].length]})}return i}function pa(n){let t={view:"context",modifiers:[{view:"switch",when:"beforeDemo",content:[{when:({beforeDemo:i})=>typeof i=="string",content:'html:"<p>" + beforeDemo + "</p>"'},{content:{view:"render",config:"beforeDemo",context:"{ __demoContext: true, ...(viewDef | { name, group, options }) }"}}]},{view:"block",when:"demo or view",className:"usage-render",postRender:(i,{onInit:o},{demoFixed:l})=>{l&&(i.classList.add("demo-fixed"),i.style.height=l+"px"),o(i,"root")},content:{view:"render",config:"demo or view",data:"demoData",context:"{ __demoContext: true, ...(viewDef | { name, group, options }) }"}},{view:"switch",when:"afterDemo",content:[{when:({afterDemo:i})=>typeof i=="string",content:'html:"<p>" + afterDemo + "</p>"'},{content:{view:"render",config:"afterDemo",context:"{ __demoContext: true, ...(viewDef | { name, group, options }) }"}}]}],content:{view:"tabs",when:"source != false",className:"usage-sources",name:"code",tabs:[{value:"config",text:"Config (JS)"},{value:"config-json",text:"Config (JSON)"},{value:"html",text:"Rendered HTML"}],content:{view:"switch",content:[{when:'#.code="config"',content:[{view:"expand",when:'"demoData" in $',header:'text:"Input data"',content:{view:"struct",expanded:2,data:"demoData"}},{view:"source",className:"first-tab",data:i=>{let o=Zn(i.demo||i.view);return{syntax:"discovery-view",content:o,refs:My(i,o)}}}]},{when:'#.code="config-json"',content:[{view:"expand",when:'"demoData" in $',header:'text:"Input data"',content:{view:"struct",expanded:2,data:"demoData"}},{view:"source",data:i=>{let o=JSON.stringify(i.demo||i.view,null,4);return{syntax:"json",content:o,refs:My(i,o)}}}]},{when:'#.code="html"',content:{view:"source",data:(i,o)=>({syntax:"html",content:xc(o.root)})}}]}}};return{view:"block",className:"discovery-view-usage",data({name:i,options:o},l){let c=[...n.view.values].filter(f=>f.options.usage===o.usage).map(f=>f.name);return c.includes(i)||c.unshift(i),l.viewDef={demo:{view:i,data:'"'+i+'"'},...typeof o.usage=="function"?o.usage(i,c):Array.isArray(o.usage)?{examples:o.usage}:o.usage,name:i,group:c,options:o}},content:["h1:name",t,{view:"list",data:"examples",whenData:!0,itemConfig:{className:"usage-section"},item:["h2{ anchor: true, data: title }",t]}]}}var Dy=`{
    view: 'struct',
    expanded: 1
}`,DS=[{name:"Table",content:Zn({view:"table"})},{name:"Auto-link list",content:Zn({view:"ol",item:"auto-link"})},{name:"Signature",content:Zn({view:"signature",expanded:2})}];function OS(n,t,i){return U("div",{class:"discovery-editor-tab",onclick:()=>i({view:t})},n||"Untitled preset")}function Oy(n,t){let i=DS,o={},l,c,f,d,g,y,b=new n.view.ViewEditor(n).on("change",M=>y.checked&&t({view:M},!0)),k=U("div","buttons"),C=U("div","form view-editor-form",[U("div","view-editor-form-header",[U("div","discovery-editor-tabs view-mode",g=["Default","Custom"].map(M=>U("div",{class:"discovery-editor-tab","data-mode":M.toLowerCase(),onclick:()=>t({view:M==="Default"?void 0:Dy},!0)},M))),U("div","discovery-editor-tabs presets",i.map(({name:M,content:O})=>OS(M,O,t))),U("div","view-editor-form-header-links",'<a href="#views-showcase" class="view-link">Views showcase</a>')]),l=U("div",{class:"view-editor-form-content",hidden:!0},[U("button",{class:"view-button formatting",title:"Prettify (input should be a JSON)",onclick(){b.focus();try{let M=b.getValue().trim(),O=new Function("return 0,"+M)();t({view:Zn(O)})}catch(M){n.log("error","View editor prettify failed:",M)}}}),b.el,U("div","editor-toolbar",[c=U("div","view-expand",[U("div",{class:"header",onclick:()=>{c.classList.toggle("expanded"),d.classList.toggle("visible")}},[f=U("div","header-content"),U("div","trigger")]),d=U("div","view-editor-view-list")]),U("label","view-checkbox",[y=U("input",{class:"live-update",type:"checkbox",checked:!0,onchange:M=>{M.target.checked&&t({view:b.getValue()},!0)}}),U("span","view-checkbox__label","build on input")]),k])])]);n.view.render(k,{view:"button-primary",content:'text:"Build"',onClick:()=>{o={},t({view:b.getValue()},!0),n.scheduleRender("page")}}),new n.view.Popup({className:"view-editor-view-list-hint",hoverTriggers:".view-editor-view-list .item.with-usage",render:function(M,O){n.view.render(M,pa(n),n.view.get(O.textContent),{})}}),f.textContent=`Available ${[...n.view.entries].filter(([,M])=>M.options.usage).length} views`;let E=()=>d.innerHTML='<a href="#views-showcase" class="view-link">Views showcase</a><br><br>'+[...n.view.entries].sort().map(([M,O])=>`<div><a class="item view-link${O.options.usage?" with-usage":""}" ${O.options.usage?'href="#views-showcase:'+M+'"':""}>${M}</a></div>`).join("");return E(),n.view.on("define",In(E,100)),{el:C,render(M,O,L){let S=ca(O,o.context),T=typeof O.params.view=="string"?"custom":"default",N=O.params.view,A=null;if(b.setValue(N),l.hidden=T!=="custom",g.forEach(j=>j.classList.toggle("active",j.dataset.mode===T)),!N&&T==="default"&&(N=Dy),o.view!==N||o.data!==M||o.context!==S){L.innerHTML="";try{A=Function("return "+(N?"0,"+N:"null"))(),n.view.render(L,A,M,S)}catch(j){n.view.render(L,I=>{I.className="discovery-error render-error",I.innerHTML=Ge(String(j))+"<br>(see details in console)",n.log("error",j)})}o={data:M,context:S,view:N}}}}}function Py(n){function t(b,k){return n.setPageParams({...n.pageParams,...b},k)}function i(){if(f!==null)return f;let b=Ay(n,t),k=Ly(n,t),C=Oy(n,t),E=U("div",{class:"discovery-editor discovery-hidden-in-dzen",hidden:!0},[k.el,C.el]),M=U("div","discovery-render-content"),O=[...b.el,E,M];return f={header:b,queryEditor:k,viewEditor:C,discoverEditorEl:E,discoverContentEl:M,layout:O}}function o(b){return b===g}function l(b,k){o(k)&&i().queryEditor.createSubquery(b)}function c(b,k){o(k)&&i().queryEditor.appendToQuery(b)}let f=null,d=null,g=NaN,y=null;n.on("pageHashChange",()=>{y!==n.pageId&&(n.pageId===n.discoveryPageId?(n.action.define("queryAcceptChanges",o),n.action.define("querySubquery",l),n.action.define("queryAppend",c)):(n.action.revoke("queryAcceptChanges"),n.action.revoke("querySubquery"),n.action.revoke("queryAppend")),y=n.pageId)}),n.page.define("discovery",function(b,k,C){let{header:E,queryEditor:M,viewEditor:O,discoverEditorEl:L,discoverContentEl:S}=i();L.hidden=C.params.noedit,E.render(k,C),g=NaN;let T=d={};M.perform(k,C).then(N=>{if(d===T){if(N.error){O.el.hidden=!0,S.hidden=!0;return}g=N.computed,O.el.hidden=!1,S.hidden=!1,O.render(g,C,S)}})},{reuseEl:!0,init(b){i().layout.forEach(k=>b.appendChild(k))},encodeParams:Cy,decodeParams:Sy})}var PS="\n## Working with views\n\nIn Discovery.js, presentations are organized as a tree of views. Views are defined using object notation, where the `view` property specifies the type, and additional properties allow further customization.\n\n```discovery-view\n{\n    view: \"view-name\"\n}\n```\n\nA view definition takes `data` and `context` values, which can be used to define properties and control rendering. Views can transform data and context (using the `data` and `context` properties) for use by the view and its descendant views, enabling clear data flow. Views are rendered by calling the render method:\n\n```js\ndiscovery.render(containerEl, viewDefinition, data, context)\n```\n\nDiscovery.js is designed to be declarative. For dynamic calculations or event handling, [jora](https://discoveryjs.github.io/jora/) queries are preferred over JavaScript functions.\n\nEach view can use the following properties:\n\n- `view` (required) \u2014 Specifies the view type.\n- `when` \u2014 Controls whether the view should be rendered. Evaluated before `data` transformation.\n- `context` \u2014 Transforms the input context for the view and its nested views.\n- `data` \u2014 Transforms the input data for the view and its nested views.\n- `whenData` \u2014 Controls rendering based on the computed `data`. Evaluated after `context` and `data` are set.\n- `className` \u2014 Adds CSS class name(s) to the root element of the view.\n- `postRender` \u2014 A function executed after rendering the view but before placing it in the DOM.\n- `tooltip` \u2014 Sets up a tooltip for the view (only applicable to views with a container element).\n\nThe sequence of property evaluation during rendering (view render lifecycle):\n\n```\n[start]               render(data, context)\n \\                          |     |\n  * when()                  |     | // stop rendering when value is falsy\n  |\\                        |     |\n  | * context() ------------|-----* // replace `context` with new value\n  |  \\                      |     |\n  |   * data() -------------*     | // replace `data` with new value\n  |    \\                    |     |\n  |     * whenData()        |     | // stop rendering when value is falsy\n  |     |\\                  |     |\n  |     | * (render)        |     |\n  |     |  \\                |     |\n  |     |   * postRender()  |     |\n  |     |    \\              |     |\n  |     |     * className() |     |\n  |     |      \\            V     V\n  +-----+-----> * [finish render]\n```\n\n- `context` and `data` \u2014 Modify the flow of context or data based on the provided value:\n  - **String** \u2014 Treated as a jora query, and its result is used.\n  - **Function** (`fn(data, context)`) \u2014 The result of the function invocation is used.\n  - **Other values** \u2014 Directly used as a new value for data or context.\n- `when` and `whenData` \u2014 Determine if a view should be rendered:\n  - **String** \u2014 Treated as a jora query.\n  - `true` \u2014 Evaluated as an empty query, meaning the data itself is tested for truthiness.\n  - `undefined` \u2014 Treated as not specified, allowing rendering.\n  - **Function** (`fn(data, context)`) or other values \u2014 Evaluated for truthiness.\n  > Note: In jora, empty arrays and objects with no own keys are falsy, unlike JavaScript where they are truthy.\n\n```discovery-view\n{\n    view: 'list',\n    data: 'some.list.sort(name asc)', // Fetch an array for the list view, based on current data\n    whenData: 'size() > 0',  // Check if the array has elements, skip rendering if empty\n    item: 'text:name' // Render each element as text, displaying the name\n}\n```\n\n## Computable property values\n\nIf a property starts with `=`, it indicates a jora query used to compute the property's value before a rendering.\n\n```discovery-view\n{\n    view: 'list',\n    limit: '=size() <= 12 ? false : 10' // Dynamically computes the limit based on flow data\n}\n```\n\n> To pass a literal string that starts with `=`, use a query like `'=\"=some string\"'`.\n\n## Shorthand notations\n\nDiscovery.js supports shorthand notations for defining views, making the configuration more concise:\n\n| Shorthand notation                      | Expanded form                                      |\n| --------------------------------------- | -------------------------------------------------- |\n| `'name'`                                | `{ view: 'name' }`                                 |\n| `'name:<query>'`                        | `{ view: 'name', data: '<query>' }`                |\n| `'name{ foo: size() / 2, bar: \"qux\" }'` | `{ view: 'name', foo: '=size() / 2', bar: 'qux' }` |\n\n## Lists of views\n\nMultiple views can be combined into a list using an array:\n\n```discovery-view\n{\n    view: 'list',\n    item: [ // render two views as a content of a list item\n        'text:name',\n        { view: 'badge', data: 'something.size()' }\n    ]\n}\n```\n\n## Tooltips\n\nTooltips can be configured using a simple view definition or an object with additional settings. When the `tooltip` value is a view definition, it becomes the `content` of the tooltip.\n\n```discovery-view\n{\n    view: 'button',\n    tooltip: 'md:\"Some **content**\"'\n}\n```\n\n```discovery-view\n{\n    view: 'button',\n    tooltip: {\n        position: 'trigger',\n        content: 'md:\"Some **content**\"'\n    }\n}\n```\n\n| Tooltip value                     | Normalized tooltip config                      |\n| --------------------------------- | ---------------------------------------------- |\n| `'shorthand-view-notation'`       | `{ content: 'shorthand-view-notation' }`       |\n| `{ view: 'name', ... }`           | `{ content: { view: 'name', ... } }`           |\n| `['view', { view: 'name', ... }]` | `{ content: ['view', { view: 'name', ... }] }` |\n\nTooltip options:\n\n- `className` \u2014 Additional class names for the tooltip element.\n- `position` \u2014 Where the tooltip is positioned. Options are `'trigger'` or `'pointer'` (default).\n- `positionMode` \u2014 Positioning mode. Options are `'natural'` (default) or `'safe'`.\n- `pointerOffsetX` \u2014 Horizontal offset from the pointer (default: 3).\n- `pointerOffsetY` \u2014 Vertical offset from the pointer (default: 3).\n- `showDelay` \u2014 Delay before showing the tooltip. Options are `true` (300ms, default), `false` (0ms), a number, or a function that returns a boolean or numeric value.\n- `content` \u2014 View configuration for tooltip content.\n";function Ny(n){n.page.define("views-showcase",{view:"context",data:()=>[...n.view.values],modifiers:[{view:"block",className:"sidebar",content:[{view:"link",className:"index-page-link",href:'="".pageLink(#.page)',text:"Index page"},{view:"content-filter",content:{view:"menu",name:"view",limit:!1,emptyText:"Nothing matched",item:"text-match:{ text: name, match: #.filter }",data:`
                                .[name ~= #.filter]
                                .sort(name asc)
                                .({ ..., disabled: no options.usage })
                            `}}]}],content:{view:"block",className:"content",data:"$[=> name=(#.view.name or #.id)]",content:{view:"switch",content:[{when:"no $ and #.id",content:'alert-warning:"View \\"" + #.id + "\\" not found"'},{when:"no $",content:['h1:"Views showcase"','alert:"\u2190 Select a view to get details"',{view:"markdown",source:PS}]},{content:[{view:"context",postRender:function(t,i,o,l){n.setPageRef(o.name),n.cancelScheduledRender(),l.id=n.pageRef}},pa(n)]}]}}},{sidebar:!1})}var NS=["sidebar","page"],IS=n=>n,RS=n=>Object.fromEntries(n);function kc(n,t,i){i?n.dataset[t]=i:delete n.dataset[t]}function BS(n,t,i,o){let l=n.page.get(t)?.options;return l!==void 0&&Le(l,i)?l[i]:o}function Iy(n,t,i,o){let l=BS(n,t,i,o);return typeof l=="function"?l:o}var jo=class extends xo{compact;darkmode;inspectMode;view;nav;preset;page;#e;defaultPageId;discoveryPageId;reportToDiscoveryRedirect;pageId;pageRef;pageParams;pageHash;dom;queryExtensions;constructor(t){let{container:i,styles:o,extensions:l,logLevel:c,compact:f,darkmode:d="disabled",darkmodePersistent:g=!1,defaultPage:y,defaultPageId:b,discoveryPageId:k,reportToDiscoveryRedirect:C=!0,inspector:E=!1}=t||{};super({...t,logLevel:c||"perf",extensions:void 0}),this.compact=!!f,this.darkmode=new Us(d,g),this.inspectMode=new jt(!1),this.initDom(o),this.view=new Ao(this),this.nav=new $s(this),this.preset=new Eo(this.view),this.page=new To(this,this.view),this.#e=new Set,this.initRenderTriggers(),this.defaultPageId=b||"default",this.discoveryPageId=k||"discovery",this.reportToDiscoveryRedirect=!!C,this.pageId=this.defaultPageId,this.pageRef=null,this.pageParams={},this.pageHash=this.encodePageHash(this.pageId,this.pageRef,this.pageParams),this.apply(la),this.apply(ha),this.apply(l),y&&this.page.define(this.defaultPageId,y),E&&this.apply(Fu),this.nav.render(this.dom.nav,this.data,this.getRenderContext()),this.setContainer(i);for(let{name:M,page:O}of this.objectMarkers.values)O&&!this.page.isDefined(O)&&this.log("error",`Page reference "${O}" in object marker "${M}" doesn't exist`)}initRenderTriggers(){this.on("unloadData",()=>this.scheduleRender()),this.action.on("define",()=>{this.context&&this.scheduleRender()}).on("revoke",()=>{this.context&&this.scheduleRender()}),this.page.on("define",t=>{if(this.pageId===t&&this.pageHash!=="#"){let i=this.pageHash;this.pageHash="#",this.setPageHash(i),this.cancelScheduledRender()}})}async setData(t,i,o){o=o||{},await super.setData(t,o),this.context=i||{},(!("render"in o)||o.render)&&this.scheduleRender()}async setDataProgress(t,i,o){let{dataset:l,progressbar:c}=o||{};this.emit("startSetData",(...f)=>c?.subscribeSync(...f)),await c?.setState({stage:"prepare"}),await this.setData(t,i,{dataset:l,setPrepareWorkTitle:c?.setStateStep.bind(c),render:!1}),await c?.setState({stage:"initui"}),this.scheduleRender(),await Promise.all([this.dom.wrapper.parentNode?this.dom.ready:!0,this.#e.timer]),c?.finish()}queryToConfig(t,i){let{ast:o}=en.syntax.parse(i),l={view:t};if(o.type!=="Block")throw new SyntaxError('[Discovery] Widget#queryToConfig(): query root must be a "Block"');if(o.body.type!=="Object")throw new SyntaxError('[Discovery] Widget#queryToConfig(): query root must return an "Object"');for(let c of o.body.properties){if(c.type!=="ObjectEntry")throw new SyntaxError('[Discovery] Widget#queryToConfig(): unsupported object entry type "'+c.type+'"');let f,d=c.value;switch(c.key.type){case"Literal":f=c.key.value;break;case"Identifier":f=c.key.name,d||=c.key;break;case"Reference":f=c.key.name.name,d||=c.key;break;default:throw new SyntaxError('[Discovery] Widget#queryToConfig(): unsupported object key type "'+c.key.type+'"')}if(f==="view"||f==="postRender")throw new SyntaxError('[Discovery] Widget#queryToConfig(): set a value for "'+f+'" property in shorthand notation is prohibited');f==="when"||f==="data"||f==="whenData"?l[f]=d.type==="Literal"&&typeof d.value!="string"?d.value:en.syntax.stringify(d):l[f]=d.type==="Literal"&&(typeof d.value!="string"||d.value[0]!=="=")?d.value:"="+en.syntax.stringify(d)}return l}initDom(t){let i=U("div","discovery"),o=i.attachShadow({mode:"open"}),l=Co(o,t),c=o.appendChild(U("div")),f=U("article"),d=U("div","discovery-nav discovery-hidden-in-dzen"),g=U("nav","discovery-sidebar discovery-hidden-in-dzen"),y=U("main","discovery-content",[f]);this.dom={ready:l,wrapper:i,root:o,container:c,nav:d,sidebar:g,content:y,pageContent:f,detachDarkMode:this.darkmode.subscribe(b=>c.classList.toggle("discovery-root-darkmode",b),!0)},c.classList.add("discovery-root","discovery"),c.append(d,g,y),o.addEventListener("click",b=>{let k=b.target?.closest("a");!k||k.getAttribute("target")||k.origin!==location.origin||k.pathname!==location.pathname||(b.preventDefault(),k.classList.contains("ignore-href")||this.setPageHash(k.hash))},!0)}setContainer(t){t instanceof HTMLElement?t.append(this.dom.wrapper):this.dom.wrapper.remove()}disposeDom(){typeof this.dom.detachDarkMode=="function"&&(this.dom.detachDarkMode(),this.dom.detachDarkMode=null),this.dom.container.remove(),this.dom=null}addGlobalEventListener(t,i,o){return document.addEventListener(t,i,o),()=>document.removeEventListener(t,i,o)}addHostElEventListener(t,i,o){let l=this.dom.container;return l.addEventListener(t,i,o),()=>l.removeEventListener(t,i,o)}scheduleRender(t){if(t===void 0){for(let o of NS)this.scheduleRender(o);return}let i=this.#e;if(!i.has(t)&&(i.add(t),!i.timer))return i.timer=Promise.resolve().then(async()=>{for(let o of i)switch(o){case"sidebar":await this.renderSidebar();break;case"page":await this.renderPage();break}i.timer=null}),i.timer}cancelScheduledRender(t){t?this.#e.delete(t):this.#e.clear()}getRenderContext(){return{page:this.pageId,id:this.pageRef,params:this.pageParams,actions:this.action.actionMap,datasets:this.datasets,data:this.data,...this.context}}renderSidebar(){if(this.#e.delete("sidebar"),this.hasDatasets()&&this.view.isDefined("sidebar")){let t=Date.now(),i=this.data,o=this.getRenderContext();return this.view.setViewRoot(this.dom.sidebar,"sidebar",{data:i,context:o}),this.dom.sidebar.innerHTML="",this.view.render(this.dom.sidebar,"sidebar",i,o).finally(()=>this.log("perf",`Sidebar rendered in ${Date.now()-t}ms`))}}encodePageHash(t,i=null,o){let l=t||this.defaultPageId,f=Iy(this,t,"encodeParams",IS)(o||{});return super.encodePageHash(l!==this.defaultPageId?l:"",i,f)}decodePageHash(t){let{pageId:i,pageRef:o,pageParams:l}=super.decodePageHash(t,c=>Iy(this,c||this.defaultPageId,"decodeParams",RS));return{pageId:i||this.defaultPageId,pageRef:o,pageParams:l}}setPage(t,i=null,o,l=!1){return this.setPageHash(this.encodePageHash(t||this.defaultPageId,i,o),l)}setPageRef(t=null,i=!1){return this.setPage(this.pageId,t,this.pageParams,i)}setPageParams(t,i=!1){return this.setPage(this.pageId,this.pageRef,t,i)}setPageHash(t,i=!1){let{pageId:o,pageRef:l,pageParams:c}=this.decodePageHash(t);return this.reportToDiscoveryRedirect&&o==="report"&&setTimeout(()=>this.pageId==="report"&&this.setPage("discovery",this.pageRef,this.pageParams,!0)),(this.pageId!==o||this.pageRef!==l||!Hs(this.pageParams,c))&&(this.pageId=o,this.pageRef=l,this.pageParams=c,this.scheduleRender("page")),t!==this.pageHash?(this.pageHash=t,this.emit("pageHashChange",i),!0):!1}renderPage(){this.#e.delete("page");let t=this.data,i=this.getRenderContext(),{pageEl:o,renderState:l,config:c}=this.page.render(this.dom.pageContent,this.pageId,t,i);return this.view.setViewRoot(o,"Page: "+this.pageId,{inspectable:!1,config:c,data:t,context:i}),this.dom.pageContent=o,this.nav.render(this.dom.nav,t,i),kc(this.dom.container,"page",this.pageId),kc(this.dom.container,"dzen",!!this.pageParams.dzen),kc(this.dom.container,"compact",!!this.compact),l.then(()=>{if(this.pageParams["!anchor"]){let f=o.querySelector("#"+CSS.escape("!anchor:"+this.pageParams["!anchor"]));if(f){let d=o.querySelector(".view-page-header");f.style.scrollMargin=d?d.offsetHeight+"px":"",f.scrollIntoView(!0)}}}),l}};var zy={inited:{value:0,duration:0,title:"Init"},request:{value:0,duration:.1,title:"Awaiting data"},receiving:{value:.1,duration:.8,title:"Receiving data"},decoding:{value:.9,duration:.015,title:"Decoding data"},received:{value:.915,duration:.01,title:"Await app ready"},prepare:{value:.925,duration:.055,title:"Processing data (prepare)"},initui:{value:.98,duration:.02,title:"Rendering UI"},done:{value:1,duration:0,title:"Done!"},error:{value:1,duration:0,title:"Error"}},jS=n=>n|0,Ry=n=>typeof n=="function"?n:()=>{},By=n=>new Promise(t=>setTimeout(t,n)),zS=async()=>{if(!document.hidden)return Promise.race([new Promise(requestAnimationFrame).then(()=>By(0)),By(12)])};function jy(n,t,i){let{value:o,title:l,duration:c}=zy[n],f=0,d=null;if(t){let{done:g,elapsed:y,units:b,completed:k,total:C}=t;C?(f=g?1:k/C,d=b==="bytes"?Math.round(f*100)+"%":`${k}/${C}`):(f=g?1:.1+Math.min(.9,y/2e4),d=b==="bytes"?(k/(1024*1024)).toFixed(1)+"MB":String(k))}return{stageTitle:l,progressValue:o+f*c,progressText:d,stepText:i||"",title:d?`${l} (${d})${i?":":"..."}`:n!=="done"?`${l}${i?":":"..."}`:l}}var Lr=class extends jt{startTime;lastStageStartTime;awaitRepaintPenaltyTime;finished;awaitRepaint;timings;onTiming;onFinish;appearanceDelay;domReady;el;#e;#t;constructor({onTiming:t,onFinish:i,domReady:o}){super({stage:"inited",progress:null,error:null}),this.startTime=null,this.lastStageStartTime=null,this.awaitRepaintPenaltyTime=0,this.finished=!1,this.awaitRepaint=null,this.timings=[],this.onTiming=Ry(t),this.onFinish=Ry(i),this.domReady=o||Promise.resolve(),this.el=U("div","view-progress skip-fast-track",[U("div","content main-secondary",[this.#e=U("span","main"),this.#t=U("span","secondary")]),U("div","progress")])}recordTiming(t,i,o=performance.now()){let l={stage:t,title:zy[t].title,duration:jS(o-i)};this.lastStageStartTime=o,this.timings.push(l),this.onTiming(l)}async#n(t=!1,i=performance.now()){let o=i-(this.awaitRepaint||0),l=i-(this.lastStageStartTime||0);if(t||o>65&&l>200){let c=performance.now();await zS(),this.awaitRepaintPenaltyTime+=performance.now()-c,this.awaitRepaint=performance.now()}}async setState(t,i){let o=this.value.stage,{stage:l=o,progress:c=null,error:f=null}=t;if(this.finished)return;if(f){this.set("stage"in t?{stage:l,progress:c,error:f}:{...this.value,error:f}),this.finish(f);return}this.set({stage:l,progress:c,error:f});let d=l!==o,g=performance.now();o==="inited"&&(this.startTime=g),d&&(this.lastStageStartTime!==null&&this.recordTiming(o,this.lastStageStartTime,g),this.lastStageStartTime=g,this.awaitRepaint=g);let{title:y,stepText:b,progressValue:k}=jy(l,c,i);this.el.style.setProperty("--progress",String(k)),this.#e.textContent=y,this.#t.textContent=b,this.el.offsetWidth,await this.#n(d,g)}async setStateStep(t){let{title:i,stepText:o}=jy(this.value.stage,this.value.progress,t);this.#e.textContent=i,this.#t.textContent=o,this.el.offsetWidth,await this.#n(!0)}finish(t){this.finished||(this.finished=!0,this.lastStageStartTime!==null&&this.recordTiming(this.value.stage,this.lastStageStartTime),this.recordTiming(t?"error":"done",this.startTime||this.lastStageStartTime||performance.now()),this.set({stage:"done",progress:null,error:t||null}),this.onFinish(Object.assign([...this.timings],{awaitRepaintPenaltyTime:Math.round(this.awaitRepaintPenaltyTime)})),this.el.classList.add("done"),this.el.classList.toggle("error",!!t))}dispose(){this.finish(),this.el.remove()}};var Cc=Object.assign(Hy(),{setup:Hy}),Fy=n=>/^\./.test(n);function Hy(n){return n=n||{},function(t){let i=!!(n.dragdrop||n.dragdrop===void 0),o=n.accept?String(n.accept):"application/json,application/jsonxl,.json,.jsonxl",l=o.split(",");i&&(t.dom.container.addEventListener("drop",c=>{t.loadDataFromEvent(c)},!0),t.dom.container.addEventListener("dragover",c=>{c.stopPropagation(),c.preventDefault()},!0)),t.preset.define("upload",[{view:"button-primary",onClick:"=#.actions.uploadFile",content:'text:`Open file ${#.actions.uploadFile.fileExtensions | $ ? "(" + join(", ") + ")" : ""}`'},{view:"context",when:"#.actions.uploadFile.dragdrop",content:['html:"<span style=\\"color: #888; padding: 0 1ex\\"> or </span>"','text:"drop a file on the page"']}]),t.action.define("unloadData",()=>{t.unloadData()}),t.action.define("uploadFile",Object.assign(()=>{U("input",{type:"file",accept:o,onchange:c=>t.loadDataFromEvent(c)}).click()},{fileExtensions:l.filter(c=>Fy(c)),mimeTypes:l.filter(c=>!Fy(c)),dragdrop:i}))}}function Sc(){return[performance.timeOrigin.toString(16),(1e4*performance.now()).toString(16),String(Math.random().toString(16).slice(2))].join("-")}var zo=Object.assign(Vy(),{setup:Vy}),_y=()=>{},qy=["primary","secondary","menu"],FS=new Map([["insert",0],["prepend",0],["append",0],["before",1],["after",1],["replace",1],["remove"]]);function Wy({mode:n,value:t}){return n==="auto"?"auto":t?"dark":"light"}function Vy(n){return n=n||{},function(t){let i=null,o=_y,l=()=>{i?.finish(),i=null},c=n.hostId||Sc(),f=window.parent,d=new Map,g=(C,E=null)=>{f.postMessage({from:"discoveryjs-app",id:c,type:C,payload:E},"*")},y=C=>{o=()=>{C!==null&&(o=_y,C())}},b=C=>{(typeof t.trackLoadDataProgress=="function"?t.trackLoadDataProgress(C):C.dataset.then(M=>t.setData(M.data,null,{dataset:M}))).catch(()=>{})},k=C=>{let{id:E,type:M,payload:O}=C.data||{};if(E===c)switch(M){case"defineAction":{let L=O;t.action.define(L,(...S)=>new Promise((T,N)=>{let A=Sc();d.set(A,{resolve:T,reject:N}),setTimeout(()=>{d.delete(A),N(new Error("Timeout"))},3e4),g("action",{callId:A,name:L,args:S})}));break}case"actionResult":{let{callId:L,value:S,error:T}=O;if(!d.has(L)){t.log("error",`[Discovery.js] Unknown action call id "${L}"`);break}let{resolve:N,reject:A}=d.get(L);T?A(T):N(S);break}case"setPageHash":{let{replace:L,hash:S}=O||{};t.setPageHash(S||"",L||!1);break}case"setPage":{let{replace:L,id:S,ref:T,params:N}=O||{};t.setPage(S,T,N,L);break}case"setPageRef":{let{replace:L,ref:S}=O||{};t.setPageRef(S,L);break}case"setPageParams":{let{replace:L,params:S}=O||{};t.setPageParams(S,L);break}case"setDarkmode":{let L=O,S=["auto","light","dark"];if(!S.includes(L)){t.log("warn",`Wrong value for darkmode "${L}", supported values: ${S.map(T=>JSON.stringify(T)).join(", ")}`);break}t.darkmode.set(L==="auto"?"auto":L==="dark");break}case"setRouterPreventLocationUpdate":{t.action.call("setPreventLocationUpdate",!!O);break}case"changeNavButtons":{let{section:L="primary",action:S="append",name:T,position:N,commands:A,config:j}=O||{};if(!qy.includes(L)){t.log("warn",`Wrong value for nav button place "${L}", supported values: ${qy.map(W=>JSON.stringify(W)).join(", ")}`);break}let I=A||{},z=JSON.parse(JSON.stringify(j),(W,H)=>I.includes(H)?()=>g("navMethod",H):H);switch(S){case"insert":t.nav[L].insert(z,N,T);break;case"prepend":case"append":t.nav[L][S](z);break;case"before":case"after":case"replace":t.nav[L][S](T,z);break;case"remove":t.nav[L].remove(T);break;default:t.log("warn",`Wrong value for nav button action "${S}", supported values: ${FS.map(W=>JSON.stringify(W)).join(", ")}`)}break}case"unloadData":{l(),t.unloadData();break}case"dataStream":{let{stream:L,resource:S}=O;l(),b(si(L,{resource:S}));break}case"startChunkedDataUpload":{let{acceptToken:L,resource:S}=O;l(),i=Object.assign(js({resource:S}),{acceptToken:L}),b(i);break}case"cancelChunkedDataUpload":{let{acceptToken:L,error:S}=O;i?.acceptToken===L&&l(S)}case"dataChunk":{let{acceptToken:L,value:S,done:T}=O;if(i===null){t.log("warn","Loading data is not inited");break}if(i.acceptToken!==L){t.log("warn","Bad accept token");break}S&&i.push(S),T&&l();break}default:t.log("warn",`Got a post-message addressed to discovery app but with unknown "${M}" type`)}};f!==window&&(t.on("pageHashChange",C=>g("pageHashChanged",{replace:C,hash:t.pageHash||"#",id:t.pageId,ref:t.pageRef,params:t.pageParams})),t.on("startLoadData",C=>{o(),y(C(E=>g("loadingState",E)))}),t.on("startSetData",C=>{o(),y(C(E=>g("loadingState",E)))}),t.on("unloadData",()=>{o(),g("unloadData")}),t.on("data",()=>{g("data")}),t.darkmode.subscribe((C,E)=>g("darkmodeChanged",{mode:E,value:Wy({mode:E,value:C})})),n.postponeMessages&&Promise.resolve().then(()=>{for(let C of n.postponeMessages)k({data:C})}),addEventListener("message",k,!1),addEventListener("unload",()=>g("destroy"),!1),g("ready",{page:{hash:t.pageHash||"#",id:t.pageId,ref:t.pageRef,params:t.pageParams},darkmode:{mode:t.darkmode.mode,value:Wy(t.darkmode)}}))}}function Tc(n){let t=!1;n.setPageHash(location.hash),n.cancelScheduledRender(),n.action.define("permalink",i=>new URL(i,String(location)).href),n.action.define("setPreventLocationUpdate",(i=!0)=>{t=i}),window.addEventListener("hashchange",()=>n.setPageHash(location.hash),!1),n.on("pageHashChange",function(i){let o=n.pageHash||"#";t||o==="#"&&!location.hash||(i?location.replace(o):location.hash=o)})}var vi=(n,t)=>n!==void 0?n:t,bi=class extends jo{mode;_defaultPageId;constructor(t={}){let i=t.extensions?[t.extensions]:[];i.push(Wp),vi(t.router,!0)&&i.push(Tc),t.mode!=="modelfree"&&(i.push(Hp),i.push(_p)),vi(t.upload,!1)&&(i.push(Cc.setup(t.upload)),i.push(qp)),vi(t.embed,!1)&&i.push(zo),vi(t.inspector,!0)&&i.push(Vp),super({container:document.body,...t,extensions:i,darkmode:vi(t.darkmode,"auto"),darkmodePersistent:vi(t.darkmodePersistent,!0)}),this.mode=t.mode}setLoadingState(t,i){let o=this.dom.loadingOverlay,{progressbar:l}=i||{};switch(t){case"init":{if(o.classList.remove("error","done"),l?.el.parentNode)return;o.replaceChildren(l?.el||"");break}case"success":{o.classList.add("done");break}case"error":{let c=i?.error;o.classList.add("error"),o.replaceChildren(),this.view.render(o,[{view:"block",className:"action-buttons",content:[{view:"preset/upload",when:this.preset.isDefined("upload")}]},{view:"block",className:Le(c,"renderContent")?"warning-message":"error-message",content:[{view:"block",className:"error-type-badge",postRender(f,d,g){g.stage&&(f.dataset.stage=` on ${g.stage}`)}},"h3:errorText",c.renderContent||'text:"(see details in the console)"']}],{stage:l?.value.stage,errorText:String(c),errorMessage:c.message||String(c),errorStack:(c.stack||"").replace(/^Error:\s*(\S+Error:)/,"$1")},{actions:this.action.actionMap}).then(()=>{this.log("error",c),l?.setState({error:c})});break}}}async setDataProgress(t,i,o){let l=o?.dataset,c=o?.progressbar||this.progressbar({title:"Set data"});try{this.setLoadingState("init",{progressbar:c}),await super.setDataProgress(t,i,{dataset:l,progressbar:c}),this.setLoadingState("success")}catch(f){this.setLoadingState("error",{error:f,progressbar:c})}}progressbar(t){return new Lr({domReady:this.dom.ready,onFinish:i=>this.log({level:"perf",message:`${t.title||"Load data"} (${i[i.length-1].duration}ms)`,collapsed:()=>[...i.map(o=>`${o.title}: ${o.duration}ms`),`(await repaint: ${i.awaitRepaintPenaltyTime}ms)`]}),...t})}async trackLoadDataProgress(t){let i=this.progressbar({title:t.title});this.setLoadingState("init",{progressbar:i}),this.emit("startLoadData",i.subscribe.bind(i)),vu(t,i).then(o=>this.setDataProgress(o.data,null,{dataset:o,progressbar:i}),o=>this.setLoadingState("error",{error:o,progressbar:i})),await t.dataset}loadDataFromEvent(t,i){return this.mode==="modelfree"&&this.defaultPageId!==this.discoveryPageId&&(this._defaultPageId=this.defaultPageId,this.defaultPageId=this.discoveryPageId,this.setPageHash(this.pageHash,!0),this.cancelScheduledRender()),super.loadDataFromEvent(t,i)}unloadData(){this.hasDatasets()&&this.mode==="modelfree"&&this._defaultPageId!==this.defaultPageId&&(this.defaultPageId=this._defaultPageId,this.setPageHash(this.pageHash,!0),this.cancelScheduledRender()),super.unloadData()}initDom(t){super.initDom(t),this.dom.container.append(this.dom.loadingOverlay=U("div","loading-overlay done"))}renderPage(){return document.title=this.getRenderContext().name||document.title,super.renderPage()}};var Ec={};Ae(Ec,{applyContainerStyles:()=>qS,rollbackContainerStyles:()=>WS});var HS={"font-family":"Tahoma, Verdana, Arial, sans-serif","font-size":"14px","line-height":"1.6","-webkit-text-size-adjust":"none","text-size-adjust":"none","background-color":"var(--discovery-background-color, white)",color:"var(--discovery-color, black)","transition-property":"background-color, color","transition-duration":".25s","transition-timing-function":"ease-in"},_S={"--discovery-background-color":"#242424","--discovery-color":"#cccccc"},Ac=new WeakSet,wi=new WeakMap;function Uy(n,t,i){t in i||(i[t]=[n.style.getPropertyValue(t),n.style.getPropertyPriority(t)])}function qS(n,t){t=t||{},wi.has(n)||wi.set(n,Object.create(null));let i=Fp(t.darkmode,t.darkmodePersistent),o=wi.get(n)??{};for(let[l,c]of Object.entries(HS))(Ac.has(n)||!/^transition/.test(l))&&(Uy(n,l,o),n.style.setProperty(l,c));for(let[l,c]of Object.entries(_S))Uy(n,l,o),i?n.style.setProperty(l,c):n.style.removeProperty(l);return Ac.add(n),i}function WS(n){if(wi.has(n)){let t=wi.get(n)??{};for(let[i,o]of Object.entries(t))n.style.setProperty(i,...o);wi.delete(n),Ac.delete(n)}}var VS={...Ec,base64:ua,...Su,copyText:kt,...wu,debounce:In,...Cu,..._u,injectStyles:Co,...lc,...uu,...pc,...Bu,pattern:cc,persistent:Au,...ju,progressbar:Lr,safeFilterRx:Oo,...Mu};function a2(n,t,i,o){let l=n.model,c=new bi({mode:n.mode,styles:n.styles,darkmode:l.darkmode,darkmodePersistent:l.darkmodePersistent,upload:l.upload,inspector:l.inspector,router:l.router,encodings:Ld,setup:ul,extensions:[...Md,l.embed?zo.setup(i):null,ul?null:Ed]});n.mode==="multi"&&c.nav.menu.append({name:"switch-model",onClick:'=$handler:"openModelIndex".actionHandler(href); $hide: #.hide; $handler and => $hide() or $handler()',data:{text:"Switch model",href:n.indexUrl}});let f={model:l};return o?c.setDataProgress(o.data,f,{progressbar:t,dataset:o}):(c.context=f,c.renderPage())}export{a2 as default};
